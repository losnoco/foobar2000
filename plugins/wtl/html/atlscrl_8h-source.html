<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>atlscrl.h Source File</title>
<link href="mystyles.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>atlscrl.h</h1><a href="atlscrl_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// Windows Template Library - WTL version 7.0</font>
00002 <font class="comment">// Copyright (C) 1997-2002 Microsoft Corporation</font>
00003 <font class="comment">// All rights reserved.</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// This file is a part of the Windows Template Library.</font>
00006 <font class="comment">// The code and information is provided "as-is" without</font>
00007 <font class="comment">// warranty of any kind, either expressed or implied.</font>
00008 
00009 <font class="preprocessor">#ifndef __ATLSCRL_H__</font>
00010 <font class="preprocessor"></font><font class="preprocessor">#define __ATLSCRL_H__</font>
00011 <font class="preprocessor"></font>
00012 <font class="preprocessor">#pragma once</font>
00013 <font class="preprocessor"></font>
00014 <font class="preprocessor">#ifndef __cplusplus</font>
00015 <font class="preprocessor"></font><font class="preprocessor">    #error ATL requires C++ compilation (use a .cpp suffix)</font>
00016 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00017 <font class="preprocessor"></font>
00018 <font class="preprocessor">#ifndef __ATLAPP_H__</font>
00019 <font class="preprocessor"></font><font class="preprocessor">    #error atlscrl.h requires atlapp.h to be included first</font>
00020 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00021 <font class="preprocessor"></font>
00022 <font class="preprocessor">#ifndef __ATLWIN_H__</font>
00023 <font class="preprocessor"></font><font class="preprocessor">    #error atlscrl.h requires atlwin.h to be included first</font>
00024 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00025 <font class="preprocessor"></font>
00026 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00027 <font class="preprocessor"></font><font class="preprocessor">#include &lt;zmouse.h&gt;</font>
00028 <font class="preprocessor">#endif </font>
00029 <font class="preprocessor"></font>
00030 <font class="preprocessor"></font>
00032 <font class="comment">// Classes in this file</font>
00033 <font class="comment">//</font>
00034 <font class="comment">// CScrollImpl&lt;T&gt;</font>
00035 <font class="comment">// CScrollWindowImpl&lt;T, TBase, TWinTraits&gt;</font>
00036 <font class="comment">// CMapScrollImpl&lt;T&gt;</font>
00037 <font class="comment">// CMapScrollWindowImpl&lt;T, TBase, TWinTraits&gt;</font>
00038 <font class="comment">// CFSBWindowT&lt;TBase&gt;</font>
00039 
00040 
00041 <font class="keyword">namespace </font>WTL
00042 {
00043 
00045 <font class="comment">// CScrollImpl - Provides scrolling support to any window</font>
00046 
00047 <font class="comment">// Scroll extended styles</font>
<a name="l00048"></a><a class="code" href="atlscrl_8h.html#a0">00048</a> <font class="preprocessor">#define SCRL_SCROLLCHILDREN 0x00000001</font>
<a name="l00049"></a><a class="code" href="atlscrl_8h.html#a1">00049</a> <font class="preprocessor"></font><font class="preprocessor">#define SCRL_ERASEBACKGROUND    0x00000002</font>
<a name="l00050"></a><a class="code" href="atlscrl_8h.html#a2">00050</a> <font class="preprocessor"></font><font class="preprocessor">#define SCRL_NOTHUMBTRACKING    0x00000004</font>
00051 <font class="preprocessor"></font><font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l00052"></a><a class="code" href="atlscrl_8h.html#a3">00052</a> <font class="preprocessor"></font><font class="preprocessor">#define SCRL_SMOOTHSCROLL   0x00000008</font>
00053 <font class="preprocessor"></font><font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
00054 <font class="preprocessor"></font>
00055 
00056 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l00057"></a><a class="code" href="classWTL_1_1CScrollImpl.html">00057</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl</a>
00058 {
00059 <font class="keyword">public</font>:
00060     <font class="keyword">enum</font> { <a class="code" href="classWTL_1_1CScrollImpl.html#s1s0">uSCROLL_FLAGS</a> = SW_INVALIDATE };
00061 
<a name="l00062"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m0">00062</a>     POINT <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>;
<a name="l00063"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m1">00063</a>     SIZE <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>;
<a name="l00064"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m2">00064</a>     SIZE <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>;
<a name="l00065"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m3">00065</a>     SIZE <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>;
<a name="l00066"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m4">00066</a>     SIZE <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>;
<a name="l00067"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m5">00067</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a>;           <font class="comment">// current wheel value</font>
<a name="l00068"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m6">00068</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CScrollImpl.html#m6">m_nWheelLines</a>;      <font class="comment">// number of lines to scroll on wheel</font>
00069 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00070 <font class="preprocessor"></font>    UINT m_uMsgMouseWheel;      <font class="comment">// MSH_MOUSEWHEEL</font>
00071     <font class="comment">// Note that this message must be forwarded from a top level window</font>
00072 <font class="preprocessor">#endif </font>
<a name="l00073"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m7">00073</a> <font class="preprocessor">    UINT m_uScrollFlags;</font>
<a name="l00074"></a><a class="code" href="classWTL_1_1CScrollImpl.html#m8">00074</a> <font class="preprocessor"></font>    DWORD <a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a>;    <font class="comment">// scroll specific extended styles</font>
00075 
00076 <font class="comment">// Constructor</font>
<a name="l00077"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a0">00077</a>     <a class="code" href="classWTL_1_1CScrollImpl.html#a0">CScrollImpl</a>() : <a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a>(0), <a class="code" href="classWTL_1_1CScrollImpl.html#m6">m_nWheelLines</a>(3), <a class="code" href="classWTL_1_1CScrollImpl.html#m7">m_uScrollFlags</a>(0U), <a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a>(0)
00078     {
00079         <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x = 0;
00080         <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y = 0;
00081         <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx = 0;
00082         <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy = 0;
00083         <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx = 0;
00084         <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy = 0;
00085         <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx = 0;
00086         <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy = 0;
00087         <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cx = 0;
00088         <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cy = 0;
00089 
00090         <a class="code" href="classWTL_1_1CScrollImpl.html#a2">SetScrollExtendedStyle</a>(<a class="code" href="atlscrl_8h.html#a0">SCRL_SCROLLCHILDREN</a> | <a class="code" href="atlscrl_8h.html#a1">SCRL_ERASEBACKGROUND</a>);
00091     }
00092 
00093 <font class="comment">// Attributes &amp; Operations</font>
<a name="l00094"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a1">00094</a>     DWORD <a class="code" href="classWTL_1_1CScrollImpl.html#a1">GetScrollExtendedStyle</a>()<font class="keyword"> const</font>
00095 <font class="keyword">    </font>{
00096         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a>;
00097     }
00098 
<a name="l00099"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a2">00099</a>     DWORD <a class="code" href="classWTL_1_1CScrollImpl.html#a2">SetScrollExtendedStyle</a>(DWORD dwExtendedStyle, DWORD dwMask = 0)
00100     {
00101         DWORD dwPrevStyle = <a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a>;
00102         <font class="keywordflow">if</font>(dwMask == 0)
00103             <a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> = dwExtendedStyle;
00104         <font class="keywordflow">else</font>
00105             <a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> = (<a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> &amp; ~dwMask) | (dwExtendedStyle &amp; dwMask);
00106         <font class="comment">// cache scroll flags</font>
00107         T* pT = static_cast&lt;T*&gt;(this);
00108         pT; <font class="comment">// avoid level 4 warning</font>
00109         <a class="code" href="classWTL_1_1CScrollImpl.html#m7">m_uScrollFlags</a> = pT-&gt;uSCROLL_FLAGS | (<a class="code" href="classWTL_1_1CScrollImpl.html#a50">IsScrollingChildren</a>() ? SW_SCROLLCHILDREN : 0) | (<a class="code" href="classWTL_1_1CScrollImpl.html#a51">IsErasingBackground</a>() ? SW_ERASE : 0);
00110 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
00111 <font class="preprocessor"></font>        <a class="code" href="classWTL_1_1CScrollImpl.html#m7">m_uScrollFlags</a> |= (<a class="code" href="classWTL_1_1CScrollImpl.html#a53">IsSmoothScroll</a>() ? SW_SMOOTHSCROLL : 0);
00112 <font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
00113 <font class="preprocessor"></font>        <font class="keywordflow">return</font> dwPrevStyle;
00114     }
00115 
00116     <font class="comment">// offset operations</font>
<a name="l00117"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a3">00117</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, BOOL bRedraw = TRUE)
00118     {
00119         T* pT = static_cast&lt;T*&gt;(this);
00120         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00121 
00122         <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x = x;
00123         <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y = y;
00124 
00125         SCROLLINFO si;
00126         si.cbSize = <font class="keyword">sizeof</font>(si);
00127         si.fMask = SIF_POS;
00128 
00129         si.nPos = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x;
00130         pT-&gt;SetScrollInfo(SB_HORZ, &amp;si, bRedraw);
00131 
00132         si.nPos = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y;
00133         pT-&gt;SetScrollInfo(SB_VERT, &amp;si, bRedraw);
00134 
00135         <font class="keywordflow">if</font>(bRedraw)
00136             pT-&gt;Invalidate();
00137     }
<a name="l00138"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a4">00138</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(POINT ptOffset, BOOL bRedraw = TRUE)
00139     {
00140         <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(ptOffset.x, ptOffset.y, bRedraw);
00141     }
<a name="l00142"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a5">00142</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a5">GetScrollOffset</a>(POINT&amp; ptOffset)<font class="keyword"> const</font>
00143 <font class="keyword">    </font>{
00144         ptOffset = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>;
00145     }
00146 
00147     <font class="comment">// size operations</font>
<a name="l00148"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a6">00148</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy, BOOL bRedraw = TRUE)
00149     {
00150         T* pT = static_cast&lt;T*&gt;(this);
00151         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00152 
00153         <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx = cx;
00154         <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy = cy;
00155 
00156         <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x = 0;
00157         <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y = 0;
00158 
00159         SCROLLINFO si;
00160         si.cbSize = <font class="keyword">sizeof</font>(si);
00161         si.fMask = SIF_PAGE | SIF_RANGE | SIF_POS;
00162         si.nMin = 0;
00163 
00164         si.nMax = <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx - 1;
00165         si.nPage = <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cx;
00166         si.nPos = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x;
00167         pT-&gt;SetScrollInfo(SB_HORZ, &amp;si, bRedraw);
00168 
00169         si.nMax = <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy - 1;
00170         si.nPage = <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cy;
00171         si.nPos = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y;
00172         pT-&gt;SetScrollInfo(SB_VERT, &amp;si, bRedraw);
00173 
00174         <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(0, 0);
00175         <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(0, 0);
00176 
00177         <font class="keywordflow">if</font>(bRedraw)
00178             pT-&gt;Invalidate();
00179     }
<a name="l00180"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a7">00180</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(SIZE size, BOOL bRedraw = TRUE)
00181     {
00182         <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(size.cx, size.cy, bRedraw);
00183     }
<a name="l00184"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a8">00184</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a8">GetScrollSize</a>(SIZE&amp; sizeWnd)<font class="keyword"> const</font>
00185 <font class="keyword">    </font>{
00186         sizeWnd = <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>;
00187     }
00188 
00189     <font class="comment">// line operations</font>
<a name="l00190"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a9">00190</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(<font class="keywordtype">int</font> cxLine, <font class="keywordtype">int</font> cyLine)
00191     {
00192         ATLASSERT(cxLine &gt;= 0 &amp;&amp; cyLine &gt;= 0);
00193         ATLASSERT(<a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx != 0 &amp;&amp; <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy != 0);
00194 
00195         <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx = <a class="code" href="classWTL_1_1CScrollImpl.html#a48">CalcLineOrPage</a>(cxLine, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, 100);
00196         <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy = <a class="code" href="classWTL_1_1CScrollImpl.html#a48">CalcLineOrPage</a>(cyLine, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, 100);
00197     }
<a name="l00198"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a10">00198</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(SIZE sizeLine)
00199     {
00200         <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(sizeLine.cx, sizeLine.cy);
00201     }
<a name="l00202"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a11">00202</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a11">GetScrollLine</a>(SIZE&amp; sizeLine)<font class="keyword"> const</font>
00203 <font class="keyword">    </font>{
00204         sizeLine = <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>;
00205     }
00206 
00207     <font class="comment">// page operations</font>
<a name="l00208"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a12">00208</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(<font class="keywordtype">int</font> cxPage, <font class="keywordtype">int</font> cyPage)
00209     {
00210         ATLASSERT(cxPage &gt;= 0 &amp;&amp; cyPage &gt;= 0);
00211         ATLASSERT(<a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx != 0 &amp;&amp; <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy != 0);
00212 
00213         <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx = <a class="code" href="classWTL_1_1CScrollImpl.html#a48">CalcLineOrPage</a>(cxPage, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, 10);
00214         <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy = <a class="code" href="classWTL_1_1CScrollImpl.html#a48">CalcLineOrPage</a>(cyPage, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, 10);
00215     }
<a name="l00216"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a13">00216</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(SIZE sizePage)
00217     {
00218         <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(sizePage.cx, sizePage.cy);
00219     }
<a name="l00220"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a14">00220</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a14">GetScrollPage</a>(SIZE&amp; sizePage)<font class="keyword"> const</font>
00221 <font class="keyword">    </font>{
00222         sizePage = <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>;
00223     }
00224 
00225     <font class="comment">// commands</font>
<a name="l00226"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a15">00226</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a15">ScrollLineDown</a>()
00227     {
00228         T* pT = static_cast&lt;T*&gt;(this);
00229         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00230         pT-&gt;DoScroll(SB_VERT, SB_LINEDOWN, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00231     }
00232 
<a name="l00233"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a16">00233</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a16">ScrollLineUp</a>()
00234     {
00235         T* pT = static_cast&lt;T*&gt;(this);
00236         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00237         pT-&gt;DoScroll(SB_VERT, SB_LINEUP, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00238     }
00239 
<a name="l00240"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a17">00240</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a17">ScrollPageDown</a>()
00241     {
00242         T* pT = static_cast&lt;T*&gt;(this);
00243         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00244         pT-&gt;DoScroll(SB_VERT, SB_PAGEDOWN, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00245     }
00246 
<a name="l00247"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a18">00247</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a18">ScrollPageUp</a>()
00248     {
00249         T* pT = static_cast&lt;T*&gt;(this);
00250         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00251         pT-&gt;DoScroll(SB_VERT, SB_PAGEUP, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00252     }
00253 
<a name="l00254"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a19">00254</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a19">ScrollTop</a>()
00255     {
00256         T* pT = static_cast&lt;T*&gt;(this);
00257         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00258         pT-&gt;DoScroll(SB_VERT, SB_TOP, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00259     }
00260 
<a name="l00261"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a20">00261</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a20">ScrollBottom</a>()
00262     {
00263         T* pT = static_cast&lt;T*&gt;(this);
00264         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00265         pT-&gt;DoScroll(SB_VERT, SB_BOTTOM, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00266     }
00267 
<a name="l00268"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a21">00268</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a21">ScrollLineRight</a>()
00269     {
00270         T* pT = static_cast&lt;T*&gt;(this);
00271         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00272         pT-&gt;DoScroll(SB_HORZ, SB_LINEDOWN, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00273     }
00274 
<a name="l00275"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a22">00275</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a22">ScrollLineLeft</a>()
00276     {
00277         T* pT = static_cast&lt;T*&gt;(this);
00278         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00279         pT-&gt;DoScroll(SB_HORZ, SB_LINEUP, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00280     }
00281 
<a name="l00282"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a23">00282</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a23">ScrollPageRight</a>()
00283     {
00284         T* pT = static_cast&lt;T*&gt;(this);
00285         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00286         pT-&gt;DoScroll(SB_HORZ, SB_PAGEDOWN, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00287     }
00288 
<a name="l00289"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a24">00289</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a24">ScrollPageLeft</a>()
00290     {
00291         T* pT = static_cast&lt;T*&gt;(this);
00292         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00293         pT-&gt;DoScroll(SB_HORZ, SB_PAGEUP, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00294     }
00295 
<a name="l00296"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a25">00296</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a25">ScrollAllLeft</a>()
00297     {
00298         T* pT = static_cast&lt;T*&gt;(this);
00299         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00300         pT-&gt;DoScroll(SB_HORZ, SB_TOP, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00301     }
00302 
<a name="l00303"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a26">00303</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a26">ScrollAllRight</a>()
00304     {
00305         T* pT = static_cast&lt;T*&gt;(this);
00306         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00307         pT-&gt;DoScroll(SB_HORZ, SB_BOTTOM, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00308     }
00309 
00310     BEGIN_MSG_MAP(CScrollImpl&lt; T &gt;)
00311         MESSAGE_HANDLER(WM_CREATE, <a class="code" href="classWTL_1_1CScrollImpl.html#a27">OnCreate</a>)
00312         MESSAGE_HANDLER(WM_VSCROLL, <a class="code" href="classWTL_1_1CScrollImpl.html#a28">OnVScroll</a>)
00313         MESSAGE_HANDLER(WM_HSCROLL, <a class="code" href="classWTL_1_1CScrollImpl.html#a29">OnHScroll</a>)
00314         MESSAGE_HANDLER(WM_MOUSEWHEEL, <a class="code" href="classWTL_1_1CScrollImpl.html#a30">OnMouseWheel</a>)
00315 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00316 <font class="preprocessor"></font>        MESSAGE_HANDLER(m_uMsgMouseWheel, <a class="code" href="classWTL_1_1CScrollImpl.html#a30">OnMouseWheel</a>)
00317 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400)</font>
00318 <font class="preprocessor"></font>        MESSAGE_HANDLER(WM_SETTINGCHANGE, <a class="code" href="classWTL_1_1CScrollImpl.html#a31">OnSettingChange</a>)
00319         MESSAGE_HANDLER(WM_SIZE, <a class="code" href="classWTL_1_1CScrollImpl.html#a32">OnSize</a>)
00320         MESSAGE_HANDLER(WM_PAINT, <a class="code" href="classWTL_1_1CScrollImpl.html#a33">OnPaint</a>)
00321         MESSAGE_HANDLER(WM_PRINTCLIENT, <a class="code" href="classWTL_1_1CScrollImpl.html#a33">OnPaint</a>)
00322     <font class="comment">// standard scroll commands</font>
00323     ALT_MSG_MAP(1)
00324         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a81">ID_SCROLL_UP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a34">OnScrollUp</a>)
00325         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a82">ID_SCROLL_DOWN</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a35">OnScrollDown</a>)
00326         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a83">ID_SCROLL_PAGE_UP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a36">OnScrollPageUp</a>)
00327         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a84">ID_SCROLL_PAGE_DOWN</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a37">OnScrollPageDown</a>)
00328         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a85">ID_SCROLL_TOP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a38">OnScrollTop</a>)
00329         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a86">ID_SCROLL_BOTTOM</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a39">OnScrollBottom</a>)
00330         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a87">ID_SCROLL_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a40">OnScrollLeft</a>)
00331         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a88">ID_SCROLL_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a41">OnScrollRight</a>)
00332         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a89">ID_SCROLL_PAGE_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a42">OnScrollPageLeft</a>)
00333         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a90">ID_SCROLL_PAGE_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a43">OnScrollPageRight</a>)
00334         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a91">ID_SCROLL_ALL_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a44">OnScrollAllLeft</a>)
00335         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a92">ID_SCROLL_ALL_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html#a45">OnScrollAllRight</a>)
00336     END_MSG_MAP()
00337 
<a name="l00338"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a27">00338</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a27">OnCreate</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00339     {
00340         <a class="code" href="classWTL_1_1CScrollImpl.html#a49">GetSystemSettings</a>();
00341         bHandled = FALSE;
00342         <font class="keywordflow">return</font> 1;
00343     }
00344 
<a name="l00345"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a28">00345</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a28">OnVScroll</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00346     {
00347         T* pT = static_cast&lt;T*&gt;(this);
00348         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00349         pT-&gt;DoScroll(SB_VERT, (<font class="keywordtype">int</font>)(<font class="keywordtype">short</font>)LOWORD(wParam), (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00350         <font class="keywordflow">return</font> 0;
00351     }
00352 
<a name="l00353"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a29">00353</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a29">OnHScroll</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00354     {
00355         T* pT = static_cast&lt;T*&gt;(this);
00356         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00357         pT-&gt;DoScroll(SB_HORZ, (<font class="keywordtype">int</font>)(<font class="keywordtype">short</font>)LOWORD(wParam), (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00358         <font class="keywordflow">return</font> 0;
00359     }
00360 
<a name="l00361"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a30">00361</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a30">OnMouseWheel</a>(UINT uMsg, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00362     {
00363         T* pT = static_cast&lt;T*&gt;(this);
00364         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00365 
00366 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400)</font>
00367 <font class="preprocessor"></font>        uMsg;
00368         <font class="keywordtype">int</font> zDelta = (int)(short)HIWORD(wParam);
00369 <font class="preprocessor">#else</font>
00370 <font class="preprocessor"></font>        <font class="keywordtype">int</font> zDelta = (uMsg == WM_MOUSEWHEEL) ? (int)(short)HIWORD(wParam) : (int)wParam;
00371 <font class="preprocessor">#endif </font>
00372 <font class="preprocessor">        int nScrollCode = (m_nWheelLines == WHEEL_PAGESCROLL) ? ((zDelta &gt; 0) ? SB_PAGEUP : SB_PAGEDOWN) : ((zDelta &gt; 0) ? SB_LINEUP : SB_LINEDOWN);</font>
00373 <font class="preprocessor"></font>        <a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a> += zDelta;     <font class="comment">// cumulative</font>
00374         <font class="keywordtype">int</font> zTotal = (<a class="code" href="classWTL_1_1CScrollImpl.html#m6">m_nWheelLines</a> == WHEEL_PAGESCROLL) ? abs(<a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a>) : abs(<a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a>) * <a class="code" href="classWTL_1_1CScrollImpl.html#m6">m_nWheelLines</a>;
00375         <font class="keywordflow">if</font>((pT-&gt;GetStyle() &amp; WS_VSCROLL) != 0)
00376         {
00377             <font class="keywordflow">for</font>(<font class="keywordtype">short</font> i = 0; i &lt; zTotal; i += WHEEL_DELTA)
00378             {
00379                 pT-&gt;DoScroll(SB_VERT, nScrollCode, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cy, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cy);
00380                 pT-&gt;UpdateWindow();
00381             }
00382         }
00383         <font class="keywordflow">else</font>        <font class="comment">// can't scroll vertically, scroll horizontally</font>
00384         {
00385             <font class="keywordflow">for</font>(<font class="keywordtype">short</font> i = 0; i &lt; zTotal; i += WHEEL_DELTA)
00386             {
00387                 pT-&gt;DoScroll(SB_HORZ, nScrollCode, (<font class="keywordtype">int</font>&amp;)<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m3">m_sizePage</a>.cx, <a class="code" href="classWTL_1_1CScrollImpl.html#m2">m_sizeLine</a>.cx);
00388                 pT-&gt;UpdateWindow();
00389             }
00390         }
00391         <font class="keywordtype">int</font> nSteps = <a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a> / WHEEL_DELTA;
00392         <a class="code" href="classWTL_1_1CScrollImpl.html#m5">m_zDelta</a> -= nSteps * WHEEL_DELTA;
00393 
00394         <font class="keywordflow">return</font> 0;
00395     }
00396 
<a name="l00397"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a31">00397</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a31">OnSettingChange</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00398     {
00399         <a class="code" href="classWTL_1_1CScrollImpl.html#a49">GetSystemSettings</a>();
00400         <font class="keywordflow">return</font> 0;
00401     }
00402 
<a name="l00403"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a32">00403</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a32">OnSize</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; bHandled)
00404     {
00405         T* pT = static_cast&lt;T*&gt;(this);
00406         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00407 
00408         <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cx = <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam);
00409         <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cy = <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam);
00410 
00411         SCROLLINFO si;
00412         si.cbSize = <font class="keyword">sizeof</font>(si);
00413         si.fMask = SIF_PAGE | SIF_POS;
00414 
00415         si.nPage = <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cx;
00416         si.nPos = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x;
00417         pT-&gt;SetScrollInfo(SB_HORZ, &amp;si, FALSE);
00418 
00419         si.nPage = <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cy;
00420         si.nPos = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y;
00421         pT-&gt;SetScrollInfo(SB_VERT, &amp;si, FALSE);
00422 
00423         <font class="keywordtype">bool</font> bUpdate = <font class="keyword">false</font>;
00424         <font class="keywordtype">int</font> cxMax = <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cx - <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cx;
00425         <font class="keywordtype">int</font> cyMax = <a class="code" href="classWTL_1_1CScrollImpl.html#m1">m_sizeAll</a>.cy - <a class="code" href="classWTL_1_1CScrollImpl.html#m4">m_sizeClient</a>.cy;
00426         <font class="keywordtype">int</font> x = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x;
00427         <font class="keywordtype">int</font> y = <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y;
00428         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x &gt; cxMax)
00429         {
00430             bUpdate = <font class="keyword">true</font>;
00431             x = (cxMax &gt;= 0) ? cxMax : 0;
00432         }
00433         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y &gt; cyMax)
00434         {
00435             bUpdate = <font class="keyword">true</font>;
00436             y = (cyMax &gt;= 0) ? cyMax : 0;
00437         }
00438         <font class="keywordflow">if</font>(bUpdate)
00439         {
00440             pT-&gt;ScrollWindowEx(<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x - x, <a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y - y, <a class="code" href="classWTL_1_1CScrollImpl.html#m7">m_uScrollFlags</a>);
00441             <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(x, y, FALSE);
00442         }
00443 
00444         bHandled = FALSE;
00445         <font class="keywordflow">return</font> 1;
00446     }
00447 
<a name="l00448"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a33">00448</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a33">OnPaint</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00449     {
00450         T* pT = static_cast&lt;T*&gt;(this);
00451         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00452         <font class="keywordflow">if</font>(wParam != NULL)
00453         {
00454             <a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc = (HDC)wParam;
00455             dc.SetViewportOrg(-<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, -<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y);
00456             pT-&gt;DoPaint(dc);
00457         }
00458         <font class="keywordflow">else</font>
00459         {
00460             <a class="code" href="classWTL_1_1CPaintDC.html">CPaintDC</a> dc(pT-&gt;m_hWnd);
00461             dc.<a class="code" href="classWTL_1_1CDCT.html#a56">SetViewportOrg</a>(-<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.x, -<a class="code" href="classWTL_1_1CScrollImpl.html#m0">m_ptOffset</a>.y);
00462             pT-&gt;DoPaint(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
00463         }
00464         <font class="keywordflow">return</font> 0;
00465     }
00466 
00467     <font class="comment">// scrolling handlers</font>
<a name="l00468"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a34">00468</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a34">OnScrollUp</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00469     {
00470         <a class="code" href="classWTL_1_1CScrollImpl.html#a16">ScrollLineUp</a>();
00471         <font class="keywordflow">return</font> 0;
00472     }
<a name="l00473"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a35">00473</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a35">OnScrollDown</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00474     {
00475         <a class="code" href="classWTL_1_1CScrollImpl.html#a15">ScrollLineDown</a>();
00476         <font class="keywordflow">return</font> 0;
00477     }
<a name="l00478"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a36">00478</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a36">OnScrollPageUp</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00479     {
00480         <a class="code" href="classWTL_1_1CScrollImpl.html#a18">ScrollPageUp</a>();
00481         <font class="keywordflow">return</font> 0;
00482     }
<a name="l00483"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a37">00483</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a37">OnScrollPageDown</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00484     {
00485         <a class="code" href="classWTL_1_1CScrollImpl.html#a17">ScrollPageDown</a>();
00486         <font class="keywordflow">return</font> 0;
00487     }
<a name="l00488"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a38">00488</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a38">OnScrollTop</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00489     {
00490         <a class="code" href="classWTL_1_1CScrollImpl.html#a19">ScrollTop</a>();
00491         <font class="keywordflow">return</font> 0;
00492     }
<a name="l00493"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a39">00493</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a39">OnScrollBottom</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00494     {
00495         <a class="code" href="classWTL_1_1CScrollImpl.html#a20">ScrollBottom</a>();
00496         <font class="keywordflow">return</font> 0;
00497     }
<a name="l00498"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a40">00498</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a40">OnScrollLeft</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00499     {
00500         <a class="code" href="classWTL_1_1CScrollImpl.html#a22">ScrollLineLeft</a>();
00501         <font class="keywordflow">return</font> 0;
00502     }
<a name="l00503"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a41">00503</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a41">OnScrollRight</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00504     {
00505         <a class="code" href="classWTL_1_1CScrollImpl.html#a21">ScrollLineRight</a>();
00506         <font class="keywordflow">return</font> 0;
00507     }
<a name="l00508"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a42">00508</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a42">OnScrollPageLeft</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00509     {
00510         <a class="code" href="classWTL_1_1CScrollImpl.html#a24">ScrollPageLeft</a>();
00511         <font class="keywordflow">return</font> 0;
00512     }
<a name="l00513"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a43">00513</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a43">OnScrollPageRight</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00514     {
00515         <a class="code" href="classWTL_1_1CScrollImpl.html#a23">ScrollPageRight</a>();
00516         <font class="keywordflow">return</font> 0;
00517     }
<a name="l00518"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a44">00518</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a44">OnScrollAllLeft</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00519     {
00520         <a class="code" href="classWTL_1_1CScrollImpl.html#a25">ScrollAllLeft</a>();
00521         <font class="keywordflow">return</font> 0;
00522     }
<a name="l00523"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a45">00523</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a45">OnScrollAllRight</a>(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00524     {
00525         <a class="code" href="classWTL_1_1CScrollImpl.html#a26">ScrollAllRight</a>();
00526         <font class="keywordflow">return</font> 0;
00527     }
00528 
00529 <font class="comment">// Overrideables</font>
<a name="l00530"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a46">00530</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a46">DoPaint</a>(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> <font class="comment">/*dc*/</font>)
00531     {
00532         <font class="comment">// must be implemented in a derived class</font>
00533         ATLASSERT(FALSE);
00534     }
00535 
00536 <font class="comment">// Implementation</font>
<a name="l00537"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a47">00537</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a47">DoScroll</a>(<font class="keywordtype">int</font> nType, <font class="keywordtype">int</font> nScrollCode, <font class="keywordtype">int</font>&amp; cxyOffset, <font class="keywordtype">int</font> cxySizeAll, <font class="keywordtype">int</font> cxySizePage, <font class="keywordtype">int</font> cxySizeLine)
00538     {
00539         T* pT = static_cast&lt;T*&gt;(this);
00540         RECT rect;
00541         pT-&gt;GetClientRect(&amp;rect);
00542         <font class="keywordtype">int</font> cxyClient = (nType == SB_VERT) ? rect.bottom : rect.right;
00543         <font class="keywordtype">int</font> cxyMax = cxySizeAll - cxyClient;
00544 
00545         <font class="keywordflow">if</font>(cxyMax &lt; 0)      <font class="comment">// can't scroll, client area is bigger</font>
00546             <font class="keywordflow">return</font>;
00547 
00548         BOOL bUpdate = TRUE;
00549         <font class="keywordtype">int</font> cxyScroll = 0;
00550 
00551         <font class="keywordflow">switch</font>(nScrollCode)
00552         {
00553         <font class="keywordflow">case</font> SB_TOP:        <font class="comment">// top or all left</font>
00554             cxyScroll = cxyOffset;
00555             cxyOffset = 0;
00556             <font class="keywordflow">break</font>;
00557         <font class="keywordflow">case</font> SB_BOTTOM:     <font class="comment">// bottom or all right</font>
00558             cxyScroll = cxyOffset - cxyMax;
00559             cxyOffset = cxyMax;
00560             <font class="keywordflow">break</font>;
00561         <font class="keywordflow">case</font> SB_LINEUP:     <font class="comment">// line up or line left</font>
00562             <font class="keywordflow">if</font>(cxyOffset &gt;= cxySizeLine)
00563             {
00564                 cxyScroll = cxySizeLine;
00565                 cxyOffset -= cxySizeLine;
00566             }
00567             <font class="keywordflow">else</font>
00568             {
00569                 cxyScroll = cxyOffset;
00570                 cxyOffset = 0;
00571             }
00572             <font class="keywordflow">break</font>;
00573         <font class="keywordflow">case</font> SB_LINEDOWN:   <font class="comment">// line down or line right</font>
00574             <font class="keywordflow">if</font>(cxyOffset &lt; cxyMax - cxySizeLine)
00575             {
00576                 cxyScroll = -cxySizeLine;
00577                 cxyOffset += cxySizeLine;
00578             }
00579             <font class="keywordflow">else</font>
00580             {
00581                 cxyScroll = cxyOffset - cxyMax;
00582                 cxyOffset = cxyMax;
00583             }
00584             <font class="keywordflow">break</font>;
00585         <font class="keywordflow">case</font> SB_PAGEUP:     <font class="comment">// page up or page left</font>
00586             <font class="keywordflow">if</font>(cxyOffset &gt;= cxySizePage)
00587             {
00588                 cxyScroll = cxySizePage;
00589                 cxyOffset -= cxySizePage;
00590             }
00591             <font class="keywordflow">else</font>
00592             {
00593                 cxyScroll = cxyOffset;
00594                 cxyOffset = 0;
00595             }
00596             <font class="keywordflow">break</font>;
00597         <font class="keywordflow">case</font> SB_PAGEDOWN:   <font class="comment">// page down or page right</font>
00598             <font class="keywordflow">if</font>(cxyOffset &lt; cxyMax - cxySizePage)
00599             {
00600                 cxyScroll = -cxySizePage;
00601                 cxyOffset += cxySizePage;
00602             }
00603             <font class="keywordflow">else</font>
00604             {
00605                 cxyScroll = cxyOffset - cxyMax;
00606                 cxyOffset = cxyMax;
00607             }
00608             <font class="keywordflow">break</font>;
00609         <font class="keywordflow">case</font> SB_THUMBTRACK:
00610             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CScrollImpl.html#a52">IsNoThumbTracking</a>())
00611                 <font class="keywordflow">break</font>;
00612             <font class="comment">// else fall through</font>
00613         <font class="keywordflow">case</font> SB_THUMBPOSITION:
00614             {
00615                 SCROLLINFO si;
00616                 si.cbSize = <font class="keyword">sizeof</font>(SCROLLINFO);
00617                 si.fMask = SIF_TRACKPOS;
00618                 <font class="keywordflow">if</font>(pT-&gt;GetScrollInfo(nType, &amp;si))
00619                 {
00620                     cxyScroll = cxyOffset - si.nTrackPos;
00621                     cxyOffset = si.nTrackPos;
00622                 }
00623             }
00624             <font class="keywordflow">break</font>;
00625         <font class="keywordflow">case</font> SB_ENDSCROLL:
00626         <font class="keywordflow">default</font>:
00627             bUpdate = FALSE;
00628             <font class="keywordflow">break</font>;
00629         }
00630 
00631         <font class="keywordflow">if</font>(bUpdate &amp;&amp; cxyScroll != 0)
00632         {
00633             pT-&gt;SetScrollPos(nType, cxyOffset, TRUE);
00634             <font class="keywordflow">if</font>(nType == SB_VERT)
00635                 pT-&gt;ScrollWindowEx(0, cxyScroll, <a class="code" href="classWTL_1_1CScrollImpl.html#m7">m_uScrollFlags</a>);
00636             <font class="keywordflow">else</font>
00637                 pT-&gt;ScrollWindowEx(cxyScroll, 0, <a class="code" href="classWTL_1_1CScrollImpl.html#m7">m_uScrollFlags</a>);
00638         }
00639     }
<a name="l00640"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a48">00640</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a48">CalcLineOrPage</a>(<font class="keywordtype">int</font> nVal, <font class="keywordtype">int</font> nMax, <font class="keywordtype">int</font> nDiv)
00641     {
00642         <font class="keywordflow">if</font>(nVal == 0)
00643         {
00644             nVal = nMax / nDiv;
00645             <font class="keywordflow">if</font>(nVal &lt; 1)
00646                 nVal = 1;
00647         }
00648         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(nVal &gt; nMax)
00649             nVal = nMax;
00650 
00651         <font class="keywordflow">return</font> nVal;
00652     }
<a name="l00653"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a49">00653</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a49">GetSystemSettings</a>()
00654     {
00655 <font class="preprocessor">#ifndef SPI_GETWHEELSCROLLLINES</font>
00656 <font class="preprocessor"></font>        <font class="keyword">const</font> UINT SPI_GETWHEELSCROLLLINES = 104;
00657 <font class="preprocessor">#endif </font>
00658 <font class="preprocessor">        ::SystemParametersInfo(SPI_GETWHEELSCROLLLINES, 0, &amp;m_nWheelLines, 0);</font>
00659 <font class="preprocessor"></font>
00660 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00661 <font class="preprocessor"></font>        <font class="keywordflow">if</font>(m_uMsgMouseWheel != 0)
00662             m_uMsgMouseWheel = ::RegisterWindowMessage(MSH_MOUSEWHEEL);
00663 
00664         HWND hWndWheel = FindWindow(MSH_WHEELMODULE_CLASS, MSH_WHEELMODULE_TITLE);
00665         <font class="keywordflow">if</font>(::IsWindow(hWndWheel))
00666         {
00667             UINT uMsgScrollLines = ::RegisterWindowMessage(MSH_SCROLL_LINES);
00668             <font class="keywordflow">if</font>(uMsgScrollLines != 0)
00669                 <a class="code" href="classWTL_1_1CScrollImpl.html#m6">m_nWheelLines</a> = ::SendMessage(hWndWheel, uMsgScrollLines, 0, 0L);
00670         }
00671 <font class="preprocessor">#endif </font>
00672 <font class="preprocessor">    }</font>
<a name="l00673"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a50">00673</a> <font class="preprocessor"></font>    <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a50">IsScrollingChildren</a>()<font class="keyword"> const</font>
00674 <font class="keyword">    </font>{
00675         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> &amp; <a class="code" href="atlscrl_8h.html#a0">SCRL_SCROLLCHILDREN</a>) != 0;
00676     }
<a name="l00677"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a51">00677</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a51">IsErasingBackground</a>()<font class="keyword"> const</font>
00678 <font class="keyword">    </font>{
00679         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> &amp; <a class="code" href="atlscrl_8h.html#a1">SCRL_ERASEBACKGROUND</a>) != 0;
00680     }
<a name="l00681"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a52">00681</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a52">IsNoThumbTracking</a>()<font class="keyword"> const</font>
00682 <font class="keyword">    </font>{
00683         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> &amp; <a class="code" href="atlscrl_8h.html#a2">SCRL_NOTHUMBTRACKING</a>) != 0;
00684     }
00685 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l00686"></a><a class="code" href="classWTL_1_1CScrollImpl.html#a53">00686</a> <font class="preprocessor"></font>    <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a53">IsSmoothScroll</a>()<font class="keyword"> const</font>
00687 <font class="keyword">    </font>{
00688         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CScrollImpl.html#m8">m_dwExtendedStyle</a> &amp; <a class="code" href="atlscrl_8h.html#a3">SCRL_SMOOTHSCROLL</a>) != 0;
00689     }
00690 <font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
00691 <font class="preprocessor"></font>};
00692 
00693 
00695 <font class="comment">// CScrollWindowImpl - Implements a scrollable window</font>
00696 
00697 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CWindow, <font class="keyword">class</font> TWinTraits = CControlWinTraits&gt;
<a name="l00698"></a><a class="code" href="classWTL_1_1CScrollWindowImpl.html">00698</a> <font class="keyword">class </font>ATL_NO_VTABLE <a class="code" href="classWTL_1_1CScrollWindowImpl.html">CScrollWindowImpl</a> : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt;T, TBase, TWinTraits&gt;, <font class="keyword">public</font> <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl</a>&lt; T &gt;
00699 {
00700 <font class="keyword">public</font>:
00701     BEGIN_MSG_MAP(<a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>)
00702         MESSAGE_HANDLER(WM_VSCROLL, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnVScroll)
00703         MESSAGE_HANDLER(WM_HSCROLL, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnHScroll)
00704         MESSAGE_HANDLER(WM_MOUSEWHEEL, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnMouseWheel)
00705 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00706 <font class="preprocessor"></font>        MESSAGE_HANDLER(m_uMsgMouseWheel, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnMouseWheel)
00707 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400)</font>
00708 <font class="preprocessor"></font>        MESSAGE_HANDLER(WM_SETTINGCHANGE, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnSettingChange)
00709         MESSAGE_HANDLER(WM_SIZE, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnSize)
00710         MESSAGE_HANDLER(WM_PAINT, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnPaint)
00711         MESSAGE_HANDLER(WM_PRINTCLIENT, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnPaint)
00712     ALT_MSG_MAP(1)
00713         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a81">ID_SCROLL_UP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollUp)
00714         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a82">ID_SCROLL_DOWN</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollDown)
00715         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a83">ID_SCROLL_PAGE_UP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageUp)
00716         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a84">ID_SCROLL_PAGE_DOWN</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageDown)
00717         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a85">ID_SCROLL_TOP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollTop)
00718         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a86">ID_SCROLL_BOTTOM</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollBottom)
00719         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a87">ID_SCROLL_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollLeft)
00720         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a88">ID_SCROLL_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollRight)
00721         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a89">ID_SCROLL_PAGE_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageLeft)
00722         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a90">ID_SCROLL_PAGE_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageRight)
00723         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a91">ID_SCROLL_ALL_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollAllLeft)
00724         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a92">ID_SCROLL_ALL_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollAllRight)
00725     END_MSG_MAP()
00726 };
00727 
00728 
00730 <font class="comment">// CMapScrollImpl - Provides mapping and scrolling support to any window</font>
00731 
00732 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l00733"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html">00733</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CMapScrollImpl.html">CMapScrollImpl</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl</a>&lt; T &gt;
00734 {
00735 <font class="keyword">public</font>:
<a name="l00736"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#m0">00736</a>     <font class="keywordtype">int</font> m_nMapMode;
<a name="l00737"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#m1">00737</a>     RECT m_rectLogAll;
<a name="l00738"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#m2">00738</a>     SIZE m_sizeLogLine;
<a name="l00739"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#m3">00739</a>     SIZE m_sizeLogPage;
00740 
00741 <font class="comment">// Constructor</font>
<a name="l00742"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a0">00742</a>     <a class="code" href="classWTL_1_1CMapScrollImpl.html">CMapScrollImpl</a>() : m_nMapMode(MM_TEXT)
00743     {
00744         ::SetRectEmpty(&amp;m_rectLogAll);
00745         m_sizeLogPage.cx = 0;
00746         m_sizeLogPage.cy = 0;
00747         m_sizeLogLine.cx = 0;
00748         m_sizeLogLine.cy = 0;
00749     }
00750 
00751 <font class="comment">// Attributes &amp; Operations</font>
00752     <font class="comment">// mapping mode operations</font>
<a name="l00753"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a1">00753</a>     <font class="keywordtype">void</font> SetScrollMapMode(<font class="keywordtype">int</font> nMapMode)
00754     {
00755         ATLASSERT(nMapMode &gt;= MM_MIN &amp;&amp; nMapMode &lt;= MM_MAX_FIXEDSCALE);
00756         m_nMapMode = nMapMode;
00757     }
<a name="l00758"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a2">00758</a>     <font class="keywordtype">int</font> GetScrollMapMode()<font class="keyword"> const</font>
00759 <font class="keyword">    </font>{
00760         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00761         <font class="keywordflow">return</font> m_nMapMode;
00762     }
00763 
00764     <font class="comment">// offset operations</font>
<a name="l00765"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a3">00765</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, BOOL bRedraw = TRUE)
00766     {
00767         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00768         POINT ptOff = { x, y };
00769         <font class="comment">// block: convert logical to device units</font>
00770         {
00771             <a class="code" href="classWTL_1_1CWindowDC.html">CWindowDC</a> dc(NULL);
00772             dc.<a class="code" href="classWTL_1_1CDCT.html#a55">SetMapMode</a>(m_nMapMode);
00773             dc.<a class="code" href="classWTL_1_1CDCT.html#a74">LPtoDP</a>(&amp;ptOff);
00774         }
00775         <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;::SetScrollOffset</a>(ptOff, bRedraw);
00776     }
<a name="l00777"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a4">00777</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(POINT ptOffset, BOOL bRedraw = TRUE)
00778     {
00779         <a class="code" href="classWTL_1_1CScrollImpl.html#a3">SetScrollOffset</a>(ptOffset.x, ptOffset.y, bRedraw);
00780     }
<a name="l00781"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a5">00781</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a5">GetScrollOffset</a>(POINT&amp; ptOffset)<font class="keyword"> const</font>
00782 <font class="keyword">    </font>{
00783         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00784         ptOffset = m_ptOffset;
00785         <font class="comment">// block: convert logical to device units</font>
00786         {
00787             <a class="code" href="classWTL_1_1CWindowDC.html">CWindowDC</a> dc(NULL);
00788             dc.<a class="code" href="classWTL_1_1CDCT.html#a55">SetMapMode</a>(m_nMapMode);
00789             dc.<a class="code" href="classWTL_1_1CDCT.html#a71">DPtoLP</a>(&amp;ptOffset);
00790         }
00791     }
00792 
00793     <font class="comment">// size operations</font>
<a name="l00794"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a6">00794</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(<font class="keywordtype">int</font> xMin, <font class="keywordtype">int</font> yMin, <font class="keywordtype">int</font> xMax, <font class="keywordtype">int</font> yMax, BOOL bRedraw = TRUE)
00795     {
00796         ATLASSERT(xMax &gt; xMin &amp;&amp; yMax &gt; yMin);
00797         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00798 
00799         ::SetRect(&amp;m_rectLogAll, xMin, yMax, xMax, yMin);
00800 
00801         SIZE sizeAll;
00802         sizeAll.cx = xMax - xMin + 1;
00803         sizeAll.cy = yMax - xMin + 1;
00804         <font class="comment">// block: convert logical to device units</font>
00805         {
00806             <a class="code" href="classWTL_1_1CWindowDC.html">CWindowDC</a> dc(NULL);
00807             dc.<a class="code" href="classWTL_1_1CDCT.html#a55">SetMapMode</a>(m_nMapMode);
00808             dc.<a class="code" href="classWTL_1_1CDCT.html#a74">LPtoDP</a>(&amp;sizeAll);
00809         }
00810         <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;::SetScrollSize</a>(sizeAll, bRedraw);
00811         <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(0, 0);
00812         <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(0, 0);
00813     }
<a name="l00814"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a7">00814</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(RECT&amp; rcScroll, BOOL bRedraw = TRUE)
00815     {
00816         <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(rcScroll.left, rcScroll.top, rcScroll.right, rcScroll.bottom, bRedraw);
00817     }
<a name="l00818"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a8">00818</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy, BOOL bRedraw = TRUE)
00819     {
00820         <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(0, 0, cx, cy, bRedraw);
00821     }
<a name="l00822"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a9">00822</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(SIZE size, BOOL bRedraw = NULL)
00823     {
00824         <a class="code" href="classWTL_1_1CScrollImpl.html#a6">SetScrollSize</a>(0, 0, size.cx, size.cy, bRedraw);
00825     }
<a name="l00826"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a10">00826</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a8">GetScrollSize</a>(RECT&amp; rcScroll)<font class="keyword"> const</font>
00827 <font class="keyword">    </font>{
00828         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00829         rcScroll = m_rectLogAll;
00830     }
00831 
00832     <font class="comment">// line operations</font>
<a name="l00833"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a11">00833</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(<font class="keywordtype">int</font> cxLine, <font class="keywordtype">int</font> cyLine)
00834     {
00835         ATLASSERT(cxLine &gt;= 0 &amp;&amp; cyLine &gt;= 0);
00836         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00837 
00838         m_sizeLogLine.cx = cxLine;
00839         m_sizeLogLine.cy = cyLine;
00840         SIZE sizeLine = m_sizeLogLine;
00841         <font class="comment">// block: convert logical to device units</font>
00842         {
00843             <a class="code" href="classWTL_1_1CWindowDC.html">CWindowDC</a> dc(NULL);
00844             dc.<a class="code" href="classWTL_1_1CDCT.html#a55">SetMapMode</a>(m_nMapMode);
00845             dc.<a class="code" href="classWTL_1_1CDCT.html#a74">LPtoDP</a>(&amp;sizeLine);
00846         }
00847         <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;::SetScrollLine</a>(sizeLine);
00848     }
<a name="l00849"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a12">00849</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(SIZE sizeLine)
00850     {
00851         <a class="code" href="classWTL_1_1CScrollImpl.html#a9">SetScrollLine</a>(sizeLine.cx, sizeLine.cy);
00852     }
<a name="l00853"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a13">00853</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a11">GetScrollLine</a>(SIZE&amp; sizeLine)<font class="keyword"> const</font>
00854 <font class="keyword">    </font>{
00855         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00856         sizeLine = m_sizeLogLine;
00857     }
00858 
00859     <font class="comment">// page operations</font>
<a name="l00860"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a14">00860</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(<font class="keywordtype">int</font> cxPage, <font class="keywordtype">int</font> cyPage)
00861     {
00862         ATLASSERT(cxPage &gt;= 0 &amp;&amp; cyPage &gt;= 0);
00863         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00864 
00865         m_sizeLogPage.cx = cxPage;
00866         m_sizeLogPage.cy = cyPage;
00867         SIZE sizePage = m_sizeLogPage;
00868         <font class="comment">// block: convert logical to device units</font>
00869         {
00870             <a class="code" href="classWTL_1_1CWindowDC.html">CWindowDC</a> dc(NULL);
00871             dc.<a class="code" href="classWTL_1_1CDCT.html#a55">SetMapMode</a>(m_nMapMode);
00872             dc.<a class="code" href="classWTL_1_1CDCT.html#a74">LPtoDP</a>(&amp;sizePage);
00873         }
00874         <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;::SetScrollPage</a>(sizePage);
00875     }
<a name="l00876"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a15">00876</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(SIZE sizePage)
00877     {
00878         <a class="code" href="classWTL_1_1CScrollImpl.html#a12">SetScrollPage</a>(sizePage.cx, sizePage.cy);
00879     }
<a name="l00880"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a16">00880</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CScrollImpl.html#a14">GetScrollPage</a>(SIZE&amp; sizePage)<font class="keyword"> const</font>
00881 <font class="keyword">    </font>{
00882         ATLASSERT(m_nMapMode &gt;= MM_MIN &amp;&amp; m_nMapMode &lt;= MM_MAX_FIXEDSCALE);
00883         sizePage = m_sizeLogPage;
00884     }
00885 
00886     BEGIN_MSG_MAP(CMapScrollImpl&lt; T &gt;)
00887         MESSAGE_HANDLER(WM_VSCROLL, CScrollImpl&lt; T &gt;::OnVScroll)
00888         MESSAGE_HANDLER(WM_HSCROLL, CScrollImpl&lt; T &gt;::OnHScroll)
00889         MESSAGE_HANDLER(WM_MOUSEWHEEL, CScrollImpl&lt; T &gt;::OnMouseWheel)
00890 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00891 <font class="preprocessor"></font>        MESSAGE_HANDLER(m_uMsgMouseWheel, CScrollImpl&lt; T &gt;::OnMouseWheel)
00892 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400)</font>
00893 <font class="preprocessor"></font>        MESSAGE_HANDLER(WM_SETTINGCHANGE, CScrollImpl&lt; T &gt;::OnSettingChange)
00894         MESSAGE_HANDLER(WM_SIZE, CScrollImpl&lt; T &gt;::OnSize)
00895         MESSAGE_HANDLER(WM_PAINT, OnPaint)
00896         MESSAGE_HANDLER(WM_PRINTCLIENT, OnPaint)
00897     ALT_MSG_MAP(1)
00898         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a81">ID_SCROLL_UP</a>, CScrollImpl&lt; T &gt;::OnScrollUp)
00899         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a82">ID_SCROLL_DOWN</a>, CScrollImpl&lt; T &gt;::OnScrollDown)
00900         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a83">ID_SCROLL_PAGE_UP</a>, CScrollImpl&lt; T &gt;::OnScrollPageUp)
00901         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a84">ID_SCROLL_PAGE_DOWN</a>, CScrollImpl&lt; T &gt;::OnScrollPageDown)
00902         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a85">ID_SCROLL_TOP</a>, CScrollImpl&lt; T &gt;::OnScrollTop)
00903         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a86">ID_SCROLL_BOTTOM</a>, CScrollImpl&lt; T &gt;::OnScrollBottom)
00904         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a87">ID_SCROLL_LEFT</a>, CScrollImpl&lt; T &gt;::OnScrollLeft)
00905         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a88">ID_SCROLL_RIGHT</a>, CScrollImpl&lt; T &gt;::OnScrollRight)
00906         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a89">ID_SCROLL_PAGE_LEFT</a>, CScrollImpl&lt; T &gt;::OnScrollPageLeft)
00907         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a90">ID_SCROLL_PAGE_RIGHT</a>, CScrollImpl&lt; T &gt;::OnScrollPageRight)
00908         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a91">ID_SCROLL_ALL_LEFT</a>, CScrollImpl&lt; T &gt;::OnScrollAllLeft)
00909         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a92">ID_SCROLL_ALL_RIGHT</a>, CScrollImpl&lt; T &gt;::OnScrollAllRight)
00910     END_MSG_MAP()
00911 
<a name="l00912"></a><a class="code" href="classWTL_1_1CMapScrollImpl.html#a17">00912</a>     LRESULT <a class="code" href="classWTL_1_1CScrollImpl.html#a33">OnPaint</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00913     {
00914         T* pT = static_cast&lt;T*&gt;(this);
00915         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
00916         <font class="keywordflow">if</font>(wParam != NULL)
00917         {
00918             <a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc = (HDC)wParam;
00919             dc.SetMapMode(m_nMapMode);
00920             <font class="keywordflow">if</font>(m_nMapMode == MM_TEXT)
00921                 dc.SetViewportOrg(-m_ptOffset.x, -m_ptOffset.y);
00922             <font class="keywordflow">else</font>
00923                 dc.SetViewportOrg(-m_ptOffset.x, -m_ptOffset.y + m_sizeAll.cy);
00924             dc.SetWindowOrg(m_rectLogAll.left, m_rectLogAll.bottom);
00925             pT-&gt;DoPaint(dc);
00926         }
00927         <font class="keywordflow">else</font>
00928         {
00929             <a class="code" href="classWTL_1_1CPaintDC.html">CPaintDC</a> dc(pT-&gt;m_hWnd);
00930             dc.<a class="code" href="classWTL_1_1CDCT.html#a55">SetMapMode</a>(m_nMapMode);
00931             <font class="keywordflow">if</font>(m_nMapMode == MM_TEXT)
00932                 dc.<a class="code" href="classWTL_1_1CDCT.html#a56">SetViewportOrg</a>(-m_ptOffset.x, -m_ptOffset.y);
00933             <font class="keywordflow">else</font>
00934                 dc.<a class="code" href="classWTL_1_1CDCT.html#a56">SetViewportOrg</a>(-m_ptOffset.x, -m_ptOffset.y + m_sizeAll.cy);
00935             dc.<a class="code" href="classWTL_1_1CDCT.html#a64">SetWindowOrg</a>(m_rectLogAll.left, m_rectLogAll.bottom);
00936             pT-&gt;DoPaint(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
00937         }
00938         <font class="keywordflow">return</font> 0;
00939     }
00940 };
00941 
00942 
00944 <font class="comment">// CMapScrollWindowImpl - Implements scrolling window with mapping</font>
00945 
00946 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CWindow, <font class="keyword">class</font> TWinTraits = CControlWinTraits&gt;
<a name="l00947"></a><a class="code" href="classWTL_1_1CMapScrollWindowImpl.html">00947</a> <font class="keyword">class </font>ATL_NO_VTABLE CMapScrollWindowImpl : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt; T, TBase, TWinTraits &gt;, <font class="keyword">public</font> <a class="code" href="classWTL_1_1CMapScrollImpl.html">CMapScrollImpl</a>&lt; T &gt;
00948 {
00949 <font class="keyword">public</font>:
00950     BEGIN_MSG_MAP(<a class="code" href="classWTL_1_1CMapScrollWindowImpl.html">CMapScrollWindowImpl&lt; T &gt;</a>)
00951         MESSAGE_HANDLER(WM_VSCROLL, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnVScroll)
00952         MESSAGE_HANDLER(WM_HSCROLL, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnHScroll)
00953         MESSAGE_HANDLER(WM_MOUSEWHEEL, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnMouseWheel)
00954 <font class="preprocessor">#if !((_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400))</font>
00955 <font class="preprocessor"></font>        MESSAGE_HANDLER(m_uMsgMouseWheel, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnMouseWheel)
00956 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0400) || (_WIN32_WINDOWS &gt; 0x0400)</font>
00957 <font class="preprocessor"></font>        MESSAGE_HANDLER(WM_SETTINGCHANGE, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnSettingChange)
00958         MESSAGE_HANDLER(WM_SIZE, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnSize)
00959         MESSAGE_HANDLER(WM_PAINT, <a class="code" href="classWTL_1_1CMapScrollImpl.html">CMapScrollImpl&lt; T &gt;</a>::OnPaint)
00960         MESSAGE_HANDLER(WM_PRINTCLIENT, <a class="code" href="classWTL_1_1CMapScrollImpl.html">CMapScrollImpl&lt; T &gt;</a>::OnPaint)
00961     ALT_MSG_MAP(1)
00962         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a81">ID_SCROLL_UP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollUp)
00963         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a82">ID_SCROLL_DOWN</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollDown)
00964         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a83">ID_SCROLL_PAGE_UP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageUp)
00965         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a84">ID_SCROLL_PAGE_DOWN</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageDown)
00966         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a85">ID_SCROLL_TOP</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollTop)
00967         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a86">ID_SCROLL_BOTTOM</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollBottom)
00968         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a87">ID_SCROLL_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollLeft)
00969         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a88">ID_SCROLL_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollRight)
00970         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a89">ID_SCROLL_PAGE_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageLeft)
00971         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a90">ID_SCROLL_PAGE_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollPageRight)
00972         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a91">ID_SCROLL_ALL_LEFT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollAllLeft)
00973         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a92">ID_SCROLL_ALL_RIGHT</a>, <a class="code" href="classWTL_1_1CScrollImpl.html">CScrollImpl&lt; T &gt;</a>::OnScrollAllRight)
00974     END_MSG_MAP()
00975 };
00976 
00977 
00979 <font class="comment">// CFSBWindow - Use as a base instead of CWindow to get flat scroll bar support</font>
00980 
00981 <font class="preprocessor">#if defined(__ATLCTRLS_H__) &amp;&amp; (_WIN32_IE &gt;= 0x0400)</font>
00982 <font class="preprocessor"></font>
00983 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase = CWindow&gt; <font class="keyword">class </font>CFSBWindowT : <font class="keyword">public</font> TBase, <font class="keyword">public</font> CFlatScrollBarImpl&lt;CFSBWindowT&lt; TBase &gt; &gt;
00984 {
00985 <font class="keyword">public</font>:
00986 <font class="comment">// Constructors</font>
00987     CFSBWindowT(HWND hWnd = NULL) : TBase(hWnd)
00988     { }
00989 
00990     CFSBWindowT&lt; TBase &gt;&amp; operator=(HWND hWnd)
00991     {
00992         m_hWnd = hWnd;
00993         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00994     }
00995 
00996 <font class="comment">// CWindow overrides that use flat scroll bar API</font>
00997 <font class="comment">// (only those methods that are used by scroll window classes)</font>
00998     <font class="keywordtype">int</font> SetScrollPos(<font class="keywordtype">int</font> nBar, <font class="keywordtype">int</font> nPos, BOOL bRedraw = TRUE)
00999     {
01000         ATLASSERT(::IsWindow(m_hWnd));
01001         <font class="keywordflow">return</font> FlatSB_SetScrollPos(nBar, nPos, bRedraw);
01002     }
01003 
01004     BOOL GetScrollInfo(<font class="keywordtype">int</font> nBar, LPSCROLLINFO lpScrollInfo)
01005     {
01006         ATLASSERT(::IsWindow(m_hWnd));
01007         <font class="keywordflow">return</font> FlatSB_GetScrollInfo(nBar, lpScrollInfo);
01008     }
01009 
01010     BOOL SetScrollInfo(<font class="keywordtype">int</font> nBar, LPSCROLLINFO lpScrollInfo, BOOL bRedraw = TRUE)
01011     {
01012         ATLASSERT(::IsWindow(m_hWnd));
01013         <font class="keywordflow">return</font> FlatSB_SetScrollInfo(nBar, lpScrollInfo, bRedraw);
01014     }
01015 };
01016 
01017 <font class="keyword">typedef</font> CFSBWindowT&lt;CWindow&gt;    CFSBWindow;
01018 
01019 <font class="preprocessor">#endif //defined(__ATLCTRLS_H__) &amp;&amp; (_WIN32_IE &gt;= 0x0400)</font>
01020 <font class="preprocessor"></font>
01021 }; <font class="comment">//namespace WTL</font>
01022 
01023 <font class="preprocessor">#endif //__ATLSCRL_H__</font>
</pre></div><hr><address align="right"><small>Generated on Thu Apr 11 21:09:32 2002 for wtl-doc by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
