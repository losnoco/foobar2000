<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>atlsplit.h Source File</title>
<link href="mystyles.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>atlsplit.h</h1><a href="atlsplit_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// Windows Template Library - WTL version 7.0</font>
00002 <font class="comment">// Copyright (C) 1997-2002 Microsoft Corporation</font>
00003 <font class="comment">// All rights reserved.</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// This file is a part of the Windows Template Library.</font>
00006 <font class="comment">// The code and information is provided "as-is" without</font>
00007 <font class="comment">// warranty of any kind, either expressed or implied.</font>
00008 
00009 <font class="preprocessor">#ifndef __ATLSPLIT_H__</font>
00010 <font class="preprocessor"></font><font class="preprocessor">#define __ATLSPLIT_H__</font>
00011 <font class="preprocessor"></font>
00012 <font class="preprocessor">#pragma once</font>
00013 <font class="preprocessor"></font>
00014 <font class="preprocessor">#ifndef __cplusplus</font>
00015 <font class="preprocessor"></font><font class="preprocessor">    #error ATL requires C++ compilation (use a .cpp suffix)</font>
00016 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00017 <font class="preprocessor"></font>
00018 <font class="preprocessor">#ifndef __ATLAPP_H__</font>
00019 <font class="preprocessor"></font><font class="preprocessor">    #error atlsplit.h requires atlapp.h to be included first</font>
00020 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00021 <font class="preprocessor"></font>
00022 <font class="preprocessor">#ifndef __ATLWIN_H__</font>
00023 <font class="preprocessor"></font><font class="preprocessor">    #error atlsplit.h requires atlwin.h to be included first</font>
00024 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00025 <font class="preprocessor"></font>
00026 
00028 <font class="comment">// Classes in this file</font>
00029 <font class="comment">//</font>
00030 <font class="comment">// CSplitterImpl&lt;T, t_bVertical&gt;</font>
00031 <font class="comment">// CSplitterWindowImpl&lt;T, t_bVertical, TBase, TWinTraits&gt;</font>
00032 <font class="comment">// CSplitterWindowT&lt;t_bVertical&gt;</font>
00033 
00034 
00035 <font class="keyword">namespace </font>WTL
00036 {
00037 
00039 <font class="comment">// CSplitterImpl - Provides splitter support to any window</font>
00040 
00041 <font class="comment">// Splitter panes constants</font>
<a name="l00042"></a><a class="code" href="atlsplit_8h.html#a0">00042</a> <font class="preprocessor">#define SPLIT_PANE_LEFT          0</font>
<a name="l00043"></a><a class="code" href="atlsplit_8h.html#a1">00043</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_PANE_RIGHT         1</font>
<a name="l00044"></a><a class="code" href="atlsplit_8h.html#a2">00044</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_PANE_TOP           SPLIT_PANE_LEFT</font>
<a name="l00045"></a><a class="code" href="atlsplit_8h.html#a3">00045</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_PANE_BOTTOM        SPLIT_PANE_RIGHT</font>
<a name="l00046"></a><a class="code" href="atlsplit_8h.html#a4">00046</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_PANE_NONE         -1</font>
00047 <font class="preprocessor"></font>
00048 <font class="comment">// Splitter extended styles</font>
<a name="l00049"></a><a class="code" href="atlsplit_8h.html#a5">00049</a> <font class="preprocessor">#define SPLIT_PROPORTIONAL      0x00000001</font>
<a name="l00050"></a><a class="code" href="atlsplit_8h.html#a6">00050</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_NONINTERACTIVE        0x00000002</font>
<a name="l00051"></a><a class="code" href="atlsplit_8h.html#a7">00051</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_RIGHTALIGNED      0x00000004</font>
<a name="l00052"></a><a class="code" href="atlsplit_8h.html#a8">00052</a> <font class="preprocessor"></font><font class="preprocessor">#define SPLIT_BOTTOMALIGNED     SPLIT_RIGHTALIGNED</font>
00053 <font class="preprocessor"></font>
00054 <font class="comment">// Note: SPLIT_PROPORTIONAL and SPLIT_RIGHTALIGNED/SPLIT_BOTTOMALIGNED are </font>
00055 <font class="comment">// mutually exclusive. If both are set, splitter defaults to SPLIT_PROPORTIONAL</font>
00056 
00057 
00058 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">bool</font> t_bVertical = true&gt;
<a name="l00059"></a><a class="code" href="classWTL_1_1CSplitterImpl.html">00059</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CSplitterImpl.html">CSplitterImpl</a>
00060 {
00061 <font class="keyword">public</font>:
00062     <font class="keyword">enum</font> { <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a> = 2, <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s2">m_nPropMax</a> = 10000 };
00063 
<a name="l00064"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m0">00064</a>     HWND <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a>];
<a name="l00065"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m1">00065</a>     RECT <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>;
<a name="l00066"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m2">00066</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
<a name="l00067"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m3">00067</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a>;
<a name="l00068"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m4">00068</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a>;      <font class="comment">// splitter bar width/height</font>
<a name="l00069"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#p0">00069</a>     <font class="keyword">static</font> HCURSOR <a class="code" href="classWTL_1_1CSplitterImpl.html#p0">m_hCursor</a>;
<a name="l00070"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m5">00070</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a>;           <font class="comment">// minimum pane size</font>
<a name="l00071"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m6">00071</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>;       <font class="comment">// splitter bar edge</font>
<a name="l00072"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m7">00072</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m7">m_bFullDrag</a>;
<a name="l00073"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m8">00073</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m8">m_cxyDragOffset</a>;
<a name="l00074"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m9">00074</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a>;
<a name="l00075"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m10">00075</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m10">m_bUpdateProportionalPos</a>;
<a name="l00076"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m11">00076</a>     DWORD <a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a>;    <font class="comment">// splitter specific extended styles</font>
<a name="l00077"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#m12">00077</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>;      <font class="comment">// single pane mode</font>
00078 
00079 <font class="comment">// Constructor</font>
<a name="l00080"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a0">00080</a>     <a class="code" href="classWTL_1_1CSplitterImpl.html#a0">CSplitterImpl</a>() :
00081             <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>(-1), <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a>(<a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>), 
00082             <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a>(0), <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a>(0), <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>(0), <a class="code" href="classWTL_1_1CSplitterImpl.html#m7">m_bFullDrag</a>(true), 
00083             <a class="code" href="classWTL_1_1CSplitterImpl.html#m8">m_cxyDragOffset</a>(0), <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a>(0), <a class="code" href="classWTL_1_1CSplitterImpl.html#m10">m_bUpdateProportionalPos</a>(true),
00084             <a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a>(<a class="code" href="atlsplit_8h.html#a5">SPLIT_PROPORTIONAL</a>),
00085             <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>(<a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00086     {
00087         <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>] = NULL;
00088         <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>] = NULL;
00089 
00090         ::SetRectEmpty(&amp;<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>);
00091 
00092         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#p0">m_hCursor</a> == NULL)
00093         {
00094             ::EnterCriticalSection(&amp;_Module.m_csStaticDataInit);
00095             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#p0">m_hCursor</a> == NULL)
00096                 <a class="code" href="classWTL_1_1CSplitterImpl.html#p0">m_hCursor</a> = ::LoadCursor(NULL, t_bVertical ? IDC_SIZEWE : IDC_SIZENS);
00097             ::LeaveCriticalSection(&amp;_Module.m_csStaticDataInit);
00098         }
00099     }
00100 
00101 <font class="comment">// Attributes</font>
<a name="l00102"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a1">00102</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a1">SetSplitterRect</a>(LPRECT lpRect = NULL, <font class="keywordtype">bool</font> bUpdate = <font class="keyword">true</font>)
00103     {
00104         <font class="keywordflow">if</font>(lpRect == NULL)
00105         {
00106             T* pT = static_cast&lt;T*&gt;(this);
00107             pT-&gt;GetClientRect(&amp;<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>);
00108         }
00109         <font class="keywordflow">else</font>
00110         {
00111             <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a> = *lpRect;
00112         }
00113 
00114         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a38">IsProportional</a>())
00115             <a class="code" href="classWTL_1_1CSplitterImpl.html#a40">UpdateProportionalPos</a>();
00116         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a41">IsRightAligned</a>())
00117             <a class="code" href="classWTL_1_1CSplitterImpl.html#a43">UpdateRightAlignPos</a>();
00118 
00119         <font class="keywordflow">if</font>(bUpdate)
00120             <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00121     }
00122 
<a name="l00123"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a2">00123</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a2">GetSplitterRect</a>(LPRECT lpRect)<font class="keyword"> const</font>
00124 <font class="keyword">    </font>{
00125         ATLASSERT(lpRect != NULL);
00126         *lpRect = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>;
00127     }
00128 
<a name="l00129"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a3">00129</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a3">SetSplitterPos</a>(<font class="keywordtype">int</font> xyPos = -1, <font class="keywordtype">bool</font> bUpdate = <font class="keyword">true</font>)
00130     {
00131         <font class="keywordflow">if</font>(xyPos == -1)     <font class="comment">// -1 == middle</font>
00132         {
00133             <font class="keywordflow">if</font>(t_bVertical)
00134                 xyPos = (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>) / 2;
00135             <font class="keywordflow">else</font>
00136                 xyPos = (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>) / 2;
00137         }
00138 
00139         <font class="comment">// Adjust if out of valid range</font>
00140         <font class="keywordtype">int</font> cxyMax = 0;
00141         <font class="keywordflow">if</font>(t_bVertical)
00142             cxyMax = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left;
00143         <font class="keywordflow">else</font>
00144             cxyMax = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top;
00145 
00146         <font class="keywordflow">if</font>(xyPos &lt; <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>)
00147             xyPos = <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a>;
00148         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(xyPos &gt; (cxyMax - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a>))
00149             xyPos = cxyMax - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a>;
00150 
00151         <font class="comment">// Set new position and update if requested</font>
00152         <font class="keywordtype">bool</font> bRet = (<a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> != xyPos);
00153         <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> = xyPos;
00154 
00155         <font class="keywordflow">if</font>(m_bUpdateProportionalPos)
00156         {
00157             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a38">IsProportional</a>())
00158                 <a class="code" href="classWTL_1_1CSplitterImpl.html#a39">StoreProportionalPos</a>();
00159             <font class="keywordflow">else</font> <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a41">IsRightAligned</a>())
00160                 <a class="code" href="classWTL_1_1CSplitterImpl.html#a42">StoreRightAlignPos</a>();
00161         }
00162         <font class="keywordflow">else</font>
00163         {
00164             <a class="code" href="classWTL_1_1CSplitterImpl.html#m10">m_bUpdateProportionalPos</a> = <font class="keyword">true</font>;
00165         }
00166 
00167         <font class="keywordflow">if</font>(bUpdate &amp;&amp; bRet)
00168             <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00169 
00170         <font class="keywordflow">return</font> bRet;
00171     }
00172 
<a name="l00173"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a4">00173</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a4">GetSplitterPos</a>()<font class="keyword"> const</font>
00174 <font class="keyword">    </font>{
00175         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00176     }
00177 
<a name="l00178"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a5">00178</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a5">SetSinglePaneMode</a>(<font class="keywordtype">int</font> nPane = <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00179     {
00180         ATLASSERT(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a> || nPane == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>);
00181         <font class="keywordflow">if</font>(!(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a> || nPane == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>))
00182             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00183 
00184         <font class="keywordflow">if</font>(nPane != <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00185         {
00186             <font class="keywordflow">if</font>(!::IsWindowVisible(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane]))
00187                 ::ShowWindow(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane], SW_SHOW);
00188             <font class="keywordtype">int</font> nOtherPane = (nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>) ? <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a> : <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>;
00189             ::ShowWindow(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nOtherPane], SW_HIDE);
00190             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> != nPane)
00191                 <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> = nPane;
00192         }
00193         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> != <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00194         {
00195             <font class="keywordtype">int</font> nOtherPane = (<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>) ? <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a> : <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>;
00196             ::ShowWindow(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nOtherPane], SW_SHOW);
00197         }
00198 
00199         <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> = nPane;
00200         <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00201         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00202     }
00203 
<a name="l00204"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a6">00204</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a6">GetSinglePaneMode</a>()<font class="keyword"> const</font>
00205 <font class="keyword">    </font>{
00206         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>;
00207     }
00208 
<a name="l00209"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a7">00209</a>     DWORD <a class="code" href="classWTL_1_1CSplitterImpl.html#a7">GetSplitterExtendedStyle</a>()<font class="keyword"> const</font>
00210 <font class="keyword">    </font>{
00211         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a>;
00212     }
00213 
<a name="l00214"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a8">00214</a>     DWORD <a class="code" href="classWTL_1_1CSplitterImpl.html#a8">SetSplitterExtendedStyle</a>(DWORD dwExtendedStyle, DWORD dwMask = 0)
00215     {
00216         DWORD dwPrevStyle = <a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a>;
00217         <font class="keywordflow">if</font>(dwMask == 0)
00218             <a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a> = dwExtendedStyle;
00219         <font class="keywordflow">else</font>
00220             <a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a> = (<a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a> &amp; ~dwMask) | (dwExtendedStyle &amp; dwMask);
00221 <font class="preprocessor">#ifdef _DEBUG</font>
00222 <font class="preprocessor"></font>        <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a38">IsProportional</a>() &amp;&amp; <a class="code" href="classWTL_1_1CSplitterImpl.html#a41">IsRightAligned</a>())
00223             ATLTRACE2(<a class="code" href="namespaceWTL.html#a111a1">atlTraceUI</a>, 0, <font class="stringliteral">"CSplitterImpl::SetSplitterExtendedStyle - SPLIT_PROPORTIONAL and SPLIT_RIGHTALIGNED are mutually exclusive, defaulting to SPLIT_PROPORTIONAL.\n"</font>);
00224 <font class="preprocessor">#endif //_DEBUG</font>
00225 <font class="preprocessor"></font>        <font class="keywordflow">return</font> dwPrevStyle;
00226     }
00227 
00228 <font class="comment">// Splitter operations</font>
<a name="l00229"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a9">00229</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a9">SetSplitterPanes</a>(HWND hWndLeftTop, HWND hWndRightBottom, <font class="keywordtype">bool</font> bUpdate = <font class="keyword">true</font>)
00230     {
00231         <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>] = hWndLeftTop;
00232         <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>] = hWndRightBottom;
00233         ATLASSERT(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>] == NULL || <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>] == NULL || <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>] != <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>]);
00234         <font class="keywordflow">if</font>(bUpdate)
00235             <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00236     }
00237 
<a name="l00238"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a10">00238</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a10">SetSplitterPane</a>(<font class="keywordtype">int</font> nPane, HWND hWnd, <font class="keywordtype">bool</font> bUpdate = <font class="keyword">true</font>)
00239     {
00240         ATLASSERT(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>);
00241 
00242         <font class="keywordflow">if</font>(nPane != <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> &amp;&amp; nPane != <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>)
00243             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00244         <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane] = hWnd;
00245         ATLASSERT(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>] == NULL || <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>] == NULL || <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>] != <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>]);
00246         <font class="keywordflow">if</font>(bUpdate)
00247             <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00248         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00249     }
00250 
<a name="l00251"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a11">00251</a>     HWND <a class="code" href="classWTL_1_1CSplitterImpl.html#a11">GetSplitterPane</a>(<font class="keywordtype">int</font> nPane)<font class="keyword"> const</font>
00252 <font class="keyword">    </font>{
00253         ATLASSERT(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>);
00254 
00255         <font class="keywordflow">if</font>(nPane != <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> &amp;&amp; nPane != <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>)
00256             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00257         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane];
00258     }
00259 
<a name="l00260"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a12">00260</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a12">SetActivePane</a>(<font class="keywordtype">int</font> nPane)
00261     {
00262         ATLASSERT(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>);
00263 
00264         <font class="keywordflow">if</font>(nPane != <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> &amp;&amp; nPane != <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>)
00265             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00266         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> != <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a> &amp;&amp; nPane != <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>)
00267             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00268         ::SetFocus(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane]);
00269         <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> = nPane;
00270         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00271     }
00272 
<a name="l00273"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a13">00273</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a13">GetActivePane</a>()<font class="keyword"> const</font>
00274 <font class="keyword">    </font>{
00275         <font class="keywordtype">int</font> nRet = <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>;
00276         HWND hWndFocus = ::GetFocus();
00277         <font class="keywordflow">if</font>(hWndFocus != NULL)
00278         {
00279             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nPane = 0; nPane &lt; <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a>; nPane++)
00280             {
00281                 <font class="keywordflow">if</font>(hWndFocus == <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane] || ::IsChild(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane], hWndFocus))
00282                 {
00283                     nRet = nPane;
00284                     <font class="keywordflow">break</font>;
00285                 }
00286             }
00287         }
00288         <font class="keywordflow">return</font> nRet;
00289     }
00290 
<a name="l00291"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a14">00291</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a14">ActivateNextPane</a>(<font class="keywordtype">bool</font> bNext = <font class="keyword">true</font>)
00292     {
00293         <font class="keywordtype">int</font> nPane = <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>;
00294         <font class="keywordflow">if</font>(nPane == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00295         {
00296             <font class="keywordflow">switch</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a13">GetActivePane</a>())
00297             {
00298             <font class="keywordflow">case</font> <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>:
00299                 nPane = <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>;
00300                 <font class="keywordflow">break</font>;
00301             <font class="keywordflow">case</font> <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>:
00302                 nPane = <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>;
00303                 <font class="keywordflow">break</font>;
00304             <font class="keywordflow">default</font>:
00305                 nPane = bNext ? <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> : <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>;
00306                 <font class="keywordflow">break</font>;
00307             }
00308         }
00309         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a12">SetActivePane</a>(nPane);
00310     }
00311 
<a name="l00312"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a15">00312</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a15">SetDefaultActivePane</a>(<font class="keywordtype">int</font> nPane)
00313     {
00314         ATLASSERT(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>);
00315 
00316         <font class="keywordflow">if</font>(nPane != <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> &amp;&amp; nPane != <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>)
00317             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00318         <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> = nPane;
00319         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00320     }
00321 
<a name="l00322"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a16">00322</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a15">SetDefaultActivePane</a>(HWND hWnd)
00323     {
00324         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nPane = 0; nPane &lt; <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a>; nPane++)
00325         {
00326             <font class="keywordflow">if</font>(hWnd == <a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane])
00327             {
00328                 <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> = nPane;
00329                 <font class="keywordflow">return</font> <font class="keyword">true</font>;
00330             }
00331         }
00332         <font class="keywordflow">return</font> <font class="keyword">false</font>;   <font class="comment">// not found</font>
00333     }
00334 
<a name="l00335"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a17">00335</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a17">GetDefaultActivePane</a>()<font class="keyword"> const</font>
00336 <font class="keyword">    </font>{
00337         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a>;
00338     }
00339 
<a name="l00340"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a18">00340</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a18">DrawSplitter</a>(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc)
00341     {
00342         ATLASSERT(dc.m_hDC != NULL);
00343         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a> &amp;&amp; <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> == -1)
00344             <font class="keywordflow">return</font>;
00345 
00346         T* pT = static_cast&lt;T*&gt;(this);
00347         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00348         {
00349             pT-&gt;DrawSplitterBar(dc);
00350 
00351             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nPane = 0; nPane &lt; <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a>; nPane++)
00352             {
00353                 <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane] == NULL)
00354                     pT-&gt;DrawSplitterPane(dc, nPane);
00355             }
00356         }
00357         <font class="keywordflow">else</font>
00358         {
00359             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>] == NULL)
00360                 pT-&gt;DrawSplitterPane(dc, <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>);
00361         }
00362     }
00363 
00364 <font class="comment">// Overrideables</font>
<a name="l00365"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a19">00365</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a19">DrawSplitterBar</a>(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc)
00366     {
00367         RECT rect;
00368         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a32">GetSplitterBarRect</a>(&amp;rect))
00369         {
00370             dc.FillRect(&amp;rect, COLOR_3DFACE);
00371             <font class="comment">// draw 3D edge if needed</font>
00372             T* pT = static_cast&lt;T*&gt;(this);
00373             <font class="keywordflow">if</font>((pT-&gt;GetExStyle() &amp; WS_EX_CLIENTEDGE) != 0)
00374                 dc.DrawEdge(&amp;rect, EDGE_RAISED, t_bVertical ? (BF_LEFT | BF_RIGHT) : (BF_TOP | BF_BOTTOM));
00375         }
00376     }
00377 
00378     <font class="comment">// called only if pane is empty</font>
<a name="l00379"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a20">00379</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a20">DrawSplitterPane</a>(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc, <font class="keywordtype">int</font> nPane)
00380     {
00381         RECT rect;
00382         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a33">GetSplitterPaneRect</a>(nPane, &amp;rect))
00383         {
00384             T* pT = static_cast&lt;T*&gt;(this);
00385             <font class="keywordflow">if</font>((pT-&gt;GetExStyle() &amp; WS_EX_CLIENTEDGE) == 0)
00386                 dc.DrawEdge(&amp;rect, EDGE_SUNKEN, BF_RECT | BF_ADJUST);
00387             dc.FillRect(&amp;rect, COLOR_APPWORKSPACE);
00388         }
00389     }
00390 
00391 <font class="comment">// Message map and handlers</font>
<a name="l00392"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#s0">00392</a>     <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CSplitterImpl.html">CSplitterImpl&lt; T, t_bVertical&gt;</a>  <a class="code" href="classWTL_1_1CSplitterImpl.html#s0">thisClass</a>;
00393     BEGIN_MSG_MAP(thisClass)
00394         MESSAGE_HANDLER(WM_CREATE, <a class="code" href="classWTL_1_1CSplitterImpl.html#a21">OnCreate</a>)
00395         MESSAGE_HANDLER(WM_PAINT, <a class="code" href="classWTL_1_1CSplitterImpl.html#a22">OnPaint</a>)
00396         MESSAGE_HANDLER(WM_PRINTCLIENT, <a class="code" href="classWTL_1_1CSplitterImpl.html#a22">OnPaint</a>)
00397         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a44">IsInteractive</a>())
00398         {
00399             MESSAGE_HANDLER(WM_SETCURSOR, <a class="code" href="classWTL_1_1CSplitterImpl.html#a23">OnSetCursor</a>)
00400             MESSAGE_HANDLER(WM_MOUSEMOVE, <a class="code" href="classWTL_1_1CSplitterImpl.html#a24">OnMouseMove</a>)
00401             MESSAGE_HANDLER(WM_LBUTTONDOWN, <a class="code" href="classWTL_1_1CSplitterImpl.html#a25">OnLButtonDown</a>)
00402             MESSAGE_HANDLER(WM_LBUTTONUP, <a class="code" href="classWTL_1_1CSplitterImpl.html#a26">OnLButtonUp</a>)
00403             MESSAGE_HANDLER(WM_LBUTTONDBLCLK, <a class="code" href="classWTL_1_1CSplitterImpl.html#a27">OnLButtonDoubleClick</a>)
00404         }
00405         MESSAGE_HANDLER(WM_SETFOCUS, <a class="code" href="classWTL_1_1CSplitterImpl.html#a28">OnSetFocus</a>)
00406         MESSAGE_HANDLER(WM_MOUSEACTIVATE, <a class="code" href="classWTL_1_1CSplitterImpl.html#a29">OnMouseActivate</a>)
00407         MESSAGE_HANDLER(WM_SETTINGCHANGE, <a class="code" href="classWTL_1_1CSplitterImpl.html#a30">OnSettingChange</a>)
00408     END_MSG_MAP()
00409 
<a name="l00410"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a21">00410</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a21">OnCreate</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00411     {
00412         <a class="code" href="classWTL_1_1CSplitterImpl.html#a37">GetSystemSettings</a>(<font class="keyword">false</font>);
00413         bHandled = FALSE;
00414         <font class="keywordflow">return</font> 1;
00415     }
00416 
<a name="l00417"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a22">00417</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a22">OnPaint</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00418     {
00419         T* pT = static_cast&lt;T*&gt;(this);
00420         <font class="comment">// try setting position if not set</font>
00421         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a> &amp;&amp; <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> == -1)
00422             pT-&gt;SetSplitterPos();
00423         <font class="comment">// do painting</font>
00424         <a class="code" href="classWTL_1_1CPaintDC.html">CPaintDC</a> dc(pT-&gt;m_hWnd);
00425         pT-&gt;DrawSplitter(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
00426         <font class="keywordflow">return</font> 0;
00427     }
00428 
<a name="l00429"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a23">00429</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a23">OnSetCursor</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)
00430     {
00431         T* pT = static_cast&lt;T*&gt;(this);
00432         <font class="keywordflow">if</font>((HWND)wParam == pT-&gt;m_hWnd &amp;&amp; LOWORD(lParam) == HTCLIENT)
00433         {
00434             DWORD dwPos = ::GetMessagePos();
00435             POINT ptPos = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwPos), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwPos) };
00436             pT-&gt;ScreenToClient(&amp;ptPos);
00437             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a35">IsOverSplitterBar</a>(ptPos.x, ptPos.y))
00438                 <font class="keywordflow">return</font> 1;
00439         }
00440 
00441         bHandled = FALSE;
00442         <font class="keywordflow">return</font> 0;
00443     }
00444 
<a name="l00445"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a24">00445</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a24">OnMouseMove</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)
00446     {
00447         T* pT = static_cast&lt;T*&gt;(this);
00448         <font class="keywordtype">int</font> xPos = <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam);
00449         <font class="keywordtype">int</font> yPos = <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam);
00450         <font class="keywordflow">if</font>((wParam &amp; MK_LBUTTON) &amp;&amp; ::GetCapture() == pT-&gt;m_hWnd)
00451         {
00452             <font class="keywordtype">int</font> xyNewSplitPos = 0;
00453             <font class="keywordflow">if</font>(t_bVertical)
00454                 xyNewSplitPos = xPos - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m8">m_cxyDragOffset</a>;
00455             <font class="keywordflow">else</font>
00456                 xyNewSplitPos = yPos - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m8">m_cxyDragOffset</a>;
00457 
00458             <font class="keywordflow">if</font>(xyNewSplitPos == -1) <font class="comment">// avoid -1, that means middle</font>
00459                 xyNewSplitPos = -2;
00460 
00461             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> != xyNewSplitPos)
00462             {
00463                 <font class="keywordflow">if</font>(m_bFullDrag)
00464                 {
00465                     <font class="keywordflow">if</font>(pT-&gt;SetSplitterPos(xyNewSplitPos, <font class="keyword">true</font>))
00466                         pT-&gt;UpdateWindow();
00467                 }
00468                 <font class="keywordflow">else</font>
00469                 {
00470                     <a class="code" href="classWTL_1_1CSplitterImpl.html#a36">DrawGhostBar</a>();
00471                     pT-&gt;SetSplitterPos(xyNewSplitPos, <font class="keyword">false</font>);
00472                     <a class="code" href="classWTL_1_1CSplitterImpl.html#a36">DrawGhostBar</a>();
00473                 }
00474             }
00475         }
00476         <font class="keywordflow">else</font>        <font class="comment">// not dragging, just set cursor</font>
00477         {
00478             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a35">IsOverSplitterBar</a>(xPos, yPos))
00479                 ::SetCursor(m_hCursor);
00480             bHandled = FALSE;
00481         }
00482 
00483         <font class="keywordflow">return</font> 0;
00484     }
00485 
<a name="l00486"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a25">00486</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a25">OnLButtonDown</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; bHandled)
00487     {
00488         <font class="keywordtype">int</font> xPos = <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam);
00489         <font class="keywordtype">int</font> yPos = <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam);
00490         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a35">IsOverSplitterBar</a>(xPos, yPos))
00491         {
00492             T* pT = static_cast&lt;T*&gt;(this);
00493             pT-&gt;SetCapture();
00494             ::SetCursor(m_hCursor);
00495             <font class="keywordflow">if</font>(!<a class="code" href="classWTL_1_1CSplitterImpl.html#m7">m_bFullDrag</a>)
00496                 <a class="code" href="classWTL_1_1CSplitterImpl.html#a36">DrawGhostBar</a>();
00497             <font class="keywordflow">if</font>(t_bVertical)
00498                 <a class="code" href="classWTL_1_1CSplitterImpl.html#m8">m_cxyDragOffset</a> = xPos - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00499             <font class="keywordflow">else</font>
00500                 <a class="code" href="classWTL_1_1CSplitterImpl.html#m8">m_cxyDragOffset</a> = yPos - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00501         }
00502         bHandled = FALSE;
00503         <font class="keywordflow">return</font> 1;
00504     }
00505 
<a name="l00506"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a26">00506</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a26">OnLButtonUp</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00507     {
00508         <font class="keywordflow">if</font>(!<a class="code" href="classWTL_1_1CSplitterImpl.html#m7">m_bFullDrag</a>)
00509         {
00510             <a class="code" href="classWTL_1_1CSplitterImpl.html#a36">DrawGhostBar</a>();
00511             T* pT = static_cast&lt;T*&gt;(this);
00512             <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00513             pT-&gt;UpdateWindow();
00514         }
00515         ::ReleaseCapture();
00516         bHandled = FALSE;
00517         <font class="keywordflow">return</font> 1;
00518     }
00519 
<a name="l00520"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a27">00520</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a27">OnLButtonDoubleClick</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00521     {
00522         T* pT = static_cast&lt;T*&gt;(this);
00523         pT-&gt;SetSplitterPos();   <font class="comment">// middle</font>
00524         <font class="keywordflow">return</font> 0;
00525     }
00526 
<a name="l00527"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a28">00527</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a28">OnSetFocus</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM, BOOL&amp; bHandled)
00528     {
00529         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00530         {
00531             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>)
00532                 ::SetFocus(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a>]);
00533         }
00534         <font class="keywordflow">else</font>
00535         {
00536             ::SetFocus(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>]);
00537         }
00538         bHandled = FALSE;
00539         <font class="keywordflow">return</font> 1;
00540     }
00541 
<a name="l00542"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a29">00542</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a29">OnMouseActivate</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00543     {
00544         T* pT = static_cast&lt;T*&gt;(this);
00545         LRESULT lRet = pT-&gt;DefWindowProc(uMsg, wParam, lParam);
00546         <font class="keywordflow">if</font>(lRet == MA_ACTIVATE || lRet == MA_ACTIVATEANDEAT)
00547         {
00548             DWORD dwPos = ::GetMessagePos();
00549             POINT pt = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwPos), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwPos) };
00550             pT-&gt;ScreenToClient(&amp;pt);
00551             RECT rcPane;
00552             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nPane = 0; nPane &lt; <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a>; nPane++)
00553             {
00554                 <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a33">GetSplitterPaneRect</a>(nPane, &amp;rcPane) &amp;&amp; ::PtInRect(&amp;rcPane, pt))
00555                 {
00556                     <a class="code" href="classWTL_1_1CSplitterImpl.html#m3">m_nDefActivePane</a> = nPane;
00557                     <font class="keywordflow">break</font>;
00558                 }
00559             }
00560         }
00561         <font class="keywordflow">return</font> lRet;
00562     }
00563 
<a name="l00564"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a30">00564</a>     LRESULT <a class="code" href="classWTL_1_1CSplitterImpl.html#a30">OnSettingChange</a>(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00565     {
00566         <a class="code" href="classWTL_1_1CSplitterImpl.html#a37">GetSystemSettings</a>(<font class="keyword">true</font>);
00567         <font class="keywordflow">return</font> 0;
00568     }
00569 
00570 <font class="comment">// Implementation - internal helpers</font>
<a name="l00571"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a31">00571</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>()
00572     {
00573         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a> &amp;&amp; <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> == -1)
00574             <font class="keywordflow">return</font>;
00575 
00576         T* pT = static_cast&lt;T*&gt;(this);
00577         RECT rect = { 0, 0, 0, 0 };
00578         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> == <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00579         {
00580             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a32">GetSplitterBarRect</a>(&amp;rect))
00581                 pT-&gt;InvalidateRect(&amp;rect);
00582 
00583             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nPane = 0; nPane &lt; <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s1">m_nPanesCount</a>; nPane++)
00584             {
00585                 <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a33">GetSplitterPaneRect</a>(nPane, &amp;rect))
00586                 {
00587                     <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane] != NULL)
00588                         ::SetWindowPos(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[nPane], NULL, rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top, SWP_NOZORDER);
00589                     <font class="keywordflow">else</font>
00590                         pT-&gt;InvalidateRect(&amp;rect);
00591                 }
00592             }
00593         }
00594         <font class="keywordflow">else</font>
00595         {
00596             <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a33">GetSplitterPaneRect</a>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>, &amp;rect))
00597             {
00598                 <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>] != NULL)
00599                     ::SetWindowPos(<a class="code" href="classWTL_1_1CSplitterImpl.html#m0">m_hWndPane</a>[<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>], NULL, rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top, SWP_NOZORDER);
00600                 <font class="keywordflow">else</font>
00601                     pT-&gt;InvalidateRect(&amp;rect);
00602             }
00603         }
00604     }
00605 
<a name="l00606"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a32">00606</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a32">GetSplitterBarRect</a>(LPRECT lpRect)<font class="keyword"> const</font>
00607 <font class="keyword">    </font>{
00608         ATLASSERT(lpRect != NULL);
00609         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> != <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a> || <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> == -1)
00610             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00611 
00612         <font class="keywordflow">if</font>(t_bVertical)
00613         {
00614             lpRect-&gt;left = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00615             lpRect-&gt;top = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top;
00616             lpRect-&gt;right = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>;
00617             lpRect-&gt;bottom = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom;
00618         }
00619         <font class="keywordflow">else</font>
00620         {
00621             lpRect-&gt;left = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left;
00622             lpRect-&gt;top = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00623             lpRect-&gt;right = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right;
00624             lpRect-&gt;bottom = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>;
00625         }
00626 
00627         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00628     }
00629 
<a name="l00630"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a33">00630</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a33">GetSplitterPaneRect</a>(<font class="keywordtype">int</font> nPane, LPRECT lpRect)<font class="keyword"> const</font>
00631 <font class="keyword">    </font>{
00632         ATLASSERT(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a> || nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>);
00633         ATLASSERT(lpRect != NULL);
00634         <font class="keywordtype">bool</font> bRet = <font class="keyword">true</font>;
00635         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> != <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00636         {
00637             <font class="keywordflow">if</font>(nPane == <a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a>)
00638                 *lpRect = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>;
00639             <font class="keywordflow">else</font>
00640                 bRet = <font class="keyword">false</font>;
00641         }
00642         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(nPane == <a class="code" href="atlsplit_8h.html#a0">SPLIT_PANE_LEFT</a>)
00643         {
00644             <font class="keywordflow">if</font>(t_bVertical)
00645             {
00646                 lpRect-&gt;left = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left;
00647                 lpRect-&gt;top = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top;
00648                 lpRect-&gt;right = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00649                 lpRect-&gt;bottom = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom;
00650             }
00651             <font class="keywordflow">else</font>
00652             {
00653                 lpRect-&gt;left = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left;
00654                 lpRect-&gt;top = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top;
00655                 lpRect-&gt;right = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right;
00656                 lpRect-&gt;bottom = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00657             }
00658         }   
00659         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(nPane == <a class="code" href="atlsplit_8h.html#a1">SPLIT_PANE_RIGHT</a>)
00660         {
00661             <font class="keywordflow">if</font>(t_bVertical)
00662             {
00663                 lpRect-&gt;left = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>;
00664                 lpRect-&gt;top = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top;
00665                 lpRect-&gt;right = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right;
00666                 lpRect-&gt;bottom = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom;
00667             }
00668             <font class="keywordflow">else</font>
00669             {
00670                 lpRect-&gt;left = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left;
00671                 lpRect-&gt;top = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>;
00672                 lpRect-&gt;right = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right;
00673                 lpRect-&gt;bottom = <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom;
00674             }
00675         }
00676         <font class="keywordflow">else</font>
00677         {
00678             bRet = <font class="keyword">false</font>;
00679         }
00680         <font class="keywordflow">return</font> bRet;
00681     }
00682 
<a name="l00683"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a34">00683</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a34">IsOverSplitterRect</a>(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y)<font class="keyword"> const</font>
00684 <font class="keyword">    </font>{
00685         <font class="comment">// -1 == don't check</font>
00686         <font class="keywordflow">return</font> ((x == -1 || (x &gt;= <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left &amp;&amp; x &lt;= <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right)) &amp;&amp;
00687             (y == -1 || (y &gt;= <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top &amp;&amp; y &lt;= <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom)));
00688     }
00689 
<a name="l00690"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a35">00690</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a35">IsOverSplitterBar</a>(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y)<font class="keyword"> const</font>
00691 <font class="keyword">    </font>{
00692         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m12">m_nSinglePane</a> != <a class="code" href="atlsplit_8h.html#a4">SPLIT_PANE_NONE</a>)
00693             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00694         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> == -1 || !<a class="code" href="classWTL_1_1CSplitterImpl.html#a34">IsOverSplitterRect</a>(x, y))
00695             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00696         <font class="keywordtype">int</font> xy = t_bVertical ? x : y;
00697         <font class="keywordtype">int</font> xyOff = t_bVertical ? <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left : <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top;
00698         <font class="keywordflow">return</font> ((xy &gt;= (xyOff + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>)) &amp;&amp; (xy &lt; xyOff + <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> + <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>));
00699     }
00700 
<a name="l00701"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a36">00701</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a36">DrawGhostBar</a>()
00702     {
00703         RECT rect = { 0, 0, 0, 0 };
00704         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CSplitterImpl.html#a32">GetSplitterBarRect</a>(&amp;rect))
00705         {
00706             <font class="comment">// invert the brush pattern (looks just like frame window sizing)</font>
00707             T* pT = static_cast&lt;T*&gt;(this);
00708             <a class="code" href="classWTL_1_1CWindowDC.html">CWindowDC</a> dc(pT-&gt;m_hWnd);
00709             <a class="code" href="namespaceWTL.html#a38">CBrush</a> brush = CDCHandle::GetHalftoneBrush();
00710             <font class="keywordflow">if</font>(brush.m_hBrush != NULL)
00711             {
00712                 <a class="code" href="namespaceWTL.html#a37">CBrushHandle</a> brushOld = dc.<a class="code" href="classWTL_1_1CDCT.html#a27">SelectBrush</a>(brush);
00713                 dc.<a class="code" href="classWTL_1_1CDCT.html#a141">PatBlt</a>(rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top, PATINVERT);
00714                 dc.<a class="code" href="classWTL_1_1CDCT.html#a27">SelectBrush</a>(brushOld);
00715             }
00716         }
00717     }
00718 
<a name="l00719"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a37">00719</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a37">GetSystemSettings</a>(<font class="keywordtype">bool</font> bUpdate)
00720     {
00721         <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> = ::GetSystemMetrics(t_bVertical ? SM_CXSIZEFRAME : SM_CYSIZEFRAME);
00722 
00723         T* pT = static_cast&lt;T*&gt;(this);
00724         <font class="keywordflow">if</font>((pT-&gt;GetExStyle() &amp; WS_EX_CLIENTEDGE))
00725         {
00726             <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a> = 2 * ::GetSystemMetrics(t_bVertical ? SM_CXEDGE : SM_CYEDGE);
00727             <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a> = 0;
00728         }
00729         <font class="keywordflow">else</font>
00730         {
00731             <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a> = 0;
00732             <a class="code" href="classWTL_1_1CSplitterImpl.html#m5">m_cxyMin</a> = 2 * ::GetSystemMetrics(t_bVertical ? SM_CXEDGE : SM_CYEDGE);
00733         }
00734 
00735         ::SystemParametersInfo(SPI_GETDRAGFULLWINDOWS, 0, &amp;<a class="code" href="classWTL_1_1CSplitterImpl.html#m7">m_bFullDrag</a>, 0);
00736 
00737         <font class="keywordflow">if</font>(bUpdate)
00738             <a class="code" href="classWTL_1_1CSplitterImpl.html#a31">UpdateSplitterLayout</a>();
00739     }
00740 
<a name="l00741"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a38">00741</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a38">IsProportional</a>()<font class="keyword"> const</font>
00742 <font class="keyword">    </font>{
00743         <font class="keywordflow">return</font> ((<a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a> &amp; <a class="code" href="atlsplit_8h.html#a5">SPLIT_PROPORTIONAL</a>) != 0);
00744     }
00745 
<a name="l00746"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a39">00746</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a39">StoreProportionalPos</a>()
00747     {
00748         <font class="keywordtype">int</font> cxyTotal = t_bVertical ? (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>) : (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>);
00749         <font class="keywordflow">if</font>(cxyTotal &gt; 0)
00750             <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a> = ::MulDiv(<a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>, <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s2">m_nPropMax</a>, cxyTotal);
00751         <font class="keywordflow">else</font>
00752             <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a> = 0;
00753         ATLTRACE2(<a class="code" href="namespaceWTL.html#a111a1">atlTraceUI</a>, 0, <font class="stringliteral">"CSplitterImpl::StoreProportionalPos - %i\n"</font>, <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a>);
00754     }
00755 
<a name="l00756"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a40">00756</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a40">UpdateProportionalPos</a>()
00757     {
00758         <font class="keywordtype">int</font> cxyTotal = t_bVertical ? (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>) : (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>);
00759         <font class="keywordflow">if</font>(cxyTotal &gt; 0)
00760         {
00761             <font class="keywordtype">int</font> xyNewPos = ::MulDiv(<a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a>, cxyTotal, <a class="code" href="classWTL_1_1CSplitterImpl.html#s3s2">m_nPropMax</a>);
00762             <a class="code" href="classWTL_1_1CSplitterImpl.html#m10">m_bUpdateProportionalPos</a> = <font class="keyword">false</font>;
00763             T* pT = static_cast&lt;T*&gt;(this);
00764             pT-&gt;SetSplitterPos(xyNewPos, <font class="keyword">false</font>);
00765         }
00766     }
00767 
<a name="l00768"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a41">00768</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a41">IsRightAligned</a>()<font class="keyword"> const</font>
00769 <font class="keyword">    </font>{
00770         <font class="keywordflow">return</font> ((<a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a> &amp; <a class="code" href="atlsplit_8h.html#a7">SPLIT_RIGHTALIGNED</a>) != 0);
00771     }
00772 
<a name="l00773"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a42">00773</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a42">StoreRightAlignPos</a>()
00774     {
00775         <font class="keywordtype">int</font> cxyTotal = t_bVertical ? (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>) : (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>);
00776         <font class="keywordflow">if</font>(cxyTotal &gt; 0)
00777             <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a> = cxyTotal - <a class="code" href="classWTL_1_1CSplitterImpl.html#m2">m_xySplitterPos</a>;
00778         <font class="keywordflow">else</font>
00779             <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a> = 0;
00780         ATLTRACE2(<a class="code" href="namespaceWTL.html#a111a1">atlTraceUI</a>, 0, <font class="stringliteral">"CSplitterImpl::StoreRightAlignPos - %i\n"</font>, <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a>);
00781     }
00782 
<a name="l00783"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a43">00783</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a43">UpdateRightAlignPos</a>()
00784     {
00785         <font class="keywordtype">int</font> cxyTotal = t_bVertical ? (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.right - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.left - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>) : (<a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.bottom - <a class="code" href="classWTL_1_1CSplitterImpl.html#m1">m_rcSplitter</a>.top - <a class="code" href="classWTL_1_1CSplitterImpl.html#m4">m_cxySplitBar</a> - <a class="code" href="classWTL_1_1CSplitterImpl.html#m6">m_cxyBarEdge</a>);
00786         <font class="keywordflow">if</font>(cxyTotal &gt; 0)
00787         {
00788             <a class="code" href="classWTL_1_1CSplitterImpl.html#m10">m_bUpdateProportionalPos</a> = <font class="keyword">false</font>;
00789             T* pT = static_cast&lt;T*&gt;(this);
00790             pT-&gt;SetSplitterPos(cxyTotal - <a class="code" href="classWTL_1_1CSplitterImpl.html#m9">m_nProportionalPos</a>, <font class="keyword">false</font>);
00791         }
00792     }
00793 
<a name="l00794"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#a44">00794</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CSplitterImpl.html#a44">IsInteractive</a>()<font class="keyword"> const</font>
00795 <font class="keyword">    </font>{
00796         <font class="keywordflow">return</font> ((<a class="code" href="classWTL_1_1CSplitterImpl.html#m11">m_dwExtendedStyle</a> &amp; <a class="code" href="atlsplit_8h.html#a6">SPLIT_NONINTERACTIVE</a>) == 0);
00797     }
00798 };
00799 
<a name="l00800"></a><a class="code" href="classWTL_1_1CSplitterImpl.html#p0">00800</a> <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">bool</font> t_bVertical&gt; HCURSOR <a class="code" href="classWTL_1_1CSplitterImpl.html">CSplitterImpl&lt; T, t_bVertical&gt;</a>::m_hCursor = NULL;
00801 
00802 
00804 <font class="comment">// CSplitterWindowImpl - Implements a splitter window</font>
00805 
00806 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">bool</font> t_bVertical = true, <font class="keyword">class</font> TBase = CWindow, <font class="keyword">class</font> TWinTraits = CControlWinTraits&gt;
<a name="l00807"></a><a class="code" href="classWTL_1_1CSplitterWindowImpl.html">00807</a> <font class="keyword">class </font>ATL_NO_VTABLE <a class="code" href="classWTL_1_1CSplitterWindowImpl.html">CSplitterWindowImpl</a> : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt; T, TBase, TWinTraits &gt;, <font class="keyword">public</font> <a class="code" href="classWTL_1_1CSplitterImpl.html">CSplitterImpl</a>&lt; T , t_bVertical &gt;
00808 {
00809 <font class="keyword">public</font>:
00810     DECLARE_WND_CLASS_EX(NULL, CS_DBLCLKS, COLOR_WINDOW)
00811 
<a name="l00812"></a><a class="code" href="classWTL_1_1CSplitterWindowImpl.html#s0">00812</a>     <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CSplitterWindowImpl.html">CSplitterWindowImpl&lt; T , t_bVertical, TBase, TWinTraits &gt;</a>   thisClass;
<a name="l00813"></a><a class="code" href="classWTL_1_1CSplitterWindowImpl.html#s1">00813</a>     <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CSplitterImpl.html">CSplitterImpl&lt; T , t_bVertical &gt;</a>                baseClass;
00814     BEGIN_MSG_MAP(thisClass)
00815         MESSAGE_HANDLER(WM_ERASEBKGND, OnEraseBackground)
00816         MESSAGE_HANDLER(WM_SIZE, OnSize)
00817         CHAIN_MSG_MAP(baseClass)
00818         <a class="code" href="atlapp_8h.html#a30">FORWARD_NOTIFICATIONS</a>()
00819     END_MSG_MAP()
00820 
<a name="l00821"></a><a class="code" href="classWTL_1_1CSplitterWindowImpl.html#a0">00821</a>     LRESULT OnEraseBackground(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00822     {
00823         <font class="comment">// handled, no background painting needed</font>
00824         <font class="keywordflow">return</font> 1;
00825     }
00826 
<a name="l00827"></a><a class="code" href="classWTL_1_1CSplitterWindowImpl.html#a1">00827</a>     LRESULT OnSize(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00828     {
00829         <font class="keywordflow">if</font>(wParam != SIZE_MINIMIZED)
00830             SetSplitterRect();
00831 
00832         bHandled = FALSE;
00833         <font class="keywordflow">return</font> 1;
00834     }
00835 };
00836 
00837 
00839 <font class="comment">// CSplitterWindow - Implements a splitter window to be used as is</font>
00840 
00841 <font class="keyword">template</font> &lt;<font class="keywordtype">bool</font> t_bVertical = true&gt;
<a name="l00842"></a><a class="code" href="classWTL_1_1CSplitterWindowT.html">00842</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CSplitterWindowT.html">CSplitterWindowT</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CSplitterWindowImpl.html">CSplitterWindowImpl</a>&lt;CSplitterWindowT&lt;t_bVertical&gt;, t_bVertical&gt;
00843 {
00844 <font class="keyword">public</font>:
00845     DECLARE_WND_CLASS_EX(_T(<font class="stringliteral">"WTL_SplitterWindow"</font>), CS_DBLCLKS, COLOR_WINDOW)
00846 };
00847 
<a name="l00848"></a><a class="code" href="namespaceWTL.html#a55">00848</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CSplitterWindowT.html">CSplitterWindowT&lt;true&gt;</a>  <a class="code" href="namespaceWTL.html#a55">CSplitterWindow</a>;
<a name="l00849"></a><a class="code" href="namespaceWTL.html#a56">00849</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CSplitterWindowT.html">CSplitterWindowT&lt;false&gt;</a> <a class="code" href="namespaceWTL.html#a56">CHorSplitterWindow</a>;
00850 
00851 }; <font class="comment">//namespace WTL</font>
00852 
00853 <font class="preprocessor">#endif // __ATLSPLIT_H__</font>
</pre></div><hr><address align="right"><small>Generated on Thu Apr 11 21:09:32 2002 for wtl-doc by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
