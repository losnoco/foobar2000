<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>atlctrls.h Source File</title>
<link href="mystyles.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>atlctrls.h</h1><a href="atlctrls_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// Windows Template Library - WTL version 7.0</font>
00002 <font class="comment">// Copyright (C) 1997-2002 Microsoft Corporation</font>
00003 <font class="comment">// All rights reserved.</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// This file is a part of the Windows Template Library.</font>
00006 <font class="comment">// The code and information is provided "as-is" without</font>
00007 <font class="comment">// warranty of any kind, either expressed or implied.</font>
00008 
00009 <font class="preprocessor">#ifndef __ATLCTRLS_H__</font>
00010 <font class="preprocessor"></font><font class="preprocessor">#define __ATLCTRLS_H__</font>
00011 <font class="preprocessor"></font>
00012 <font class="preprocessor">#pragma once</font>
00013 <font class="preprocessor"></font>
00014 <font class="preprocessor">#ifndef __cplusplus</font>
00015 <font class="preprocessor"></font><font class="preprocessor">    #error ATL requires C++ compilation (use a .cpp suffix)</font>
00016 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00017 <font class="preprocessor"></font>
00018 <font class="preprocessor">#ifndef __ATLAPP_H__</font>
00019 <font class="preprocessor"></font><font class="preprocessor">    #error atlctrls.h requires atlapp.h to be included first</font>
00020 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00021 <font class="preprocessor"></font>
00022 <font class="preprocessor">#ifndef __ATLWIN_H__</font>
00023 <font class="preprocessor"></font><font class="preprocessor">    #error atlctrls.h requires atlwin.h to be included first</font>
00024 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00025 <font class="preprocessor"></font>
00026 <font class="preprocessor">#if (_WIN32_IE &lt; 0x0300)</font>
00027 <font class="preprocessor"></font><font class="preprocessor">    #error atlctrls.h requires IE Version 3.0 or higher</font>
00028 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00029 <font class="preprocessor"></font>
00030 
00031 <font class="preprocessor">#include &lt;richedit.h&gt;</font>
00032 <font class="preprocessor">#include &lt;richole.h&gt;</font>
00033 
00034 <font class="comment">// protect template members from windowsx.h macros</font>
00035 <font class="preprocessor">#ifdef _INC_WINDOWSX</font>
00036 <font class="preprocessor"></font><font class="preprocessor">#undef GetNextSibling</font>
00037 <font class="preprocessor"></font><font class="preprocessor">#undef GetPrevSibling</font>
00038 <font class="preprocessor"></font><font class="preprocessor">#endif //_INC_WINDOWSX</font>
00039 <font class="preprocessor"></font>
00040 
00042 <font class="comment">// Classes in this file</font>
00043 <font class="comment">//</font>
00044 <font class="comment">// CStaticT&lt;TBase&gt;</font>
00045 <font class="comment">// CButtonT&lt;TBase&gt;</font>
00046 <font class="comment">// CListBoxT&lt;TBase&gt;</font>
00047 <font class="comment">// CComboBoxT&lt;TBase&gt;</font>
00048 <font class="comment">// CEditT&lt;TBase&gt;</font>
00049 <font class="comment">// CEditCommands&lt;T&gt;</font>
00050 <font class="comment">// CScrollBarT&lt;TBase&gt;</font>
00051 <font class="comment">//</font>
00052 <font class="comment">// CImageList</font>
00053 <font class="comment">// CListViewCtrlT&lt;TBase&gt;</font>
00054 <font class="comment">// CTreeViewCtrlT&lt;TBase&gt;</font>
00055 <font class="comment">// CTreeItem</font>
00056 <font class="comment">// CTreeViewCtrlExT&lt;TBase&gt;</font>
00057 <font class="comment">// CHeaderCtrlT&lt;TBase&gt;</font>
00058 <font class="comment">// CToolBarCtrlT&lt;TBase&gt;</font>
00059 <font class="comment">// CStatusBarCtrlT&lt;TBase&gt;</font>
00060 <font class="comment">// CTabCtrlT&lt;TBase&gt;</font>
00061 <font class="comment">// CToolInfo</font>
00062 <font class="comment">// CToolTipCtrlT&lt;TBase&gt;</font>
00063 <font class="comment">// CTrackBarCtrlT&lt;TBase&gt;</font>
00064 <font class="comment">// CUpDownCtrlT&lt;TBase&gt;</font>
00065 <font class="comment">// CProgressBarCtrlT&lt;TBase&gt;</font>
00066 <font class="comment">// CHotKeyCtrlT&lt;TBase&gt;</font>
00067 <font class="comment">// CAnimateCtrlT&lt;TBase&gt;</font>
00068 <font class="comment">// CRichEditCtrlT&lt;TBase&gt;</font>
00069 <font class="comment">// CRichEditCommands&lt;T&gt;</font>
00070 <font class="comment">// CDragListBoxT&lt;TBase&gt;</font>
00071 <font class="comment">// CDragListNotifyImpl&lt;T&gt;</font>
00072 <font class="comment">// CReBarCtrlT&lt;TBase&gt;</font>
00073 <font class="comment">// CComboBoxExT&lt;TBase&gt;</font>
00074 <font class="comment">// CDateTimePickerCtrlT&lt;TBase&gt;</font>
00075 <font class="comment">// CMonthCalendarCtrlT&lt;TBase&gt;</font>
00076 <font class="comment">// CFlatScrollBarImpl&lt;T&gt;</font>
00077 <font class="comment">// CFlatScrollBarT&lt;TBase&gt;</font>
00078 <font class="comment">// CIPAddressCtrlT&lt;TBase&gt;</font>
00079 <font class="comment">// CPagerCtrlT&lt;TBase&gt;</font>
00080 <font class="comment">// CLinkCtrlT&lt;TBase&gt;</font>
00081 <font class="comment">//</font>
00082 <font class="comment">// CCustomDraw&lt;T&gt;</font>
00083 
00084 
00085 <font class="keyword">namespace </font>WTL
00086 {
00087 
00088 <font class="comment">// These are wrapper classes for Windows standard and common controls.</font>
00089 <font class="comment">// To implement a window based on a control, use following:</font>
00090 <font class="comment">// Example: Implementing a window based on a list box</font>
00091 <font class="comment">//</font>
00092 <font class="comment">// class CMyListBox : CWindowImpl&lt;CMyListBox, CListBox&gt;</font>
00093 <font class="comment">// {</font>
00094 <font class="comment">// public:</font>
00095 <font class="comment">//      BEGIN_MSG_MAP(CMyListBox)</font>
00096 <font class="comment">//          // put your message handler entries here</font>
00097 <font class="comment">//      END_MSG_MAP()</font>
00098 <font class="comment">// };</font>
00099 
00100 
00101 
00102 <font class="comment">// --- Standard Windows controls ---</font>
00103 
00105 <font class="comment">// CStatic - client side for a Windows STATIC control</font>
00106 
00107 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l00108"></a><a class="code" href="classWTL_1_1CStaticT.html">00108</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CStaticT.html">CStaticT</a> : <font class="keyword">public</font> TBase
00109 {
00110 <font class="keyword">public</font>:
00111 <font class="comment">// Constructors</font>
<a name="l00112"></a><a class="code" href="classWTL_1_1CStaticT.html#a0">00112</a>     <a class="code" href="classWTL_1_1CStaticT.html#a0">CStaticT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
00113 
<a name="l00114"></a><a class="code" href="classWTL_1_1CStaticT.html#a1">00114</a>     <a class="code" href="classWTL_1_1CStaticT.html">CStaticT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CStaticT.html#a1">operator=</a>(HWND hWnd)
00115     {
00116         m_hWnd = hWnd;
00117         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00118     }
00119 
<a name="l00120"></a><a class="code" href="classWTL_1_1CStaticT.html#a2">00120</a>     HWND <a class="code" href="classWTL_1_1CStaticT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
00121             DWORD dwStyle = 0, DWORD dwExStyle = 0,
00122             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
00123     {
00124         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CStaticT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
00125     }
00126 
00127 <font class="comment">// Attributes</font>
<a name="l00128"></a><a class="code" href="classWTL_1_1CStaticT.html#d0">00128</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CStaticT.html#d0">GetWndClassName</a>()
00129     {
00130         <font class="keywordflow">return</font> _T(<font class="stringliteral">"STATIC"</font>);
00131     }
00132 
<a name="l00133"></a><a class="code" href="classWTL_1_1CStaticT.html#a3">00133</a>     HICON <a class="code" href="classWTL_1_1CStaticT.html#a3">GetIcon</a>()<font class="keyword"> const</font>
00134 <font class="keyword">    </font>{
00135         ATLASSERT(::IsWindow(m_hWnd));
00136         <font class="keywordflow">return</font> (HICON)::SendMessage(m_hWnd, STM_GETICON, 0, 0L);
00137     }
<a name="l00138"></a><a class="code" href="classWTL_1_1CStaticT.html#a4">00138</a>     HICON <a class="code" href="classWTL_1_1CStaticT.html#a4">SetIcon</a>(HICON hIcon)
00139     {
00140         ATLASSERT(::IsWindow(m_hWnd));
00141         <font class="keywordflow">return</font> (HICON)::SendMessage(m_hWnd, STM_SETICON, (WPARAM)hIcon, 0L);
00142     }
<a name="l00143"></a><a class="code" href="classWTL_1_1CStaticT.html#a5">00143</a>     HENHMETAFILE <a class="code" href="classWTL_1_1CStaticT.html#a5">GetEnhMetaFile</a>()<font class="keyword"> const</font>
00144 <font class="keyword">    </font>{
00145         ATLASSERT(::IsWindow(m_hWnd));
00146         <font class="keywordflow">return</font> (HENHMETAFILE)::SendMessage(m_hWnd, STM_GETIMAGE, IMAGE_ENHMETAFILE, 0L);
00147     }
<a name="l00148"></a><a class="code" href="classWTL_1_1CStaticT.html#a6">00148</a>     HENHMETAFILE <a class="code" href="classWTL_1_1CStaticT.html#a6">SetEnhMetaFile</a>(HENHMETAFILE hMetaFile)
00149     {
00150         ATLASSERT(::IsWindow(m_hWnd));
00151         <font class="keywordflow">return</font> (HENHMETAFILE)::SendMessage(m_hWnd, STM_SETIMAGE, IMAGE_ENHMETAFILE, (LPARAM)hMetaFile);
00152     }
<a name="l00153"></a><a class="code" href="classWTL_1_1CStaticT.html#a7">00153</a>     <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a> <a class="code" href="classWTL_1_1CStaticT.html#a7">GetBitmap</a>()<font class="keyword"> const</font>
00154 <font class="keyword">    </font>{
00155         ATLASSERT(::IsWindow(m_hWnd));
00156         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a>((HBITMAP)::SendMessage(m_hWnd, STM_GETIMAGE, IMAGE_BITMAP, 0L));
00157     }
<a name="l00158"></a><a class="code" href="classWTL_1_1CStaticT.html#a8">00158</a>     <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a> <a class="code" href="classWTL_1_1CStaticT.html#a8">SetBitmap</a>(HBITMAP hBitmap)
00159     {
00160         ATLASSERT(::IsWindow(m_hWnd));
00161         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a>((HBITMAP)::SendMessage(m_hWnd, STM_SETIMAGE, IMAGE_BITMAP, (LPARAM)hBitmap));
00162     }
<a name="l00163"></a><a class="code" href="classWTL_1_1CStaticT.html#a9">00163</a>     HCURSOR <a class="code" href="classWTL_1_1CStaticT.html#a9">GetCursor</a>()<font class="keyword"> const</font>
00164 <font class="keyword">    </font>{
00165         ATLASSERT(::IsWindow(m_hWnd));
00166         <font class="keywordflow">return</font> (HCURSOR)::SendMessage(m_hWnd, STM_GETIMAGE, IMAGE_CURSOR, 0L);
00167     }
<a name="l00168"></a><a class="code" href="classWTL_1_1CStaticT.html#a10">00168</a>     HCURSOR <a class="code" href="classWTL_1_1CStaticT.html#a10">SetCursor</a>(HCURSOR hCursor)
00169     {
00170         ATLASSERT(::IsWindow(m_hWnd));
00171         <font class="keywordflow">return</font> (HCURSOR)::SendMessage(m_hWnd, STM_SETIMAGE, IMAGE_CURSOR, (LPARAM)hCursor);
00172     }
00173 };
00174 
<a name="l00175"></a><a class="code" href="namespaceWTL.html#a2">00175</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CStaticT.html">CStaticT&lt;CWindow&gt;</a>   <a class="code" href="namespaceWTL.html#a2">CStatic</a>;
00176 
00177 
00179 <font class="comment">// CButton - client side for a Windows BUTTON control</font>
00180 
00181 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l00182"></a><a class="code" href="classWTL_1_1CButtonT.html">00182</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CButtonT.html">CButtonT</a> : <font class="keyword">public</font> TBase
00183 {
00184 <font class="keyword">public</font>:
00185 <font class="comment">// Constructors</font>
<a name="l00186"></a><a class="code" href="classWTL_1_1CButtonT.html#a0">00186</a>     <a class="code" href="classWTL_1_1CButtonT.html#a0">CButtonT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
00187 
<a name="l00188"></a><a class="code" href="classWTL_1_1CButtonT.html#a1">00188</a>     <a class="code" href="classWTL_1_1CButtonT.html">CButtonT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CButtonT.html#a1">operator=</a>(HWND hWnd)
00189     {
00190         m_hWnd = hWnd;
00191         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00192     }
00193 
<a name="l00194"></a><a class="code" href="classWTL_1_1CButtonT.html#a2">00194</a>     HWND <a class="code" href="classWTL_1_1CButtonT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
00195             DWORD dwStyle = 0, DWORD dwExStyle = 0,
00196             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
00197     {
00198         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CButtonT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
00199     }
00200 
00201 <font class="comment">// Attributes</font>
<a name="l00202"></a><a class="code" href="classWTL_1_1CButtonT.html#d0">00202</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CButtonT.html#d0">GetWndClassName</a>()
00203     {
00204         <font class="keywordflow">return</font> _T(<font class="stringliteral">"BUTTON"</font>);
00205     }
00206 
<a name="l00207"></a><a class="code" href="classWTL_1_1CButtonT.html#a3">00207</a>     UINT <a class="code" href="classWTL_1_1CButtonT.html#a3">GetState</a>()<font class="keyword"> const</font>
00208 <font class="keyword">    </font>{
00209         ATLASSERT(::IsWindow(m_hWnd));
00210         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, BM_GETSTATE, 0, 0L);
00211     }
<a name="l00212"></a><a class="code" href="classWTL_1_1CButtonT.html#a4">00212</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CButtonT.html#a4">SetState</a>(BOOL bHighlight)
00213     {
00214         ATLASSERT(::IsWindow(m_hWnd));
00215         ::SendMessage(m_hWnd, BM_SETSTATE, bHighlight, 0L);
00216     }
<a name="l00217"></a><a class="code" href="classWTL_1_1CButtonT.html#a5">00217</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CButtonT.html#a5">GetCheck</a>()<font class="keyword"> const</font>
00218 <font class="keyword">    </font>{
00219         ATLASSERT(::IsWindow(m_hWnd));
00220         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, BM_GETCHECK, 0, 0L);
00221     }
<a name="l00222"></a><a class="code" href="classWTL_1_1CButtonT.html#a6">00222</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CButtonT.html#a6">SetCheck</a>(<font class="keywordtype">int</font> nCheck)
00223     {
00224         ATLASSERT(::IsWindow(m_hWnd));
00225         ::SendMessage(m_hWnd, BM_SETCHECK, nCheck, 0L);
00226     }
<a name="l00227"></a><a class="code" href="classWTL_1_1CButtonT.html#a7">00227</a>     UINT <a class="code" href="classWTL_1_1CButtonT.html#a7">GetButtonStyle</a>()<font class="keyword"> const</font>
00228 <font class="keyword">    </font>{
00229         ATLASSERT(::IsWindow(m_hWnd));
00230         <font class="keywordflow">return</font> (UINT)::GetWindowLong(m_hWnd, GWL_STYLE) &amp; 0xff;
00231     }
<a name="l00232"></a><a class="code" href="classWTL_1_1CButtonT.html#a8">00232</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CButtonT.html#a8">SetButtonStyle</a>(UINT nStyle, BOOL bRedraw = TRUE)
00233     {
00234         ATLASSERT(::IsWindow(m_hWnd));
00235         ::SendMessage(m_hWnd, BM_SETSTYLE, nStyle, (LPARAM)bRedraw);
00236     }
00237 
<a name="l00238"></a><a class="code" href="classWTL_1_1CButtonT.html#a9">00238</a>     HICON <a class="code" href="classWTL_1_1CButtonT.html#a9">GetIcon</a>()<font class="keyword"> const</font>
00239 <font class="keyword">    </font>{
00240         ATLASSERT(::IsWindow(m_hWnd));
00241         <font class="keywordflow">return</font> (HICON)::SendMessage(m_hWnd, BM_GETIMAGE, IMAGE_ICON, 0L);
00242     }
<a name="l00243"></a><a class="code" href="classWTL_1_1CButtonT.html#a10">00243</a>     HICON <a class="code" href="classWTL_1_1CButtonT.html#a10">SetIcon</a>(HICON hIcon)
00244     {
00245         ATLASSERT(::IsWindow(m_hWnd));
00246         <font class="keywordflow">return</font> (HICON)::SendMessage(m_hWnd, BM_SETIMAGE, IMAGE_ICON, (LPARAM)hIcon);
00247     }
<a name="l00248"></a><a class="code" href="classWTL_1_1CButtonT.html#a11">00248</a>     <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a> <a class="code" href="classWTL_1_1CButtonT.html#a11">GetBitmap</a>()<font class="keyword"> const</font>
00249 <font class="keyword">    </font>{
00250         ATLASSERT(::IsWindow(m_hWnd));
00251         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a>((HBITMAP)::SendMessage(m_hWnd, BM_GETIMAGE, IMAGE_BITMAP, 0L));
00252     }
<a name="l00253"></a><a class="code" href="classWTL_1_1CButtonT.html#a12">00253</a>     <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a> <a class="code" href="classWTL_1_1CButtonT.html#a12">SetBitmap</a>(HBITMAP hBitmap)
00254     {
00255         ATLASSERT(::IsWindow(m_hWnd));
00256         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a41">CBitmapHandle</a>((HBITMAP)::SendMessage(m_hWnd, BM_SETIMAGE, IMAGE_BITMAP, (LPARAM)hBitmap));
00257     }
00258 
00259 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l00260"></a><a class="code" href="classWTL_1_1CButtonT.html#a13">00260</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CButtonT.html#a13">GetIdealSize</a>(LPSIZE lpSize)<font class="keyword"> const</font>
00261 <font class="keyword">    </font>{
00262         ATLASSERT(::IsWindow(m_hWnd));
00263         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, BCM_GETIDEALSIZE, 0, (LPARAM)lpSize);
00264     }
<a name="l00265"></a><a class="code" href="classWTL_1_1CButtonT.html#a14">00265</a>     BOOL <a class="code" href="classWTL_1_1CButtonT.html#a14">GetImageList</a>(PBUTTON_IMAGELIST pButtonImagelist)<font class="keyword"> const</font>
00266 <font class="keyword">    </font>{
00267         ATLASSERT(::IsWindow(m_hWnd));
00268         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, BCM_GETIMAGELIST, 0, (LPARAM)pButtonImagelist);
00269     }
<a name="l00270"></a><a class="code" href="classWTL_1_1CButtonT.html#a15">00270</a>     BOOL <a class="code" href="classWTL_1_1CButtonT.html#a15">SetImageList</a>(PBUTTON_IMAGELIST pButtonImagelist)
00271     {
00272         ATLASSERT(::IsWindow(m_hWnd));
00273         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, BCM_SETIMAGELIST, 0, (LPARAM)pButtonImagelist);
00274     }
<a name="l00275"></a><a class="code" href="classWTL_1_1CButtonT.html#a16">00275</a>     BOOL <a class="code" href="classWTL_1_1CButtonT.html#a16">GetTextMargin</a>(LPRECT lpRect)<font class="keyword"> const</font>
00276 <font class="keyword">    </font>{
00277         ATLASSERT(::IsWindow(m_hWnd));
00278         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, BCM_GETTEXTMARGIN, 0, (LPARAM)lpRect);
00279     }
<a name="l00280"></a><a class="code" href="classWTL_1_1CButtonT.html#a17">00280</a>     BOOL <a class="code" href="classWTL_1_1CButtonT.html#a17">SetTextMargin</a>(LPRECT lpRect)
00281     {
00282         ATLASSERT(::IsWindow(m_hWnd));
00283         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, BCM_SETTEXTMARGIN, 0, (LPARAM)lpRect);
00284     }
00285 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
00286 <font class="preprocessor"></font>
00287 <font class="comment">// Operations</font>
<a name="l00288"></a><a class="code" href="classWTL_1_1CButtonT.html#a18">00288</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CButtonT.html#a18">Click</a>()
00289     {
00290         ATLASSERT(::IsWindow(m_hWnd));
00291         ::SendMessage(m_hWnd, BM_CLICK, 0, 0L);
00292     }
00293 };
00294 
<a name="l00295"></a><a class="code" href="namespaceWTL.html#a3">00295</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CButtonT.html">CButtonT&lt;CWindow&gt;</a>   <a class="code" href="namespaceWTL.html#a3">CButton</a>;
00296 
00297 
00299 <font class="comment">// CListBox - client side for a Windows LISTBOX control</font>
00300 
00301 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l00302"></a><a class="code" href="classWTL_1_1CListBoxT.html">00302</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CListBoxT.html">CListBoxT</a> : <font class="keyword">public</font> TBase
00303 {
00304 <font class="keyword">public</font>:
00305 <font class="comment">// Constructors</font>
<a name="l00306"></a><a class="code" href="classWTL_1_1CListBoxT.html#a0">00306</a>     <a class="code" href="classWTL_1_1CListBoxT.html#a0">CListBoxT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
00307 
<a name="l00308"></a><a class="code" href="classWTL_1_1CListBoxT.html#a1">00308</a>     <a class="code" href="classWTL_1_1CListBoxT.html">CListBoxT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
00309     {
00310         m_hWnd = hWnd;
00311         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00312     }
00313 
<a name="l00314"></a><a class="code" href="classWTL_1_1CListBoxT.html#a2">00314</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
00315             DWORD dwStyle = 0, DWORD dwExStyle = 0,
00316             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
00317     {
00318         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
00319     }
00320 
00321 <font class="comment">// Attributes</font>
<a name="l00322"></a><a class="code" href="classWTL_1_1CListBoxT.html#d0">00322</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
00323     {
00324         <font class="keywordflow">return</font> _T(<font class="stringliteral">"LISTBOX"</font>);
00325     }
00326 
00327     <font class="comment">// for entire listbox</font>
<a name="l00328"></a><a class="code" href="classWTL_1_1CListBoxT.html#a3">00328</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a3">GetCount</a>()<font class="keyword"> const</font>
00329 <font class="keyword">    </font>{
00330         ATLASSERT(::IsWindow(m_hWnd));
00331         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETCOUNT, 0, 0L);
00332     }
<a name="l00333"></a><a class="code" href="classWTL_1_1CListBoxT.html#a4">00333</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a4">SetCount</a>(<font class="keywordtype">int</font> cItems)
00334     {
00335         ATLASSERT(::IsWindow(m_hWnd));
00336         ATLASSERT(((GetStyle() &amp; LBS_NODATA) != 0) &amp;&amp; ((GetStyle() &amp; LBS_HASSTRINGS) == 0));
00337         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETCOUNT, cItems, 0L);
00338     }
<a name="l00339"></a><a class="code" href="classWTL_1_1CListBoxT.html#a5">00339</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a5">GetHorizontalExtent</a>()<font class="keyword"> const</font>
00340 <font class="keyword">    </font>{
00341         ATLASSERT(::IsWindow(m_hWnd));
00342         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETHORIZONTALEXTENT, 0, 0L);
00343     }
<a name="l00344"></a><a class="code" href="classWTL_1_1CListBoxT.html#a6">00344</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a6">SetHorizontalExtent</a>(<font class="keywordtype">int</font> cxExtent)
00345     {
00346         ATLASSERT(::IsWindow(m_hWnd));
00347         ::SendMessage(m_hWnd, LB_SETHORIZONTALEXTENT, cxExtent, 0L);
00348     }
<a name="l00349"></a><a class="code" href="classWTL_1_1CListBoxT.html#a7">00349</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a7">GetTopIndex</a>()<font class="keyword"> const</font>
00350 <font class="keyword">    </font>{
00351         ATLASSERT(::IsWindow(m_hWnd));
00352         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETTOPINDEX, 0, 0L);
00353     }
<a name="l00354"></a><a class="code" href="classWTL_1_1CListBoxT.html#a8">00354</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a8">SetTopIndex</a>(<font class="keywordtype">int</font> nIndex)
00355     {
00356         ATLASSERT(::IsWindow(m_hWnd));
00357         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETTOPINDEX, nIndex, 0L);
00358     }
<a name="l00359"></a><a class="code" href="classWTL_1_1CListBoxT.html#a9">00359</a>     LCID <a class="code" href="classWTL_1_1CListBoxT.html#a9">GetLocale</a>()<font class="keyword"> const</font>
00360 <font class="keyword">    </font>{
00361         ATLASSERT(::IsWindow(m_hWnd));
00362         <font class="keywordflow">return</font> (LCID)::SendMessage(m_hWnd, LB_GETLOCALE, 0, 0L);
00363     }
<a name="l00364"></a><a class="code" href="classWTL_1_1CListBoxT.html#a10">00364</a>     LCID <a class="code" href="classWTL_1_1CListBoxT.html#a10">SetLocale</a>(LCID nNewLocale)
00365     {
00366         ATLASSERT(::IsWindow(m_hWnd));
00367         <font class="keywordflow">return</font> (LCID)::SendMessage(m_hWnd, LB_SETLOCALE, (WPARAM)nNewLocale, 0L);
00368     }
00369 
00370 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l00371"></a><a class="code" href="classWTL_1_1CListBoxT.html#a11">00371</a> <font class="preprocessor"></font>    DWORD <a class="code" href="classWTL_1_1CListBoxT.html#a11">GetListBoxInfo</a>()<font class="keyword"> const</font>
00372 <font class="keyword">    </font>{
00373         ATLASSERT(::IsWindow(m_hWnd));
00374 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
00375 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LB_GETLISTBOXINFO, 0, 0L);
00376 <font class="preprocessor">#else </font>
00377 <font class="preprocessor">        return ::GetListBoxInfo(m_hWnd);</font>
00378 <font class="preprocessor"></font><font class="preprocessor">#endif </font>
00379 <font class="preprocessor">    }</font>
00380 <font class="preprocessor"></font><font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
00381 <font class="preprocessor"></font>
00382     <font class="comment">// for single-selection listboxes</font>
<a name="l00383"></a><a class="code" href="classWTL_1_1CListBoxT.html#a12">00383</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a12">GetCurSel</a>()<font class="keyword"> const</font>
00384 <font class="keyword">    </font>{
00385         ATLASSERT(::IsWindow(m_hWnd));
00386         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) == 0);
00387         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETCURSEL, 0, 0L);
00388     }
<a name="l00389"></a><a class="code" href="classWTL_1_1CListBoxT.html#a13">00389</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a13">SetCurSel</a>(<font class="keywordtype">int</font> nSelect)
00390     {
00391         ATLASSERT(::IsWindow(m_hWnd));
00392         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) == 0);
00393         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETCURSEL, nSelect, 0L);
00394     }
00395 
00396     <font class="comment">// for multiple-selection listboxes</font>
<a name="l00397"></a><a class="code" href="classWTL_1_1CListBoxT.html#a14">00397</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a14">GetSel</a>(<font class="keywordtype">int</font> nIndex) <font class="keyword">const</font>           <font class="comment">// also works for single-selection</font>
00398     {
00399         ATLASSERT(::IsWindow(m_hWnd));
00400         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETSEL, nIndex, 0L);
00401     }
<a name="l00402"></a><a class="code" href="classWTL_1_1CListBoxT.html#a15">00402</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a15">SetSel</a>(<font class="keywordtype">int</font> nIndex, BOOL bSelect = TRUE)
00403     {
00404         ATLASSERT(::IsWindow(m_hWnd));
00405         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) != 0);
00406         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETSEL, bSelect, nIndex);
00407     }
<a name="l00408"></a><a class="code" href="classWTL_1_1CListBoxT.html#a16">00408</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a16">GetSelCount</a>()<font class="keyword"> const</font>
00409 <font class="keyword">    </font>{
00410         ATLASSERT(::IsWindow(m_hWnd));
00411         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) != 0);
00412         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETSELCOUNT, 0, 0L);
00413     }
<a name="l00414"></a><a class="code" href="classWTL_1_1CListBoxT.html#a17">00414</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a17">GetSelItems</a>(<font class="keywordtype">int</font> nMaxItems, LPINT rgIndex)<font class="keyword"> const</font>
00415 <font class="keyword">    </font>{
00416         ATLASSERT(::IsWindow(m_hWnd));
00417         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) != 0);
00418         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETSELITEMS, nMaxItems, (LPARAM)rgIndex);
00419     }
<a name="l00420"></a><a class="code" href="classWTL_1_1CListBoxT.html#a18">00420</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a18">GetAnchorIndex</a>()<font class="keyword"> const</font>
00421 <font class="keyword">    </font>{
00422         ATLASSERT(::IsWindow(m_hWnd));
00423         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) != 0);
00424         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETANCHORINDEX, 0, 0L);
00425     }
<a name="l00426"></a><a class="code" href="classWTL_1_1CListBoxT.html#a19">00426</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a19">SetAnchorIndex</a>(<font class="keywordtype">int</font> nIndex)
00427     {
00428         ATLASSERT(::IsWindow(m_hWnd));
00429         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) != 0);
00430         ::SendMessage(m_hWnd, LB_SETANCHORINDEX, nIndex, 0L);
00431     }
<a name="l00432"></a><a class="code" href="classWTL_1_1CListBoxT.html#a20">00432</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a20">GetCaretIndex</a>()<font class="keyword"> const</font>
00433 <font class="keyword">    </font>{
00434         ATLASSERT(::IsWindow(m_hWnd));
00435         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETCARETINDEX, 0, 0);
00436     }
<a name="l00437"></a><a class="code" href="classWTL_1_1CListBoxT.html#a21">00437</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a21">SetCaretIndex</a>(<font class="keywordtype">int</font> nIndex, BOOL bScroll = TRUE)
00438     {
00439         ATLASSERT(::IsWindow(m_hWnd));
00440         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETCARETINDEX, nIndex, MAKELONG(bScroll, 0));
00441     }
00442 
00443     <font class="comment">// for listbox items</font>
<a name="l00444"></a><a class="code" href="classWTL_1_1CListBoxT.html#a22">00444</a>     <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> <a class="code" href="classWTL_1_1CListBoxT.html#a22">GetItemData</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00445 <font class="keyword">    </font>{
00446         ATLASSERT(::IsWindow(m_hWnd));
00447         <font class="keywordflow">return</font> (DWORD_PTR)::SendMessage(m_hWnd, LB_GETITEMDATA, nIndex, 0L);
00448     }
<a name="l00449"></a><a class="code" href="classWTL_1_1CListBoxT.html#a23">00449</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a23">SetItemData</a>(<font class="keywordtype">int</font> nIndex, <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwItemData)
00450     {
00451         ATLASSERT(::IsWindow(m_hWnd));
00452         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETITEMDATA, nIndex, (LPARAM)dwItemData);
00453     }
<a name="l00454"></a><a class="code" href="classWTL_1_1CListBoxT.html#a24">00454</a>     <font class="keywordtype">void</font>* <a class="code" href="classWTL_1_1CListBoxT.html#a24">GetItemDataPtr</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00455 <font class="keyword">    </font>{
00456         ATLASSERT(::IsWindow(m_hWnd));
00457         <font class="keywordflow">return</font> (<font class="keywordtype">void</font>*)::SendMessage(m_hWnd, LB_GETITEMDATA, nIndex, 0L);
00458     }
<a name="l00459"></a><a class="code" href="classWTL_1_1CListBoxT.html#a25">00459</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a25">SetItemDataPtr</a>(<font class="keywordtype">int</font> nIndex, <font class="keywordtype">void</font>* pData)
00460     {
00461         ATLASSERT(::IsWindow(m_hWnd));
00462         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CListBoxT.html#a23">SetItemData</a>(nIndex, (<a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a>)pData);
00463     }
<a name="l00464"></a><a class="code" href="classWTL_1_1CListBoxT.html#a26">00464</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a26">GetItemRect</a>(<font class="keywordtype">int</font> nIndex, LPRECT lpRect)<font class="keyword"> const</font>
00465 <font class="keyword">    </font>{
00466         ATLASSERT(::IsWindow(m_hWnd));
00467         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETITEMRECT, nIndex, (LPARAM)lpRect);
00468     }
<a name="l00469"></a><a class="code" href="classWTL_1_1CListBoxT.html#a27">00469</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(<font class="keywordtype">int</font> nIndex, LPTSTR lpszBuffer)<font class="keyword"> const</font>
00470 <font class="keyword">    </font>{
00471         ATLASSERT(::IsWindow(m_hWnd));
00472         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETTEXT, nIndex, (LPARAM)lpszBuffer);
00473     }
00474 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
00475 <font class="preprocessor"></font><font class="preprocessor">#ifdef _OLEAUTO_H_</font>
00476 <font class="preprocessor"></font>    BOOL GetTextBSTR(<font class="keywordtype">int</font> nIndex, BSTR&amp; bstrText)<font class="keyword"> const</font>
00477 <font class="keyword">    </font>{
00478         USES_CONVERSION;
00479         ATLASSERT(::IsWindow(m_hWnd));
00480         ATLASSERT(bstrText == NULL);
00481 
00482         <font class="keywordtype">int</font> nLen = <a class="code" href="classWTL_1_1CListBoxT.html#a28">GetTextLen</a>(nIndex);
00483         <font class="keywordflow">if</font>(nLen == LB_ERR)
00484             <font class="keywordflow">return</font> FALSE;
00485 
00486         LPTSTR lpszText = (LPTSTR)_alloca((nLen + 1) * <font class="keyword">sizeof</font>(TCHAR));
00487 
00488         <font class="keywordflow">if</font>(<a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(nIndex, lpszText) == LB_ERR)
00489             <font class="keywordflow">return</font> FALSE;
00490 
00491         bstrText = ::SysAllocString(T2OLE(lpszText));
00492         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
00493     }
00494 <font class="preprocessor">#endif // _OLEAUTO_H_</font>
00495 <font class="preprocessor"></font><font class="preprocessor">#endif </font>
00496 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
00497 <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(<font class="keywordtype">int</font> nIndex, CString&amp; strText)<font class="keyword"> const</font>
00498 <font class="keyword">    </font>{
00499         ATLASSERT(::IsWindow(m_hWnd));
00500         <font class="keywordtype">int</font> nRet = LB_ERR;
00501         LPTSTR lpstr = strText.GetBufferSetLength(<a class="code" href="classWTL_1_1CListBoxT.html#a28">GetTextLen</a>(nIndex));
00502         <font class="keywordflow">if</font>(lpstr != NULL)
00503         {
00504             nRet = <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(nIndex, lpstr);
00505             strText.ReleaseBuffer();
00506         }
00507         <font class="keywordflow">return</font> nRet;
00508     }
00509 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l00510"></a><a class="code" href="classWTL_1_1CListBoxT.html#a28">00510</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a28">GetTextLen</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00511 <font class="keyword">    </font>{
00512         ATLASSERT(::IsWindow(m_hWnd));
00513         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETTEXTLEN, nIndex, 0L);
00514     }
<a name="l00515"></a><a class="code" href="classWTL_1_1CListBoxT.html#a29">00515</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a29">GetItemHeight</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00516 <font class="keyword">    </font>{
00517         ATLASSERT(::IsWindow(m_hWnd));
00518         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_GETITEMHEIGHT, nIndex, 0L);
00519     }
<a name="l00520"></a><a class="code" href="classWTL_1_1CListBoxT.html#a30">00520</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a30">SetItemHeight</a>(<font class="keywordtype">int</font> nIndex, UINT cyItemHeight)
00521     {
00522         ATLASSERT(::IsWindow(m_hWnd));
00523         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SETITEMHEIGHT, nIndex, MAKELONG(cyItemHeight, 0));
00524     }
00525 
00526     <font class="comment">// Settable only attributes</font>
<a name="l00527"></a><a class="code" href="classWTL_1_1CListBoxT.html#a31">00527</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a31">SetColumnWidth</a>(<font class="keywordtype">int</font> cxWidth)
00528     {
00529         ATLASSERT(::IsWindow(m_hWnd));
00530         ::SendMessage(m_hWnd, LB_SETCOLUMNWIDTH, cxWidth, 0L);
00531     }
<a name="l00532"></a><a class="code" href="classWTL_1_1CListBoxT.html#a32">00532</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a33">SetTabStops</a>(<font class="keywordtype">int</font> nTabStops, LPINT rgTabStops)
00533     {
00534         ATLASSERT(::IsWindow(m_hWnd));
00535         ATLASSERT((GetStyle() &amp; LBS_USETABSTOPS) != 0);
00536         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LB_SETTABSTOPS, nTabStops, (LPARAM)rgTabStops);
00537     }
<a name="l00538"></a><a class="code" href="classWTL_1_1CListBoxT.html#a33">00538</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a33">SetTabStops</a>()
00539     {
00540         ATLASSERT(::IsWindow(m_hWnd));
00541         ATLASSERT((GetStyle() &amp; LBS_USETABSTOPS) != 0);
00542         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LB_SETTABSTOPS, 0, 0L);
00543     }
<a name="l00544"></a><a class="code" href="classWTL_1_1CListBoxT.html#a34">00544</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a33">SetTabStops</a>(<font class="keyword">const</font> <font class="keywordtype">int</font>&amp; cxEachStop)    <font class="comment">// takes an 'int'</font>
00545     {
00546         ATLASSERT(::IsWindow(m_hWnd));
00547         ATLASSERT((GetStyle() &amp; LBS_USETABSTOPS) != 0);
00548         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LB_SETTABSTOPS, 1, (LPARAM)(LPINT)&amp;cxEachStop);
00549     }
00550 
00551 <font class="comment">// Operations</font>
<a name="l00552"></a><a class="code" href="classWTL_1_1CListBoxT.html#a35">00552</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a35">InitStorage</a>(<font class="keywordtype">int</font> nItems, UINT nBytes)
00553     {
00554         ATLASSERT(::IsWindow(m_hWnd));
00555         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_INITSTORAGE, (WPARAM)nItems, nBytes);
00556     }
<a name="l00557"></a><a class="code" href="classWTL_1_1CListBoxT.html#a36">00557</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a36">ResetContent</a>()
00558     {
00559         ATLASSERT(::IsWindow(m_hWnd));
00560         ::SendMessage(m_hWnd, LB_RESETCONTENT, 0, 0L);
00561     }
<a name="l00562"></a><a class="code" href="classWTL_1_1CListBoxT.html#a37">00562</a>     UINT <a class="code" href="classWTL_1_1CListBoxT.html#a37">ItemFromPoint</a>(POINT pt, BOOL&amp; bOutside)<font class="keyword"> const</font>
00563 <font class="keyword">    </font>{
00564         ATLASSERT(::IsWindow(m_hWnd));
00565         DWORD dw = (DWORD)::SendMessage(m_hWnd, LB_ITEMFROMPOINT, 0, MAKELPARAM(pt.x, pt.y));
00566         bOutside = (BOOL)HIWORD(dw);
00567         <font class="keywordflow">return</font> (UINT)LOWORD(dw);
00568     }
00569 
00570     <font class="comment">// manipulating listbox items</font>
<a name="l00571"></a><a class="code" href="classWTL_1_1CListBoxT.html#a38">00571</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a38">AddString</a>(LPCTSTR lpszItem)
00572     {
00573         ATLASSERT(::IsWindow(m_hWnd));
00574         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_ADDSTRING, 0, (LPARAM)lpszItem);
00575     }
<a name="l00576"></a><a class="code" href="classWTL_1_1CListBoxT.html#a39">00576</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a39">DeleteString</a>(UINT nIndex)
00577     {
00578         ATLASSERT(::IsWindow(m_hWnd));
00579         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_DELETESTRING, nIndex, 0L);
00580     }
<a name="l00581"></a><a class="code" href="classWTL_1_1CListBoxT.html#a40">00581</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a40">InsertString</a>(<font class="keywordtype">int</font> nIndex, LPCTSTR lpszItem)
00582     {
00583         ATLASSERT(::IsWindow(m_hWnd));
00584         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_INSERTSTRING, nIndex, (LPARAM)lpszItem);
00585     }
<a name="l00586"></a><a class="code" href="classWTL_1_1CListBoxT.html#a41">00586</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a41">Dir</a>(UINT attr, LPCTSTR lpszWildCard)
00587     {
00588         ATLASSERT(::IsWindow(m_hWnd));
00589         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_DIR, attr, (LPARAM)lpszWildCard);
00590     }
<a name="l00591"></a><a class="code" href="classWTL_1_1CListBoxT.html#a42">00591</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a42">AddFile</a>(LPCTSTR lpstrFileName)
00592     {
00593         ATLASSERT(::IsWindow(m_hWnd));
00594         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_ADDFILE, 0, (LPARAM)lpstrFileName);
00595     }
00596 
00597     <font class="comment">// selection helpers</font>
<a name="l00598"></a><a class="code" href="classWTL_1_1CListBoxT.html#a43">00598</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a43">FindString</a>(<font class="keywordtype">int</font> nStartAfter, LPCTSTR lpszItem)<font class="keyword"> const</font>
00599 <font class="keyword">    </font>{
00600         ATLASSERT(::IsWindow(m_hWnd));
00601         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_FINDSTRING, nStartAfter, (LPARAM)lpszItem);
00602     }
<a name="l00603"></a><a class="code" href="classWTL_1_1CListBoxT.html#a44">00603</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a44">FindStringExact</a>(<font class="keywordtype">int</font> nIndexStart, LPCTSTR lpszFind)<font class="keyword"> const</font>
00604 <font class="keyword">    </font>{
00605         ATLASSERT(::IsWindow(m_hWnd));
00606         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_FINDSTRINGEXACT, nIndexStart, (LPARAM)lpszFind);
00607     }
<a name="l00608"></a><a class="code" href="classWTL_1_1CListBoxT.html#a45">00608</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a45">SelectString</a>(<font class="keywordtype">int</font> nStartAfter, LPCTSTR lpszItem)
00609     {
00610         ATLASSERT(::IsWindow(m_hWnd));
00611         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LB_SELECTSTRING, nStartAfter, (LPARAM)lpszItem);
00612     }
<a name="l00613"></a><a class="code" href="classWTL_1_1CListBoxT.html#a46">00613</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a46">SelItemRange</a>(BOOL bSelect, <font class="keywordtype">int</font> nFirstItem, <font class="keywordtype">int</font> nLastItem)
00614     {
00615         ATLASSERT(::IsWindow(m_hWnd));
00616         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) != 0);
00617         ATLASSERT(nFirstItem &lt;= nLastItem);
00618         <font class="keywordflow">return</font> bSelect ? (int)::SendMessage(m_hWnd, LB_SELITEMRANGEEX, nFirstItem, nLastItem) : (int)::SendMessage(m_hWnd, LB_SELITEMRANGEEX, nLastItem, nFirstItem);
00619     }
00620 };
00621 
<a name="l00622"></a><a class="code" href="namespaceWTL.html#a4">00622</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CListBoxT.html">CListBoxT&lt;CWindow&gt;</a>  <a class="code" href="namespaceWTL.html#a4">CListBox</a>;
00623 
00624 
00626 <font class="comment">// CComboBox - client side for a Windows COMBOBOX control</font>
00627 
00628 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l00629"></a><a class="code" href="classWTL_1_1CComboBoxT.html">00629</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CComboBoxT.html">CComboBoxT</a> : <font class="keyword">public</font> TBase
00630 {
00631 <font class="keyword">public</font>:
00632 <font class="comment">// Constructors</font>
<a name="l00633"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a0">00633</a>     <a class="code" href="classWTL_1_1CComboBoxT.html">CComboBoxT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
00634 
<a name="l00635"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a1">00635</a>     <a class="code" href="classWTL_1_1CComboBoxT.html">CComboBoxT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
00636     {
00637         m_hWnd = hWnd;
00638         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00639     }
00640 
<a name="l00641"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a2">00641</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
00642             DWORD dwStyle = 0, DWORD dwExStyle = 0,
00643             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
00644     {
00645         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
00646     }
00647 
00648 <font class="comment">// Attributes</font>
<a name="l00649"></a><a class="code" href="classWTL_1_1CComboBoxT.html#d0">00649</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
00650     {
00651         <font class="keywordflow">return</font> _T(<font class="stringliteral">"COMBOBOX"</font>);
00652     }
00653 
00654     <font class="comment">// for entire combo box</font>
<a name="l00655"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a3">00655</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a3">GetCount</a>()<font class="keyword"> const</font>
00656 <font class="keyword">    </font>{
00657         ATLASSERT(::IsWindow(m_hWnd));
00658         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETCOUNT, 0, 0L);
00659     }
<a name="l00660"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a4">00660</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a12">GetCurSel</a>()<font class="keyword"> const</font>
00661 <font class="keyword">    </font>{
00662         ATLASSERT(::IsWindow(m_hWnd));
00663         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETCURSEL, 0, 0L);
00664     }
<a name="l00665"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a5">00665</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a13">SetCurSel</a>(<font class="keywordtype">int</font> nSelect)
00666     {
00667         ATLASSERT(::IsWindow(m_hWnd));
00668         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SETCURSEL, nSelect, 0L);
00669     }
<a name="l00670"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a6">00670</a>     LCID <a class="code" href="classWTL_1_1CListBoxT.html#a9">GetLocale</a>()<font class="keyword"> const</font>
00671 <font class="keyword">    </font>{
00672         ATLASSERT(::IsWindow(m_hWnd));
00673         <font class="keywordflow">return</font> (LCID)::SendMessage(m_hWnd, CB_GETLOCALE, 0, 0L);
00674     }
<a name="l00675"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a7">00675</a>     LCID <a class="code" href="classWTL_1_1CListBoxT.html#a10">SetLocale</a>(LCID nNewLocale)
00676     {
00677         ATLASSERT(::IsWindow(m_hWnd));
00678         <font class="keywordflow">return</font> (LCID)::SendMessage(m_hWnd, CB_SETLOCALE, (WPARAM)nNewLocale, 0L);
00679     }
<a name="l00680"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a8">00680</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a7">GetTopIndex</a>()<font class="keyword"> const</font>
00681 <font class="keyword">    </font>{
00682         ATLASSERT(::IsWindow(m_hWnd));
00683         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETTOPINDEX, 0, 0L);
00684     }
<a name="l00685"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a9">00685</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a8">SetTopIndex</a>(<font class="keywordtype">int</font> nIndex)
00686     {
00687         ATLASSERT(::IsWindow(m_hWnd));
00688         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SETTOPINDEX, nIndex, 0L);
00689     }
<a name="l00690"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a10">00690</a>     UINT <a class="code" href="classWTL_1_1CListBoxT.html#a5">GetHorizontalExtent</a>()<font class="keyword"> const</font>
00691 <font class="keyword">    </font>{
00692         ATLASSERT(::IsWindow(m_hWnd));
00693         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, CB_GETHORIZONTALEXTENT, 0, 0L);
00694     }
<a name="l00695"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a11">00695</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a6">SetHorizontalExtent</a>(UINT nExtent)
00696     {
00697         ATLASSERT(::IsWindow(m_hWnd));
00698         ::SendMessage(m_hWnd, CB_SETHORIZONTALEXTENT, nExtent, 0L);
00699     }
<a name="l00700"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a12">00700</a>     <font class="keywordtype">int</font> GetDroppedWidth()<font class="keyword"> const</font>
00701 <font class="keyword">    </font>{
00702         ATLASSERT(::IsWindow(m_hWnd));
00703         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETDROPPEDWIDTH, 0, 0L);
00704     }
<a name="l00705"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a13">00705</a>     <font class="keywordtype">int</font> SetDroppedWidth(UINT nWidth)
00706     {
00707         ATLASSERT(::IsWindow(m_hWnd));
00708         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SETDROPPEDWIDTH, nWidth, 0L);
00709     }
00710 
00711 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l00712"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a14">00712</a> <font class="preprocessor"></font>    BOOL GetComboBoxInfo(PCOMBOBOXINFO pComboBoxInfo)<font class="keyword"> const</font>
00713 <font class="keyword">    </font>{
00714         ATLASSERT(::IsWindow(m_hWnd));
00715 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
00716 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CB_GETCOMBOBOXINFO, 0, (LPARAM)pComboBoxInfo);
00717 <font class="preprocessor">#else </font>
00718 <font class="preprocessor">        return ::GetComboBoxInfo(m_hWnd, pComboBoxInfo);</font>
00719 <font class="preprocessor"></font><font class="preprocessor">#endif </font>
00720 <font class="preprocessor">    }</font>
00721 <font class="preprocessor"></font><font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
00722 <font class="preprocessor"></font>
00723     <font class="comment">// for edit control</font>
<a name="l00724"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a15">00724</a>     DWORD GetEditSel()<font class="keyword"> const</font>
00725 <font class="keyword">    </font>{
00726         ATLASSERT(::IsWindow(m_hWnd));
00727         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, CB_GETEDITSEL, 0, 0L);
00728     }
<a name="l00729"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a16">00729</a>     BOOL SetEditSel(<font class="keywordtype">int</font> nStartChar, <font class="keywordtype">int</font> nEndChar)
00730     {
00731         ATLASSERT(::IsWindow(m_hWnd));
00732         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CB_SETEDITSEL, 0, MAKELONG(nStartChar, nEndChar));
00733     }
00734 
00735     <font class="comment">// for combobox item</font>
<a name="l00736"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a17">00736</a>     <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> <a class="code" href="classWTL_1_1CListBoxT.html#a22">GetItemData</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00737 <font class="keyword">    </font>{
00738         ATLASSERT(::IsWindow(m_hWnd));
00739         <font class="keywordflow">return</font> (DWORD_PTR)::SendMessage(m_hWnd, CB_GETITEMDATA, nIndex, 0L);
00740     }
<a name="l00741"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a18">00741</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a23">SetItemData</a>(<font class="keywordtype">int</font> nIndex, <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwItemData)
00742     {
00743         ATLASSERT(::IsWindow(m_hWnd));
00744         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SETITEMDATA, nIndex, (LPARAM)dwItemData);
00745     }
<a name="l00746"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a19">00746</a>     <font class="keywordtype">void</font>* <a class="code" href="classWTL_1_1CListBoxT.html#a24">GetItemDataPtr</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00747 <font class="keyword">    </font>{
00748         ATLASSERT(::IsWindow(m_hWnd));
00749         <font class="keywordflow">return</font> (<font class="keywordtype">void</font>*)<a class="code" href="classWTL_1_1CListBoxT.html#a22">GetItemData</a>(nIndex);
00750     }
<a name="l00751"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a20">00751</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a25">SetItemDataPtr</a>(<font class="keywordtype">int</font> nIndex, <font class="keywordtype">void</font>* pData)
00752     {
00753         ATLASSERT(::IsWindow(m_hWnd));
00754         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CListBoxT.html#a23">SetItemData</a>(nIndex, (<a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a>)pData);
00755     }
<a name="l00756"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a21">00756</a>     <font class="keywordtype">int</font> GetLBText(<font class="keywordtype">int</font> nIndex, LPTSTR lpszText)<font class="keyword"> const</font>
00757 <font class="keyword">    </font>{
00758         ATLASSERT(::IsWindow(m_hWnd));
00759         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETLBTEXT, nIndex, (LPARAM)lpszText);
00760     }
00761 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
<a name="l00762"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a22">00762</a> <font class="preprocessor"></font>    BOOL GetLBTextBSTR(<font class="keywordtype">int</font> nIndex, BSTR&amp; bstrText)<font class="keyword"> const</font>
00763 <font class="keyword">    </font>{
00764         USES_CONVERSION;
00765         ATLASSERT(::IsWindow(m_hWnd));
00766         ATLASSERT(bstrText == NULL);
00767 
00768         <font class="keywordtype">int</font> nLen = GetLBTextLen(nIndex);
00769         <font class="keywordflow">if</font>(nLen == CB_ERR)
00770             <font class="keywordflow">return</font> FALSE;
00771 
00772         LPTSTR lpszText = (LPTSTR)_alloca((nLen + 1) * <font class="keyword">sizeof</font>(TCHAR));
00773 
00774         <font class="keywordflow">if</font>(GetLBText(nIndex, lpszText) == CB_ERR)
00775             <font class="keywordflow">return</font> FALSE;
00776 
00777         bstrText = ::SysAllocString(T2OLE(lpszText));
00778         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
00779     }
00780 <font class="preprocessor">#endif </font>
00781 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
00782 <font class="preprocessor"></font>    <font class="keywordtype">int</font> GetLBText(<font class="keywordtype">int</font> nIndex, CString&amp; strText)<font class="keyword"> const</font>
00783 <font class="keyword">    </font>{
00784         ATLASSERT(::IsWindow(m_hWnd));
00785         <font class="keywordtype">int</font> nRet = CB_ERR;
00786         LPTSTR lpstr = strText.GetBufferSetLength(GetLBTextLen(nIndex));
00787         <font class="keywordflow">if</font>(lpstr != NULL)
00788         {
00789             nRet = GetLBText(nIndex, lpstr);
00790             strText.ReleaseBuffer();
00791         }
00792         <font class="keywordflow">return</font> nRet;
00793     }
00794 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l00795"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a23">00795</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> GetLBTextLen(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00796 <font class="keyword">    </font>{
00797         ATLASSERT(::IsWindow(m_hWnd));
00798         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETLBTEXTLEN, nIndex, 0L);
00799     }
00800 
<a name="l00801"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a24">00801</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a29">GetItemHeight</a>(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
00802 <font class="keyword">    </font>{
00803         ATLASSERT(::IsWindow(m_hWnd));
00804         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETITEMHEIGHT, nIndex, 0L);
00805     }
<a name="l00806"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a25">00806</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a30">SetItemHeight</a>(<font class="keywordtype">int</font> nIndex, UINT cyItemHeight)
00807     {
00808         ATLASSERT(::IsWindow(m_hWnd));
00809         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SETITEMHEIGHT, nIndex, MAKELONG(cyItemHeight, 0));
00810     }
<a name="l00811"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a26">00811</a>     BOOL GetExtendedUI()<font class="keyword"> const</font>
00812 <font class="keyword">    </font>{
00813         ATLASSERT(::IsWindow(m_hWnd));
00814         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CB_GETEXTENDEDUI, 0, 0L);
00815     }
<a name="l00816"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a27">00816</a>     <font class="keywordtype">int</font> SetExtendedUI(BOOL bExtended = TRUE)
00817     {
00818         ATLASSERT(::IsWindow(m_hWnd));
00819         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SETEXTENDEDUI, bExtended, 0L);
00820     }
<a name="l00821"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a28">00821</a>     <font class="keywordtype">void</font> GetDroppedControlRect(LPRECT lprect)<font class="keyword"> const</font>
00822 <font class="keyword">    </font>{
00823         ATLASSERT(::IsWindow(m_hWnd));
00824         ::SendMessage(m_hWnd, CB_GETDROPPEDCONTROLRECT, 0, (LPARAM)lprect);
00825     }
<a name="l00826"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a29">00826</a>     BOOL GetDroppedState()<font class="keyword"> const</font>
00827 <font class="keyword">    </font>{
00828         ATLASSERT(::IsWindow(m_hWnd));
00829         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CB_GETDROPPEDSTATE, 0, 0L);
00830     }
00831 
00832 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l00833"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a30">00833</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> GetMinVisible()<font class="keyword"> const</font>
00834 <font class="keyword">    </font>{
00835         ATLASSERT(::IsWindow(m_hWnd));
00836         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_GETMINVISIBLE, 0, 0L);
00837     }
<a name="l00838"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a31">00838</a>     BOOL SetMinVisible(<font class="keywordtype">int</font> nMinVisible)
00839     {
00840         ATLASSERT(::IsWindow(m_hWnd));
00841         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CB_SETMINVISIBLE, nMinVisible, 0L);
00842     }
00843 
00844 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
00845 <font class="preprocessor"></font>
00846 <font class="comment">// Operations</font>
<a name="l00847"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a32">00847</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a35">InitStorage</a>(<font class="keywordtype">int</font> nItems, UINT nBytes)
00848     {
00849         ATLASSERT(::IsWindow(m_hWnd));
00850         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_INITSTORAGE, (WPARAM)nItems, nBytes);
00851     }
<a name="l00852"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a33">00852</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a36">ResetContent</a>()
00853     {
00854         ATLASSERT(::IsWindow(m_hWnd));
00855         ::SendMessage(m_hWnd, CB_RESETCONTENT, 0, 0L);
00856     }
00857 
00858     <font class="comment">// for edit control</font>
<a name="l00859"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a34">00859</a>     BOOL LimitText(<font class="keywordtype">int</font> nMaxChars)
00860     {
00861         ATLASSERT(::IsWindow(m_hWnd));
00862         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CB_LIMITTEXT, nMaxChars, 0L);
00863     }
00864 
00865     <font class="comment">// for drop-down combo boxes</font>
<a name="l00866"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a35">00866</a>     <font class="keywordtype">void</font> ShowDropDown(BOOL bShowIt = TRUE)
00867     {
00868         ATLASSERT(::IsWindow(m_hWnd));
00869         ::SendMessage(m_hWnd, CB_SHOWDROPDOWN, bShowIt, 0L);
00870     }
00871 
00872     <font class="comment">// manipulating listbox items</font>
<a name="l00873"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a36">00873</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a38">AddString</a>(LPCTSTR lpszString)
00874     {
00875         ATLASSERT(::IsWindow(m_hWnd));
00876         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_ADDSTRING, 0, (LPARAM)lpszString);
00877     }
<a name="l00878"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a37">00878</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a39">DeleteString</a>(UINT nIndex)
00879     {
00880         ATLASSERT(::IsWindow(m_hWnd));
00881         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_DELETESTRING, nIndex, 0L);
00882     }
<a name="l00883"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a38">00883</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a40">InsertString</a>(<font class="keywordtype">int</font> nIndex, LPCTSTR lpszString)
00884     {
00885         ATLASSERT(::IsWindow(m_hWnd));
00886         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_INSERTSTRING, nIndex, (LPARAM)lpszString);
00887     }
<a name="l00888"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a39">00888</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a41">Dir</a>(UINT attr, LPCTSTR lpszWildCard)
00889     {
00890         ATLASSERT(::IsWindow(m_hWnd));
00891         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_DIR, attr, (LPARAM)lpszWildCard);
00892     }
00893 
00894     <font class="comment">// selection helpers</font>
<a name="l00895"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a40">00895</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a43">FindString</a>(<font class="keywordtype">int</font> nStartAfter, LPCTSTR lpszString)<font class="keyword"> const</font>
00896 <font class="keyword">    </font>{
00897         ATLASSERT(::IsWindow(m_hWnd));
00898         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_FINDSTRING, nStartAfter, (LPARAM)lpszString);
00899     }
<a name="l00900"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a41">00900</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a44">FindStringExact</a>(<font class="keywordtype">int</font> nIndexStart, LPCTSTR lpszFind)<font class="keyword"> const</font>
00901 <font class="keyword">    </font>{
00902         ATLASSERT(::IsWindow(m_hWnd));
00903         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_FINDSTRINGEXACT, nIndexStart, (LPARAM)lpszFind);
00904     }
<a name="l00905"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a42">00905</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a45">SelectString</a>(<font class="keywordtype">int</font> nStartAfter, LPCTSTR lpszString)
00906     {
00907         ATLASSERT(::IsWindow(m_hWnd));
00908         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CB_SELECTSTRING, nStartAfter, (LPARAM)lpszString);
00909     }
00910 
00911     <font class="comment">// Clipboard operations</font>
<a name="l00912"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a43">00912</a>     <font class="keywordtype">void</font> Clear()
00913     {
00914         ATLASSERT(::IsWindow(m_hWnd));
00915         ::SendMessage(m_hWnd, WM_CLEAR, 0, 0L);
00916     }
<a name="l00917"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a44">00917</a>     <font class="keywordtype">void</font> Copy()
00918     {
00919         ATLASSERT(::IsWindow(m_hWnd));
00920         ::SendMessage(m_hWnd, WM_COPY, 0, 0L);
00921     }
<a name="l00922"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a45">00922</a>     <font class="keywordtype">void</font> Cut()
00923     {
00924         ATLASSERT(::IsWindow(m_hWnd));
00925         ::SendMessage(m_hWnd, WM_CUT, 0, 0L);
00926     }
<a name="l00927"></a><a class="code" href="classWTL_1_1CComboBoxT.html#a46">00927</a>     <font class="keywordtype">void</font> Paste()
00928     {
00929         ATLASSERT(::IsWindow(m_hWnd));
00930         ::SendMessage(m_hWnd, WM_PASTE, 0, 0L);
00931     }
00932 };
00933 
<a name="l00934"></a><a class="code" href="namespaceWTL.html#a5">00934</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CComboBoxT.html">CComboBoxT&lt;CWindow&gt;</a> <a class="code" href="namespaceWTL.html#a5">CComboBox</a>;
00935 
00936 
00938 <font class="comment">// CEdit - client side for a Windows EDIT control</font>
00939 
00940 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l00941"></a><a class="code" href="classWTL_1_1CEditT.html">00941</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CEditT.html">CEditT</a> : <font class="keyword">public</font> TBase
00942 {
00943 <font class="keyword">public</font>:
00944 <font class="comment">// Constructors</font>
<a name="l00945"></a><a class="code" href="classWTL_1_1CEditT.html#a0">00945</a>     <a class="code" href="classWTL_1_1CEditT.html">CEditT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
00946 
<a name="l00947"></a><a class="code" href="classWTL_1_1CEditT.html#a1">00947</a>     <a class="code" href="classWTL_1_1CEditT.html">CEditT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
00948     {
00949         m_hWnd = hWnd;
00950         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00951     }
00952 
<a name="l00953"></a><a class="code" href="classWTL_1_1CEditT.html#a2">00953</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
00954             DWORD dwStyle = 0, DWORD dwExStyle = 0,
00955             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
00956     {
00957         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
00958     }
00959 
00960 <font class="comment">// Attributes</font>
<a name="l00961"></a><a class="code" href="classWTL_1_1CEditT.html#d0">00961</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
00962     {
00963         <font class="keywordflow">return</font> _T(<font class="stringliteral">"EDIT"</font>);
00964     }
00965 
<a name="l00966"></a><a class="code" href="classWTL_1_1CEditT.html#a3">00966</a>     BOOL CanUndo()<font class="keyword"> const</font>
00967 <font class="keyword">    </font>{
00968         ATLASSERT(::IsWindow(m_hWnd));
00969         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_CANUNDO, 0, 0L);
00970     }
<a name="l00971"></a><a class="code" href="classWTL_1_1CEditT.html#a4">00971</a>     <font class="keywordtype">int</font> GetLineCount()<font class="keyword"> const</font>
00972 <font class="keyword">    </font>{
00973         ATLASSERT(::IsWindow(m_hWnd));
00974         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETLINECOUNT, 0, 0L);
00975     }
<a name="l00976"></a><a class="code" href="classWTL_1_1CEditT.html#a5">00976</a>     BOOL GetModify()<font class="keyword"> const</font>
00977 <font class="keyword">    </font>{
00978         ATLASSERT(::IsWindow(m_hWnd));
00979         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_GETMODIFY, 0, 0L);
00980     }
<a name="l00981"></a><a class="code" href="classWTL_1_1CEditT.html#a6">00981</a>     <font class="keywordtype">void</font> SetModify(BOOL bModified = TRUE)
00982     {
00983         ATLASSERT(::IsWindow(m_hWnd));
00984         ::SendMessage(m_hWnd, EM_SETMODIFY, bModified, 0L);
00985     }
<a name="l00986"></a><a class="code" href="classWTL_1_1CEditT.html#a7">00986</a>     <font class="keywordtype">void</font> GetRect(LPRECT lpRect)<font class="keyword"> const</font>
00987 <font class="keyword">    </font>{
00988         ATLASSERT(::IsWindow(m_hWnd));
00989         ::SendMessage(m_hWnd, EM_GETRECT, 0, (LPARAM)lpRect);
00990     }
<a name="l00991"></a><a class="code" href="classWTL_1_1CEditT.html#a8">00991</a>     DWORD <a class="code" href="classWTL_1_1CListBoxT.html#a14">GetSel</a>()<font class="keyword"> const</font>
00992 <font class="keyword">    </font>{
00993         ATLASSERT(::IsWindow(m_hWnd));
00994         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETSEL, 0, 0L);
00995     }
<a name="l00996"></a><a class="code" href="classWTL_1_1CEditT.html#a9">00996</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a14">GetSel</a>(<font class="keywordtype">int</font>&amp; nStartChar, <font class="keywordtype">int</font>&amp; nEndChar)<font class="keyword"> const</font>
00997 <font class="keyword">    </font>{
00998         ATLASSERT(::IsWindow(m_hWnd));
00999         ::SendMessage(m_hWnd, EM_GETSEL, (WPARAM)&amp;nStartChar, (LPARAM)&amp;nEndChar);
01000     }
<a name="l01001"></a><a class="code" href="classWTL_1_1CEditT.html#a10">01001</a>     HLOCAL GetHandle()<font class="keyword"> const</font>
01002 <font class="keyword">    </font>{
01003         ATLASSERT(::IsWindow(m_hWnd));
01004         <font class="keywordflow">return</font> (HLOCAL)::SendMessage(m_hWnd, EM_GETHANDLE, 0, 0L);
01005     }
<a name="l01006"></a><a class="code" href="classWTL_1_1CEditT.html#a11">01006</a>     <font class="keywordtype">void</font> SetHandle(HLOCAL hBuffer)
01007     {
01008         ATLASSERT(::IsWindow(m_hWnd));
01009         ::SendMessage(m_hWnd, EM_SETHANDLE, (WPARAM)hBuffer, 0L);
01010     }
<a name="l01011"></a><a class="code" href="classWTL_1_1CEditT.html#a12">01011</a>     DWORD GetMargins()<font class="keyword"> const</font>
01012 <font class="keyword">    </font>{
01013         ATLASSERT(::IsWindow(m_hWnd));
01014         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETMARGINS, 0, 0L);
01015     }
<a name="l01016"></a><a class="code" href="classWTL_1_1CEditT.html#a13">01016</a>     <font class="keywordtype">void</font> SetMargins(UINT nLeft, UINT nRight)
01017     {
01018         ATLASSERT(::IsWindow(m_hWnd));
01019         ::SendMessage(m_hWnd, EM_SETMARGINS, EC_LEFTMARGIN|EC_RIGHTMARGIN, MAKELONG(nLeft, nRight));
01020     }
<a name="l01021"></a><a class="code" href="classWTL_1_1CEditT.html#a14">01021</a>     UINT GetLimitText()<font class="keyword"> const</font>
01022 <font class="keyword">    </font>{
01023         ATLASSERT(::IsWindow(m_hWnd));
01024         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, EM_GETLIMITTEXT, 0, 0L);
01025     }
<a name="l01026"></a><a class="code" href="classWTL_1_1CEditT.html#a15">01026</a>     <font class="keywordtype">void</font> SetLimitText(UINT nMax)
01027     {
01028         ATLASSERT(::IsWindow(m_hWnd));
01029         ::SendMessage(m_hWnd, EM_SETLIMITTEXT, nMax, 0L);
01030     }
<a name="l01031"></a><a class="code" href="classWTL_1_1CEditT.html#a16">01031</a>     POINT PosFromChar(UINT nChar)<font class="keyword"> const</font>
01032 <font class="keyword">    </font>{
01033         ATLASSERT(::IsWindow(m_hWnd));
01034         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, EM_POSFROMCHAR, nChar, 0);
01035         POINT point = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwRet), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwRet) };
01036         <font class="keywordflow">return</font> point;
01037     }
<a name="l01038"></a><a class="code" href="classWTL_1_1CEditT.html#a17">01038</a>     <font class="keywordtype">int</font> CharFromPos(POINT pt, <font class="keywordtype">int</font>* pLine = NULL)<font class="keyword"> const</font>
01039 <font class="keyword">    </font>{
01040         ATLASSERT(::IsWindow(m_hWnd));
01041         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, EM_CHARFROMPOS, 0, MAKELPARAM(pt.x, pt.y));
01042         <font class="keywordflow">if</font>(pLine != NULL)
01043             *pLine = (int)(short)HIWORD(dwRet);
01044         <font class="keywordflow">return</font> (int)(short)LOWORD(dwRet);
01045     }
01046 
01047     <font class="comment">// NOTE: first word in lpszBuffer must contain the size of the buffer!</font>
<a name="l01048"></a><a class="code" href="classWTL_1_1CEditT.html#a18">01048</a>     <font class="keywordtype">int</font> GetLine(<font class="keywordtype">int</font> nIndex, LPTSTR lpszBuffer)<font class="keyword"> const</font>
01049 <font class="keyword">    </font>{
01050         ATLASSERT(::IsWindow(m_hWnd));
01051         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETLINE, nIndex, (LPARAM)lpszBuffer);
01052     }
<a name="l01053"></a><a class="code" href="classWTL_1_1CEditT.html#a19">01053</a>     <font class="keywordtype">int</font> GetLine(<font class="keywordtype">int</font> nIndex, LPTSTR lpszBuffer, <font class="keywordtype">int</font> nMaxLength)<font class="keyword"> const</font>
01054 <font class="keyword">    </font>{
01055         ATLASSERT(::IsWindow(m_hWnd));
01056         *(LPWORD)lpszBuffer = (WORD)nMaxLength;
01057         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETLINE, nIndex, (LPARAM)lpszBuffer);
01058     }
01059 
<a name="l01060"></a><a class="code" href="classWTL_1_1CEditT.html#a20">01060</a>     TCHAR GetPasswordChar()<font class="keyword"> const</font>
01061 <font class="keyword">    </font>{
01062         ATLASSERT(::IsWindow(m_hWnd));
01063         <font class="keywordflow">return</font> (TCHAR)::SendMessage(m_hWnd, EM_GETPASSWORDCHAR, 0, 0L);
01064     }
<a name="l01065"></a><a class="code" href="classWTL_1_1CEditT.html#a21">01065</a>     <font class="keywordtype">void</font> SetPasswordChar(TCHAR ch)
01066     {
01067         ATLASSERT(::IsWindow(m_hWnd));
01068         ::SendMessage(m_hWnd, EM_SETPASSWORDCHAR, ch, 0L);
01069     }
<a name="l01070"></a><a class="code" href="classWTL_1_1CEditT.html#a22">01070</a>     EDITWORDBREAKPROC GetWordBreakProc()<font class="keyword"> const</font>
01071 <font class="keyword">    </font>{
01072         ATLASSERT(::IsWindow(m_hWnd));
01073         <font class="keywordflow">return</font> (EDITWORDBREAKPROC)::SendMessage(m_hWnd, EM_GETWORDBREAKPROC, 0, 0L);
01074     }
<a name="l01075"></a><a class="code" href="classWTL_1_1CEditT.html#a23">01075</a>     <font class="keywordtype">void</font> SetWordBreakProc(EDITWORDBREAKPROC ewbprc)
01076     {
01077         ATLASSERT(::IsWindow(m_hWnd));
01078         ::SendMessage(m_hWnd, EM_SETWORDBREAKPROC, 0, (LPARAM)ewbprc);
01079     }
<a name="l01080"></a><a class="code" href="classWTL_1_1CEditT.html#a24">01080</a>     <font class="keywordtype">int</font> GetFirstVisibleLine()<font class="keyword"> const</font>
01081 <font class="keyword">    </font>{
01082         ATLASSERT(::IsWindow(m_hWnd));
01083         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETFIRSTVISIBLELINE, 0, 0L);
01084     }
<a name="l01085"></a><a class="code" href="classWTL_1_1CEditT.html#a25">01085</a>     <font class="keywordtype">int</font> GetThumb()<font class="keyword"> const</font>
01086 <font class="keyword">    </font>{
01087         ATLASSERT(::IsWindow(m_hWnd));
01088         ATLASSERT((GetStyle() &amp; ES_MULTILINE) != 0);
01089         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTHUMB, 0, 0L);
01090     }
<a name="l01091"></a><a class="code" href="classWTL_1_1CEditT.html#a26">01091</a>     BOOL SetReadOnly(BOOL bReadOnly = TRUE)
01092     {
01093         ATLASSERT(::IsWindow(m_hWnd));
01094         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETREADONLY, bReadOnly, 0L);
01095     }
01096 
01097 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l01098"></a><a class="code" href="classWTL_1_1CEditT.html#a27">01098</a> <font class="preprocessor"></font>    UINT GetImeStatus(UINT uStatus)<font class="keyword"> const</font>
01099 <font class="keyword">    </font>{
01100         ATLASSERT(::IsWindow(m_hWnd));
01101         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, EM_GETIMESTATUS, uStatus, 0L);
01102     }
<a name="l01103"></a><a class="code" href="classWTL_1_1CEditT.html#a28">01103</a>     UINT SetImeStatus(UINT uStatus, UINT uData)
01104     {
01105         ATLASSERT(::IsWindow(m_hWnd));
01106         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, EM_SETIMESTATUS, uStatus, uData);
01107     }
01108 <font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
01109 <font class="preprocessor"></font>
01110 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l01111"></a><a class="code" href="classWTL_1_1CEditT.html#a29">01111</a> <font class="preprocessor"></font>    BOOL GetCueBannerText(LPCWSTR lpstrText, <font class="keywordtype">int</font> cchText)<font class="keyword"> const</font>
01112 <font class="keyword">    </font>{
01113         ATLASSERT(::IsWindow(m_hWnd));
01114         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_GETCUEBANNER, (WPARAM)lpstrText, cchText);
01115     }
<a name="l01116"></a><a class="code" href="classWTL_1_1CEditT.html#a30">01116</a>     BOOL SetCueBannerText(LPCWSTR lpstrText)
01117     {
01118         ATLASSERT(::IsWindow(m_hWnd));
01119         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCUEBANNER, 0, (LPARAM)(lpstrText));
01120     }
01121 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
01122 <font class="preprocessor"></font>
01123 <font class="comment">// Operations</font>
<a name="l01124"></a><a class="code" href="classWTL_1_1CEditT.html#a31">01124</a>     <font class="keywordtype">void</font> EmptyUndoBuffer()
01125     {
01126         ATLASSERT(::IsWindow(m_hWnd));
01127         ::SendMessage(m_hWnd, EM_EMPTYUNDOBUFFER, 0, 0L);
01128     }
<a name="l01129"></a><a class="code" href="classWTL_1_1CEditT.html#a32">01129</a>     BOOL FmtLines(BOOL bAddEOL)
01130     {
01131         ATLASSERT(::IsWindow(m_hWnd));
01132         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_FMTLINES, bAddEOL, 0L);
01133     }
<a name="l01134"></a><a class="code" href="classWTL_1_1CEditT.html#a33">01134</a>     <font class="keywordtype">void</font> LimitText(<font class="keywordtype">int</font> nChars = 0)
01135     {
01136         ATLASSERT(::IsWindow(m_hWnd));
01137         ::SendMessage(m_hWnd, EM_LIMITTEXT, nChars, 0L);
01138     }
<a name="l01139"></a><a class="code" href="classWTL_1_1CEditT.html#a34">01139</a>     <font class="keywordtype">int</font> LineFromChar(<font class="keywordtype">int</font> nIndex = -1)<font class="keyword"> const</font>
01140 <font class="keyword">    </font>{
01141         ATLASSERT(::IsWindow(m_hWnd));
01142         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_LINEFROMCHAR, nIndex, 0L);
01143     }
<a name="l01144"></a><a class="code" href="classWTL_1_1CEditT.html#a35">01144</a>     <font class="keywordtype">int</font> LineIndex(<font class="keywordtype">int</font> nLine = -1)<font class="keyword"> const</font>
01145 <font class="keyword">    </font>{
01146         ATLASSERT(::IsWindow(m_hWnd));
01147         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_LINEINDEX, nLine, 0L);
01148     }
<a name="l01149"></a><a class="code" href="classWTL_1_1CEditT.html#a36">01149</a>     <font class="keywordtype">int</font> LineLength(<font class="keywordtype">int</font> nLine = -1)<font class="keyword"> const</font>
01150 <font class="keyword">    </font>{
01151         ATLASSERT(::IsWindow(m_hWnd));
01152         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_LINELENGTH, nLine, 0L);
01153     }
<a name="l01154"></a><a class="code" href="classWTL_1_1CEditT.html#a37">01154</a>     <font class="keywordtype">void</font> LineScroll(<font class="keywordtype">int</font> nLines, <font class="keywordtype">int</font> nChars = 0)
01155     {
01156         ATLASSERT(::IsWindow(m_hWnd));
01157         ::SendMessage(m_hWnd, EM_LINESCROLL, nChars, nLines);
01158     }
<a name="l01159"></a><a class="code" href="classWTL_1_1CEditT.html#a38">01159</a>     <font class="keywordtype">void</font> ReplaceSel(LPCTSTR lpszNewText, BOOL bCanUndo = FALSE)
01160     {
01161         ATLASSERT(::IsWindow(m_hWnd));
01162         ::SendMessage(m_hWnd, EM_REPLACESEL, (WPARAM) bCanUndo, (LPARAM)lpszNewText);
01163     }
<a name="l01164"></a><a class="code" href="classWTL_1_1CEditT.html#a39">01164</a>     <font class="keywordtype">void</font> SetRect(LPCRECT lpRect)
01165     {
01166         ATLASSERT(::IsWindow(m_hWnd));
01167         ::SendMessage(m_hWnd, EM_SETRECT, 0, (LPARAM)lpRect);
01168     }
<a name="l01169"></a><a class="code" href="classWTL_1_1CEditT.html#a40">01169</a>     <font class="keywordtype">void</font> SetRectNP(LPCRECT lpRect)
01170     {
01171         ATLASSERT(::IsWindow(m_hWnd));
01172         ::SendMessage(m_hWnd, EM_SETRECTNP, 0, (LPARAM)lpRect);
01173     }
<a name="l01174"></a><a class="code" href="classWTL_1_1CEditT.html#a41">01174</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a15">SetSel</a>(DWORD dwSelection, BOOL bNoScroll = FALSE)
01175     {
01176         ATLASSERT(::IsWindow(m_hWnd));
01177         ::SendMessage(m_hWnd, EM_SETSEL, LOWORD(dwSelection), HIWORD(dwSelection));
01178         <font class="keywordflow">if</font>(!bNoScroll)
01179             ::SendMessage(m_hWnd, EM_SCROLLCARET, 0, 0L);
01180     }
<a name="l01181"></a><a class="code" href="classWTL_1_1CEditT.html#a42">01181</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a15">SetSel</a>(<font class="keywordtype">int</font> nStartChar, <font class="keywordtype">int</font> nEndChar, BOOL bNoScroll = FALSE)
01182     {
01183         ATLASSERT(::IsWindow(m_hWnd));
01184         ::SendMessage(m_hWnd, EM_SETSEL, nStartChar, nEndChar);
01185         <font class="keywordflow">if</font>(!bNoScroll)
01186             ::SendMessage(m_hWnd, EM_SCROLLCARET, 0, 0L);
01187     }
<a name="l01188"></a><a class="code" href="classWTL_1_1CEditT.html#a43">01188</a>     <font class="keywordtype">void</font> SetSelAll(BOOL bNoScroll = FALSE)
01189     {
01190         <a class="code" href="classWTL_1_1CListBoxT.html#a15">SetSel</a>(0, -1, bNoScroll);
01191     }
<a name="l01192"></a><a class="code" href="classWTL_1_1CEditT.html#a44">01192</a>     <font class="keywordtype">void</font> SetSelNone(BOOL bNoScroll = FALSE)
01193     {
01194         <a class="code" href="classWTL_1_1CListBoxT.html#a15">SetSel</a>(-1, 0, bNoScroll);
01195     }
<a name="l01196"></a><a class="code" href="classWTL_1_1CEditT.html#a45">01196</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a33">SetTabStops</a>(<font class="keywordtype">int</font> nTabStops, LPINT rgTabStops)
01197     {
01198         ATLASSERT(::IsWindow(m_hWnd));
01199         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETTABSTOPS, nTabStops, (LPARAM)rgTabStops);
01200     }
<a name="l01201"></a><a class="code" href="classWTL_1_1CEditT.html#a46">01201</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a33">SetTabStops</a>()
01202     {
01203         ATLASSERT(::IsWindow(m_hWnd));
01204         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETTABSTOPS, 0, 0L);
01205     }
<a name="l01206"></a><a class="code" href="classWTL_1_1CEditT.html#a47">01206</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a33">SetTabStops</a>(<font class="keyword">const</font> <font class="keywordtype">int</font>&amp; cxEachStop)    <font class="comment">// takes an 'int'</font>
01207     {
01208         ATLASSERT(::IsWindow(m_hWnd));
01209         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETTABSTOPS, 1, (LPARAM)(LPINT)&amp;cxEachStop);
01210     }
<a name="l01211"></a><a class="code" href="classWTL_1_1CEditT.html#a48">01211</a>     <font class="keywordtype">void</font> ScrollCaret()
01212     {
01213         ATLASSERT(::IsWindow(m_hWnd));
01214         ::SendMessage(m_hWnd, EM_SCROLLCARET, 0, 0L);
01215     }
<a name="l01216"></a><a class="code" href="classWTL_1_1CEditT.html#a49">01216</a>     <font class="keywordtype">int</font> Scroll(<font class="keywordtype">int</font> nScrollAction)
01217     {
01218         ATLASSERT(::IsWindow(m_hWnd));
01219         ATLASSERT((GetStyle() &amp; ES_MULTILINE) != 0);
01220         LRESULT lRet = ::SendMessage(m_hWnd, EM_SCROLL, nScrollAction, 0L);
01221         <font class="keywordflow">if</font>(!(BOOL)HIWORD(lRet))
01222             <font class="keywordflow">return</font> -1;  <font class="comment">// failed</font>
01223         <font class="keywordflow">return</font> (int)(short)LOWORD(lRet);
01224         
01225     }
01226 
<a name="l01227"></a><a class="code" href="classWTL_1_1CEditT.html#a50">01227</a>     <font class="keywordtype">void</font> InsertText(<font class="keywordtype">int</font> nInsertAfterChar, LPCTSTR lpstrText, BOOL bNoScroll = FALSE, BOOL bCanUndo = FALSE)
01228     {
01229         <a class="code" href="classWTL_1_1CListBoxT.html#a15">SetSel</a>(nInsertAfterChar, nInsertAfterChar, bNoScroll);
01230         ReplaceSel(lpstrText, bCanUndo);
01231     }
<a name="l01232"></a><a class="code" href="classWTL_1_1CEditT.html#a51">01232</a>     <font class="keywordtype">void</font> AppendText(LPCTSTR lpstrText, BOOL bNoScroll = FALSE, BOOL bCanUndo = FALSE)
01233     {
01234         InsertText(GetWindowTextLength(), lpstrText, bNoScroll, bCanUndo);
01235     }
01236 
01237 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l01238"></a><a class="code" href="classWTL_1_1CEditT.html#a52">01238</a> <font class="preprocessor"></font>    BOOL ShowBalloonTip(PEDITBALLOONTIP pEditBaloonTip)
01239     {
01240         ATLASSERT(::IsWindow(m_hWnd));
01241         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SHOWBALLOONTIP, 0, (LPARAM)pEditBaloonTip);
01242     }
<a name="l01243"></a><a class="code" href="classWTL_1_1CEditT.html#a53">01243</a>     BOOL HideBalloonTip()
01244     {
01245         ATLASSERT(::IsWindow(m_hWnd));
01246         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_HIDEBALLOONTIP, 0, 0L);
01247     }
01248 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
01249 <font class="preprocessor"></font>
01250     <font class="comment">// Clipboard operations</font>
<a name="l01251"></a><a class="code" href="classWTL_1_1CEditT.html#a54">01251</a>     BOOL Undo()
01252     {
01253         ATLASSERT(::IsWindow(m_hWnd));
01254         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_UNDO, 0, 0L);
01255     }
<a name="l01256"></a><a class="code" href="classWTL_1_1CEditT.html#a55">01256</a>     <font class="keywordtype">void</font> Clear()
01257     {
01258         ATLASSERT(::IsWindow(m_hWnd));
01259         ::SendMessage(m_hWnd, WM_CLEAR, 0, 0L);
01260     }
<a name="l01261"></a><a class="code" href="classWTL_1_1CEditT.html#a56">01261</a>     <font class="keywordtype">void</font> Copy()
01262     {
01263         ATLASSERT(::IsWindow(m_hWnd));
01264         ::SendMessage(m_hWnd, WM_COPY, 0, 0L);
01265     }
<a name="l01266"></a><a class="code" href="classWTL_1_1CEditT.html#a57">01266</a>     <font class="keywordtype">void</font> Cut()
01267     {
01268         ATLASSERT(::IsWindow(m_hWnd));
01269         ::SendMessage(m_hWnd, WM_CUT, 0, 0L);
01270     }
<a name="l01271"></a><a class="code" href="classWTL_1_1CEditT.html#a58">01271</a>     <font class="keywordtype">void</font> Paste()
01272     {
01273         ATLASSERT(::IsWindow(m_hWnd));
01274         ::SendMessage(m_hWnd, WM_PASTE, 0, 0L);
01275     }
01276 };
01277 
<a name="l01278"></a><a class="code" href="namespaceWTL.html#a6">01278</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CEditT.html">CEditT&lt;CWindow&gt;</a>     <a class="code" href="namespaceWTL.html#a6">CEdit</a>;
01279 
01280 
01282 <font class="comment">// CEditCommands - message handlers for standard EDIT commands</font>
01283 
01284 <font class="comment">// Chain to CEditCommands message map. Your class must also derive from CEdit.</font>
01285 <font class="comment">// Example:</font>
01286 <font class="comment">// class CMyEdit : public CWindowImpl&lt;CMyEdit, CEdit&gt;,</font>
01287 <font class="comment">//                 public CEditCommands&lt;CMyEdit&gt;</font>
01288 <font class="comment">// {</font>
01289 <font class="comment">// public:</font>
01290 <font class="comment">//      BEGIN_MSG_MAP(CMyEdit)</font>
01291 <font class="comment">//              // your handlers...</font>
01292 <font class="comment">//              CHAIN_MSG_MAP_ALT(CEditCommands&lt;CMyEdit&gt;, 1)</font>
01293 <font class="comment">//      END_MSG_MAP()</font>
01294 <font class="comment">//      // other stuff...</font>
01295 <font class="comment">// };</font>
01296 
01297 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l01298"></a><a class="code" href="classWTL_1_1CEditCommands.html">01298</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands</a>
01299 {
01300 <font class="keyword">public</font>:
01301     BEGIN_MSG_MAP(<a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>)
01302     ALT_MSG_MAP(1)
01303         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a47">ID_EDIT_CLEAR</a>, OnEditClear)
01304         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a48">ID_EDIT_CLEAR_ALL</a>, OnEditClearAll)
01305         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a49">ID_EDIT_COPY</a>, OnEditCopy)
01306         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a50">ID_EDIT_CUT</a>, OnEditCut)
01307         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a52">ID_EDIT_PASTE</a>, OnEditPaste)
01308         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a57">ID_EDIT_SELECT_ALL</a>, OnEditSelectAll)
01309         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a58">ID_EDIT_UNDO</a>, OnEditUndo)
01310     END_MSG_MAP()
01311 
<a name="l01312"></a><a class="code" href="classWTL_1_1CEditCommands.html#a0">01312</a>     LRESULT OnEditClear(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01313     {
01314         T* pT = static_cast&lt;T*&gt;(this);
01315         pT-&gt;Clear();
01316         <font class="keywordflow">return</font> 0;
01317     }
<a name="l01318"></a><a class="code" href="classWTL_1_1CEditCommands.html#a1">01318</a>     LRESULT OnEditClearAll(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01319     {
01320         T* pT = static_cast&lt;T*&gt;(this);
01321         pT-&gt;SetSel(0, -1);
01322         pT-&gt;Clear();
01323         <font class="keywordflow">return</font> 0;
01324     }
<a name="l01325"></a><a class="code" href="classWTL_1_1CEditCommands.html#a2">01325</a>     LRESULT OnEditCopy(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01326     {
01327         T* pT = static_cast&lt;T*&gt;(this);
01328         pT-&gt;Copy();
01329         <font class="keywordflow">return</font> 0;
01330     }
<a name="l01331"></a><a class="code" href="classWTL_1_1CEditCommands.html#a3">01331</a>     LRESULT OnEditCut(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01332     {
01333         T* pT = static_cast&lt;T*&gt;(this);
01334         pT-&gt;Cut();
01335         <font class="keywordflow">return</font> 0;
01336     }
<a name="l01337"></a><a class="code" href="classWTL_1_1CEditCommands.html#a4">01337</a>     LRESULT OnEditPaste(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01338     {
01339         T* pT = static_cast&lt;T*&gt;(this);
01340         pT-&gt;Paste();
01341         <font class="keywordflow">return</font> 0;
01342     }
<a name="l01343"></a><a class="code" href="classWTL_1_1CEditCommands.html#a5">01343</a>     LRESULT OnEditSelectAll(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01344     {
01345         T* pT = static_cast&lt;T*&gt;(this);
01346         pT-&gt;SetSel(0, -1);
01347         <font class="keywordflow">return</font> 0;
01348     }
<a name="l01349"></a><a class="code" href="classWTL_1_1CEditCommands.html#a6">01349</a>     LRESULT OnEditUndo(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01350     {
01351         T* pT = static_cast&lt;T*&gt;(this);
01352         pT-&gt;Undo();
01353         <font class="keywordflow">return</font> 0;
01354     }
01355 
01356 <font class="comment">// State (update UI) helpers</font>
<a name="l01357"></a><a class="code" href="classWTL_1_1CEditCommands.html#a7">01357</a>     BOOL CanCut()<font class="keyword"> const</font>
01358 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasSelection(); }
<a name="l01359"></a><a class="code" href="classWTL_1_1CEditCommands.html#a8">01359</a>     BOOL CanCopy()<font class="keyword"> const</font>
01360 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasSelection(); }
<a name="l01361"></a><a class="code" href="classWTL_1_1CEditCommands.html#a9">01361</a>     BOOL CanClear()<font class="keyword"> const</font>
01362 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasSelection(); }
<a name="l01363"></a><a class="code" href="classWTL_1_1CEditCommands.html#a10">01363</a>     BOOL CanSelectAll()<font class="keyword"> const</font>
01364 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasText(); }
<a name="l01365"></a><a class="code" href="classWTL_1_1CEditCommands.html#a11">01365</a>     BOOL CanFind()<font class="keyword"> const</font>
01366 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasText(); }
<a name="l01367"></a><a class="code" href="classWTL_1_1CEditCommands.html#a12">01367</a>     BOOL CanRepeat()<font class="keyword"> const</font>
01368 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasText(); }
<a name="l01369"></a><a class="code" href="classWTL_1_1CEditCommands.html#a13">01369</a>     BOOL CanReplace()<font class="keyword"> const</font>
01370 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasText(); }
<a name="l01371"></a><a class="code" href="classWTL_1_1CEditCommands.html#a14">01371</a>     BOOL CanClearAll()<font class="keyword"> const</font>
01372 <font class="keyword">    </font>{ <font class="keywordflow">return</font> HasText(); }
01373 
01374 <font class="comment">// Implementation</font>
<a name="l01375"></a><a class="code" href="classWTL_1_1CEditCommands.html#a15">01375</a>     BOOL HasSelection()<font class="keyword"> const</font>
01376 <font class="keyword">    </font>{
01377         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
01378         <font class="keywordtype">int</font> nMin, nMax;
01379         ::SendMessage(pT-&gt;m_hWnd, EM_GETSEL, (WPARAM)&amp;nMin, (LPARAM)&amp;nMax);
01380         <font class="keywordflow">return</font> (nMin != nMax);
01381     }
<a name="l01382"></a><a class="code" href="classWTL_1_1CEditCommands.html#a16">01382</a>     BOOL HasText()<font class="keyword"> const</font>
01383 <font class="keyword">    </font>{
01384         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
01385         <font class="keywordflow">return</font> (pT-&gt;GetWindowTextLength() &gt; 0);
01386     }
01387 };
01388 
01389 
01391 <font class="comment">// CScrollBar - client side for a Windows SCROLLBAR control</font>
01392 
01393 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l01394"></a><a class="code" href="classWTL_1_1CScrollBarT.html">01394</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CScrollBarT.html">CScrollBarT</a> : <font class="keyword">public</font> TBase
01395 {
01396 <font class="keyword">public</font>:
01397 <font class="comment">// Constructors</font>
<a name="l01398"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a0">01398</a>     <a class="code" href="classWTL_1_1CScrollBarT.html">CScrollBarT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
01399 
<a name="l01400"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a1">01400</a>     <a class="code" href="classWTL_1_1CScrollBarT.html">CScrollBarT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
01401     {
01402         m_hWnd = hWnd;
01403         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
01404     }
01405 
<a name="l01406"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a2">01406</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
01407             DWORD dwStyle = 0, DWORD dwExStyle = 0,
01408             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
01409     {
01410         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
01411     }
01412 
01413 <font class="comment">// Attributes</font>
<a name="l01414"></a><a class="code" href="classWTL_1_1CScrollBarT.html#d0">01414</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
01415     {
01416         <font class="keywordflow">return</font> _T(<font class="stringliteral">"SCROLLBAR"</font>);
01417     }
01418 
<a name="l01419"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a3">01419</a>     <font class="keywordtype">int</font> GetScrollPos()<font class="keyword"> const</font>
01420 <font class="keyword">    </font>{
01421         ATLASSERT(::IsWindow(m_hWnd));
01422         return ::GetScrollPos(m_hWnd, SB_CTL);
01423     }
<a name="l01424"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a4">01424</a>     <font class="keywordtype">int</font> SetScrollPos(<font class="keywordtype">int</font> nPos, BOOL bRedraw = TRUE)
01425     {
01426         ATLASSERT(::IsWindow(m_hWnd));
01427         return ::SetScrollPos(m_hWnd, SB_CTL, nPos, bRedraw);
01428     }
<a name="l01429"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a5">01429</a>     <font class="keywordtype">void</font> GetScrollRange(LPINT lpMinPos, LPINT lpMaxPos)<font class="keyword"> const</font>
01430 <font class="keyword">    </font>{
01431         ATLASSERT(::IsWindow(m_hWnd));
01432         ::GetScrollRange(m_hWnd, SB_CTL, lpMinPos, lpMaxPos);
01433     }
<a name="l01434"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a6">01434</a>     <font class="keywordtype">void</font> SetScrollRange(<font class="keywordtype">int</font> nMinPos, <font class="keywordtype">int</font> nMaxPos, BOOL bRedraw = TRUE)
01435     {
01436         ATLASSERT(::IsWindow(m_hWnd));
01437         ::SetScrollRange(m_hWnd, SB_CTL, nMinPos, nMaxPos, bRedraw);
01438     }
<a name="l01439"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a7">01439</a>     BOOL GetScrollInfo(LPSCROLLINFO lpScrollInfo)<font class="keyword"> const</font>
01440 <font class="keyword">    </font>{
01441         ATLASSERT(::IsWindow(m_hWnd));
01442         return ::GetScrollInfo(m_hWnd, SB_CTL, lpScrollInfo);
01443     }
<a name="l01444"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a8">01444</a>     <font class="keywordtype">int</font> SetScrollInfo(LPSCROLLINFO lpScrollInfo, BOOL bRedraw = TRUE)
01445     {
01446         ATLASSERT(::IsWindow(m_hWnd));
01447         return ::SetScrollInfo(m_hWnd, SB_CTL, lpScrollInfo, bRedraw);
01448     }
<a name="l01449"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a9">01449</a>     <font class="keywordtype">int</font> GetScrollLimit()<font class="keyword"> const</font>
01450 <font class="keyword">    </font>{
01451         <font class="keywordtype">int</font> nMin, nMax;
01452         ::GetScrollRange(m_hWnd, SB_CTL, &amp;nMin, &amp;nMax);
01453         SCROLLINFO info;
01454         info.cbSize = <font class="keyword">sizeof</font>(SCROLLINFO);
01455         info.fMask = SIF_PAGE;
01456         <font class="keywordflow">if</font>(::GetScrollInfo(m_hWnd, SB_CTL, &amp;info))
01457             nMax -= ((info.nPage - 1) &gt; 0) ? (info.nPage - 1) : 0;
01458 
01459         <font class="keywordflow">return</font> nMax;
01460     }
01461 
01462 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l01463"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a10">01463</a> <font class="preprocessor"></font>    BOOL GetScrollBarInfo(PSCROLLBARINFO pScrollBarInfo)<font class="keyword"> const</font>
01464 <font class="keyword">    </font>{
01465         ATLASSERT(::IsWindow(m_hWnd));
01466 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
01467 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SBM_GETSCROLLBARINFO, 0, (LPARAM)pScrollBarInfo);
01468 <font class="preprocessor">#else </font>
01469 <font class="preprocessor">        return ::GetScrollBarInfo(m_hWnd, OBJID_CLIENT, pScrollBarInfo);</font>
01470 <font class="preprocessor"></font><font class="preprocessor">#endif </font>
01471 <font class="preprocessor">    }</font>
01472 <font class="preprocessor"></font><font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
01473 <font class="preprocessor"></font>
01474 <font class="comment">// Operations</font>
<a name="l01475"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a11">01475</a>     <font class="keywordtype">void</font> ShowScrollBar(BOOL bShow = TRUE)
01476     {
01477         ATLASSERT(::IsWindow(m_hWnd));
01478         ::ShowScrollBar(m_hWnd, SB_CTL, bShow);
01479     }
01480 
<a name="l01481"></a><a class="code" href="classWTL_1_1CScrollBarT.html#a12">01481</a>     BOOL EnableScrollBar(UINT nArrowFlags = ESB_ENABLE_BOTH)
01482     {
01483         ATLASSERT(::IsWindow(m_hWnd));
01484         return ::EnableScrollBar(m_hWnd, SB_CTL, nArrowFlags);
01485     }
01486 
01487 };
01488 
<a name="l01489"></a><a class="code" href="namespaceWTL.html#a7">01489</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CScrollBarT.html">CScrollBarT&lt;CWindow&gt;</a>    <a class="code" href="namespaceWTL.html#a7">CScrollBar</a>;
01490 
01491 
01492 <font class="comment">// --- Windows Common Controls ---</font>
01493 
01495 <font class="comment">// CImageList</font>
01496 
<a name="l01497"></a><a class="code" href="classWTL_1_1CImageList.html">01497</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CImageList.html">CImageList</a>
01498 {
01499 <font class="keyword">public</font>:
<a name="l01500"></a><a class="code" href="classWTL_1_1CImageList.html#m0">01500</a>     HIMAGELIST m_hImageList;
01501 
01502 <font class="comment">// Constructor</font>
<a name="l01503"></a><a class="code" href="classWTL_1_1CImageList.html#a0">01503</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>(HIMAGELIST hImageList = NULL) : m_hImageList(hImageList)
01504     { }
01505 
01506 <font class="comment">// Operators, etc.</font>
<a name="l01507"></a><a class="code" href="classWTL_1_1CImageList.html#a1">01507</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HIMAGELIST hImageList)
01508     {
01509         m_hImageList = hImageList;
01510         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
01511     }
01512 
<a name="l01513"></a><a class="code" href="classWTL_1_1CImageList.html#a2">01513</a>     operator HIMAGELIST()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_hImageList; }
01514 
<a name="l01515"></a><a class="code" href="classWTL_1_1CImageList.html#a3">01515</a>     <font class="keywordtype">void</font> Attach(HIMAGELIST hImageList)
01516     {
01517         ATLASSERT(m_hImageList == NULL);
01518         ATLASSERT(hImageList != NULL);
01519         m_hImageList = hImageList;
01520     }
<a name="l01521"></a><a class="code" href="classWTL_1_1CImageList.html#a4">01521</a>     HIMAGELIST Detach()
01522     {
01523         HIMAGELIST hImageList = m_hImageList;
01524         m_hImageList = NULL;
01525         <font class="keywordflow">return</font> hImageList;
01526     }
01527 
<a name="l01528"></a><a class="code" href="classWTL_1_1CImageList.html#a5">01528</a>     <font class="keywordtype">bool</font> IsNull()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> (m_hImageList == NULL); }
01529 
01530 <font class="comment">// Attributes</font>
<a name="l01531"></a><a class="code" href="classWTL_1_1CImageList.html#a6">01531</a>     <font class="keywordtype">int</font> GetImageCount()<font class="keyword"> const</font>
01532 <font class="keyword">    </font>{
01533         ATLASSERT(m_hImageList != NULL);
01534         <font class="keywordflow">return</font> ImageList_GetImageCount(m_hImageList);
01535     }
<a name="l01536"></a><a class="code" href="classWTL_1_1CImageList.html#a7">01536</a>     COLORREF GetBkColor()<font class="keyword"> const</font>
01537 <font class="keyword">    </font>{
01538         ATLASSERT(m_hImageList != NULL);
01539         <font class="keywordflow">return</font> ImageList_GetBkColor(m_hImageList);
01540     }
<a name="l01541"></a><a class="code" href="classWTL_1_1CImageList.html#a8">01541</a>     COLORREF SetBkColor(COLORREF cr)
01542     {
01543         ATLASSERT(m_hImageList != NULL);
01544         <font class="keywordflow">return</font> ImageList_SetBkColor(m_hImageList, cr);
01545     }
<a name="l01546"></a><a class="code" href="classWTL_1_1CImageList.html#a9">01546</a>     BOOL GetImageInfo(<font class="keywordtype">int</font> nImage, IMAGEINFO* pImageInfo)<font class="keyword"> const</font>
01547 <font class="keyword">    </font>{
01548         ATLASSERT(m_hImageList != NULL);
01549         <font class="keywordflow">return</font> ImageList_GetImageInfo(m_hImageList, nImage, pImageInfo);
01550     }
01551 
<a name="l01552"></a><a class="code" href="classWTL_1_1CImageList.html#a10">01552</a>     HICON GetIcon(<font class="keywordtype">int</font> nIndex, UINT uFlags = ILD_NORMAL)<font class="keyword"> const</font>
01553 <font class="keyword">    </font>{
01554         ATLASSERT(m_hImageList != NULL);
01555         <font class="keywordflow">return</font> ImageList_GetIcon(m_hImageList, nIndex, uFlags);
01556     }
<a name="l01557"></a><a class="code" href="classWTL_1_1CImageList.html#a11">01557</a>     BOOL GetIconSize(<font class="keywordtype">int</font>&amp; cx, <font class="keywordtype">int</font>&amp; cy)<font class="keyword"> const</font>
01558 <font class="keyword">    </font>{
01559         ATLASSERT(m_hImageList != NULL);
01560         <font class="keywordflow">return</font> ImageList_GetIconSize(m_hImageList, &amp;cx, &amp;cy);
01561     }
<a name="l01562"></a><a class="code" href="classWTL_1_1CImageList.html#a12">01562</a>     BOOL GetIconSize(SIZE&amp; size)<font class="keyword"> const</font>
01563 <font class="keyword">    </font>{
01564         ATLASSERT(m_hImageList != NULL);
01565         <font class="keywordflow">return</font> ImageList_GetIconSize(m_hImageList, (<font class="keywordtype">int</font>*)&amp;size.cx, (<font class="keywordtype">int</font>*)&amp;size.cy);
01566     }
<a name="l01567"></a><a class="code" href="classWTL_1_1CImageList.html#a13">01567</a>     BOOL SetIconSize(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy)
01568     {
01569         ATLASSERT(m_hImageList != NULL);
01570         <font class="keywordflow">return</font> ImageList_SetIconSize(m_hImageList, cx, cy);
01571     }
<a name="l01572"></a><a class="code" href="classWTL_1_1CImageList.html#a14">01572</a>     BOOL SetIconSize(SIZE size)
01573     {
01574         ATLASSERT(m_hImageList != NULL);
01575         <font class="keywordflow">return</font> ImageList_SetIconSize(m_hImageList, size.cx, size.cy);
01576     }
<a name="l01577"></a><a class="code" href="classWTL_1_1CImageList.html#a15">01577</a>     BOOL SetImageCount(UINT uNewCount)
01578     {
01579         ATLASSERT(m_hImageList != NULL);
01580         <font class="keywordflow">return</font> ImageList_SetImageCount(m_hImageList, uNewCount);
01581     }
<a name="l01582"></a><a class="code" href="classWTL_1_1CImageList.html#a16">01582</a>     BOOL SetOverlayImage(<font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> nOverlay)
01583     {
01584         ATLASSERT(m_hImageList != NULL);
01585         <font class="keywordflow">return</font> ImageList_SetOverlayImage(m_hImageList, nImage, nOverlay);
01586     }
01587 
01588 <font class="comment">// Operations</font>
<a name="l01589"></a><a class="code" href="classWTL_1_1CImageList.html#a17">01589</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy, UINT nFlags, <font class="keywordtype">int</font> nInitial, <font class="keywordtype">int</font> nGrow)
01590     {
01591         ATLASSERT(m_hImageList == NULL);
01592         m_hImageList = ImageList_Create(cx, cy, nFlags, nInitial, nGrow);
01593         <font class="keywordflow">return</font> (m_hImageList != NULL) ? TRUE : FALSE;
01594     }
<a name="l01595"></a><a class="code" href="classWTL_1_1CImageList.html#a18">01595</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(<a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> bitmap, <font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> nGrow, COLORREF crMask)
01596     {
01597         ATLASSERT(m_hImageList == NULL);
01598         m_hImageList = ImageList_LoadBitmap(_Module.GetResourceInstance(), bitmap.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>, cx, nGrow, crMask);
01599         <font class="keywordflow">return</font> (m_hImageList != NULL) ? TRUE : FALSE;
01600     }
<a name="l01601"></a><a class="code" href="classWTL_1_1CImageList.html#a19">01601</a>     BOOL CreateFromImage(<a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> image, <font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> nGrow, COLORREF crMask, UINT uType, UINT uFlags = LR_DEFAULTCOLOR | LR_DEFAULTSIZE)
01602     {
01603         ATLASSERT(m_hImageList == NULL);
01604         m_hImageList = ImageList_LoadImage(_Module.GetResourceInstance(), image.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>, cx, nGrow, crMask, uType, uFlags);
01605         <font class="keywordflow">return</font> (m_hImageList != NULL) ? TRUE : FALSE;
01606     }
<a name="l01607"></a><a class="code" href="classWTL_1_1CImageList.html#a20">01607</a>     BOOL Merge(HIMAGELIST hImageList1, <font class="keywordtype">int</font> nImage1, HIMAGELIST hImageList2, <font class="keywordtype">int</font> nImage2, <font class="keywordtype">int</font> dx, <font class="keywordtype">int</font> dy)
01608     {
01609         ATLASSERT(m_hImageList == NULL);
01610         m_hImageList = ImageList_Merge(hImageList1, nImage1, hImageList2, nImage2, dx, dy);
01611         <font class="keywordflow">return</font> (m_hImageList != NULL) ? TRUE : FALSE;
01612     }
<a name="l01613"></a><a class="code" href="classWTL_1_1CImageList.html#a21">01613</a>     BOOL CreateFromStream(LPSTREAM lpStream)
01614     {
01615         ATLASSERT(m_hImageList == NULL);
01616         m_hImageList = ImageList_Read(lpStream);
01617         <font class="keywordflow">return</font> (m_hImageList != NULL) ? TRUE : FALSE;
01618     }
01619 
<a name="l01620"></a><a class="code" href="classWTL_1_1CImageList.html#a22">01620</a>     BOOL Destroy()
01621     {
01622         <font class="keywordflow">if</font> (m_hImageList == NULL)
01623             <font class="keywordflow">return</font> FALSE;
01624         BOOL bRet = ImageList_Destroy(m_hImageList);
01625         <font class="keywordflow">if</font>(bRet)
01626             m_hImageList = NULL;
01627         <font class="keywordflow">return</font> bRet;
01628     }
01629 
<a name="l01630"></a><a class="code" href="classWTL_1_1CImageList.html#a23">01630</a>     <font class="keywordtype">int</font> Add(HBITMAP hBitmap, HBITMAP hBitmapMask = NULL)
01631     {
01632         ATLASSERT(m_hImageList != NULL);
01633         <font class="keywordflow">return</font> ImageList_Add(m_hImageList, hBitmap, hBitmapMask);
01634     }
<a name="l01635"></a><a class="code" href="classWTL_1_1CImageList.html#a24">01635</a>     <font class="keywordtype">int</font> Add(HBITMAP hBitmap, COLORREF crMask)
01636     {
01637         ATLASSERT(m_hImageList != NULL);
01638         <font class="keywordflow">return</font> ImageList_AddMasked(m_hImageList, hBitmap, crMask);
01639     }
<a name="l01640"></a><a class="code" href="classWTL_1_1CImageList.html#a25">01640</a>     BOOL Remove(<font class="keywordtype">int</font> nImage)
01641     {
01642         ATLASSERT(m_hImageList != NULL);
01643         <font class="keywordflow">return</font> ImageList_Remove(m_hImageList, nImage);
01644     }
<a name="l01645"></a><a class="code" href="classWTL_1_1CImageList.html#a26">01645</a>     BOOL RemoveAll()
01646     {
01647         ATLASSERT(m_hImageList != NULL);
01648         <font class="keywordflow">return</font> ImageList_RemoveAll(m_hImageList);
01649     }
<a name="l01650"></a><a class="code" href="classWTL_1_1CImageList.html#a27">01650</a>     BOOL Replace(<font class="keywordtype">int</font> nImage, HBITMAP hBitmap, HBITMAP hBitmapMask)
01651     {
01652         ATLASSERT(m_hImageList != NULL);
01653         <font class="keywordflow">return</font> ImageList_Replace(m_hImageList, nImage, hBitmap, hBitmapMask);
01654     }
<a name="l01655"></a><a class="code" href="classWTL_1_1CImageList.html#a28">01655</a>     <font class="keywordtype">int</font> AddIcon(HICON hIcon)
01656     {
01657         ATLASSERT(m_hImageList != NULL);
01658         <font class="keywordflow">return</font> ImageList_AddIcon(m_hImageList, hIcon);
01659     }
<a name="l01660"></a><a class="code" href="classWTL_1_1CImageList.html#a29">01660</a>     <font class="keywordtype">int</font> ReplaceIcon(<font class="keywordtype">int</font> nImage, HICON hIcon)
01661     {
01662         ATLASSERT(m_hImageList != NULL);
01663         <font class="keywordflow">return</font> ImageList_ReplaceIcon(m_hImageList, nImage, hIcon);
01664     }
<a name="l01665"></a><a class="code" href="classWTL_1_1CImageList.html#a30">01665</a>     HICON ExtractIcon(<font class="keywordtype">int</font> nImage)
01666     {
01667         ATLASSERT(m_hImageList != NULL);
01668         <font class="keywordflow">return</font> ImageList_ExtractIcon(NULL, m_hImageList, nImage);
01669     }
<a name="l01670"></a><a class="code" href="classWTL_1_1CImageList.html#a31">01670</a>     BOOL Draw(HDC hDC, <font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, UINT nStyle)
01671     {
01672         ATLASSERT(m_hImageList != NULL);
01673         ATLASSERT(hDC != NULL);
01674         <font class="keywordflow">return</font> ImageList_Draw(m_hImageList, nImage, hDC, x, y, nStyle);
01675     }
<a name="l01676"></a><a class="code" href="classWTL_1_1CImageList.html#a32">01676</a>     BOOL Draw(HDC hDC, <font class="keywordtype">int</font> nImage, POINT pt, UINT nStyle)
01677     {
01678         ATLASSERT(m_hImageList != NULL);
01679         ATLASSERT(hDC != NULL);
01680         <font class="keywordflow">return</font> ImageList_Draw(m_hImageList, nImage, hDC, pt.x, pt.y, nStyle);
01681     }
<a name="l01682"></a><a class="code" href="classWTL_1_1CImageList.html#a33">01682</a>     BOOL DrawEx(<font class="keywordtype">int</font> nImage, HDC hDC, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">int</font> dx, <font class="keywordtype">int</font> dy, COLORREF rgbBk, COLORREF rgbFg, UINT fStyle)
01683     {
01684         ATLASSERT(m_hImageList != NULL);
01685         ATLASSERT(hDC != NULL);
01686         <font class="keywordflow">return</font> ImageList_DrawEx(m_hImageList, nImage, hDC, x, y, dx, dy, rgbBk, rgbFg, fStyle);
01687     }
<a name="l01688"></a><a class="code" href="classWTL_1_1CImageList.html#a34">01688</a>     BOOL DrawEx(<font class="keywordtype">int</font> nImage, HDC hDC, RECT&amp; rect, COLORREF rgbBk, COLORREF rgbFg, UINT fStyle)
01689     {
01690         ATLASSERT(m_hImageList != NULL);
01691         ATLASSERT(hDC != NULL);
01692         <font class="keywordflow">return</font> ImageList_DrawEx(m_hImageList, nImage, hDC, rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top, rgbBk, rgbFg, fStyle);
01693     }
<a name="l01694"></a><a class="code" href="classWTL_1_1CImageList.html#d0">01694</a>     <font class="keyword">static</font> BOOL DrawIndirect(IMAGELISTDRAWPARAMS* pimldp)
01695     {
01696         <font class="keywordflow">return</font> ImageList_DrawIndirect(pimldp);
01697     }
<a name="l01698"></a><a class="code" href="classWTL_1_1CImageList.html#a35">01698</a>     BOOL Copy(<font class="keywordtype">int</font> nSrc, <font class="keywordtype">int</font> nDst, UINT uFlags = ILCF_MOVE)
01699     {
01700         ATLASSERT(m_hImageList != NULL);
01701         <font class="keywordflow">return</font> ImageList_Copy(m_hImageList, nDst, m_hImageList, nSrc, uFlags);
01702     }
<a name="l01703"></a><a class="code" href="classWTL_1_1CImageList.html#d1">01703</a>     <font class="keyword">static</font> HIMAGELIST Read(LPSTREAM lpStream)
01704     {
01705         <font class="keywordflow">return</font> ImageList_Read(lpStream);
01706     }
<a name="l01707"></a><a class="code" href="classWTL_1_1CImageList.html#a36">01707</a>     BOOL Write(LPSTREAM lpStream)
01708     {
01709         ATLASSERT(m_hImageList != NULL);
01710         <font class="keywordflow">return</font> ImageList_Write(m_hImageList, lpStream);
01711     }
01712 
01713 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l01714"></a><a class="code" href="classWTL_1_1CImageList.html#d2">01714</a> <font class="preprocessor"></font>    <font class="keyword">static</font> HRESULT ReadEx(DWORD dwFlags, LPSTREAM lpStream, REFIID riid, PVOID* ppv)
01715     {
01716         <font class="keywordflow">return</font> ImageList_ReadEx(dwFlags, lpStream, riid, ppv);
01717     }
<a name="l01718"></a><a class="code" href="classWTL_1_1CImageList.html#a37">01718</a>     HRESULT WriteEx(DWORD dwFlags, LPSTREAM lpStream)
01719     {
01720         ATLASSERT(m_hImageList != NULL);
01721         <font class="keywordflow">return</font> ImageList_WriteEx(m_hImageList, dwFlags, lpStream);
01722     }
01723 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
01724 <font class="preprocessor"></font>
01725     <font class="comment">// Drag operations</font>
<a name="l01726"></a><a class="code" href="classWTL_1_1CImageList.html#a38">01726</a>     BOOL BeginDrag(<font class="keywordtype">int</font> nImage, POINT ptHotSpot)
01727     {
01728         ATLASSERT(m_hImageList != NULL);
01729         <font class="keywordflow">return</font> ImageList_BeginDrag(m_hImageList, nImage, ptHotSpot.x, ptHotSpot.y);
01730     }
<a name="l01731"></a><a class="code" href="classWTL_1_1CImageList.html#a39">01731</a>     BOOL BeginDrag(<font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> xHotSpot, <font class="keywordtype">int</font> yHotSpot)
01732     {
01733         ATLASSERT(m_hImageList != NULL);
01734         <font class="keywordflow">return</font> ImageList_BeginDrag(m_hImageList, nImage, xHotSpot, yHotSpot);
01735     }
<a name="l01736"></a><a class="code" href="classWTL_1_1CImageList.html#d3">01736</a>     <font class="keyword">static</font> <font class="keywordtype">void</font> EndDrag()
01737     {
01738         ImageList_EndDrag();
01739     }
<a name="l01740"></a><a class="code" href="classWTL_1_1CImageList.html#d4">01740</a>     <font class="keyword">static</font> BOOL DragMove(POINT pt)
01741     {
01742         <font class="keywordflow">return</font> ImageList_DragMove(pt.x, pt.y);
01743     }
<a name="l01744"></a><a class="code" href="classWTL_1_1CImageList.html#d5">01744</a>     <font class="keyword">static</font> BOOL DragMove(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y)
01745     {
01746         <font class="keywordflow">return</font> ImageList_DragMove(x, y);
01747     }
<a name="l01748"></a><a class="code" href="classWTL_1_1CImageList.html#a40">01748</a>     BOOL SetDragCursorImage(<font class="keywordtype">int</font> nDrag, POINT ptHotSpot)
01749     {
01750         ATLASSERT(m_hImageList != NULL);
01751         <font class="keywordflow">return</font> ImageList_SetDragCursorImage(m_hImageList, nDrag, ptHotSpot.x, ptHotSpot.y);
01752     }
<a name="l01753"></a><a class="code" href="classWTL_1_1CImageList.html#a41">01753</a>     BOOL SetDragCursorImage(<font class="keywordtype">int</font> nDrag, <font class="keywordtype">int</font> xHotSpot, <font class="keywordtype">int</font> yHotSpot)
01754     {
01755         ATLASSERT(m_hImageList != NULL);
01756         <font class="keywordflow">return</font> ImageList_SetDragCursorImage(m_hImageList, nDrag, xHotSpot, yHotSpot);
01757     }
<a name="l01758"></a><a class="code" href="classWTL_1_1CImageList.html#d6">01758</a>     <font class="keyword">static</font> BOOL DragShowNolock(BOOL bShow = TRUE)
01759     {
01760         <font class="keywordflow">return</font> ImageList_DragShowNolock(bShow);
01761     }
<a name="l01762"></a><a class="code" href="classWTL_1_1CImageList.html#d7">01762</a>     <font class="keyword">static</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> GetDragImage(LPPOINT lpPoint, LPPOINT lpPointHotSpot)
01763     {
01764         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>(ImageList_GetDragImage(lpPoint, lpPointHotSpot));
01765     }
<a name="l01766"></a><a class="code" href="classWTL_1_1CImageList.html#d8">01766</a>     <font class="keyword">static</font> BOOL DragEnter(HWND hWnd, POINT point)
01767     {
01768         <font class="keywordflow">return</font> ImageList_DragEnter(hWnd, point.x, point.y);
01769     }
<a name="l01770"></a><a class="code" href="classWTL_1_1CImageList.html#d9">01770</a>     <font class="keyword">static</font> BOOL DragEnter(HWND hWnd, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y)
01771     {
01772         <font class="keywordflow">return</font> ImageList_DragEnter(hWnd, x, y);
01773     }
<a name="l01774"></a><a class="code" href="classWTL_1_1CImageList.html#d10">01774</a>     <font class="keyword">static</font> BOOL DragLeave(HWND hWnd)
01775     {
01776         <font class="keywordflow">return</font> ImageList_DragLeave(hWnd);
01777     }
01778 
01779 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l01780"></a><a class="code" href="classWTL_1_1CImageList.html#a42">01780</a> <font class="preprocessor"></font>    <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> Duplicate()
01781     {
01782         ATLASSERT(m_hImageList != NULL);
01783         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>(ImageList_Duplicate(m_hImageList));
01784     }
<a name="l01785"></a><a class="code" href="classWTL_1_1CImageList.html#d11">01785</a>     <font class="keyword">static</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> Duplicate(HIMAGELIST hImageList)
01786     {
01787         ATLASSERT(hImageList != NULL);
01788         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>(ImageList_Duplicate(hImageList));
01789     }
01790 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
01791 <font class="preprocessor"></font>};
01792 
01793 
01795 <font class="comment">// CToolTipCtrl</font>
01796 
<a name="l01797"></a><a class="code" href="classWTL_1_1CToolInfo.html">01797</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> : <font class="keyword">public</font> TOOLINFO
01798 {
01799 <font class="keyword">public</font>:
<a name="l01800"></a><a class="code" href="classWTL_1_1CToolInfo.html#a0">01800</a>     <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a>(UINT nFlags, HWND hWnd, UINT nIDTool = 0, LPRECT lpRect = NULL, LPTSTR lpstrText = LPSTR_TEXTCALLBACK, LPARAM lUserParam = NULL)
01801     {
01802         Init(nFlags, hWnd, nIDTool, lpRect, lpstrText, lUserParam);
01803     }
01804 
<a name="l01805"></a><a class="code" href="classWTL_1_1CToolInfo.html#a1">01805</a>     operator LPTOOLINFO() { <font class="keywordflow">return</font> <font class="keyword">this</font>; }
<a name="l01806"></a><a class="code" href="classWTL_1_1CToolInfo.html#a2">01806</a>     operator LPARAM() { <font class="keywordflow">return</font> (LPARAM)<font class="keyword">this</font>; }
01807 
<a name="l01808"></a><a class="code" href="classWTL_1_1CToolInfo.html#a3">01808</a>     <font class="keywordtype">void</font> Init(UINT nFlags, HWND hWnd, UINT nIDTool = 0, LPRECT lpRect = NULL, LPTSTR lpstrText = LPSTR_TEXTCALLBACK, LPARAM lUserParam = NULL)
01809     {
01810         ATLASSERT(::IsWindow(hWnd));
01811         memset(<font class="keyword">this</font>, 0, <font class="keyword">sizeof</font>(TOOLINFO));
01812         cbSize = <font class="keyword">sizeof</font>(TOOLINFO);
01813         uFlags = nFlags;
01814         <font class="keywordflow">if</font>(nIDTool == 0)
01815         {
01816             hwnd = ::GetParent(hWnd);
01817             uFlags |= TTF_IDISHWND;
01818             uId = (UINT_PTR)hWnd;
01819         }
01820         <font class="keywordflow">else</font>
01821         {
01822             hwnd = hWnd;
01823             uId = nIDTool;
01824         }
01825         <font class="keywordflow">if</font>(lpRect != NULL)
01826             rect = *lpRect;
01827         hinst = _Module.GetResourceInstance();
01828         lpszText = lpstrText;
01829         lParam = lUserParam;
01830     }
01831 };
01832 
01833 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l01834"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html">01834</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CToolTipCtrlT.html">CToolTipCtrlT</a> : <font class="keyword">public</font> TBase
01835 {
01836 <font class="keyword">public</font>:
01837 <font class="comment">// Constructors</font>
<a name="l01838"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a0">01838</a>     <a class="code" href="classWTL_1_1CToolTipCtrlT.html">CToolTipCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
01839 
<a name="l01840"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a1">01840</a>     <a class="code" href="classWTL_1_1CToolTipCtrlT.html">CToolTipCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
01841     {
01842         m_hWnd = hWnd;
01843         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
01844     }
01845 
<a name="l01846"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a2">01846</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
01847             DWORD dwStyle = 0, DWORD dwExStyle = 0,
01848             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
01849     {
01850         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
01851     }
01852 
01853 <font class="comment">// Attributes</font>
<a name="l01854"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#d0">01854</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
01855     {
01856         <font class="keywordflow">return</font> TOOLTIPS_CLASS;
01857     }
01858 
<a name="l01859"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a3">01859</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(LPTOOLINFO lpToolInfo)<font class="keyword"> const</font>
01860 <font class="keyword">    </font>{
01861         ATLASSERT(::IsWindow(m_hWnd));
01862         ::SendMessage(m_hWnd, TTM_GETTEXT, 0, (LPARAM)&amp;lpToolInfo);
01863     }
<a name="l01864"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a4">01864</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(LPTSTR lpstrText, HWND hWnd, UINT nIDTool = 0)<font class="keyword"> const</font>
01865 <font class="keyword">    </font>{
01866         ATLASSERT(::IsWindow(m_hWnd));
01867         ATLASSERT(hWnd != NULL);
01868         <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> ti(0, hWnd, nIDTool, NULL, lpstrText);
01869         ::SendMessage(m_hWnd, TTM_GETTEXT, 0, ti);
01870     }
<a name="l01871"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a5">01871</a>     BOOL GetToolInfo(LPTOOLINFO lpToolInfo)<font class="keyword"> const</font>
01872 <font class="keyword">    </font>{
01873         ATLASSERT(::IsWindow(m_hWnd));
01874         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_GETTOOLINFO, 0, (LPARAM)lpToolInfo);
01875     }
<a name="l01876"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a6">01876</a>     BOOL GetToolInfo(HWND hWnd, UINT nIDTool, UINT* puFlags, LPRECT lpRect, LPTSTR lpstrText)<font class="keyword"> const</font>
01877 <font class="keyword">    </font>{
01878         ATLASSERT(::IsWindow(m_hWnd));
01879         ATLASSERT(hWnd != NULL);
01880         <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> ti(0, hWnd, nIDTool, NULL, lpstrText);
01881         BOOL bRet = (BOOL)::SendMessage(m_hWnd, TTM_GETTOOLINFO, 0, ti);
01882         <font class="keywordflow">if</font>(bRet)
01883         {
01884             *puFlags = ti.uFlags;
01885             memcpy(lpRect, &amp;(ti.rect), <font class="keyword">sizeof</font>(RECT));
01886         }
01887         <font class="keywordflow">return</font> bRet;
01888     }
<a name="l01889"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a7">01889</a>     <font class="keywordtype">void</font> SetToolInfo(LPTOOLINFO lpToolInfo)
01890     {
01891         ATLASSERT(::IsWindow(m_hWnd));
01892         ::SendMessage(m_hWnd, TTM_SETTOOLINFO, 0, (LPARAM)lpToolInfo);
01893     }
<a name="l01894"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a8">01894</a>     <font class="keywordtype">void</font> SetToolRect(LPTOOLINFO lpToolInfo)
01895     {
01896         ATLASSERT(::IsWindow(m_hWnd));
01897         ::SendMessage(m_hWnd, TTM_NEWTOOLRECT, 0, (LPARAM)lpToolInfo);
01898     }
<a name="l01899"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a9">01899</a>     <font class="keywordtype">void</font> SetToolRect(HWND hWnd, UINT nIDTool, LPCRECT lpRect)
01900     {
01901         ATLASSERT(::IsWindow(m_hWnd));
01902         ATLASSERT(hWnd != NULL);
01903         ATLASSERT(nIDTool != 0);
01904 
01905         <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> ti(0, hWnd, nIDTool, (LPRECT)lpRect, NULL);
01906         ::SendMessage(m_hWnd, TTM_NEWTOOLRECT, 0, ti);
01907     }
<a name="l01908"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a10">01908</a>     <font class="keywordtype">int</font> GetToolCount()<font class="keyword"> const</font>
01909 <font class="keyword">    </font>{
01910         ATLASSERT(::IsWindow(m_hWnd));
01911         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TTM_GETTOOLCOUNT, 0, 0L);
01912     }
<a name="l01913"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a11">01913</a>     <font class="keywordtype">int</font> GetDelayTime(DWORD dwType)<font class="keyword"> const</font>
01914 <font class="keyword">    </font>{
01915         ATLASSERT(::IsWindow(m_hWnd));
01916         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TTM_GETDELAYTIME, dwType, 0L);
01917     }
<a name="l01918"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a12">01918</a>     <font class="keywordtype">void</font> SetDelayTime(DWORD dwType, <font class="keywordtype">int</font> nTime)
01919     {
01920         ATLASSERT(::IsWindow(m_hWnd));
01921         ::SendMessage(m_hWnd, TTM_SETDELAYTIME, dwType, MAKELPARAM(nTime, 0));
01922     }
<a name="l01923"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a13">01923</a>     <font class="keywordtype">void</font> GetMargin(LPRECT lpRect)<font class="keyword"> const</font>
01924 <font class="keyword">    </font>{
01925         ATLASSERT(::IsWindow(m_hWnd));
01926         ::SendMessage(m_hWnd, TTM_GETMARGIN, 0, (LPARAM)lpRect);
01927     }
<a name="l01928"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a14">01928</a>     <font class="keywordtype">void</font> SetMargin(LPRECT lpRect)
01929     {
01930         ATLASSERT(::IsWindow(m_hWnd));
01931         ::SendMessage(m_hWnd, TTM_SETMARGIN, 0, (LPARAM)lpRect);
01932     }
<a name="l01933"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a15">01933</a>     <font class="keywordtype">int</font> GetMaxTipWidth()<font class="keyword"> const</font>
01934 <font class="keyword">    </font>{
01935         ATLASSERT(::IsWindow(m_hWnd));
01936         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TTM_GETMAXTIPWIDTH, 0, 0L);
01937     }
<a name="l01938"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a16">01938</a>     <font class="keywordtype">int</font> SetMaxTipWidth(<font class="keywordtype">int</font> nWidth)
01939     {
01940         ATLASSERT(::IsWindow(m_hWnd));
01941         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TTM_SETMAXTIPWIDTH, 0, nWidth);
01942     }
<a name="l01943"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a17">01943</a>     COLORREF GetTipBkColor()<font class="keyword"> const</font>
01944 <font class="keyword">    </font>{
01945         ATLASSERT(::IsWindow(m_hWnd));
01946         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TTM_GETTIPBKCOLOR, 0, 0L);
01947     }
<a name="l01948"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a18">01948</a>     <font class="keywordtype">void</font> SetTipBkColor(COLORREF clr)
01949     {
01950         ATLASSERT(::IsWindow(m_hWnd));
01951         ::SendMessage(m_hWnd, TTM_SETTIPBKCOLOR, (WPARAM)clr, 0L);
01952     }
<a name="l01953"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a19">01953</a>     COLORREF GetTipTextColor()<font class="keyword"> const</font>
01954 <font class="keyword">    </font>{
01955         ATLASSERT(::IsWindow(m_hWnd));
01956         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TTM_GETTIPTEXTCOLOR, 0, 0L);
01957     }
<a name="l01958"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a20">01958</a>     <font class="keywordtype">void</font> SetTipTextColor(COLORREF clr)
01959     {
01960         ATLASSERT(::IsWindow(m_hWnd));
01961         ::SendMessage(m_hWnd, TTM_SETTIPTEXTCOLOR, (WPARAM)clr, 0L);
01962     }
<a name="l01963"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a21">01963</a>     BOOL GetCurrentTool(LPTOOLINFO lpToolInfo)<font class="keyword"> const</font>
01964 <font class="keyword">    </font>{
01965         ATLASSERT(::IsWindow(m_hWnd));
01966         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_GETCURRENTTOOL, 0, (LPARAM)lpToolInfo);
01967     }
01968 
01969 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l01970"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a22">01970</a> <font class="preprocessor"></font>    SIZE GetBubbleSize(LPTOOLINFO lpToolInfo)<font class="keyword"> const</font>
01971 <font class="keyword">    </font>{
01972         ATLASSERT(::IsWindow(m_hWnd));
01973         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, TTM_GETBUBBLESIZE, 0, (LPARAM)lpToolInfo);
01974         SIZE size = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwRet), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwRet) };
01975         <font class="keywordflow">return</font> size;
01976     }
<a name="l01977"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a23">01977</a>     BOOL SetTitle(UINT uIcon, LPCTSTR lpstrTitle)
01978     {
01979         ATLASSERT(::IsWindow(m_hWnd));
01980         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_SETTITLE, uIcon, (LPARAM)lpstrTitle);
01981     }
01982 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
01983 <font class="preprocessor"></font>
01984 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l01985"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a24">01985</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> GetTitle(PTTGETTITLE pTTGetTitle)<font class="keyword"> const</font>
01986 <font class="keyword">    </font>{
01987         ATLASSERT(::IsWindow(m_hWnd));
01988         ::SendMessage(m_hWnd, TTM_GETTITLE, 0, (LPARAM)pTTGetTitle);
01989     }
<a name="l01990"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a25">01990</a>     <font class="keywordtype">void</font> SetWindowTheme(LPCWSTR lpstrTheme)
01991     {
01992         ATLASSERT(::IsWindow(m_hWnd));
01993         ::SendMessage(m_hWnd, TTM_SETWINDOWTHEME, 0, (LPARAM)lpstrTheme);
01994     }
01995 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
01996 <font class="preprocessor"></font>
01997 <font class="comment">// Operations</font>
<a name="l01998"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a26">01998</a>     <font class="keywordtype">void</font> Activate(BOOL bActivate)
01999     {
02000         ATLASSERT(::IsWindow(m_hWnd));
02001         ::SendMessage(m_hWnd, TTM_ACTIVATE, bActivate, 0L);
02002     }
<a name="l02003"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a27">02003</a>     BOOL AddTool(LPTOOLINFO lpToolInfo)
02004     {
02005         ATLASSERT(::IsWindow(m_hWnd));
02006         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_ADDTOOL, 0, (LPARAM)lpToolInfo);
02007     }
<a name="l02008"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a28">02008</a>     BOOL AddTool(HWND hWnd, <a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> text = LPSTR_TEXTCALLBACK, LPCRECT lpRectTool = NULL, UINT nIDTool = 0)
02009     {
02010         ATLASSERT(::IsWindow(m_hWnd));
02011         ATLASSERT(hWnd != NULL);
02012         <font class="comment">// the toolrect and toolid must both be zero or both valid</font>
02013         ATLASSERT((lpRectTool != NULL &amp;&amp; nIDTool != 0) || (lpRectTool == NULL &amp;&amp; nIDTool == 0));
02014 
02015         <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> ti(0, hWnd, nIDTool, (LPRECT)lpRectTool, (LPTSTR)text.m_lpstr);
02016         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_ADDTOOL, 0, ti);
02017     }
<a name="l02018"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a29">02018</a>     <font class="keywordtype">void</font> DelTool(LPTOOLINFO lpToolInfo)
02019     {
02020         ATLASSERT(::IsWindow(m_hWnd));
02021         ::SendMessage(m_hWnd, TTM_DELTOOL, 0, (LPARAM)lpToolInfo);
02022     }
<a name="l02023"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a30">02023</a>     <font class="keywordtype">void</font> DelTool(HWND hWnd, UINT nIDTool = 0)
02024     {
02025         ATLASSERT(::IsWindow(m_hWnd));
02026         ATLASSERT(hWnd != NULL);
02027 
02028         <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> ti(0, hWnd, nIDTool, NULL, NULL);
02029         ::SendMessage(m_hWnd, TTM_DELTOOL, 0, ti);
02030     }
<a name="l02031"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a31">02031</a>     BOOL HitTest(LPTTHITTESTINFO lpHitTestInfo)<font class="keyword"> const</font>
02032 <font class="keyword">    </font>{
02033         ATLASSERT(::IsWindow(m_hWnd));
02034         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_HITTEST, 0, (LPARAM)lpHitTestInfo);
02035     }
<a name="l02036"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a32">02036</a>     BOOL HitTest(HWND hWnd, POINT pt, LPTOOLINFO lpToolInfo)<font class="keyword"> const</font>
02037 <font class="keyword">    </font>{
02038         ATLASSERT(::IsWindow(m_hWnd));
02039         ATLASSERT(hWnd != NULL);
02040         ATLASSERT(lpToolInfo != NULL);
02041 
02042         TTHITTESTINFO hti;
02043         memset(&amp;hti, 0, <font class="keyword">sizeof</font>(hti));
02044         hti.ti.cbSize = <font class="keyword">sizeof</font>(TOOLINFO);
02045         hti.hwnd = hWnd;
02046         hti.pt.x = pt.x;
02047         hti.pt.y = pt.y;
02048         <font class="keywordflow">if</font>((BOOL)::SendMessage(m_hWnd, TTM_HITTEST, 0, (LPARAM)&amp;hti))
02049         {
02050             memcpy(lpToolInfo, &amp;hti.ti, <font class="keyword">sizeof</font>(TOOLINFO));
02051             <font class="keywordflow">return</font> TRUE;
02052         }
02053         <font class="keywordflow">return</font> FALSE;
02054     }
<a name="l02055"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a33">02055</a>     <font class="keywordtype">void</font> RelayEvent(LPMSG lpMsg)
02056     {
02057         ATLASSERT(::IsWindow(m_hWnd));
02058         ::SendMessage(m_hWnd, TTM_RELAYEVENT, 0, (LPARAM)lpMsg);
02059     }
<a name="l02060"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a34">02060</a>     <font class="keywordtype">void</font> UpdateTipText(LPTOOLINFO lpToolInfo)
02061     {
02062         ATLASSERT(::IsWindow(m_hWnd));
02063         ::SendMessage(m_hWnd, TTM_UPDATETIPTEXT, 0, (LPARAM)lpToolInfo);
02064     }
<a name="l02065"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a35">02065</a>     <font class="keywordtype">void</font> UpdateTipText(<a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> text, HWND hWnd, UINT nIDTool = 0)
02066     {
02067         ATLASSERT(::IsWindow(m_hWnd));
02068         ATLASSERT(hWnd != NULL);
02069 
02070         <a class="code" href="classWTL_1_1CToolInfo.html">CToolInfo</a> ti(0, hWnd, nIDTool, NULL, (LPTSTR)text.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>);
02071         ::SendMessage(m_hWnd, TTM_UPDATETIPTEXT, 0, ti);
02072     }
02073 
<a name="l02074"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a36">02074</a>     BOOL EnumTools(UINT nTool, LPTOOLINFO lpToolInfo)<font class="keyword"> const</font>
02075 <font class="keyword">    </font>{
02076         ATLASSERT(::IsWindow(m_hWnd));
02077         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_ENUMTOOLS, nTool, (LPARAM)lpToolInfo);
02078     }
<a name="l02079"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a37">02079</a>     <font class="keywordtype">void</font> Pop()
02080     {
02081         ATLASSERT(::IsWindow(m_hWnd));
02082         ::SendMessage(m_hWnd, TTM_POP, 0, 0L);
02083     }
<a name="l02084"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a38">02084</a>     <font class="keywordtype">void</font> TrackActivate(LPTOOLINFO lpToolInfo, BOOL bActivate)
02085     {
02086         ATLASSERT(::IsWindow(m_hWnd));
02087         ::SendMessage(m_hWnd, TTM_TRACKACTIVATE, bActivate, (LPARAM)lpToolInfo);
02088     }
<a name="l02089"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a39">02089</a>     <font class="keywordtype">void</font> TrackPosition(<font class="keywordtype">int</font> xPos, <font class="keywordtype">int</font> yPos)
02090     {
02091         ATLASSERT(::IsWindow(m_hWnd));
02092         ::SendMessage(m_hWnd, TTM_TRACKPOSITION, 0, MAKELPARAM(xPos, yPos));
02093     }
02094 
02095 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l02096"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a40">02096</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> Update()
02097     {
02098         ATLASSERT(::IsWindow(m_hWnd));
02099         ::SendMessage(m_hWnd, TTM_UPDATE, 0, 0L);
02100     }
02101 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
02102 <font class="preprocessor"></font>
02103 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l02104"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a41">02104</a> <font class="preprocessor"></font>    BOOL AdjustRect(LPRECT lpRect, BOOL bLarger <font class="comment">/*= TRUE*/</font>)
02105     {
02106         ATLASSERT(::IsWindow(m_hWnd));
02107         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TTM_ADJUSTRECT, bLarger, (LPARAM)lpRect);
02108     }
02109 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
02110 <font class="preprocessor"></font>
02111 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l02112"></a><a class="code" href="classWTL_1_1CToolTipCtrlT.html#a42">02112</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> Popup()
02113     {
02114         ATLASSERT(::IsWindow(m_hWnd));
02115         ::SendMessage(m_hWnd, TTM_POPUP, 0, 0L);
02116     }
02117 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
02118 <font class="preprocessor"></font>};
02119 
<a name="l02120"></a><a class="code" href="namespaceWTL.html#a8">02120</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CToolTipCtrlT.html">CToolTipCtrlT&lt;CWindow&gt;</a>      <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>;
02121 
02122 
02124 <font class="comment">// CHeaderCtrl</font>
02125 
02126 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l02127"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html">02127</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CHeaderCtrlT.html">CHeaderCtrlT</a> : <font class="keyword">public</font> TBase
02128 {
02129 <font class="keyword">public</font>:
02130 <font class="comment">// Constructors</font>
<a name="l02131"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a0">02131</a>     <a class="code" href="classWTL_1_1CHeaderCtrlT.html">CHeaderCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
02132 
<a name="l02133"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a1">02133</a>     <a class="code" href="classWTL_1_1CHeaderCtrlT.html">CHeaderCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
02134     {
02135         m_hWnd = hWnd;
02136         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
02137     }
02138 
<a name="l02139"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a2">02139</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
02140             DWORD dwStyle = 0, DWORD dwExStyle = 0,
02141             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
02142     {
02143         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
02144     }
02145 
02146 <font class="comment">// Attributes</font>
<a name="l02147"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#d0">02147</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
02148     {
02149         <font class="keywordflow">return</font> WC_HEADER;
02150     }
02151 
<a name="l02152"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a3">02152</a>     <font class="keywordtype">int</font> GetItemCount()<font class="keyword"> const</font>
02153 <font class="keyword">    </font>{
02154         ATLASSERT(::IsWindow(m_hWnd));
02155         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_GETITEMCOUNT, 0, 0L);
02156     }
<a name="l02157"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a4">02157</a>     BOOL GetItem(<font class="keywordtype">int</font> nIndex, LPHDITEM pHeaderItem)<font class="keyword"> const</font>
02158 <font class="keyword">    </font>{
02159         ATLASSERT(::IsWindow(m_hWnd));
02160         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_GETITEM, nIndex, (LPARAM)pHeaderItem);
02161     }
<a name="l02162"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a5">02162</a>     BOOL SetItem(<font class="keywordtype">int</font> nIndex, LPHDITEM pHeaderItem)
02163     {
02164         ATLASSERT(::IsWindow(m_hWnd));
02165         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_SETITEM, nIndex, (LPARAM)pHeaderItem);
02166     }
<a name="l02167"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a6">02167</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> GetImageList()<font class="keyword"> const</font>
02168 <font class="keyword">    </font>{
02169         ATLASSERT(::IsWindow(m_hWnd));
02170         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, HDM_GETIMAGELIST, 0, 0L));
02171     }
<a name="l02172"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a7">02172</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> SetImageList(HIMAGELIST hImageList)
02173     {
02174         ATLASSERT(::IsWindow(m_hWnd));
02175         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, HDM_SETIMAGELIST, 0, (LPARAM)hImageList));
02176     }
<a name="l02177"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a8">02177</a>     BOOL GetOrderArray(<font class="keywordtype">int</font> nSize, <font class="keywordtype">int</font>* lpnArray)<font class="keyword"> const</font>
02178 <font class="keyword">    </font>{
02179         ATLASSERT(::IsWindow(m_hWnd));
02180         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_GETORDERARRAY, nSize, (LPARAM)lpnArray);
02181     }
<a name="l02182"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a9">02182</a>     BOOL SetOrderArray(<font class="keywordtype">int</font> nSize, <font class="keywordtype">int</font>* lpnArray)
02183     {
02184         ATLASSERT(::IsWindow(m_hWnd));
02185         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_SETORDERARRAY, nSize, (LPARAM)lpnArray);
02186     }
<a name="l02187"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a10">02187</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a26">GetItemRect</a>(<font class="keywordtype">int</font> nIndex, LPRECT lpItemRect)<font class="keyword"> const</font>
02188 <font class="keyword">    </font>{
02189         ATLASSERT(::IsWindow(m_hWnd));
02190         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_GETITEMRECT, nIndex, (LPARAM)lpItemRect);
02191     }
<a name="l02192"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a11">02192</a>     <font class="keywordtype">int</font> SetHotDivider(BOOL bPos, DWORD dwInputValue)
02193     {
02194         ATLASSERT(::IsWindow(m_hWnd));
02195         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_SETHOTDIVIDER, bPos, dwInputValue);
02196     }
02197 
02198 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l02199"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a12">02199</a> <font class="preprocessor"></font>    BOOL GetUnicodeFormat()<font class="keyword"> const</font>
02200 <font class="keyword">    </font>{
02201         ATLASSERT(::IsWindow(m_hWnd));
02202         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_GETUNICODEFORMAT, 0, 0L);
02203     }
<a name="l02204"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a13">02204</a>     BOOL SetUnicodeFormat(BOOL bUnicode = TRUE)
02205     {
02206         ATLASSERT(::IsWindow(m_hWnd));
02207         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_SETUNICODEFORMAT, bUnicode, 0L);
02208     }
02209 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
02210 <font class="preprocessor"></font>
02211 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l02212"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a14">02212</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> GetBitmapMargin()<font class="keyword"> const</font>
02213 <font class="keyword">    </font>{
02214         ATLASSERT(::IsWindow(m_hWnd));
02215         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_GETBITMAPMARGIN, 0, 0L);
02216     }
<a name="l02217"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a15">02217</a>     <font class="keywordtype">int</font> SetBitmapMargin(<font class="keywordtype">int</font> nWidth)
02218     {
02219         ATLASSERT(::IsWindow(m_hWnd));
02220         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_SETBITMAPMARGIN, nWidth, 0L);
02221     }
<a name="l02222"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a16">02222</a>     <font class="keywordtype">int</font> SetFilterChangeTimeout(DWORD dwTimeOut)
02223     {
02224         ATLASSERT(::IsWindow(m_hWnd));
02225         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_SETFILTERCHANGETIMEOUT, 0, dwTimeOut);
02226     }
02227 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
02228 <font class="preprocessor"></font>
02229 <font class="comment">// Operations</font>
<a name="l02230"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a17">02230</a>     <font class="keywordtype">int</font> InsertItem(<font class="keywordtype">int</font> nIndex, LPHDITEM phdi)
02231     {
02232         ATLASSERT(::IsWindow(m_hWnd));
02233         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_INSERTITEM, nIndex, (LPARAM)phdi);
02234     }
<a name="l02235"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a18">02235</a>     BOOL DeleteItem(<font class="keywordtype">int</font> nIndex)
02236     {
02237         ATLASSERT(::IsWindow(m_hWnd));
02238         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_DELETEITEM, nIndex, 0L);
02239     }
<a name="l02240"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a19">02240</a>     BOOL Layout(HD_LAYOUT* pHeaderLayout)
02241     {
02242         ATLASSERT(::IsWindow(m_hWnd));
02243         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, HDM_LAYOUT, 0, (LPARAM)pHeaderLayout);
02244     }
<a name="l02245"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a20">02245</a>     <font class="keywordtype">int</font> HitTest(LPHDHITTESTINFO lpHitTestInfo)<font class="keyword"> const</font>
02246 <font class="keyword">    </font>{
02247         ATLASSERT(::IsWindow(m_hWnd));
02248         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_HITTEST, 0, (LPARAM)lpHitTestInfo);
02249     }
<a name="l02250"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a21">02250</a>     <font class="keywordtype">int</font> OrderToIndex(<font class="keywordtype">int</font> nOrder)
02251     {
02252         ATLASSERT(::IsWindow(m_hWnd));
02253         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_ORDERTOINDEX, nOrder, 0L);
02254     }
<a name="l02255"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a22">02255</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> CreateDragImage(<font class="keywordtype">int</font> nIndex)
02256     {
02257         ATLASSERT(::IsWindow(m_hWnd));
02258         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, HDM_CREATEDRAGIMAGE, nIndex, 0L));
02259     }
02260 
02261 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l02262"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a23">02262</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> EditFilter(<font class="keywordtype">int</font> nColumn, BOOL bDiscardChanges)
02263     {
02264         ATLASSERT(::IsWindow(m_hWnd));
02265         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_EDITFILTER, nColumn, MAKELPARAM(bDiscardChanges, 0));
02266     }
<a name="l02267"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a24">02267</a>     <font class="keywordtype">int</font> ClearFilter(<font class="keywordtype">int</font> nColumn)
02268     {
02269         ATLASSERT(::IsWindow(m_hWnd));
02270         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_CLEARFILTER, nColumn, 0L);
02271     }
<a name="l02272"></a><a class="code" href="classWTL_1_1CHeaderCtrlT.html#a25">02272</a>     <font class="keywordtype">int</font> ClearAllFilters()
02273     {
02274         ATLASSERT(::IsWindow(m_hWnd));
02275         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, HDM_CLEARFILTER, (WPARAM)-1, 0L);
02276     }
02277 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
02278 <font class="preprocessor"></font>};
02279 
<a name="l02280"></a><a class="code" href="namespaceWTL.html#a9">02280</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CHeaderCtrlT.html">CHeaderCtrlT&lt;CWindow&gt;</a>       <a class="code" href="namespaceWTL.html#a9">CHeaderCtrl</a>;
02281 
02282 
02284 <font class="comment">// CListViewCtrl</font>
02285 
02286 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l02287"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html">02287</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CListViewCtrlT.html">CListViewCtrlT</a> : <font class="keyword">public</font> TBase
02288 {
02289 <font class="keyword">public</font>:
02290 <font class="comment">// Constructors</font>
<a name="l02291"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a0">02291</a>     <a class="code" href="classWTL_1_1CListViewCtrlT.html">CListViewCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
02292 
<a name="l02293"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a1">02293</a>     <a class="code" href="classWTL_1_1CListViewCtrlT.html">CListViewCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
02294     {
02295         m_hWnd = hWnd;
02296         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
02297     }
02298 
<a name="l02299"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a2">02299</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
02300             DWORD dwStyle = 0, DWORD dwExStyle = 0,
02301             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
02302     {
02303         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
02304     }
02305 
02306 <font class="comment">// Attributes</font>
<a name="l02307"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#d0">02307</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
02308     {
02309         <font class="keywordflow">return</font> WC_LISTVIEW;
02310     }
02311 
<a name="l02312"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a3">02312</a>     COLORREF GetBkColor()<font class="keyword"> const</font>
02313 <font class="keyword">    </font>{
02314         ATLASSERT(::IsWindow(m_hWnd));
02315         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_GETBKCOLOR, 0, 0L);
02316     }
<a name="l02317"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a4">02317</a>     BOOL SetBkColor(COLORREF cr)
02318     {
02319         ATLASSERT(::IsWindow(m_hWnd));
02320         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETBKCOLOR, 0, cr);
02321     }
<a name="l02322"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a5">02322</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> GetImageList(<font class="keywordtype">int</font> nImageListType)<font class="keyword"> const</font>
02323 <font class="keyword">    </font>{
02324         ATLASSERT(::IsWindow(m_hWnd));
02325         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, LVM_GETIMAGELIST, nImageListType, 0L));
02326     }
<a name="l02327"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a6">02327</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> SetImageList(HIMAGELIST hImageList, <font class="keywordtype">int</font> nImageList)
02328     {
02329         ATLASSERT(::IsWindow(m_hWnd)); 
02330         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, LVM_SETIMAGELIST, nImageList, (LPARAM)hImageList));
02331     }
<a name="l02332"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a7">02332</a>     <font class="keywordtype">int</font> GetItemCount()<font class="keyword"> const</font>
02333 <font class="keyword">    </font>{
02334         ATLASSERT(::IsWindow(m_hWnd));
02335         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETITEMCOUNT, 0, 0L);
02336     }
<a name="l02337"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a8">02337</a>     BOOL SetItemCount(<font class="keywordtype">int</font> nItems)
02338     {
02339         ATLASSERT(::IsWindow(m_hWnd));
02340         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEMCOUNT, nItems, 0L);
02341     }
<a name="l02342"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a9">02342</a>     BOOL GetItem(LPLVITEM pItem)<font class="keyword"> const</font>
02343 <font class="keyword">    </font>{
02344         ATLASSERT(::IsWindow(m_hWnd));
02345         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETITEM, 0, (LPARAM)pItem);
02346     }
<a name="l02347"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a10">02347</a>     BOOL SetItem(<font class="keyword">const</font> LVITEM* pItem)
02348     {
02349         ATLASSERT(::IsWindow(m_hWnd));
02350         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEM, 0, (LPARAM)pItem);
02351     }
<a name="l02352"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a11">02352</a>     BOOL SetItem(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, UINT nMask, LPCTSTR lpszItem,
02353         <font class="keywordtype">int</font> nImage, UINT nState, UINT nStateMask, LPARAM lParam)
02354     {
02355         ATLASSERT(::IsWindow(m_hWnd));
02356         LVITEM lvi;
02357         lvi.mask = nMask;
02358         lvi.iItem = nItem;
02359         lvi.iSubItem = nSubItem;
02360         lvi.stateMask = nStateMask;
02361         lvi.state = nState;
02362         lvi.pszText = (LPTSTR) lpszItem;
02363         lvi.iImage = nImage;
02364         lvi.lParam = lParam;
02365         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEM, 0, (LPARAM)&amp;lvi);
02366     }
<a name="l02367"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a12">02367</a>     UINT GetItemState(<font class="keywordtype">int</font> nItem, UINT nMask)<font class="keyword"> const</font>
02368 <font class="keyword">    </font>{
02369         ATLASSERT(::IsWindow(m_hWnd));
02370         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, LVM_GETITEMSTATE, nItem, nMask);
02371     }
<a name="l02372"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a13">02372</a>     BOOL SetItemState(<font class="keywordtype">int</font> nItem, UINT nState, UINT nStateMask)
02373     {
02374         ATLASSERT(::IsWindow(m_hWnd));
02375         LVITEM lvi = { 0 };
02376         lvi.state = nState;
02377         lvi.stateMask = nStateMask;
02378         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEMSTATE, nItem, (LPARAM)&amp;lvi);
02379     }
<a name="l02380"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a14">02380</a>     BOOL SetItemState(<font class="keywordtype">int</font> nItem, LPLVITEM pItem)
02381     {
02382         ATLASSERT(::IsWindow(m_hWnd));
02383         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEMSTATE, nItem, (LPARAM)pItem);
02384     }
02385 
02386 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
<a name="l02387"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a15">02387</a> <font class="preprocessor"></font>    BOOL GetItemText(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, BSTR&amp; bstrText)<font class="keyword"> const</font>
02388 <font class="keyword">    </font>{
02389         USES_CONVERSION;
02390         ATLASSERT(::IsWindow(m_hWnd));
02391         ATLASSERT(bstrText == NULL);
02392         LVITEM lvi;
02393         memset(&amp;lvi, 0, <font class="keyword">sizeof</font>(LVITEM));
02394         lvi.iSubItem = nSubItem;
02395 
02396         LPTSTR lpstrText = NULL;
02397         <font class="keywordtype">int</font> nRes = 0;
02398         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nLen = 256; ; nLen *= 2)
02399         {
02400             ATLTRY(lpstrText = <font class="keyword">new</font> TCHAR[nLen]);
02401             <font class="keywordflow">if</font>(lpstrText == NULL)
02402                 <font class="keywordflow">break</font>;
02403             lpstrText[0] = NULL;
02404             lvi.cchTextMax = nLen;
02405             lvi.pszText = lpstrText;
02406             nRes  = (int)::SendMessage(m_hWnd, LVM_GETITEMTEXT, (WPARAM)nItem, (LPARAM)&amp;lvi);
02407             <font class="keywordflow">if</font>(nRes &lt; nLen - 1)
02408                 <font class="keywordflow">break</font>;
02409             <font class="keyword">delete</font> [] lpstrText;
02410             lpstrText = NULL;
02411         }
02412 
02413         <font class="keywordflow">if</font>(lpstrText != NULL)
02414         {
02415             <font class="keywordflow">if</font>(nRes != 0)
02416                 bstrText = ::SysAllocString(T2OLE(lpstrText));
02417             <font class="keyword">delete</font> [] lpstrText;
02418         }
02419 
02420         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
02421     }
02422 <font class="preprocessor">#endif </font>
02423 <font class="preprocessor"></font>
02424 <font class="preprocessor"></font><font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
02425 <font class="preprocessor"></font>    <font class="keywordtype">int</font> GetItemText(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, CString&amp; strText)<font class="keyword"> const</font>
02426 <font class="keyword">    </font>{
02427         ATLASSERT(::IsWindow(m_hWnd));
02428         LVITEM lvi;
02429         memset(&amp;lvi, 0, <font class="keyword">sizeof</font>(LVITEM));
02430         lvi.iSubItem = nSubItem;
02431 
02432         strText.Empty();
02433         <font class="keywordtype">int</font> nRes = 0;
02434         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nLen = 256; ; nLen *= 2)
02435         {
02436             lvi.cchTextMax = nLen;
02437             lvi.pszText = strText.GetBufferSetLength(nLen);
02438             <font class="keywordflow">if</font>(lvi.pszText == NULL)
02439             {
02440                 nRes = 0;
02441                 <font class="keywordflow">break</font>;
02442             }
02443             nRes  = (int)::SendMessage(m_hWnd, LVM_GETITEMTEXT, (WPARAM)nItem, (LPARAM)&amp;lvi);
02444             <font class="keywordflow">if</font>(nRes &lt; nLen - 1)
02445                 <font class="keywordflow">break</font>;
02446         }
02447         strText.ReleaseBuffer();
02448         <font class="keywordflow">return</font> nRes;
02449     }
02450 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
02451 <font class="preprocessor"></font>
<a name="l02452"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a16">02452</a>     <font class="keywordtype">int</font> GetItemText(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, LPTSTR lpszText, <font class="keywordtype">int</font> nLen)<font class="keyword"> const</font>
02453 <font class="keyword">    </font>{
02454         ATLASSERT(::IsWindow(m_hWnd));
02455         LVITEM lvi;
02456         memset(&amp;lvi, 0, <font class="keyword">sizeof</font>(LVITEM));
02457         lvi.iSubItem = nSubItem;
02458         lvi.cchTextMax = nLen;
02459         lvi.pszText = lpszText;
02460         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETITEMTEXT, (WPARAM)nItem, (LPARAM)&amp;lvi);
02461     }
<a name="l02462"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a17">02462</a>     BOOL SetItemText(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, LPCTSTR lpszText)
02463     {
02464         ATLASSERT(::IsWindow(m_hWnd));
02465         <font class="keywordflow">return</font> SetItem(nItem, nSubItem, LVIF_TEXT, lpszText, 0, 0, 0, 0);
02466     }
<a name="l02467"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a18">02467</a>     <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> <a class="code" href="classWTL_1_1CListBoxT.html#a22">GetItemData</a>(<font class="keywordtype">int</font> nItem)<font class="keyword"> const</font>
02468 <font class="keyword">    </font>{
02469         ATLASSERT(::IsWindow(m_hWnd));
02470         LVITEM lvi;
02471         memset(&amp;lvi, 0, <font class="keyword">sizeof</font>(LVITEM));
02472         lvi.iItem = nItem;
02473         lvi.mask = LVIF_PARAM;
02474         ::SendMessage(m_hWnd, LVM_GETITEM, 0, (LPARAM)&amp;lvi);
02475         <font class="keywordflow">return</font> (DWORD_PTR)lvi.lParam;
02476     }
<a name="l02477"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a19">02477</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a23">SetItemData</a>(<font class="keywordtype">int</font> nItem, <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwData)
02478     {
02479         ATLASSERT(::IsWindow(m_hWnd));
02480         <font class="keywordflow">return</font> SetItem(nItem, 0, LVIF_PARAM, NULL, 0, 0, 0, (LPARAM)dwData);
02481     }
<a name="l02482"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a20">02482</a>     UINT GetCallbackMask()<font class="keyword"> const</font>
02483 <font class="keyword">    </font>{
02484         ATLASSERT(::IsWindow(m_hWnd));
02485         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, LVM_GETCALLBACKMASK, 0, 0L);
02486     }
<a name="l02487"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a21">02487</a>     BOOL SetCallbackMask(UINT nMask)
02488     {
02489         ATLASSERT(::IsWindow(m_hWnd));
02490         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETCALLBACKMASK, nMask, 0L);
02491     }
<a name="l02492"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a22">02492</a>     BOOL GetItemPosition(<font class="keywordtype">int</font> nItem, LPPOINT lpPoint)<font class="keyword"> const</font>
02493 <font class="keyword">    </font>{
02494         ATLASSERT(::IsWindow(m_hWnd));
02495         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETITEMPOSITION, nItem, (LPARAM)lpPoint);
02496     }
<a name="l02497"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a23">02497</a>     BOOL SetItemPosition(<font class="keywordtype">int</font> nItem, POINT pt)
02498     {
02499         ATLASSERT(::IsWindow(m_hWnd));
02500         ATLASSERT(((GetStyle() &amp; LVS_TYPEMASK) == LVS_ICON) || ((GetStyle() &amp; LVS_TYPEMASK) == LVS_SMALLICON));
02501         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEMPOSITION32, nItem, (LPARAM)&amp;pt);
02502     }
<a name="l02503"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a24">02503</a>     BOOL SetItemPosition(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y)
02504     {
02505         ATLASSERT(::IsWindow(m_hWnd));
02506         ATLASSERT(((GetStyle() &amp; LVS_TYPEMASK) == LVS_ICON) || ((GetStyle() &amp; LVS_TYPEMASK) == LVS_SMALLICON));
02507         POINT pt = { x, y };
02508         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEMPOSITION32, nItem, (LPARAM)&amp;pt);
02509     }
<a name="l02510"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a25">02510</a>     <font class="keywordtype">int</font> GetStringWidth(LPCTSTR lpsz)<font class="keyword"> const</font>
02511 <font class="keyword">    </font>{
02512         ATLASSERT(::IsWindow(m_hWnd));
02513         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETSTRINGWIDTH, 0, (LPARAM)lpsz);
02514     }
<a name="l02515"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a26">02515</a>     CEdit GetEditControl()<font class="keyword"> const</font>
02516 <font class="keyword">    </font>{
02517         ATLASSERT(::IsWindow(m_hWnd));
02518         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a6">CEdit</a>((HWND)::SendMessage(m_hWnd, LVM_GETEDITCONTROL, 0, 0L));
02519     }
<a name="l02520"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a27">02520</a>     BOOL GetColumn(<font class="keywordtype">int</font> nCol, LV_COLUMN* pColumn)<font class="keyword"> const</font>
02521 <font class="keyword">    </font>{
02522         ATLASSERT(::IsWindow(m_hWnd));
02523         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETCOLUMN, nCol, (LPARAM)pColumn);
02524     }
<a name="l02525"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a28">02525</a>     BOOL SetColumn(<font class="keywordtype">int</font> nCol, <font class="keyword">const</font> LV_COLUMN* pColumn)
02526     {
02527         ATLASSERT(::IsWindow(m_hWnd));
02528         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETCOLUMN, nCol, (LPARAM)pColumn);
02529     }
<a name="l02530"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a29">02530</a>     <font class="keywordtype">int</font> GetColumnWidth(<font class="keywordtype">int</font> nCol)<font class="keyword"> const</font>
02531 <font class="keyword">    </font>{
02532         ATLASSERT(::IsWindow(m_hWnd));
02533         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETCOLUMNWIDTH, nCol, 0L);
02534     }
<a name="l02535"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a30">02535</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a31">SetColumnWidth</a>(<font class="keywordtype">int</font> nCol, <font class="keywordtype">int</font> cx)
02536     {
02537         ATLASSERT(::IsWindow(m_hWnd));
02538         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETCOLUMNWIDTH, nCol, MAKELPARAM(cx, 0));
02539     }
<a name="l02540"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a31">02540</a>     BOOL GetViewRect(LPRECT lpRect)<font class="keyword"> const</font>
02541 <font class="keyword">    </font>{
02542         ATLASSERT(::IsWindow(m_hWnd));
02543         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETVIEWRECT, 0, (LPARAM)lpRect);
02544     }
<a name="l02545"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a32">02545</a>     COLORREF GetTextColor()<font class="keyword"> const</font>
02546 <font class="keyword">    </font>{
02547         ATLASSERT(::IsWindow(m_hWnd));
02548         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_GETTEXTCOLOR, 0, 0L);
02549     }
<a name="l02550"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a33">02550</a>     BOOL SetTextColor(COLORREF cr)
02551     {
02552         ATLASSERT(::IsWindow(m_hWnd));
02553         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETTEXTCOLOR, 0, cr);
02554     }
<a name="l02555"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a34">02555</a>     COLORREF GetTextBkColor()<font class="keyword"> const</font>
02556 <font class="keyword">    </font>{
02557         ATLASSERT(::IsWindow(m_hWnd));
02558         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_GETTEXTBKCOLOR, 0, 0L);
02559     }
<a name="l02560"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a35">02560</a>     BOOL SetTextBkColor(COLORREF cr)
02561     {
02562         ATLASSERT(::IsWindow(m_hWnd));
02563         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETTEXTBKCOLOR, 0, cr);
02564     }
<a name="l02565"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a36">02565</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a7">GetTopIndex</a>()<font class="keyword"> const</font>
02566 <font class="keyword">    </font>{
02567         ATLASSERT(::IsWindow(m_hWnd));
02568         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETTOPINDEX, 0, 0L);
02569     }
<a name="l02570"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a37">02570</a>     <font class="keywordtype">int</font> GetCountPerPage()<font class="keyword"> const</font>
02571 <font class="keyword">    </font>{
02572         ATLASSERT(::IsWindow(m_hWnd));
02573         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETCOUNTPERPAGE, 0, 0L);
02574     }
<a name="l02575"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a38">02575</a>     BOOL GetOrigin(LPPOINT lpPoint)<font class="keyword"> const</font>
02576 <font class="keyword">    </font>{
02577         ATLASSERT(::IsWindow(m_hWnd));
02578         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETORIGIN, 0, (LPARAM)lpPoint);
02579     }
<a name="l02580"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a39">02580</a>     UINT GetSelectedCount()<font class="keyword"> const</font>
02581 <font class="keyword">    </font>{
02582         ATLASSERT(::IsWindow(m_hWnd));
02583         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, LVM_GETSELECTEDCOUNT, 0, 0L);
02584     }
02585 
<a name="l02586"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a40">02586</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a26">GetItemRect</a>(<font class="keywordtype">int</font> nItem, LPRECT lpRect, UINT nCode)<font class="keyword"> const</font>
02587 <font class="keyword">    </font>{
02588         ATLASSERT(::IsWindow(m_hWnd));
02589         lpRect-&gt;left = nCode;
02590         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETITEMRECT, (WPARAM)nItem, (LPARAM)lpRect);
02591     }
02592 
<a name="l02593"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a41">02593</a>     HCURSOR GetHotCursor()<font class="keyword"> const</font>
02594 <font class="keyword">    </font>{
02595         ATLASSERT(::IsWindow(m_hWnd));
02596         <font class="keywordflow">return</font> (HCURSOR)::SendMessage(m_hWnd, LVM_GETHOTCURSOR, 0, 0L);
02597     }
<a name="l02598"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a42">02598</a>     HCURSOR SetHotCursor(HCURSOR hHotCursor)
02599     {
02600         ATLASSERT(::IsWindow(m_hWnd));
02601         <font class="keywordflow">return</font> (HCURSOR)::SendMessage(m_hWnd, LVM_SETHOTCURSOR, 0, (LPARAM)hHotCursor);
02602     }
<a name="l02603"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a43">02603</a>     <font class="keywordtype">int</font> GetHotItem()<font class="keyword"> const</font>
02604 <font class="keyword">    </font>{
02605         ATLASSERT(::IsWindow(m_hWnd));
02606         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETHOTITEM, 0, 0L);
02607     }
<a name="l02608"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a44">02608</a>     <font class="keywordtype">int</font> SetHotItem(<font class="keywordtype">int</font> nIndex)
02609     {
02610         ATLASSERT(::IsWindow(m_hWnd));
02611         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_SETHOTITEM, nIndex, 0L);
02612     }
<a name="l02613"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a45">02613</a>     BOOL GetColumnOrderArray(<font class="keywordtype">int</font> nCount, <font class="keywordtype">int</font>* lpnArray)<font class="keyword"> const</font>
02614 <font class="keyword">    </font>{
02615         ATLASSERT(::IsWindow(m_hWnd));
02616         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETCOLUMNORDERARRAY, nCount, (LPARAM)lpnArray);
02617     }
<a name="l02618"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a46">02618</a>     BOOL SetColumnOrderArray(<font class="keywordtype">int</font> nCount, <font class="keywordtype">int</font>* lpnArray)
02619     {
02620         ATLASSERT(::IsWindow(m_hWnd));
02621         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETCOLUMNORDERARRAY, nCount, (LPARAM)lpnArray);
02622     }
<a name="l02623"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a47">02623</a>     CHeaderCtrl GetHeader()<font class="keyword"> const</font>
02624 <font class="keyword">    </font>{
02625         ATLASSERT(::IsWindow(m_hWnd));
02626         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a9">CHeaderCtrl</a>((HWND)::SendMessage(m_hWnd, LVM_GETHEADER, 0, 0L));
02627     }
<a name="l02628"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a48">02628</a>     BOOL GetSubItemRect(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, <font class="keywordtype">int</font> nFlag, LPRECT lpRect)<font class="keyword"> const</font>
02629 <font class="keyword">    </font>{
02630         ATLASSERT(::IsWindow(m_hWnd));
02631         ATLASSERT((GetStyle() &amp; LVS_TYPEMASK) == LVS_REPORT);
02632         ATLASSERT(lpRect != NULL);
02633         lpRect-&gt;top = nSubItem;
02634         lpRect-&gt;left = nFlag;
02635         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETSUBITEMRECT, nItem, (LPARAM)lpRect);
02636     }
<a name="l02637"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a49">02637</a>     DWORD SetIconSpacing(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy)
02638     {
02639         ATLASSERT(::IsWindow(m_hWnd));
02640         ATLASSERT((GetStyle() &amp; LVS_TYPEMASK) == LVS_ICON);
02641         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_SETICONSPACING, 0, MAKELPARAM(cx, cy));
02642     }
<a name="l02643"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a50">02643</a>     <font class="keywordtype">int</font> GetISearchString(LPTSTR lpstr)<font class="keyword"> const</font>
02644 <font class="keyword">    </font>{
02645         ATLASSERT(::IsWindow(m_hWnd));
02646         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETISEARCHSTRING, 0, (LPARAM)lpstr);
02647     }
<a name="l02648"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a51">02648</a>     <font class="keywordtype">void</font> GetItemSpacing(SIZE&amp; sizeSpacing, BOOL bSmallIconView = FALSE)<font class="keyword"> const</font>
02649 <font class="keyword">    </font>{
02650         ATLASSERT(::IsWindow(m_hWnd));
02651         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, LVM_GETITEMSPACING, bSmallIconView, 0L);
02652         sizeSpacing.cx = <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwRet);
02653         sizeSpacing.cy = <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwRet);
02654     }
02655 
02656     <font class="comment">// single-selection only</font>
<a name="l02657"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a52">02657</a>     <font class="keywordtype">int</font> GetSelectedIndex()<font class="keyword"> const</font>
02658 <font class="keyword">    </font>{
02659         ATLASSERT(::IsWindow(m_hWnd));
02660         ATLASSERT((GetStyle() &amp; LVS_SINGLESEL) != 0);
02661         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETNEXTITEM, (WPARAM)-1, MAKELPARAM(LVNI_ALL | LVNI_SELECTED, 0));
02662     }
<a name="l02663"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a53">02663</a>     BOOL GetSelectedItem(LPLVITEM pItem)<font class="keyword"> const</font>
02664 <font class="keyword">    </font>{
02665         ATLASSERT(::IsWindow(m_hWnd));
02666         ATLASSERT((GetStyle() &amp; LVS_SINGLESEL) != 0);
02667         ATLASSERT(pItem != NULL);
02668         pItem-&gt;iItem = (int)::SendMessage(m_hWnd, LVM_GETNEXTITEM, (WPARAM)-1, MAKELPARAM(LVNI_ALL | LVNI_SELECTED, 0));
02669         <font class="keywordflow">if</font>(pItem-&gt;iItem == -1)
02670             <font class="keywordflow">return</font> FALSE;
02671         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETITEM, 0, (LPARAM)pItem);
02672     }
02673 
02674     <font class="comment">// extended list view styles</font>
<a name="l02675"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a54">02675</a>     DWORD GetExtendedListViewStyle()<font class="keyword"> const</font>
02676 <font class="keyword">    </font>{
02677         ATLASSERT(::IsWindow(m_hWnd));
02678         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_GETEXTENDEDLISTVIEWSTYLE, 0, 0L);
02679     }
02680     <font class="comment">// dwExMask = 0 means all styles</font>
<a name="l02681"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a55">02681</a>     DWORD SetExtendedListViewStyle(DWORD dwExStyle, DWORD dwExMask = 0)
02682     {
02683         ATLASSERT(::IsWindow(m_hWnd));
02684         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_SETEXTENDEDLISTVIEWSTYLE, dwExMask, dwExStyle);
02685     }
02686 
02687     <font class="comment">// checkboxes only</font>
<a name="l02688"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a56">02688</a>     BOOL GetCheckState(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
02689 <font class="keyword">    </font>{
02690         ATLASSERT(::IsWindow(m_hWnd));
02691         ATLASSERT((GetExtendedListViewStyle() &amp; LVS_EX_CHECKBOXES) != 0);
02692         UINT uRet = GetItemState(nIndex, LVIS_STATEIMAGEMASK);
02693         <font class="keywordflow">return</font> (uRet &gt;&gt; 12) - 1;
02694     }
<a name="l02695"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a57">02695</a>     BOOL SetCheckState(<font class="keywordtype">int</font> nItem, BOOL bCheck)
02696     {
02697         <font class="keywordtype">int</font> nCheck = bCheck ? 2 : 1;    <font class="comment">// one based index</font>
02698         <font class="keywordflow">return</font> SetItemState(nItem, INDEXTOSTATEIMAGEMASK(nCheck), LVIS_STATEIMAGEMASK);
02699     }
02700 
02701     <font class="comment">// view type</font>
<a name="l02702"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a58">02702</a>     DWORD GetViewType()<font class="keyword"> const</font>
02703 <font class="keyword">    </font>{
02704         ATLASSERT(::IsWindow(m_hWnd));
02705         <font class="keywordflow">return</font> (GetStyle() &amp; LVS_TYPEMASK);
02706     }
02707 
<a name="l02708"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a59">02708</a>     DWORD SetViewType(DWORD dwType)
02709     {
02710         ATLASSERT(::IsWindow(m_hWnd));
02711         ATLASSERT(dwType == LVS_ICON || dwType == LVS_SMALLICON || dwType == LVS_LIST || dwType == LVS_REPORT);
02712         DWORD dwOldType = GetViewType();
02713         <font class="keywordflow">if</font>(dwType != dwOldType)
02714             ModifyStyle(LVS_TYPEMASK, (dwType &amp; LVS_TYPEMASK));
02715         <font class="keywordflow">return</font> dwOldType;
02716     }
02717 
02718 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l02719"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a60">02719</a> <font class="preprocessor"></font>    BOOL GetBkImage(LPLVBKIMAGE plvbki)<font class="keyword"> const</font>
02720 <font class="keyword">    </font>{
02721         ATLASSERT(::IsWindow(m_hWnd));
02722         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETBKIMAGE, 0, (LPARAM)plvbki);
02723     }
<a name="l02724"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a61">02724</a>     BOOL SetBkImage(LPLVBKIMAGE plvbki)
02725     {
02726         ATLASSERT(::IsWindow(m_hWnd));
02727         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETBKIMAGE, 0, (LPARAM)plvbki);
02728     }
<a name="l02729"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a62">02729</a>     <font class="keywordtype">int</font> GetSelectionMark()<font class="keyword"> const</font>
02730 <font class="keyword">    </font>{
02731         ATLASSERT(::IsWindow(m_hWnd));
02732         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETSELECTIONMARK, 0, 0L);
02733     }
<a name="l02734"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a63">02734</a>     <font class="keywordtype">int</font> SetSelectionMark(<font class="keywordtype">int</font> nIndex)
02735     {
02736         ATLASSERT(::IsWindow(m_hWnd));
02737         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_SETSELECTIONMARK, 0, nIndex);
02738     }
<a name="l02739"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a64">02739</a>     BOOL GetWorkAreas(<font class="keywordtype">int</font> nWorkAreas, LPRECT lpRect)<font class="keyword"> const</font>
02740 <font class="keyword">    </font>{
02741         ATLASSERT(::IsWindow(m_hWnd));
02742         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETWORKAREAS, nWorkAreas, (LPARAM)lpRect);
02743     }
<a name="l02744"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a65">02744</a>     BOOL SetWorkAreas(<font class="keywordtype">int</font> nWorkAreas, LPRECT lpRect)
02745     {
02746         ATLASSERT(::IsWindow(m_hWnd));
02747         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETWORKAREAS, nWorkAreas, (LPARAM)lpRect);
02748     }
<a name="l02749"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a66">02749</a>     DWORD GetHoverTime()<font class="keyword"> const</font>
02750 <font class="keyword">    </font>{
02751         ATLASSERT(::IsWindow(m_hWnd));
02752         ATLASSERT((GetExtendedListViewStyle() &amp; (LVS_EX_TRACKSELECT | LVS_EX_ONECLICKACTIVATE | LVS_EX_TWOCLICKACTIVATE)) != 0);
02753         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_GETHOVERTIME, 0, 0L);
02754     }
<a name="l02755"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a67">02755</a>     DWORD SetHoverTime(DWORD dwHoverTime)
02756     {
02757         ATLASSERT(::IsWindow(m_hWnd));
02758         ATLASSERT((GetExtendedListViewStyle() &amp; (LVS_EX_TRACKSELECT | LVS_EX_ONECLICKACTIVATE | LVS_EX_TWOCLICKACTIVATE)) != 0);
02759         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_SETHOVERTIME, 0, dwHoverTime);
02760     }
<a name="l02761"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a68">02761</a>     BOOL GetNumberOfWorkAreas(<font class="keywordtype">int</font>* pnWorkAreas)<font class="keyword"> const</font>
02762 <font class="keyword">    </font>{
02763         ATLASSERT(::IsWindow(m_hWnd));
02764         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETNUMBEROFWORKAREAS, 0, (LPARAM)pnWorkAreas);
02765     }
<a name="l02766"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a69">02766</a>     BOOL SetItemCountEx(<font class="keywordtype">int</font> nItems, DWORD dwFlags)
02767     {
02768         ATLASSERT(::IsWindow(m_hWnd));
02769         ATLASSERT(((GetStyle() &amp; LVS_OWNERDATA) != 0) &amp;&amp; (((GetStyle() &amp; LVS_TYPEMASK) == LVS_REPORT) || ((GetStyle() &amp; LVS_TYPEMASK) == LVS_LIST)));
02770         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETITEMCOUNT, nItems, dwFlags);
02771     }
<a name="l02772"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a70">02772</a>     CToolTipCtrl GetToolTips()<font class="keyword"> const</font>
02773 <font class="keyword">    </font>{
02774         ATLASSERT(::IsWindow(m_hWnd));
02775         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, LVM_GETTOOLTIPS, 0, 0L));
02776     }
<a name="l02777"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a71">02777</a>     CToolTipCtrl SetToolTips(HWND hWndTT)
02778     {
02779         ATLASSERT(::IsWindow(m_hWnd));
02780         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, LVM_SETTOOLTIPS, (WPARAM)hWndTT, 0L));
02781     }
<a name="l02782"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a72">02782</a>     BOOL GetUnicodeFormat()<font class="keyword"> const</font>
02783 <font class="keyword">    </font>{
02784         ATLASSERT(::IsWindow(m_hWnd));
02785         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETUNICODEFORMAT, 0, 0L);
02786     }
<a name="l02787"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a73">02787</a>     BOOL SetUnicodeFormat(BOOL bUnicode = TRUE)
02788     {
02789         ATLASSERT(::IsWindow(m_hWnd));
02790         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETUNICODEFORMAT, bUnicode, 0L);
02791     }
02792 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
02793 <font class="preprocessor"></font>
02794 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l02795"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a74">02795</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> GetSelectedColumn()<font class="keyword"> const</font>
02796 <font class="keyword">    </font>{
02797         ATLASSERT(::IsWindow(m_hWnd));
02798         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETSELECTEDCOLUMN, 0, 0L);
02799     }
<a name="l02800"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a75">02800</a>     <font class="keywordtype">void</font> SetSelectedColumn(<font class="keywordtype">int</font> nColumn)
02801     {
02802         ATLASSERT(::IsWindow(m_hWnd));
02803         ::SendMessage(m_hWnd, LVM_SETSELECTEDCOLUMN, nColumn, 0L);
02804     }
<a name="l02805"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a76">02805</a>     DWORD GetView()<font class="keyword"> const</font>
02806 <font class="keyword">    </font>{
02807         ATLASSERT(::IsWindow(m_hWnd));
02808         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_GETVIEW, 0, 0L);
02809     }
<a name="l02810"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a77">02810</a>     <font class="keywordtype">int</font> SetView(DWORD dwView)
02811     {
02812         ATLASSERT(::IsWindow(m_hWnd));
02813         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_SETVIEW, dwView, 0L);
02814     }
<a name="l02815"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a78">02815</a>     BOOL IsGroupViewEnabled()<font class="keyword"> const</font>
02816 <font class="keyword">    </font>{
02817         ATLASSERT(::IsWindow(m_hWnd));
02818         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_ISGROUPVIEWENABLED, 0, 0L);
02819     }
<a name="l02820"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a79">02820</a>     <font class="keywordtype">int</font> GetGroupInfo(<font class="keywordtype">int</font> nGroupID, PLVGROUP pGroup)<font class="keyword"> const</font>
02821 <font class="keyword">    </font>{
02822         ATLASSERT(::IsWindow(m_hWnd));
02823         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETGROUPINFO, nGroupID, (LPARAM)pGroup);
02824     }
<a name="l02825"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a80">02825</a>     <font class="keywordtype">int</font> SetGroupInfo(<font class="keywordtype">int</font> nGroupID, PLVGROUP pGroup)
02826     {
02827         ATLASSERT(::IsWindow(m_hWnd));
02828         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_SETGROUPINFO, nGroupID, (LPARAM)pGroup);
02829     }
<a name="l02830"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a81">02830</a>     <font class="keywordtype">void</font> GetGroupMetrics(PLVGROUPMETRICS pGroupMetrics)<font class="keyword"> const</font>
02831 <font class="keyword">    </font>{
02832         ATLASSERT(::IsWindow(m_hWnd));
02833         ::SendMessage(m_hWnd, LVM_GETGROUPMETRICS, 0, (LPARAM)pGroupMetrics);
02834     }
<a name="l02835"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a82">02835</a>     <font class="keywordtype">void</font> SetGroupMetrics(PLVGROUPMETRICS pGroupMetrics)
02836     {
02837         ATLASSERT(::IsWindow(m_hWnd));
02838         ::SendMessage(m_hWnd, LVM_SETGROUPMETRICS, 0, (LPARAM)pGroupMetrics);
02839     }
<a name="l02840"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a83">02840</a>     <font class="keywordtype">void</font> GetTileViewInfo(PLVTILEVIEWINFO pTileViewInfo)<font class="keyword"> const</font>
02841 <font class="keyword">    </font>{
02842         ATLASSERT(::IsWindow(m_hWnd));
02843         ::SendMessage(m_hWnd, LVM_GETTILEVIEWINFO, 0, (LPARAM)pTileViewInfo);
02844     }
<a name="l02845"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a84">02845</a>     BOOL SetTileViewInfo(PLVTILEVIEWINFO pTileViewInfo)
02846     {
02847         ATLASSERT(::IsWindow(m_hWnd));
02848         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETTILEVIEWINFO, 0, (LPARAM)pTileViewInfo);
02849     }
<a name="l02850"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a85">02850</a>     <font class="keywordtype">void</font> GetTileInfo(PLVTILEINFO pTileInfo)<font class="keyword"> const</font>
02851 <font class="keyword">    </font>{
02852         ATLASSERT(::IsWindow(m_hWnd));
02853         ::SendMessage(m_hWnd, LVM_GETTILEINFO, 0, (LPARAM)pTileInfo);
02854     }
<a name="l02855"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a86">02855</a>     BOOL SetTileInfo(PLVTILEINFO pTileInfo)
02856     {
02857         ATLASSERT(::IsWindow(m_hWnd));
02858         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETTILEINFO, 0, (LPARAM)pTileInfo);
02859     }
<a name="l02860"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a87">02860</a>     BOOL GetInsertMark(LPLVINSERTMARK pInsertMark)<font class="keyword"> const</font>
02861 <font class="keyword">    </font>{
02862         ATLASSERT(::IsWindow(m_hWnd));
02863         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_GETINSERTMARK, 0, (LPARAM)pInsertMark);
02864     }
<a name="l02865"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a88">02865</a>     BOOL SetInsertMark(LPLVINSERTMARK pInsertMark)
02866     {
02867         ATLASSERT(::IsWindow(m_hWnd));
02868         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETINSERTMARK, 0, (LPARAM)pInsertMark);
02869     }
<a name="l02870"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a89">02870</a>     <font class="keywordtype">int</font> GetInsertMarkRect(LPRECT lpRect)<font class="keyword"> const</font>
02871 <font class="keyword">    </font>{
02872         ATLASSERT(::IsWindow(m_hWnd));
02873         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETINSERTMARKRECT, 0, (LPARAM)lpRect);
02874     }
<a name="l02875"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a90">02875</a>     COLORREF GetInsertMarkColor()<font class="keyword"> const</font>
02876 <font class="keyword">    </font>{
02877         ATLASSERT(::IsWindow(m_hWnd));
02878         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_GETINSERTMARKCOLOR, 0, 0L);
02879     }
<a name="l02880"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a91">02880</a>     COLORREF SetInsertMarkColor(COLORREF clr)
02881     {
02882         ATLASSERT(::IsWindow(m_hWnd));
02883         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_SETINSERTMARKCOLOR, 0, clr);
02884     }
<a name="l02885"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a92">02885</a>     COLORREF GetOutlineColor()<font class="keyword"> const</font>
02886 <font class="keyword">    </font>{
02887         ATLASSERT(::IsWindow(m_hWnd));
02888         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_GETOUTLINECOLOR, 0, 0L);
02889     }
<a name="l02890"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a93">02890</a>     COLORREF SetOutlineColor(COLORREF clr)
02891     {
02892         ATLASSERT(::IsWindow(m_hWnd));
02893         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, LVM_SETOUTLINECOLOR, 0, clr);
02894     }
02895 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
02896 <font class="preprocessor"></font>
02897 <font class="comment">// Operations</font>
<a name="l02898"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a94">02898</a>     <font class="keywordtype">int</font> InsertColumn(<font class="keywordtype">int</font> nCol, <font class="keyword">const</font> LV_COLUMN* pColumn)
02899     {
02900         ATLASSERT(::IsWindow(m_hWnd));
02901         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_INSERTCOLUMN, nCol, (LPARAM)pColumn);
02902     }
<a name="l02903"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a95">02903</a>     <font class="keywordtype">int</font> InsertColumn(<font class="keywordtype">int</font> nCol, LPCTSTR lpszColumnHeading, <font class="keywordtype">int</font> nFormat, <font class="keywordtype">int</font> nWidth, <font class="keywordtype">int</font> nSubItem)
02904     {
02905         LV_COLUMN column;
02906         column.mask = LVCF_TEXT|LVCF_FMT;
02907         column.pszText = (LPTSTR)lpszColumnHeading;
02908         column.fmt = nFormat;
02909         <font class="keywordflow">if</font> (nWidth != -1)
02910         {
02911             column.mask |= LVCF_WIDTH;
02912             column.cx = nWidth;
02913         }
02914         <font class="keywordflow">if</font> (nSubItem != -1)
02915         {
02916             column.mask |= LVCF_SUBITEM;
02917             column.iSubItem = nSubItem;
02918         }
02919         <font class="keywordflow">return</font> InsertColumn(nCol, &amp;column);
02920     }
<a name="l02921"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a96">02921</a>     BOOL DeleteColumn(<font class="keywordtype">int</font> nCol)
02922     {
02923         ATLASSERT(::IsWindow(m_hWnd));
02924         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_DELETECOLUMN, nCol, 0L);
02925     }
<a name="l02926"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a97">02926</a>     <font class="keywordtype">int</font> InsertItem(UINT nMask, <font class="keywordtype">int</font> nItem, LPCTSTR lpszItem, UINT nState, UINT nStateMask, <font class="keywordtype">int</font> nImage, LPARAM lParam)
02927     {
02928         ATLASSERT(::IsWindow(m_hWnd));
02929         LVITEM item;
02930         item.mask = nMask;
02931         item.iItem = nItem;
02932         item.iSubItem = 0;
02933         item.pszText = (LPTSTR)lpszItem;
02934         item.state = nState;
02935         item.stateMask = nStateMask;
02936         item.iImage = nImage;
02937         item.lParam = lParam;
02938         <font class="keywordflow">return</font> InsertItem(&amp;item);
02939     }
<a name="l02940"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a98">02940</a>     <font class="keywordtype">int</font> InsertItem(<font class="keyword">const</font> LVITEM* pItem)
02941     {
02942         ATLASSERT(::IsWindow(m_hWnd));
02943         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_INSERTITEM, 0, (LPARAM)pItem);
02944     }
<a name="l02945"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a99">02945</a>     <font class="keywordtype">int</font> InsertItem(<font class="keywordtype">int</font> nItem, LPCTSTR lpszItem)
02946     {
02947         ATLASSERT(::IsWindow(m_hWnd));
02948         <font class="keywordflow">return</font> InsertItem(LVIF_TEXT, nItem, lpszItem, 0, 0, 0, 0);
02949     }
<a name="l02950"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a100">02950</a>     <font class="keywordtype">int</font> InsertItem(<font class="keywordtype">int</font> nItem, LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage)
02951     {
02952         ATLASSERT(::IsWindow(m_hWnd));
02953         <font class="keywordflow">return</font> InsertItem(LVIF_TEXT|LVIF_IMAGE, nItem, lpszItem, 0, 0, nImage, 0);
02954     }
<a name="l02955"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a101">02955</a>     <font class="keywordtype">int</font> GetNextItem(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nFlags)<font class="keyword"> const</font>
02956 <font class="keyword">    </font>{
02957         ATLASSERT(::IsWindow(m_hWnd));
02958         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_GETNEXTITEM, nItem, MAKELPARAM(nFlags, 0));
02959     }
<a name="l02960"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a102">02960</a>     BOOL DeleteItem(<font class="keywordtype">int</font> nItem)
02961     {
02962         ATLASSERT(::IsWindow(m_hWnd));
02963         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_DELETEITEM, nItem, 0L);
02964     }
<a name="l02965"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a103">02965</a>     BOOL DeleteAllItems()
02966     {
02967         ATLASSERT(::IsWindow(m_hWnd));
02968         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_DELETEALLITEMS, 0, 0L);
02969     }
<a name="l02970"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a104">02970</a>     <font class="keywordtype">int</font> FindItem(LV_FINDINFO* pFindInfo, <font class="keywordtype">int</font> nStart)<font class="keyword"> const</font>
02971 <font class="keyword">    </font>{
02972         ATLASSERT(::IsWindow(m_hWnd));
02973         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_FINDITEM, nStart, (LPARAM)pFindInfo);
02974     }
<a name="l02975"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a105">02975</a>     <font class="keywordtype">int</font> HitTest(LV_HITTESTINFO* pHitTestInfo)<font class="keyword"> const</font>
02976 <font class="keyword">    </font>{
02977         ATLASSERT(::IsWindow(m_hWnd));
02978         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_HITTEST, 0, (LPARAM)pHitTestInfo);
02979     }
<a name="l02980"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a106">02980</a>     <font class="keywordtype">int</font> HitTest(POINT pt, UINT* pFlags)<font class="keyword"> const</font>
02981 <font class="keyword">    </font>{
02982         ATLASSERT(::IsWindow(m_hWnd));
02983         LV_HITTESTINFO hti;
02984         hti.pt = pt;
02985         <font class="keywordtype">int</font> nRes = (int)::SendMessage(m_hWnd, LVM_HITTEST, 0, (LPARAM)&amp;hti);
02986         <font class="keywordflow">if</font> (pFlags != NULL)
02987             *pFlags = hti.flags;
02988         <font class="keywordflow">return</font> nRes;
02989     }
<a name="l02990"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a107">02990</a>     BOOL EnsureVisible(<font class="keywordtype">int</font> nItem, BOOL bPartialOK)
02991     {
02992         ATLASSERT(::IsWindow(m_hWnd));
02993         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_ENSUREVISIBLE, nItem, MAKELPARAM(bPartialOK, 0));
02994     }
<a name="l02995"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a108">02995</a>     BOOL Scroll(SIZE size)
02996     {
02997         ATLASSERT(::IsWindow(m_hWnd));
02998         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SCROLL, size.cx, size.cy);
02999     }
<a name="l03000"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a109">03000</a>     BOOL RedrawItems(<font class="keywordtype">int</font> nFirst, <font class="keywordtype">int</font> nLast)
03001     {
03002         ATLASSERT(::IsWindow(m_hWnd));
03003         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_REDRAWITEMS, nFirst, nLast);
03004     }
<a name="l03005"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a110">03005</a>     BOOL Arrange(UINT nCode)
03006     {
03007         ATLASSERT(::IsWindow(m_hWnd));
03008         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_ARRANGE, nCode, 0L);
03009     }
<a name="l03010"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a111">03010</a>     CEdit EditLabel(<font class="keywordtype">int</font> nItem)
03011     {
03012         ATLASSERT(::IsWindow(m_hWnd));
03013         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a6">CEdit</a>((HWND)::SendMessage(m_hWnd, LVM_EDITLABEL, nItem, 0L));
03014     }
<a name="l03015"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a112">03015</a>     BOOL Update(<font class="keywordtype">int</font> nItem)
03016     {
03017         ATLASSERT(::IsWindow(m_hWnd));
03018         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_UPDATE, nItem, 0L);
03019     }
<a name="l03020"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a113">03020</a>     BOOL SortItems(PFNLVCOMPARE pfnCompare, LPARAM lParamSort)
03021     {
03022         ATLASSERT(::IsWindow(m_hWnd));
03023         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SORTITEMS, (WPARAM)lParamSort, (LPARAM)pfnCompare);
03024     }
<a name="l03025"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a114">03025</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> RemoveImageList(<font class="keywordtype">int</font> nImageList)
03026     {
03027         ATLASSERT(::IsWindow(m_hWnd));
03028         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, LVM_SETIMAGELIST, (WPARAM)nImageList, NULL));
03029     }
03030 
<a name="l03031"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a115">03031</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> CreateDragImage(<font class="keywordtype">int</font> nItem, LPPOINT lpPoint)
03032     {
03033         ATLASSERT(::IsWindow(m_hWnd));
03034         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, LVM_CREATEDRAGIMAGE, nItem, (LPARAM)lpPoint));
03035     }
<a name="l03036"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a116">03036</a>     DWORD ApproximateViewRect(<font class="keywordtype">int</font> cx = -1, <font class="keywordtype">int</font> cy = -1, <font class="keywordtype">int</font> nCount = -1)
03037     {
03038         ATLASSERT(::IsWindow(m_hWnd));
03039         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, LVM_APPROXIMATEVIEWRECT, nCount, MAKELPARAM(cx, cy));
03040     }
<a name="l03041"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a117">03041</a>     <font class="keywordtype">int</font> SubItemHitTest(LPLVHITTESTINFO lpInfo)
03042     {
03043         ATLASSERT(::IsWindow(m_hWnd));
03044         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_SUBITEMHITTEST, 0, (LPARAM)lpInfo);
03045     }
03046 
<a name="l03047"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a118">03047</a>     <font class="keywordtype">int</font> AddColumn(LPCTSTR strItem, <font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem = -1,
03048             <font class="keywordtype">int</font> nMask = LVCF_FMT | LVCF_WIDTH | LVCF_TEXT | LVCF_SUBITEM,
03049             <font class="keywordtype">int</font> nFmt = LVCFMT_LEFT)
03050     {
03051         ATLASSERT(::IsWindow(m_hWnd));
03052         LV_COLUMN lvc;
03053         lvc.mask = nMask;
03054         lvc.fmt = nFmt;
03055         lvc.pszText = (LPTSTR)strItem;
03056         lvc.cx = GetStringWidth(lvc.pszText) + 15;
03057         <font class="keywordflow">if</font>(nMask &amp; LVCF_SUBITEM)
03058             lvc.iSubItem = (nSubItem != -1) ? nSubItem : nItem;
03059         <font class="keywordflow">return</font> InsertColumn(nItem, &amp;lvc);
03060     }
<a name="l03061"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a119">03061</a>     <font class="keywordtype">int</font> AddItem(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nSubItem, LPCTSTR strItem, <font class="keywordtype">int</font> nImageIndex = -1)
03062     {
03063         ATLASSERT(::IsWindow(m_hWnd));
03064         LVITEM lvItem;
03065         lvItem.mask = LVIF_TEXT;
03066         lvItem.iItem = nItem;
03067         lvItem.iSubItem = nSubItem;
03068         lvItem.pszText = (LPTSTR)strItem;
03069         <font class="keywordflow">if</font>(nImageIndex != -1)
03070         {
03071             lvItem.mask |= LVIF_IMAGE;
03072             lvItem.iImage = nImageIndex;
03073         }
03074         <font class="keywordflow">if</font>(nSubItem == 0)
03075             <font class="keywordflow">return</font> InsertItem(&amp;lvItem);
03076         <font class="keywordflow">return</font> SetItem(&amp;lvItem) ? nItem : -1;
03077     }
03078 
03079 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l03080"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a120">03080</a> <font class="preprocessor"></font>    BOOL SortItemsEx(PFNLVCOMPARE pfnCompare, LPARAM lParamSort)
03081     {
03082         ATLASSERT(::IsWindow(m_hWnd));
03083         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SORTITEMSEX, (WPARAM)lParamSort, (LPARAM)pfnCompare);
03084     }
03085 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
03086 <font class="preprocessor"></font>
03087 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l03088"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a121">03088</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> InsertGroup(<font class="keywordtype">int</font> nItem, PLVGROUP pGroup)
03089     {
03090         ATLASSERT(::IsWindow(m_hWnd));
03091         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_INSERTGROUP, nItem, (LPARAM)pGroup);
03092     }
<a name="l03093"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a122">03093</a>     <font class="keywordtype">int</font> RemoveGroup(<font class="keywordtype">int</font> nGroupID)
03094     {
03095         ATLASSERT(::IsWindow(m_hWnd));
03096         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_REMOVEGROUP, nGroupID, 0L);
03097     }
<a name="l03098"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a123">03098</a>     <font class="keywordtype">void</font> MoveGroup(<font class="keywordtype">int</font> nGroupID, <font class="keywordtype">int</font> nItem)
03099     {
03100         ATLASSERT(::IsWindow(m_hWnd));
03101         ::SendMessage(m_hWnd, LVM_MOVEGROUP, nGroupID, nItem);
03102     }
<a name="l03103"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a124">03103</a>     <font class="keywordtype">void</font> MoveItemToGroup(<font class="keywordtype">int</font> nItem, <font class="keywordtype">int</font> nGroupID)
03104     {
03105         ATLASSERT(::IsWindow(m_hWnd));
03106         ::SendMessage(m_hWnd, LVM_MOVEITEMTOGROUP, nItem, nGroupID);
03107     }
<a name="l03108"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a125">03108</a>     <font class="keywordtype">int</font> EnableGroupView(BOOL bEnable)
03109     {
03110         ATLASSERT(::IsWindow(m_hWnd));
03111         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_ENABLEGROUPVIEW, bEnable, 0L);
03112     }
<a name="l03113"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a126">03113</a>     <font class="keywordtype">int</font> SortGroups(PFNLVGROUPCOMPARE pCompareFunc, LPVOID lpVoid = NULL)
03114     {
03115         ATLASSERT(::IsWindow(m_hWnd));
03116         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_SORTGROUPS, (WPARAM)pCompareFunc, (LPARAM)lpVoid);
03117     }
<a name="l03118"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a127">03118</a>     <font class="keywordtype">void</font> InsertGroupSorted(PLVINSERTGROUPSORTED pInsertGroupSorted)
03119     {
03120         ATLASSERT(::IsWindow(m_hWnd));
03121         ::SendMessage(m_hWnd, LVM_INSERTGROUPSORTED, (WPARAM)pInsertGroupSorted, 0L);
03122     }
<a name="l03123"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a128">03123</a>     <font class="keywordtype">void</font> RemoveAllGroups()
03124     {
03125         ATLASSERT(::IsWindow(m_hWnd));
03126         ::SendMessage(m_hWnd, LVM_REMOVEALLGROUPS, 0, 0L);
03127     }
<a name="l03128"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a129">03128</a>     BOOL HasGroup(<font class="keywordtype">int</font> nGroupID)
03129     {
03130         ATLASSERT(::IsWindow(m_hWnd));
03131         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_HASGROUP, nGroupID, 0L);
03132     }
<a name="l03133"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a130">03133</a>     BOOL InsertMarkHitTest(LPPOINT lpPoint, LPLVINSERTMARK pInsertMark)
03134     {
03135         ATLASSERT(::IsWindow(m_hWnd));
03136         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_INSERTMARKHITTEST, (WPARAM)lpPoint, (LPARAM)pInsertMark);
03137     }
<a name="l03138"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a131">03138</a>     BOOL SetInfoTip(PLVSETINFOTIP pSetInfoTip)
03139     {
03140         ATLASSERT(::IsWindow(m_hWnd));
03141         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LVM_SETINFOTIP, 0, (LPARAM)pSetInfoTip);
03142     }
<a name="l03143"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a132">03143</a>     <font class="keywordtype">void</font> CancelEditLabel()
03144     {
03145         ATLASSERT(::IsWindow(m_hWnd));
03146         ::SendMessage(m_hWnd, LVM_CANCELEDITLABEL, 0, 0L);
03147     }
<a name="l03148"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a133">03148</a>     UINT MapIndexToID(<font class="keywordtype">int</font> nIndex)<font class="keyword"> const</font>
03149 <font class="keyword">    </font>{
03150         ATLASSERT(::IsWindow(m_hWnd));
03151         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, LVM_MAPINDEXTOID, nIndex, 0L);
03152     }
<a name="l03153"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a134">03153</a>     <font class="keywordtype">int</font> MapIDToIndex(UINT uID)<font class="keyword"> const</font>
03154 <font class="keyword">    </font>{
03155         ATLASSERT(::IsWindow(m_hWnd));
03156         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LVM_MAPIDTOINDEX, uID, 0L);
03157     }
03158 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
03159 <font class="preprocessor"></font>
03160     <font class="comment">// single-selection only</font>
<a name="l03161"></a><a class="code" href="classWTL_1_1CListViewCtrlT.html#a135">03161</a>     BOOL SelectItem(<font class="keywordtype">int</font> nIndex)
03162     {
03163         ATLASSERT(::IsWindow(m_hWnd));
03164         ATLASSERT((GetStyle() &amp; LVS_SINGLESEL) != 0);
03165 
03166         BOOL bRet = SetItemState(nIndex, LVIS_SELECTED | LVIS_FOCUSED, LVIS_SELECTED | LVIS_FOCUSED);
03167         <font class="keywordflow">if</font>(bRet)
03168             bRet = EnsureVisible(nIndex, FALSE);
03169         <font class="keywordflow">return</font> bRet;
03170     }
03171 };
03172 
<a name="l03173"></a><a class="code" href="namespaceWTL.html#a10">03173</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CListViewCtrlT.html">CListViewCtrlT&lt;CWindow&gt;</a>     <a class="code" href="namespaceWTL.html#a10">CListViewCtrl</a>;
03174 
03175 
03177 <font class="comment">// CTreeViewCtrl</font>
03178 
03179 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l03180"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html">03180</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CTreeViewCtrlT.html">CTreeViewCtrlT</a> : <font class="keyword">public</font> TBase
03181 {
03182 <font class="keyword">public</font>:
03183 <font class="comment">// Constructors</font>
<a name="l03184"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a0">03184</a>     <a class="code" href="classWTL_1_1CTreeViewCtrlT.html">CTreeViewCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
03185 
<a name="l03186"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a1">03186</a>     <a class="code" href="classWTL_1_1CTreeViewCtrlT.html">CTreeViewCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
03187     {
03188         m_hWnd = hWnd;
03189         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
03190     }
03191 
<a name="l03192"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a2">03192</a>     HWND <a class="code" href="classWTL_1_1CListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
03193             DWORD dwStyle = 0, DWORD dwExStyle = 0,
03194             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
03195     {
03196         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
03197     }
03198 
03199 <font class="comment">// Attributes</font>
<a name="l03200"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#d0">03200</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>()
03201     {
03202         <font class="keywordflow">return</font> WC_TREEVIEW;
03203     }
03204 
<a name="l03205"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a3">03205</a>     UINT <a class="code" href="classWTL_1_1CListBoxT.html#a3">GetCount</a>()<font class="keyword"> const</font>
03206 <font class="keyword">    </font>{
03207         ATLASSERT(::IsWindow(m_hWnd));
03208         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, TVM_GETCOUNT, 0, 0L);
03209     }
<a name="l03210"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a4">03210</a>     UINT GetIndent()<font class="keyword"> const</font>
03211 <font class="keyword">    </font>{
03212         ATLASSERT(::IsWindow(m_hWnd));
03213         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, TVM_GETINDENT, 0, 0L);
03214     }
<a name="l03215"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a5">03215</a>     <font class="keywordtype">void</font> SetIndent(UINT nIndent)
03216     {
03217         ATLASSERT(::IsWindow(m_hWnd));
03218         ::SendMessage(m_hWnd, TVM_SETINDENT, nIndent, 0L);
03219     }
<a name="l03220"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a6">03220</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> GetImageList(UINT nImageList)<font class="keyword"> const</font>
03221 <font class="keyword">    </font>{
03222         ATLASSERT(::IsWindow(m_hWnd));
03223         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TVM_GETIMAGELIST, (UINT)nImageList, 0L));
03224     }
<a name="l03225"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a7">03225</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> SetImageList(HIMAGELIST hImageList, <font class="keywordtype">int</font> nImageListType)
03226     {
03227         ATLASSERT(::IsWindow(m_hWnd));
03228         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TVM_SETIMAGELIST, (UINT)nImageListType, (LPARAM)hImageList));
03229     }
<a name="l03230"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a8">03230</a>     BOOL GetItem(LPTVITEM pItem)<font class="keyword"> const</font>
03231 <font class="keyword">    </font>{
03232         ATLASSERT(::IsWindow(m_hWnd));
03233         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)pItem);
03234     }
<a name="l03235"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a9">03235</a>     BOOL SetItem(LPTVITEM pItem)
03236     {
03237         ATLASSERT(::IsWindow(m_hWnd));
03238         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SETITEM, 0, (LPARAM)pItem);
03239     }
<a name="l03240"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a10">03240</a>     BOOL SetItem(HTREEITEM hItem, UINT nMask, LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage,
03241         <font class="keywordtype">int</font> nSelectedImage, UINT nState, UINT nStateMask, LPARAM lParam)
03242     {
03243         ATLASSERT(::IsWindow(m_hWnd));
03244         TVITEM item;
03245         item.hItem = hItem;
03246         item.mask = nMask;
03247         item.pszText = (LPTSTR) lpszItem;
03248         item.iImage = nImage;
03249         item.iSelectedImage = nSelectedImage;
03250         item.state = nState;
03251         item.stateMask = nStateMask;
03252         item.lParam = lParam;
03253         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SETITEM, 0, (LPARAM)&amp;item);
03254     }
<a name="l03255"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a11">03255</a>     BOOL GetItemText(HTREEITEM hItem, LPTSTR lpstrText, <font class="keywordtype">int</font> nLen)<font class="keyword"> const</font>
03256 <font class="keyword">    </font>{
03257         ATLASSERT(::IsWindow(m_hWnd));
03258         ATLASSERT(lpstrText != NULL);
03259 
03260         TVITEM item;
03261         item.hItem = hItem;
03262         item.mask = TVIF_TEXT;
03263         item.pszText = lpstrText;
03264         item.cchTextMax = nLen;
03265 
03266         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03267     }
03268 
03269 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
<a name="l03270"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a12">03270</a> <font class="preprocessor"></font>    BOOL GetItemText(HTREEITEM hItem, BSTR&amp; bstrText)<font class="keyword"> const</font>
03271 <font class="keyword">    </font>{
03272         USES_CONVERSION;
03273         ATLASSERT(::IsWindow(m_hWnd));
03274         ATLASSERT(bstrText == NULL);
03275         TVITEM item;
03276         item.hItem = hItem;
03277         item.mask = TVIF_TEXT;
03278 
03279         LPTSTR lpstrText = NULL;
03280         BOOL bRet = FALSE;
03281         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nLen = 256; ; nLen *= 2)
03282         {
03283             ATLTRY(lpstrText = <font class="keyword">new</font> TCHAR[nLen]);
03284             <font class="keywordflow">if</font>(lpstrText == NULL)
03285                 <font class="keywordflow">break</font>;
03286             lpstrText[0] = NULL;
03287             item.pszText = lpstrText;
03288             item.cchTextMax = nLen;
03289             bRet = (BOOL)::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03290             <font class="keywordflow">if</font>(!bRet || (lstrlen(item.pszText) &lt; nLen - 1))
03291                 <font class="keywordflow">break</font>;
03292             <font class="keyword">delete</font> [] lpstrText;
03293             lpstrText = NULL;
03294         }
03295 
03296         <font class="keywordflow">if</font>(lpstrText != NULL)
03297         {
03298             <font class="keywordflow">if</font>(bRet)
03299                 bstrText = ::SysAllocString(T2OLE(lpstrText));
03300             <font class="keyword">delete</font> [] lpstrText;
03301         }
03302 
03303         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
03304     }
03305 <font class="preprocessor">#endif </font>
03306 <font class="preprocessor"></font>
03307 <font class="preprocessor"></font><font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
03308 <font class="preprocessor"></font>    BOOL GetItemText(HTREEITEM hItem, CString&amp; strText)<font class="keyword"> const</font>
03309 <font class="keyword">    </font>{
03310         ATLASSERT(::IsWindow(m_hWnd));
03311         TVITEM item;
03312         item.hItem = hItem;
03313         item.mask = TVIF_TEXT;
03314 
03315         strText.Empty();
03316         BOOL bRet = FALSE;
03317         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nLen = 256; ; nLen *= 2)
03318         {
03319             item.pszText = strText.GetBufferSetLength(nLen);
03320             <font class="keywordflow">if</font>(item.pszText == NULL)
03321             {
03322                 bRet = FALSE;
03323                 <font class="keywordflow">break</font>;
03324             }
03325             item.cchTextMax = nLen;
03326             bRet = (BOOL)::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03327             <font class="keywordflow">if</font>(!bRet || (lstrlen(item.pszText) &lt; nLen - 1))
03328                 <font class="keywordflow">break</font>;
03329         }
03330         strText.ReleaseBuffer();
03331         <font class="keywordflow">return</font> bRet;
03332     }
03333 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l03334"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a13">03334</a> <font class="preprocessor"></font>    BOOL SetItemText(HTREEITEM hItem, LPCTSTR lpszItem)
03335     {
03336         ATLASSERT(::IsWindow(m_hWnd));
03337         <font class="keywordflow">return</font> SetItem(hItem, TVIF_TEXT, lpszItem, 0, 0, 0, 0, NULL);
03338     }
<a name="l03339"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a14">03339</a>     BOOL GetItemImage(HTREEITEM hItem, <font class="keywordtype">int</font>&amp; nImage, <font class="keywordtype">int</font>&amp; nSelectedImage)<font class="keyword"> const</font>
03340 <font class="keyword">    </font>{
03341         ATLASSERT(::IsWindow(m_hWnd));
03342         TVITEM item;
03343         item.hItem = hItem;
03344         item.mask = TVIF_IMAGE|TVIF_SELECTEDIMAGE;
03345         BOOL bRes = (BOOL)::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03346         <font class="keywordflow">if</font> (bRes)
03347         {
03348             nImage = item.iImage;
03349             nSelectedImage = item.iSelectedImage;
03350         }
03351         <font class="keywordflow">return</font> bRes;
03352     }
<a name="l03353"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a15">03353</a>     BOOL SetItemImage(HTREEITEM hItem, <font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> nSelectedImage)
03354     {
03355         ATLASSERT(::IsWindow(m_hWnd));
03356         <font class="keywordflow">return</font> SetItem(hItem, TVIF_IMAGE|TVIF_SELECTEDIMAGE, NULL, nImage, nSelectedImage, 0, 0, NULL);
03357     }
<a name="l03358"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a16">03358</a>     UINT GetItemState(HTREEITEM hItem, UINT nStateMask)<font class="keyword"> const</font>
03359 <font class="keyword">    </font>{
03360         ATLASSERT(::IsWindow(m_hWnd));
03361         TVITEM item;
03362         item.hItem = hItem;
03363         item.mask = TVIF_STATE;
03364         item.stateMask = nStateMask;
03365         item.state = 0;
03366         ::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03367         <font class="keywordflow">return</font> item.state;
03368     }
<a name="l03369"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a17">03369</a>     BOOL SetItemState(HTREEITEM hItem, UINT nState, UINT nStateMask)
03370     {
03371         ATLASSERT(::IsWindow(m_hWnd));
03372         <font class="keywordflow">return</font> SetItem(hItem, TVIF_STATE, NULL, 0, 0, nState, nStateMask, NULL);
03373     }
<a name="l03374"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a18">03374</a>     <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> <a class="code" href="classWTL_1_1CListBoxT.html#a22">GetItemData</a>(HTREEITEM hItem)<font class="keyword"> const</font>
03375 <font class="keyword">    </font>{
03376         ATLASSERT(::IsWindow(m_hWnd));
03377         TVITEM item;
03378         item.hItem = hItem;
03379         item.mask = TVIF_PARAM;
03380         ::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03381         <font class="keywordflow">return</font> (DWORD_PTR)item.lParam;
03382     }
<a name="l03383"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a19">03383</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a23">SetItemData</a>(HTREEITEM hItem, <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwData)
03384     {
03385         ATLASSERT(::IsWindow(m_hWnd));
03386         <font class="keywordflow">return</font> SetItem(hItem, TVIF_PARAM, NULL, 0, 0, 0, 0, (LPARAM)dwData);
03387     }
<a name="l03388"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a20">03388</a>     CEdit GetEditControl()<font class="keyword"> const</font>
03389 <font class="keyword">    </font>{
03390         ATLASSERT(::IsWindow(m_hWnd));
03391         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a6">CEdit</a>((HWND)::SendMessage(m_hWnd, TVM_GETEDITCONTROL, 0, 0L));
03392     }
<a name="l03393"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a21">03393</a>     UINT GetVisibleCount()<font class="keyword"> const</font>
03394 <font class="keyword">    </font>{
03395         ATLASSERT(::IsWindow(m_hWnd));
03396         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, TVM_GETVISIBLECOUNT, 0, 0L);
03397     }
<a name="l03398"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a22">03398</a>     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a26">GetItemRect</a>(HTREEITEM hItem, LPRECT lpRect, BOOL bTextOnly)<font class="keyword"> const</font>
03399 <font class="keyword">    </font>{
03400         ATLASSERT(::IsWindow(m_hWnd));
03401         *(HTREEITEM*)lpRect = hItem;
03402         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_GETITEMRECT, (WPARAM)bTextOnly, (LPARAM)lpRect);
03403     }
<a name="l03404"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a23">03404</a>     BOOL ItemHasChildren(HTREEITEM hItem)<font class="keyword"> const</font>
03405 <font class="keyword">    </font>{
03406         ATLASSERT(::IsWindow(m_hWnd));
03407         TVITEM item;
03408         item.hItem = hItem;
03409         item.mask = TVIF_CHILDREN;
03410         ::SendMessage(m_hWnd, TVM_GETITEM, 0, (LPARAM)&amp;item);
03411         <font class="keywordflow">return</font> item.cChildren;
03412     }
<a name="l03413"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a24">03413</a>     CToolTipCtrl GetToolTips()<font class="keyword"> const</font>
03414 <font class="keyword">    </font>{
03415         ATLASSERT(::IsWindow(m_hWnd));
03416         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, TVM_GETTOOLTIPS, 0, 0L));
03417     }
<a name="l03418"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a25">03418</a>     CToolTipCtrl SetToolTips(HWND hWndTT)
03419     {
03420         ATLASSERT(::IsWindow(m_hWnd));
03421         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, TVM_SETTOOLTIPS, (WPARAM)hWndTT, 0L));
03422     }
<a name="l03423"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a26">03423</a>     <font class="keywordtype">int</font> GetISearchString(LPTSTR lpstr)<font class="keyword"> const</font>
03424 <font class="keyword">    </font>{
03425         ATLASSERT(::IsWindow(m_hWnd));
03426         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TVM_GETISEARCHSTRING, 0, (LPARAM)lpstr);
03427     }
03428 
03429     <font class="comment">// checkboxes only</font>
<a name="l03430"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a27">03430</a>     BOOL GetCheckState(HTREEITEM hItem)<font class="keyword"> const</font>
03431 <font class="keyword">    </font>{
03432         ATLASSERT(::IsWindow(m_hWnd));
03433         ATLASSERT((GetStyle() &amp; TVS_CHECKBOXES) != 0);
03434         UINT uRet = GetItemState(hItem, TVIS_STATEIMAGEMASK);
03435         <font class="keywordflow">return</font> (uRet &gt;&gt; 12) - 1;
03436     }
<a name="l03437"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a28">03437</a>     BOOL SetCheckState(HTREEITEM hItem, BOOL bCheck)
03438     {
03439         <font class="keywordtype">int</font> nCheck = bCheck ? 2 : 1;    <font class="comment">// one based index</font>
03440         <font class="keywordflow">return</font> SetItemState(hItem, INDEXTOSTATEIMAGEMASK(nCheck), TVIS_STATEIMAGEMASK);
03441     }
03442 
03443 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l03444"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a29">03444</a> <font class="preprocessor"></font>    COLORREF GetBkColor()<font class="keyword"> const</font>
03445 <font class="keyword">    </font>{
03446         ATLASSERT(::IsWindow(m_hWnd));
03447         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_GETBKCOLOR, 0, 0L);
03448     }
<a name="l03449"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a30">03449</a>     COLORREF SetBkColor(COLORREF clr)
03450     {
03451         ATLASSERT(::IsWindow(m_hWnd));
03452         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_SETBKCOLOR, 0, (LPARAM)clr);
03453     }
<a name="l03454"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a31">03454</a>     COLORREF GetInsertMarkColor()<font class="keyword"> const</font>
03455 <font class="keyword">    </font>{
03456         ATLASSERT(::IsWindow(m_hWnd));
03457         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_GETINSERTMARKCOLOR, 0, 0L);
03458     }
<a name="l03459"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a32">03459</a>     COLORREF SetInsertMarkColor(COLORREF clr)
03460     {
03461         ATLASSERT(::IsWindow(m_hWnd));
03462         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_SETINSERTMARKCOLOR, 0, (LPARAM)clr);
03463     }
<a name="l03464"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a33">03464</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a29">GetItemHeight</a>()<font class="keyword"> const</font>
03465 <font class="keyword">    </font>{
03466         ATLASSERT(::IsWindow(m_hWnd));
03467         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TVM_GETITEMHEIGHT, 0, 0L);
03468     }
<a name="l03469"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a34">03469</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CListBoxT.html#a30">SetItemHeight</a>(<font class="keywordtype">int</font> cyHeight)
03470     {
03471         ATLASSERT(::IsWindow(m_hWnd));
03472         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TVM_SETITEMHEIGHT, cyHeight, 0L);
03473     }
<a name="l03474"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a35">03474</a>     <font class="keywordtype">int</font> GetScrollTime()<font class="keyword"> const</font>
03475 <font class="keyword">    </font>{
03476         ATLASSERT(::IsWindow(m_hWnd));
03477         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TVM_GETSCROLLTIME, 0, 0L);
03478     }
<a name="l03479"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a36">03479</a>     <font class="keywordtype">int</font> SetScrollTime(<font class="keywordtype">int</font> nScrollTime)
03480     {
03481         ATLASSERT(::IsWindow(m_hWnd));
03482         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TVM_SETSCROLLTIME, nScrollTime, 0L);
03483     }
<a name="l03484"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a37">03484</a>     COLORREF GetTextColor()<font class="keyword"> const</font>
03485 <font class="keyword">    </font>{
03486         ATLASSERT(::IsWindow(m_hWnd));
03487         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_GETTEXTCOLOR, 0, 0L);
03488     }
<a name="l03489"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a38">03489</a>     COLORREF SetTextColor(COLORREF clr)
03490     {
03491         ATLASSERT(::IsWindow(m_hWnd));
03492         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_SETTEXTCOLOR, 0, (LPARAM)clr);
03493     }
<a name="l03494"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a39">03494</a>     BOOL GetUnicodeFormat()<font class="keyword"> const</font>
03495 <font class="keyword">    </font>{
03496         ATLASSERT(::IsWindow(m_hWnd));
03497         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_GETUNICODEFORMAT, 0, 0L);
03498     }
<a name="l03499"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a40">03499</a>     BOOL SetUnicodeFormat(BOOL bUnicode = TRUE)
03500     {
03501         ATLASSERT(::IsWindow(m_hWnd));
03502         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SETUNICODEFORMAT, bUnicode, 0L);
03503     }
03504 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
03505 <font class="preprocessor"></font>
03506 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l03507"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a41">03507</a> <font class="preprocessor"></font>    COLORREF GetLineColor()<font class="keyword"> const</font>
03508 <font class="keyword">    </font>{
03509         ATLASSERT(::IsWindow(m_hWnd));
03510         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_GETLINECOLOR, 0, 0L);
03511     }
<a name="l03512"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a42">03512</a>     COLORREF SetLineColor(COLORREF clrNew <font class="comment">/*= CLR_DEFAULT*/</font>)
03513     {
03514         ATLASSERT(::IsWindow(m_hWnd));
03515         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TVM_SETLINECOLOR, 0, (LPARAM)clrNew);
03516     }
03517 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
03518 <font class="preprocessor"></font>
03519 <font class="comment">// Operations</font>
<a name="l03520"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a43">03520</a>     HTREEITEM InsertItem(LPTV_INSERTSTRUCT lpInsertStruct)
03521     {
03522         ATLASSERT(::IsWindow(m_hWnd));
03523         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_INSERTITEM, 0, (LPARAM)lpInsertStruct);
03524     }
<a name="l03525"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a44">03525</a>     HTREEITEM InsertItem(LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage,
03526         <font class="keywordtype">int</font> nSelectedImage, HTREEITEM hParent, HTREEITEM hInsertAfter)
03527     {
03528         ATLASSERT(::IsWindow(m_hWnd));
03529         <font class="keywordflow">return</font> InsertItem(TVIF_TEXT | TVIF_IMAGE | TVIF_SELECTEDIMAGE, lpszItem, nImage, nSelectedImage, 0, 0, 0, hParent, hInsertAfter); 
03530     }
<a name="l03531"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a45">03531</a>     HTREEITEM InsertItem(LPCTSTR lpszItem, HTREEITEM hParent, HTREEITEM hInsertAfter)
03532     { 
03533         ATLASSERT(::IsWindow(m_hWnd));
03534         <font class="keywordflow">return</font> InsertItem(TVIF_TEXT, lpszItem, 0, 0, 0, 0, 0, hParent, hInsertAfter);
03535     }
<a name="l03536"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a46">03536</a>     HTREEITEM InsertItem(UINT nMask, LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage,
03537         <font class="keywordtype">int</font> nSelectedImage, UINT nState, UINT nStateMask, LPARAM lParam,
03538         HTREEITEM hParent, HTREEITEM hInsertAfter)
03539     {
03540         ATLASSERT(::IsWindow(m_hWnd));
03541         TV_INSERTSTRUCT tvis;
03542         tvis.hParent = hParent;
03543         tvis.hInsertAfter = hInsertAfter;
03544         tvis.item.mask = nMask;
03545         tvis.item.pszText = (LPTSTR) lpszItem;
03546         tvis.item.iImage = nImage;
03547         tvis.item.iSelectedImage = nSelectedImage;
03548         tvis.item.state = nState;
03549         tvis.item.stateMask = nStateMask;
03550         tvis.item.lParam = lParam;
03551         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_INSERTITEM, 0, (LPARAM)&amp;tvis);
03552     }
<a name="l03553"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a47">03553</a>     BOOL DeleteItem(HTREEITEM hItem)
03554     {
03555         ATLASSERT(::IsWindow(m_hWnd));
03556         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_DELETEITEM, 0, (LPARAM)hItem);
03557     }
<a name="l03558"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a48">03558</a>     BOOL DeleteAllItems()
03559     {
03560         ATLASSERT(::IsWindow(m_hWnd));
03561         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_DELETEITEM, 0, (LPARAM)TVI_ROOT);
03562     }
<a name="l03563"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a49">03563</a>     BOOL Expand(HTREEITEM hItem, UINT nCode = TVE_EXPAND)
03564     {
03565         ATLASSERT(::IsWindow(m_hWnd));
03566         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_EXPAND, nCode, (LPARAM)hItem);
03567     }
<a name="l03568"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a50">03568</a>     HTREEITEM GetNextItem(HTREEITEM hItem, UINT nCode)<font class="keyword"> const</font>
03569 <font class="keyword">    </font>{ 
03570         ATLASSERT(::IsWindow(m_hWnd)); 
03571         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, nCode, (LPARAM)hItem);
03572     }
<a name="l03573"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a51">03573</a>     HTREEITEM GetChildItem(HTREEITEM hItem)<font class="keyword"> const</font>
03574 <font class="keyword">    </font>{
03575         ATLASSERT(::IsWindow(m_hWnd)); 
03576         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_CHILD, (LPARAM)hItem);
03577     }
<a name="l03578"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a52">03578</a>     HTREEITEM GetNextSiblingItem(HTREEITEM hItem)<font class="keyword"> const</font>
03579 <font class="keyword">    </font>{
03580         ATLASSERT(::IsWindow(m_hWnd)); 
03581         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_NEXT, (LPARAM)hItem); 
03582     }
<a name="l03583"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a53">03583</a>     HTREEITEM GetPrevSiblingItem(HTREEITEM hItem)<font class="keyword"> const</font>
03584 <font class="keyword">    </font>{
03585         ATLASSERT(::IsWindow(m_hWnd)); 
03586         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_PREVIOUS, (LPARAM)hItem);
03587     }
<a name="l03588"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a54">03588</a>     HTREEITEM GetParentItem(HTREEITEM hItem)<font class="keyword"> const</font>
03589 <font class="keyword">    </font>{
03590         ATLASSERT(::IsWindow(m_hWnd)); 
03591         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_PARENT, (LPARAM)hItem); 
03592     }
<a name="l03593"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a55">03593</a>     HTREEITEM GetFirstVisibleItem()<font class="keyword"> const</font>
03594 <font class="keyword">    </font>{
03595         ATLASSERT(::IsWindow(m_hWnd)); 
03596         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_FIRSTVISIBLE, 0L);
03597     }
<a name="l03598"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a56">03598</a>     HTREEITEM GetNextVisibleItem(HTREEITEM hItem)<font class="keyword"> const</font>
03599 <font class="keyword">    </font>{
03600         ATLASSERT(::IsWindow(m_hWnd));
03601         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_NEXTVISIBLE, (LPARAM)hItem);
03602     }
<a name="l03603"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a57">03603</a>     HTREEITEM GetPrevVisibleItem(HTREEITEM hItem)<font class="keyword"> const</font>
03604 <font class="keyword">    </font>{
03605         ATLASSERT(::IsWindow(m_hWnd));
03606         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_PREVIOUSVISIBLE, (LPARAM)hItem);
03607     }
<a name="l03608"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a58">03608</a>     HTREEITEM GetSelectedItem()<font class="keyword"> const</font>
03609 <font class="keyword">    </font>{
03610         ATLASSERT(::IsWindow(m_hWnd));
03611         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_CARET, 0L);
03612     }
<a name="l03613"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a59">03613</a>     HTREEITEM GetDropHilightItem()<font class="keyword"> const</font>
03614 <font class="keyword">    </font>{
03615         ATLASSERT(::IsWindow(m_hWnd));
03616         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_DROPHILITE, 0L);
03617     }
<a name="l03618"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a60">03618</a>     HTREEITEM GetRootItem()<font class="keyword"> const</font>
03619 <font class="keyword">    </font>{
03620         ATLASSERT(::IsWindow(m_hWnd));
03621         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_ROOT, 0L);
03622     }
<a name="l03623"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a61">03623</a>     BOOL Select(HTREEITEM hItem, UINT nCode)
03624     {
03625         ATLASSERT(::IsWindow(m_hWnd));
03626         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SELECTITEM, nCode, (LPARAM)hItem);
03627     }
<a name="l03628"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a62">03628</a>     BOOL SelectItem(HTREEITEM hItem)
03629     {
03630         ATLASSERT(::IsWindow(m_hWnd));
03631         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SELECTITEM, TVGN_CARET, (LPARAM)hItem);
03632     }
<a name="l03633"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a63">03633</a>     BOOL SelectDropTarget(HTREEITEM hItem)
03634     {
03635         ATLASSERT(::IsWindow(m_hWnd));
03636         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SELECTITEM, TVGN_DROPHILITE, (LPARAM)hItem);
03637     }
<a name="l03638"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a64">03638</a>     BOOL SelectSetFirstVisible(HTREEITEM hItem)
03639     {
03640         ATLASSERT(::IsWindow(m_hWnd));
03641         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SELECTITEM, TVGN_FIRSTVISIBLE, (LPARAM)hItem);
03642     }
<a name="l03643"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a65">03643</a>     CEdit EditLabel(HTREEITEM hItem)
03644     {
03645         ATLASSERT(::IsWindow(m_hWnd));
03646         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a6">CEdit</a>((HWND)::SendMessage(m_hWnd, TVM_EDITLABEL, 0, (LPARAM)hItem));
03647     }
<a name="l03648"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a66">03648</a>     BOOL EndEditLabelNow(BOOL bCancel)
03649     {
03650         ATLASSERT(::IsWindow(m_hWnd));
03651         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_ENDEDITLABELNOW, bCancel, 0L);
03652     }
<a name="l03653"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a67">03653</a>     HTREEITEM HitTest(TV_HITTESTINFO* pHitTestInfo)
03654     {
03655         ATLASSERT(::IsWindow(m_hWnd));
03656         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_HITTEST, 0, (LPARAM)pHitTestInfo);
03657     }
<a name="l03658"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a68">03658</a>     HTREEITEM HitTest(POINT pt, UINT* pFlags)
03659     {
03660         ATLASSERT(::IsWindow(m_hWnd));
03661         TV_HITTESTINFO hti;
03662         hti.pt = pt;
03663         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_HITTEST, 0, (LPARAM)&amp;hti);
03664         <font class="keywordflow">if</font> (pFlags != NULL)
03665             *pFlags = hti.flags;
03666         <font class="keywordflow">return</font> hTreeItem;
03667     }
<a name="l03668"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a69">03668</a>     BOOL SortChildren(HTREEITEM hItem)
03669     {
03670         ATLASSERT(::IsWindow(m_hWnd));
03671         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SORTCHILDREN, 0, (LPARAM)hItem);
03672     }
<a name="l03673"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a70">03673</a>     BOOL EnsureVisible(HTREEITEM hItem)
03674     {
03675         ATLASSERT(::IsWindow(m_hWnd));
03676         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_ENSUREVISIBLE, 0, (LPARAM)hItem);
03677     }
<a name="l03678"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a71">03678</a>     BOOL SortChildrenCB(LPTV_SORTCB pSort)
03679     {
03680         ATLASSERT(::IsWindow(m_hWnd));
03681         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SORTCHILDRENCB, 0, (LPARAM)pSort);
03682     }
<a name="l03683"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a72">03683</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> RemoveImageList(<font class="keywordtype">int</font> nImageList)
03684     {
03685         ATLASSERT(::IsWindow(m_hWnd));
03686         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TVM_SETIMAGELIST, (WPARAM)nImageList, NULL));
03687     }
<a name="l03688"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a73">03688</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> CreateDragImage(HTREEITEM hItem)
03689     {
03690         ATLASSERT(::IsWindow(m_hWnd));
03691         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TVM_CREATEDRAGIMAGE, 0, (LPARAM)hItem));
03692     }
03693 
03694 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l03695"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a74">03695</a> <font class="preprocessor"></font>    BOOL SetInsertMark(HTREEITEM hTreeItem, BOOL bAfter)
03696     {
03697         ATLASSERT(::IsWindow(m_hWnd));
03698         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SETINSERTMARK, bAfter, (LPARAM)hTreeItem);
03699     }
<a name="l03700"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a75">03700</a>     BOOL RemoveInsertMark()
03701     {
03702         ATLASSERT(::IsWindow(m_hWnd));
03703         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TVM_SETINSERTMARK, 0, 0L);
03704     }
03705 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
03706 <font class="preprocessor"></font>
03707 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l03708"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a76">03708</a> <font class="preprocessor"></font>    HTREEITEM MapAccIDToHTREEITEM(UINT uID)<font class="keyword"> const</font>
03709 <font class="keyword">    </font>{
03710         ATLASSERT(::IsWindow(m_hWnd));
03711         <font class="keywordflow">return</font> (HTREEITEM)::SendMessage(m_hWnd, TVM_MAPACCIDTOHTREEITEM, uID, 0L);
03712     }
<a name="l03713"></a><a class="code" href="classWTL_1_1CTreeViewCtrlT.html#a77">03713</a>     UINT MapHTREEITEMToAccID(HTREEITEM hTreeItem)<font class="keyword"> const</font>
03714 <font class="keyword">    </font>{
03715         ATLASSERT(::IsWindow(m_hWnd));
03716         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, TVM_MAPHTREEITEMTOACCID, (WPARAM)hTreeItem, 0L);
03717     }
03718 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
03719 <font class="preprocessor"></font>};
03720 
<a name="l03721"></a><a class="code" href="namespaceWTL.html#a11">03721</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CTreeViewCtrlT.html">CTreeViewCtrlT&lt;CWindow&gt;</a>     <a class="code" href="namespaceWTL.html#a11">CTreeViewCtrl</a>;
03722 
03723 
03725 <font class="comment">// CTreeViewCtrlEx</font>
03726 
03727 <font class="comment">// forward declarations</font>
03728 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt; <font class="keyword">class </font><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html">CTreeViewCtrlExT</a>;
<a name="l03729"></a><a class="code" href="namespaceWTL.html#a12">03729</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CTreeViewCtrlExT.html">CTreeViewCtrlExT&lt;CWindow&gt;</a> <a class="code" href="namespaceWTL.html#a12">CTreeViewCtrlEx</a>;
03730 
<a name="l03731"></a><a class="code" href="classWTL_1_1CTreeItem.html">03731</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>
03732 {
03733 <font class="keyword">public</font>:
<a name="l03734"></a><a class="code" href="classWTL_1_1CTreeItem.html#m0">03734</a>     HTREEITEM m_hTreeItem;
<a name="l03735"></a><a class="code" href="classWTL_1_1CTreeItem.html#m1">03735</a>     CTreeViewCtrlEx* m_pTreeView;
03736 
03737 <font class="comment">// Construction</font>
<a name="l03738"></a><a class="code" href="classWTL_1_1CTreeItem.html#a0">03738</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(HTREEITEM hTreeItem = NULL, CTreeViewCtrlEx* pTreeView = NULL) : m_hTreeItem(hTreeItem), m_pTreeView(pTreeView)
03739     { }
03740  
<a name="l03741"></a><a class="code" href="classWTL_1_1CTreeItem.html#a1">03741</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(<font class="keyword">const</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>&amp; posSrc)
03742     {
03743         *<font class="keyword">this</font> = posSrc;
03744     }
03745 
<a name="l03746"></a><a class="code" href="classWTL_1_1CTreeItem.html#a2">03746</a>     operator HTREEITEM() { <font class="keywordflow">return</font> m_hTreeItem; }
03747 
<a name="l03748"></a><a class="code" href="classWTL_1_1CTreeItem.html#a3">03748</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator =</a>(<font class="keyword">const</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>&amp; itemSrc)
03749     {
03750         m_hTreeItem = itemSrc.<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>;
03751         m_pTreeView = itemSrc.<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>;
03752         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
03753     }
03754 
03755 <font class="comment">// Attributes</font>
<a name="l03756"></a><a class="code" href="classWTL_1_1CTreeItem.html#a4">03756</a>     CTreeViewCtrlEx* GetTreeView()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_pTreeView; }
03757 
<a name="l03758"></a><a class="code" href="classWTL_1_1CTreeItem.html#a5">03758</a>     BOOL operator !()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_hTreeItem == NULL; }
<a name="l03759"></a><a class="code" href="classWTL_1_1CTreeItem.html#a6">03759</a>     BOOL IsNull()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_hTreeItem == NULL; }
03760     
03761     BOOL GetRect(LPRECT lpRect, BOOL bTextOnly) <font class="keyword">const</font>;
03762     BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(LPTSTR lpstrText, <font class="keywordtype">int</font> nLen) <font class="keyword">const</font>;
03763 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
03764 <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(BSTR&amp; bstrText) <font class="keyword">const</font>;
03765 <font class="preprocessor">#endif </font>
03766 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
03767 <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CListBoxT.html#a27">GetText</a>(CString&amp; strText) <font class="keyword">const</font>;
03768 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
03769 <font class="preprocessor"></font>    BOOL SetText(LPCTSTR lpszItem);
03770     BOOL GetImage(<font class="keywordtype">int</font>&amp; nImage, <font class="keywordtype">int</font>&amp; nSelectedImage) <font class="keyword">const</font>;
03771     BOOL SetImage(<font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> nSelectedImage);
03772     UINT GetState(UINT nStateMask) <font class="keyword">const</font>;
03773     BOOL SetState(UINT nState, UINT nStateMask);
03774     <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> GetData() <font class="keyword">const</font>;
03775     BOOL SetData(<a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwData);
03776     BOOL SetItem(UINT nMask, LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> nSelectedImage, UINT nState, UINT nStateMask, LPARAM lParam);
03777 
03778 <font class="comment">// Operations</font>
<a name="l03779"></a><a class="code" href="classWTL_1_1CTreeItem.html#a18">03779</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> InsertAfter(LPCTSTR lpstrItem, HTREEITEM hItemAfter, <font class="keywordtype">int</font> nImageIndex)
03780     {
03781         <font class="keywordflow">return</font> _Insert(lpstrItem, nImageIndex, hItemAfter);
03782     }
<a name="l03783"></a><a class="code" href="classWTL_1_1CTreeItem.html#a19">03783</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> AddHead(LPCTSTR lpstrItem, <font class="keywordtype">int</font> nImageIndex)
03784     {
03785         <font class="keywordflow">return</font> _Insert(lpstrItem, nImageIndex, TVI_FIRST);
03786     }
<a name="l03787"></a><a class="code" href="classWTL_1_1CTreeItem.html#a20">03787</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> AddTail(LPCTSTR lpstrItem, <font class="keywordtype">int</font> nImageIndex)
03788     {
03789         <font class="keywordflow">return</font> _Insert(lpstrItem, nImageIndex, TVI_LAST);
03790     }
03791 
03792     CTreeItem GetChild() <font class="keyword">const</font>;
03793     CTreeItem GetNext(UINT nCode) <font class="keyword">const</font>;
03794     CTreeItem GetNextSibling() <font class="keyword">const</font>;
03795     CTreeItem GetPrevSibling() <font class="keyword">const</font>;
03796     CTreeItem GetParent() <font class="keyword">const</font>;
03797     CTreeItem GetFirstVisible() <font class="keyword">const</font>;
03798     CTreeItem GetNextVisible() <font class="keyword">const</font>;
03799     CTreeItem GetPrevVisible() <font class="keyword">const</font>;
03800     CTreeItem GetSelected() <font class="keyword">const</font>;
03801     CTreeItem GetDropHilight() <font class="keyword">const</font>;
03802     CTreeItem GetRoot() <font class="keyword">const</font>;
03803     BOOL HasChildren() <font class="keyword">const</font>;
03804     BOOL Delete();
03805     BOOL Expand(UINT nCode = TVE_EXPAND);
03806     BOOL Select(UINT nCode);
03807     BOOL Select();
03808     BOOL SelectDropTarget();
03809     BOOL SelectSetFirstVisible();
03810     HWND EditLabel();
03811     HIMAGELIST CreateDragImage();
03812     BOOL SortChildren();
03813     BOOL EnsureVisible();
03814 
03815     CTreeItem _Insert(LPCTSTR lpstrItem, <font class="keywordtype">int</font> nImageIndex, HTREEITEM hItemAfter);
03816     <font class="keywordtype">int</font> GetImageIndex() <font class="keyword">const</font>;
03817 
03818 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
03819 <font class="preprocessor"></font>    BOOL SetInsertMark(BOOL bAfter);
03820 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
03821 <font class="preprocessor"></font>
03822 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
03823 <font class="preprocessor"></font>    UINT MapHTREEITEMToAccID() <font class="keyword">const</font>;
03824 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
03825 <font class="preprocessor"></font>};
03826 
03827 
03828 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l03829"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html">03829</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html">CTreeViewCtrlExT</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CTreeViewCtrlT.html">CTreeViewCtrlT</a>&lt; TBase &gt;
03830 {
03831 <font class="keyword">public</font>:
03832 <font class="comment">// Constructors</font>
<a name="l03833"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a0">03833</a>     <a class="code" href="classWTL_1_1CTreeViewCtrlExT.html">CTreeViewCtrlExT</a>(HWND hWnd = NULL) : <a class="code" href="classWTL_1_1CTreeViewCtrlT.html">CTreeViewCtrlT</a>&lt; TBase &gt;(hWnd) { }
03834 
<a name="l03835"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a1">03835</a>     <a class="code" href="classWTL_1_1CTreeViewCtrlExT.html">CTreeViewCtrlExT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CListBoxT.html#a1">operator=</a>(HWND hWnd)
03836     {
03837         m_hWnd = hWnd;
03838         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
03839     }
03840 
03841 <font class="comment">// Operations (overides that return CTreeItem)</font>
<a name="l03842"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a2">03842</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> InsertItem(LPTV_INSERTSTRUCT lpInsertStruct)
03843     {
03844         ATLASSERT(::IsWindow(m_hWnd));
03845         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_INSERTITEM, 0, (LPARAM)lpInsertStruct);
03846         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03847     }
<a name="l03848"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a3">03848</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> InsertItem(LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage,
03849         <font class="keywordtype">int</font> nSelectedImage, HTREEITEM hParent, HTREEITEM hInsertAfter)
03850     {
03851         ATLASSERT(::IsWindow(m_hWnd));
03852         <font class="keywordflow">return</font> InsertItem(TVIF_TEXT | TVIF_IMAGE | TVIF_SELECTEDIMAGE, lpszItem, nImage, nSelectedImage, 0, 0, 0, hParent, hInsertAfter); 
03853     }
<a name="l03854"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a4">03854</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> InsertItem(LPCTSTR lpszItem, HTREEITEM hParent, HTREEITEM hInsertAfter)
03855     { 
03856         ATLASSERT(::IsWindow(m_hWnd));
03857         <font class="keywordflow">return</font> InsertItem(TVIF_TEXT, lpszItem, 0, 0, 0, 0, 0, hParent, hInsertAfter);
03858     }
<a name="l03859"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a5">03859</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetNextItem(HTREEITEM hItem, UINT nCode)
03860     { 
03861         ATLASSERT(::IsWindow(m_hWnd)); 
03862         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, nCode, (LPARAM)hItem);
03863         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03864     }
<a name="l03865"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a6">03865</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetChildItem(HTREEITEM hItem)
03866     {
03867         ATLASSERT(::IsWindow(m_hWnd)); 
03868         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_CHILD, (LPARAM)hItem);
03869         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>); 
03870     }
<a name="l03871"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a7">03871</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetNextSiblingItem(HTREEITEM hItem)
03872     {
03873         ATLASSERT(::IsWindow(m_hWnd)); 
03874         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_NEXT, (LPARAM)hItem); 
03875         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03876     }
<a name="l03877"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a8">03877</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetPrevSiblingItem(HTREEITEM hItem)
03878     {
03879         ATLASSERT(::IsWindow(m_hWnd)); 
03880         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_PREVIOUS, (LPARAM)hItem);
03881         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03882     }
<a name="l03883"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a9">03883</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetParentItem(HTREEITEM hItem)
03884     {
03885         ATLASSERT(::IsWindow(m_hWnd)); 
03886         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_PARENT, (LPARAM)hItem); 
03887         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03888     }
<a name="l03889"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a10">03889</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetFirstVisibleItem()
03890     {
03891         ATLASSERT(::IsWindow(m_hWnd)); 
03892         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_FIRSTVISIBLE, 0L);
03893         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03894     }
<a name="l03895"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a11">03895</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetNextVisibleItem(HTREEITEM hItem)
03896     {
03897         ATLASSERT(::IsWindow(m_hWnd));
03898         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_NEXTVISIBLE, (LPARAM)hItem);
03899         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03900     }
<a name="l03901"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a12">03901</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetPrevVisibleItem(HTREEITEM hItem)
03902     {
03903         ATLASSERT(::IsWindow(m_hWnd));
03904         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_PREVIOUSVISIBLE, (LPARAM)hItem);
03905         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03906     }
<a name="l03907"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a13">03907</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetSelectedItem()
03908     {
03909         ATLASSERT(::IsWindow(m_hWnd));
03910         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_CARET, 0L);
03911         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03912     }
<a name="l03913"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a14">03913</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetDropHilightItem()
03914     {
03915         ATLASSERT(::IsWindow(m_hWnd));
03916         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_DROPHILITE, 0L);
03917         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03918     }
<a name="l03919"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a15">03919</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> GetRootItem()
03920     {
03921         ATLASSERT(::IsWindow(m_hWnd));
03922         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_GETNEXTITEM, TVGN_ROOT, 0L);
03923         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03924     }
<a name="l03925"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a16">03925</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> HitTest(TV_HITTESTINFO* pHitTestInfo)
03926     {
03927         ATLASSERT(::IsWindow(m_hWnd));
03928         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_HITTEST, 0, (LPARAM)pHitTestInfo);
03929         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03930     }
03931 
<a name="l03932"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a17">03932</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> InsertItem(UINT nMask, LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage,
03933         <font class="keywordtype">int</font> nSelectedImage, UINT nState, UINT nStateMask, LPARAM lParam,
03934         HTREEITEM hParent, HTREEITEM hInsertAfter)
03935     {
03936         ATLASSERT(::IsWindow(m_hWnd));
03937         TV_INSERTSTRUCT tvis;
03938         tvis.hParent = hParent;
03939         tvis.hInsertAfter = hInsertAfter;
03940         tvis.item.mask = nMask;
03941         tvis.item.pszText = (LPTSTR) lpszItem;
03942         tvis.item.iImage = nImage;
03943         tvis.item.iSelectedImage = nSelectedImage;
03944         tvis.item.state = nState;
03945         tvis.item.stateMask = nStateMask;
03946         tvis.item.lParam = lParam;
03947         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_INSERTITEM, 0, (LPARAM)&amp;tvis);
03948         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03949     }
03950 
<a name="l03951"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a18">03951</a>     <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> HitTest(POINT pt, UINT* pFlags)
03952     {
03953         ATLASSERT(::IsWindow(m_hWnd));
03954         TV_HITTESTINFO hti;
03955         hti.pt = pt;
03956         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_HITTEST, 0, (LPARAM)&amp;hti);
03957         <font class="keywordflow">if</font> (pFlags != NULL)
03958             *pFlags = hti.flags;
03959         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, <font class="keyword">this</font>);
03960     }
03961 
03962 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l03963"></a><a class="code" href="classWTL_1_1CTreeViewCtrlExT.html#a19">03963</a> <font class="preprocessor"></font>    <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> MapAccIDToHTREEITEM(UINT uID)<font class="keyword"> const</font>
03964 <font class="keyword">    </font>{
03965         ATLASSERT(::IsWindow(m_hWnd));
03966         HTREEITEM hTreeItem = (HTREEITEM)::SendMessage(m_hWnd, TVM_MAPACCIDTOHTREEITEM, uID, 0L);
03967         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a>(hTreeItem, (CTreeViewCtrlEx*)<font class="keyword">this</font>);
03968     }
03969 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
03970 <font class="preprocessor"></font>};
03971 
03972 
03973 <font class="comment">// CTreeItem inline methods</font>
<a name="l03974"></a><a class="code" href="classWTL_1_1CTreeItem.html#a7">03974</a> <font class="keyword">inline</font> BOOL CTreeItem::GetRect(LPRECT lpRect, BOOL bTextOnly)<font class="keyword"> const</font>
03975 <font class="keyword"></font>{
03976     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
03977     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemRect(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,lpRect,bTextOnly);
03978 }
<a name="l03979"></a><a class="code" href="classWTL_1_1CTreeItem.html#a22">03979</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetNext(UINT nCode)<font class="keyword"> const</font>
03980 <font class="keyword"></font>{
03981     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
03982     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetNextItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nCode);
03983 }
<a name="l03984"></a><a class="code" href="classWTL_1_1CTreeItem.html#a21">03984</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetChild()<font class="keyword"> const</font>
03985 <font class="keyword"></font>{
03986     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
03987     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetChildItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
03988 }
<a name="l03989"></a><a class="code" href="classWTL_1_1CTreeItem.html#a23">03989</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetNextSibling()<font class="keyword"> const</font>
03990 <font class="keyword"></font>{
03991     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
03992     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetNextSiblingItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
03993 }
<a name="l03994"></a><a class="code" href="classWTL_1_1CTreeItem.html#a24">03994</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetPrevSibling()<font class="keyword"> const</font>
03995 <font class="keyword"></font>{
03996     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
03997     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetPrevSiblingItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
03998 }
<a name="l03999"></a><a class="code" href="classWTL_1_1CTreeItem.html#a25">03999</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetParent()<font class="keyword"> const</font>
04000 <font class="keyword"></font>{
04001     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04002     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetParentItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04003 }
<a name="l04004"></a><a class="code" href="classWTL_1_1CTreeItem.html#a26">04004</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetFirstVisible()<font class="keyword"> const</font>
04005 <font class="keyword"></font>{
04006     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04007     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetFirstVisibleItem();
04008 }
<a name="l04009"></a><a class="code" href="classWTL_1_1CTreeItem.html#a27">04009</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetNextVisible()<font class="keyword"> const</font>
04010 <font class="keyword"></font>{
04011     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04012     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetNextVisibleItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04013 }
<a name="l04014"></a><a class="code" href="classWTL_1_1CTreeItem.html#a28">04014</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetPrevVisible()<font class="keyword"> const</font>
04015 <font class="keyword"></font>{
04016     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04017     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetPrevVisibleItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04018 }
<a name="l04019"></a><a class="code" href="classWTL_1_1CTreeItem.html#a29">04019</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetSelected()<font class="keyword"> const</font>
04020 <font class="keyword"></font>{
04021     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04022     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetSelectedItem();
04023 }
<a name="l04024"></a><a class="code" href="classWTL_1_1CTreeItem.html#a30">04024</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetDropHilight()<font class="keyword"> const</font>
04025 <font class="keyword"></font>{
04026     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04027     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetDropHilightItem();
04028 }
<a name="l04029"></a><a class="code" href="classWTL_1_1CTreeItem.html#a31">04029</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::GetRoot()<font class="keyword"> const</font>
04030 <font class="keyword"></font>{
04031     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04032     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetRootItem();
04033 }
<a name="l04034"></a><a class="code" href="classWTL_1_1CTreeItem.html#a8">04034</a> <font class="keyword">inline</font> BOOL CTreeItem::GetText(LPTSTR lpstrText, <font class="keywordtype">int</font> nLen)<font class="keyword"> const</font>
04035 <font class="keyword"></font>{
04036     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04037     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemText(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>, lpstrText, nLen);
04038 }
04039 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
04040 <font class="preprocessor"></font><font class="preprocessor">#ifdef _OLEAUTO_H_</font>
04041 <font class="preprocessor"></font><font class="keyword">inline</font> BOOL CTreeItem::GetText(BSTR&amp; bstrText)<font class="keyword"> const</font>
04042 <font class="keyword"></font>{
04043     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04044     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemText(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>, bstrText);
04045 }
04046 <font class="preprocessor">#endif // _OLEAUTO_H_</font>
04047 <font class="preprocessor"></font><font class="preprocessor">#endif </font>
04048 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
04049 <font class="preprocessor"></font><font class="keyword">inline</font> BOOL CTreeItem::GetText(CString&amp; strText)<font class="keyword"> const</font>
04050 <font class="keyword"></font>{
04051     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04052     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemText(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>, strText);
04053 }
04054 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l04055"></a><a class="code" href="classWTL_1_1CTreeItem.html#a11">04055</a> <font class="preprocessor"></font><font class="keyword">inline</font> BOOL CTreeItem::GetImage(<font class="keywordtype">int</font>&amp; nImage, <font class="keywordtype">int</font>&amp; nSelectedImage)<font class="keyword"> const</font>
04056 <font class="keyword"></font>{
04057     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04058     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemImage(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nImage,nSelectedImage);
04059 }
<a name="l04060"></a><a class="code" href="classWTL_1_1CTreeItem.html#a13">04060</a> <font class="keyword">inline</font> UINT CTreeItem::GetState(UINT nStateMask)<font class="keyword"> const</font>
04061 <font class="keyword"></font>{
04062     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04063     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemState(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nStateMask);
04064 }
<a name="l04065"></a><a class="code" href="classWTL_1_1CTreeItem.html#a15">04065</a> <font class="keyword">inline</font> <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> CTreeItem::GetData()<font class="keyword"> const</font>
04066 <font class="keyword"></font>{
04067     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04068     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItemData(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04069 }
<a name="l04070"></a><a class="code" href="classWTL_1_1CTreeItem.html#a17">04070</a> <font class="keyword">inline</font> BOOL CTreeItem::SetItem(UINT nMask, LPCTSTR lpszItem, <font class="keywordtype">int</font> nImage,
04071         <font class="keywordtype">int</font> nSelectedImage, UINT nState, UINT nStateMask, LPARAM lParam)
04072 {
04073     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04074     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SetItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>, nMask, lpszItem, nImage, nSelectedImage, nState, nStateMask, lParam);
04075 }
<a name="l04076"></a><a class="code" href="classWTL_1_1CTreeItem.html#a10">04076</a> <font class="keyword">inline</font> BOOL CTreeItem::SetText(LPCTSTR lpszItem)
04077 {
04078     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04079     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SetItemText(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,lpszItem);
04080 }
<a name="l04081"></a><a class="code" href="classWTL_1_1CTreeItem.html#a12">04081</a> <font class="keyword">inline</font> BOOL CTreeItem::SetImage(<font class="keywordtype">int</font> nImage, <font class="keywordtype">int</font> nSelectedImage)
04082 {
04083     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04084     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SetItemImage(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nImage,nSelectedImage);
04085 }
<a name="l04086"></a><a class="code" href="classWTL_1_1CTreeItem.html#a14">04086</a> <font class="keyword">inline</font> BOOL CTreeItem::SetState(UINT nState, UINT nStateMask)
04087 {
04088     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04089     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SetItemState(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nState,nStateMask);
04090 }
<a name="l04091"></a><a class="code" href="classWTL_1_1CTreeItem.html#a16">04091</a> <font class="keyword">inline</font> BOOL CTreeItem::SetData(<a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwData)
04092 {
04093     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04094     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SetItemData(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,dwData);
04095 }
<a name="l04096"></a><a class="code" href="classWTL_1_1CTreeItem.html#a32">04096</a> <font class="keyword">inline</font> BOOL CTreeItem::HasChildren()<font class="keyword"> const</font>
04097 <font class="keyword"></font>{
04098     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04099     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;ItemHasChildren(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04100 }
<a name="l04101"></a><a class="code" href="classWTL_1_1CTreeItem.html#a33">04101</a> <font class="keyword">inline</font> BOOL CTreeItem::Delete()
04102 {
04103     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04104     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;DeleteItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04105 }
<a name="l04106"></a><a class="code" href="classWTL_1_1CTreeItem.html#a34">04106</a> <font class="keyword">inline</font> BOOL CTreeItem::Expand(UINT nCode)
04107 {
04108     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04109     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;Expand(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nCode);
04110 }
<a name="l04111"></a><a class="code" href="classWTL_1_1CTreeItem.html#a35">04111</a> <font class="keyword">inline</font> BOOL CTreeItem::Select(UINT nCode)
04112 {
04113     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04114     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;Select(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>,nCode);
04115 }
<a name="l04116"></a><a class="code" href="classWTL_1_1CTreeItem.html#a36">04116</a> <font class="keyword">inline</font> BOOL CTreeItem::Select()
04117 {
04118     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04119     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SelectItem(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04120 }
<a name="l04121"></a><a class="code" href="classWTL_1_1CTreeItem.html#a37">04121</a> <font class="keyword">inline</font> BOOL CTreeItem::SelectDropTarget()
04122 {
04123     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04124     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SelectDropTarget(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04125 }
<a name="l04126"></a><a class="code" href="classWTL_1_1CTreeItem.html#a38">04126</a> <font class="keyword">inline</font> BOOL CTreeItem::SelectSetFirstVisible()
04127 {
04128     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04129     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SelectSetFirstVisible(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04130 }
<a name="l04131"></a><a class="code" href="classWTL_1_1CTreeItem.html#a39">04131</a> <font class="keyword">inline</font> HWND CTreeItem::EditLabel()
04132 {
04133     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04134     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;EditLabel(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04135 }
<a name="l04136"></a><a class="code" href="classWTL_1_1CTreeItem.html#a40">04136</a> <font class="keyword">inline</font> HIMAGELIST CTreeItem::CreateDragImage()
04137 {
04138     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04139     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;CreateDragImage(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04140 }
<a name="l04141"></a><a class="code" href="classWTL_1_1CTreeItem.html#a41">04141</a> <font class="keyword">inline</font> BOOL CTreeItem::SortChildren()
04142 {
04143     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04144     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SortChildren(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04145 }
<a name="l04146"></a><a class="code" href="classWTL_1_1CTreeItem.html#a42">04146</a> <font class="keyword">inline</font> BOOL CTreeItem::EnsureVisible()
04147 {
04148     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04149     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;EnsureVisible(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04150 }
04151 
<a name="l04152"></a><a class="code" href="classWTL_1_1CTreeItem.html#a43">04152</a> <font class="keyword">inline</font> <a class="code" href="classWTL_1_1CTreeItem.html">CTreeItem</a> CTreeItem::_Insert(LPCTSTR lpstrItem, <font class="keywordtype">int</font> nImageIndex, HTREEITEM hItemAfter)
04153 {
04154     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04155     TV_INSERTSTRUCT ins;
04156     ins.hParent = <a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>;
04157     ins.hInsertAfter = hItemAfter;
04158     ins.item.mask = TVIF_TEXT;
04159     ins.item.pszText = (LPTSTR)lpstrItem;
04160     <font class="keywordflow">if</font>(nImageIndex != -1)
04161     {
04162         ins.item.mask |= TVIF_IMAGE | TVIF_SELECTEDIMAGE;
04163         ins.item.iImage = nImageIndex;
04164         ins.item.iSelectedImage = nImageIndex;
04165     }
04166     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#a0">CTreeItem</a>(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;InsertItem(&amp;ins), <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>);
04167 }
04168 
<a name="l04169"></a><a class="code" href="classWTL_1_1CTreeItem.html#a44">04169</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> CTreeItem::GetImageIndex()<font class="keyword"> const</font>
04170 <font class="keyword"></font>{
04171     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04172     TVITEM item;
04173     item.mask = TVIF_HANDLE | TVIF_IMAGE;
04174     item.hItem = <a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>;
04175     <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;GetItem(&amp;item);
04176     <font class="keywordflow">return</font> item.iImage;
04177 }
04178 
04179 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l04180"></a><a class="code" href="classWTL_1_1CTreeItem.html#a45">04180</a> <font class="preprocessor"></font><font class="keyword">inline</font> BOOL CTreeItem::SetInsertMark(BOOL bAfter)
04181 {
04182     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04183     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;SetInsertMark(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>, bAfter);
04184 }
04185 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
04186 <font class="preprocessor"></font>
04187 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l04188"></a><a class="code" href="classWTL_1_1CTreeItem.html#a46">04188</a> <font class="preprocessor"></font><font class="keyword">inline</font> UINT CTreeItem::MapHTREEITEMToAccID()<font class="keyword"> const</font>
04189 <font class="keyword"></font>{
04190     ATLASSERT(<a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a> != NULL);
04191     <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CTreeItem.html#m1">m_pTreeView</a>-&gt;MapHTREEITEMToAccID(<a class="code" href="classWTL_1_1CTreeItem.html#m0">m_hTreeItem</a>);
04192 }
04193 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
04194 <font class="preprocessor"></font>
04195 
04197 <font class="comment">// CToolBarCtrl</font>
04198 
04199 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l04200"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html">04200</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CToolBarCtrlT.html">CToolBarCtrlT</a> : <font class="keyword">public</font> TBase
04201 {
04202 <font class="keyword">public</font>:
04203 <font class="comment">// Construction</font>
<a name="l04204"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a0">04204</a>     <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a0">CToolBarCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
04205 
<a name="l04206"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a1">04206</a>     <a class="code" href="classWTL_1_1CToolBarCtrlT.html">CToolBarCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a1">operator=</a>(HWND hWnd)
04207     {
04208         m_hWnd = hWnd;
04209         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
04210     }
04211 
<a name="l04212"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a2">04212</a>     HWND <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
04213             DWORD dwStyle = 0, DWORD dwExStyle = 0,
04214             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
04215     {
04216         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CToolBarCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
04217     }
04218 
04219 <font class="comment">// Attributes</font>
<a name="l04220"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#d0">04220</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CToolBarCtrlT.html#d0">GetWndClassName</a>()
04221     {
04222         <font class="keywordflow">return</font> TOOLBARCLASSNAME;
04223     }
04224 
<a name="l04225"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a3">04225</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a3">IsButtonEnabled</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04226 <font class="keyword">    </font>{
04227         ATLASSERT(::IsWindow(m_hWnd));
04228         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ISBUTTONENABLED, nID, 0L);
04229     }
<a name="l04230"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a4">04230</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a4">IsButtonChecked</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04231 <font class="keyword">    </font>{
04232         ATLASSERT(::IsWindow(m_hWnd));
04233         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ISBUTTONCHECKED, nID, 0L);
04234     }
<a name="l04235"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a5">04235</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a5">IsButtonPressed</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04236 <font class="keyword">    </font>{
04237         ATLASSERT(::IsWindow(m_hWnd));
04238         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ISBUTTONPRESSED, nID, 0L);
04239     }
<a name="l04240"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a6">04240</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a6">IsButtonHidden</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04241 <font class="keyword">    </font>{
04242         ATLASSERT(::IsWindow(m_hWnd));
04243         <font class="keywordflow">return</font>(BOOL) ::SendMessage(m_hWnd, TB_ISBUTTONHIDDEN, nID, 0L);
04244     }
<a name="l04245"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a7">04245</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a7">IsButtonIndeterminate</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04246 <font class="keyword">    </font>{
04247         ATLASSERT(::IsWindow(m_hWnd));
04248         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ISBUTTONINDETERMINATE, nID, 0L);
04249     }
<a name="l04250"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a8">04250</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a8">GetState</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04251 <font class="keyword">    </font>{
04252         ATLASSERT(::IsWindow(m_hWnd));
04253         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETSTATE, nID, 0L);
04254     }
<a name="l04255"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a9">04255</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a9">SetState</a>(<font class="keywordtype">int</font> nID, UINT nState)
04256     {
04257         ATLASSERT(::IsWindow(m_hWnd));
04258         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETSTATE, nID, MAKELPARAM(nState, 0));
04259     }
<a name="l04260"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a10">04260</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a10">GetButton</a>(<font class="keywordtype">int</font> nIndex, LPTBBUTTON lpButton)<font class="keyword"> const</font>
04261 <font class="keyword">    </font>{
04262         ATLASSERT(::IsWindow(m_hWnd));
04263         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETBUTTON, nIndex, (LPARAM)lpButton);
04264     }
<a name="l04265"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a11">04265</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a11">GetButtonCount</a>()<font class="keyword"> const</font>
04266 <font class="keyword">    </font>{
04267         ATLASSERT(::IsWindow(m_hWnd));
04268         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_BUTTONCOUNT, 0, 0L);
04269     }
<a name="l04270"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a12">04270</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a12">GetItemRect</a>(<font class="keywordtype">int</font> nIndex, LPRECT lpRect)<font class="keyword"> const</font>
04271 <font class="keyword">    </font>{
04272         ATLASSERT(::IsWindow(m_hWnd));
04273         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETITEMRECT, nIndex, (LPARAM)lpRect);
04274     }
<a name="l04275"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a13">04275</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a13">SetButtonStructSize</a>(<font class="keywordtype">int</font> nSize = <font class="keyword">sizeof</font>(TBBUTTON))
04276     {
04277         ATLASSERT(::IsWindow(m_hWnd));
04278         ::SendMessage(m_hWnd, TB_BUTTONSTRUCTSIZE, nSize, 0L);
04279     }
<a name="l04280"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a14">04280</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a14">SetButtonSize</a>(SIZE size)
04281     {
04282         ATLASSERT(::IsWindow(m_hWnd));
04283         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETBUTTONSIZE, 0, MAKELPARAM(size.cx, size.cy));
04284     }
<a name="l04285"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a15">04285</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a14">SetButtonSize</a>(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy)
04286     {
04287         ATLASSERT(::IsWindow(m_hWnd));
04288         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETBUTTONSIZE, 0, MAKELPARAM(cx, cy));
04289     }
<a name="l04290"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a16">04290</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a16">SetBitmapSize</a>(SIZE size)
04291     {
04292         ATLASSERT(::IsWindow(m_hWnd));
04293         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETBITMAPSIZE, 0, MAKELPARAM(size.cx, size.cy));
04294     }
<a name="l04295"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a17">04295</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a16">SetBitmapSize</a>(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy)
04296     {
04297         ATLASSERT(::IsWindow(m_hWnd));
04298         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETBITMAPSIZE, 0, MAKELPARAM(cx, cy));
04299     }
<a name="l04300"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a18">04300</a>     CToolTipCtrl <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a18">GetToolTips</a>()<font class="keyword"> const</font>
04301 <font class="keyword">    </font>{
04302         ATLASSERT(::IsWindow(m_hWnd));
04303         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, TB_GETTOOLTIPS, 0, 0L));
04304     }
<a name="l04305"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a19">04305</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a19">SetToolTips</a>(HWND hWndToolTip)
04306     {
04307         ATLASSERT(::IsWindow(m_hWnd));
04308         ::SendMessage(m_hWnd, TB_SETTOOLTIPS, (WPARAM)hWndToolTip, 0L);
04309     }
<a name="l04310"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a20">04310</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a20">SetNotifyWnd</a>(HWND hWnd)
04311     {
04312         ATLASSERT(::IsWindow(m_hWnd));
04313         ::SendMessage(m_hWnd, TB_SETPARENT, (WPARAM)hWnd, 0L);
04314     }
<a name="l04315"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a21">04315</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a21">GetRows</a>()<font class="keyword"> const</font>
04316 <font class="keyword">    </font>{
04317         ATLASSERT(::IsWindow(m_hWnd));
04318         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETROWS, 0, 0L);
04319     }
<a name="l04320"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a22">04320</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a22">SetRows</a>(<font class="keywordtype">int</font> nRows, BOOL bLarger, LPRECT lpRect)
04321     {
04322         ATLASSERT(::IsWindow(m_hWnd));
04323         ::SendMessage(m_hWnd, TB_SETROWS, MAKELPARAM(nRows, bLarger), (LPARAM)lpRect);
04324     }
<a name="l04325"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a23">04325</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a23">SetCmdID</a>(<font class="keywordtype">int</font> nIndex, UINT nID)
04326     {
04327         ATLASSERT(::IsWindow(m_hWnd));
04328         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETCMDID, nIndex, nID);
04329     }
<a name="l04330"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a24">04330</a>     DWORD <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a24">GetBitmapFlags</a>()<font class="keyword"> const</font>
04331 <font class="keyword">    </font>{
04332         ATLASSERT(::IsWindow(m_hWnd));
04333         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TB_GETBITMAPFLAGS, 0, 0L);
04334     }
<a name="l04335"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a25">04335</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a25">GetBitmap</a>(<font class="keywordtype">int</font> nID)<font class="keyword"> const</font>
04336 <font class="keyword">    </font>{
04337         ATLASSERT(::IsWindow(m_hWnd));
04338         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETBITMAP, nID, 0L);
04339     }
<a name="l04340"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a26">04340</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a26">GetButtonText</a>(<font class="keywordtype">int</font> nID, LPTSTR lpstrText)<font class="keyword"> const</font>
04341 <font class="keyword">    </font>{
04342         ATLASSERT(::IsWindow(m_hWnd));
04343         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETBUTTONTEXT, nID, (LPARAM)lpstrText);
04344     }
04345 
<a name="l04346"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a27">04346</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a27">GetImageList</a>()<font class="keyword"> const</font>
04347 <font class="keyword">    </font>{
04348         ATLASSERT(::IsWindow(m_hWnd));
04349         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TB_GETIMAGELIST, 0, 0L));
04350     }
<a name="l04351"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a28">04351</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a28">SetImageList</a>(HIMAGELIST hImageList)
04352     {
04353         ATLASSERT(::IsWindow(m_hWnd));
04354         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TB_SETIMAGELIST, 0, (LPARAM)hImageList));
04355     }
<a name="l04356"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a29">04356</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a29">GetDisabledImageList</a>()<font class="keyword"> const</font>
04357 <font class="keyword">    </font>{
04358         ATLASSERT(::IsWindow(m_hWnd));
04359         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TB_GETDISABLEDIMAGELIST, 0, 0L));
04360     }
<a name="l04361"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a30">04361</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a30">SetDisabledImageList</a>(HIMAGELIST hImageList)
04362     {
04363         ATLASSERT(::IsWindow(m_hWnd));
04364         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TB_SETDISABLEDIMAGELIST, 0, (LPARAM)hImageList));
04365     }
<a name="l04366"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a31">04366</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a31">GetHotImageList</a>()<font class="keyword"> const</font>
04367 <font class="keyword">    </font>{
04368         ATLASSERT(::IsWindow(m_hWnd));
04369         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TB_GETHOTIMAGELIST, 0, 0L));
04370     }
<a name="l04371"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a32">04371</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a32">SetHotImageList</a>(HIMAGELIST hImageList)
04372     {
04373         ATLASSERT(::IsWindow(m_hWnd));
04374         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TB_SETHOTIMAGELIST, 0, (LPARAM)hImageList));
04375     }
<a name="l04376"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a33">04376</a>     DWORD <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a33">GetStyle</a>()<font class="keyword"> const</font>
04377 <font class="keyword">    </font>{
04378         ATLASSERT(::IsWindow(m_hWnd));
04379         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TB_GETSTYLE, 0, 0L);
04380     }
<a name="l04381"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a34">04381</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a34">SetStyle</a>(DWORD dwStyle)
04382     {
04383         ATLASSERT(::IsWindow(m_hWnd));
04384         ::SendMessage(m_hWnd, TB_SETSTYLE, 0, dwStyle);
04385     }
<a name="l04386"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a35">04386</a>     DWORD <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a35">GetButtonSize</a>()<font class="keyword"> const</font>
04387 <font class="keyword">    </font>{
04388         ATLASSERT(::IsWindow(m_hWnd));
04389         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TB_GETBUTTONSIZE, 0, 0L);
04390     }
<a name="l04391"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a36">04391</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a35">GetButtonSize</a>(SIZE&amp; size)<font class="keyword"> const</font>
04392 <font class="keyword">    </font>{
04393         ATLASSERT(::IsWindow(m_hWnd));
04394         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, TB_GETBUTTONSIZE, 0, 0L);
04395         size.cx = LOWORD(dwRet);
04396         size.cy = HIWORD(dwRet);
04397     }
<a name="l04398"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a37">04398</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a37">GetRect</a>(<font class="keywordtype">int</font> nID, LPRECT lpRect)<font class="keyword"> const</font>
04399 <font class="keyword">    </font>{
04400         ATLASSERT(::IsWindow(m_hWnd));
04401         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETRECT, nID, (LPARAM)lpRect);
04402     }
<a name="l04403"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a38">04403</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a38">GetTextRows</a>()<font class="keyword"> const</font>
04404 <font class="keyword">    </font>{
04405         ATLASSERT(::IsWindow(m_hWnd));
04406         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETTEXTROWS, 0, 0L);
04407     }
<a name="l04408"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a39">04408</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a39">SetButtonWidth</a>(<font class="keywordtype">int</font> cxMin, <font class="keywordtype">int</font> cxMax)
04409     {
04410         ATLASSERT(::IsWindow(m_hWnd));
04411         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETBUTTONWIDTH, 0, MAKELPARAM(cxMin, cxMax));
04412     }
<a name="l04413"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a40">04413</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a40">SetIndent</a>(<font class="keywordtype">int</font> nIndent)
04414     {
04415         ATLASSERT(::IsWindow(m_hWnd));
04416         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETINDENT, nIndent, 0L);
04417     }
<a name="l04418"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a41">04418</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a41">SetMaxTextRows</a>(<font class="keywordtype">int</font> nMaxTextRows)
04419     {
04420         ATLASSERT(::IsWindow(m_hWnd));
04421         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETMAXTEXTROWS, nMaxTextRows, 0L);
04422     }
04423 
04424 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l04425"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a42">04425</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a42">GetAnchorHighlight</a>()<font class="keyword"> const</font>
04426 <font class="keyword">    </font>{
04427         ATLASSERT(::IsWindow(m_hWnd));
04428         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETANCHORHIGHLIGHT, 0, 0L);
04429     }
<a name="l04430"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a43">04430</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a43">SetAnchorHighlight</a>(BOOL bEnable = TRUE)
04431     {
04432         ATLASSERT(::IsWindow(m_hWnd));
04433         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETANCHORHIGHLIGHT, bEnable, 0L);
04434     }
<a name="l04435"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a44">04435</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a44">GetButtonInfo</a>(<font class="keywordtype">int</font> nID, LPTBBUTTONINFO lptbbi)<font class="keyword"> const</font>
04436 <font class="keyword">    </font>{
04437         ATLASSERT(::IsWindow(m_hWnd));
04438         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETBUTTONINFO, nID, (LPARAM)lptbbi);
04439     }
<a name="l04440"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a45">04440</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a45">SetButtonInfo</a>(<font class="keywordtype">int</font> nID, LPTBBUTTONINFO lptbbi)
04441     {
04442         ATLASSERT(::IsWindow(m_hWnd));
04443         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETBUTTONINFO, nID, (LPARAM)lptbbi);
04444     }
<a name="l04445"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a46">04445</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a46">GetHotItem</a>()<font class="keyword"> const</font>
04446 <font class="keyword">    </font>{
04447         ATLASSERT(::IsWindow(m_hWnd));
04448         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETHOTITEM, 0, 0L);
04449     }
<a name="l04450"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a47">04450</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a47">SetHotItem</a>(<font class="keywordtype">int</font> nItem)
04451     {
04452         ATLASSERT(::IsWindow(m_hWnd));
04453         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_SETHOTITEM, nItem, 0L);
04454     }
<a name="l04455"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a48">04455</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a48">IsButtonHighlighted</a>(<font class="keywordtype">int</font> nButtonID)<font class="keyword"> const</font>
04456 <font class="keyword">    </font>{
04457         ATLASSERT(::IsWindow(m_hWnd));
04458         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ISBUTTONHIGHLIGHTED, nButtonID, 0L);
04459     }
<a name="l04460"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a49">04460</a>     DWORD <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a49">SetDrawTextFlags</a>(DWORD dwMask, DWORD dwFlags)
04461     {
04462         ATLASSERT(::IsWindow(m_hWnd));
04463         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TB_SETDRAWTEXTFLAGS, dwMask, dwFlags);
04464     }
<a name="l04465"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a50">04465</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a50">GetColorScheme</a>(LPCOLORSCHEME lpcs)<font class="keyword"> const</font>
04466 <font class="keyword">    </font>{
04467         ATLASSERT(::IsWindow(m_hWnd));
04468         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETCOLORSCHEME, 0, (LPARAM)lpcs);
04469     }
<a name="l04470"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a51">04470</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a51">SetColorScheme</a>(LPCOLORSCHEME lpcs)
04471     {
04472         ATLASSERT(::IsWindow(m_hWnd));
04473         ::SendMessage(m_hWnd, TB_SETCOLORSCHEME, 0, (LPARAM)lpcs);
04474     }
<a name="l04475"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a52">04475</a>     DWORD <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a52">GetExtendedStyle</a>()<font class="keyword"> const</font>
04476 <font class="keyword">    </font>{
04477         ATLASSERT(::IsWindow(m_hWnd));
04478         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TB_GETEXTENDEDSTYLE, 0, 0L);
04479     }
<a name="l04480"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a53">04480</a>     DWORD <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a53">SetExtendedStyle</a>(DWORD dwStyle)
04481     {
04482         ATLASSERT(::IsWindow(m_hWnd));
04483         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TB_SETEXTENDEDSTYLE, 0, dwStyle);
04484     }
<a name="l04485"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a54">04485</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a54">GetInsertMark</a>(LPTBINSERTMARK lptbim)<font class="keyword"> const</font>
04486 <font class="keyword">    </font>{
04487         ATLASSERT(::IsWindow(m_hWnd));
04488         ::SendMessage(m_hWnd, TB_GETINSERTMARK, 0, (LPARAM)lptbim);
04489     }
<a name="l04490"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a55">04490</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a55">SetInsertMark</a>(LPTBINSERTMARK lptbim)
04491     {
04492         ATLASSERT(::IsWindow(m_hWnd));
04493         ::SendMessage(m_hWnd, TB_SETINSERTMARK, 0, (LPARAM)lptbim);
04494     }
<a name="l04495"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a56">04495</a>     COLORREF <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a56">GetInsertMarkColor</a>()<font class="keyword"> const</font>
04496 <font class="keyword">    </font>{
04497         ATLASSERT(::IsWindow(m_hWnd));
04498         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TB_GETINSERTMARKCOLOR, 0, 0L);
04499     }
<a name="l04500"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a57">04500</a>     COLORREF <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a57">SetInsertMarkColor</a>(COLORREF clr)
04501     {
04502         ATLASSERT(::IsWindow(m_hWnd));
04503         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, TB_SETINSERTMARKCOLOR, 0, (LPARAM)clr);
04504     }
<a name="l04505"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a58">04505</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a58">GetMaxSize</a>(LPSIZE lpSize)<font class="keyword"> const</font>
04506 <font class="keyword">    </font>{
04507         ATLASSERT(::IsWindow(m_hWnd));
04508         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETMAXSIZE, 0, (LPARAM)lpSize);
04509     }
<a name="l04510"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a59">04510</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a59">GetPadding</a>(LPSIZE lpSizePadding)<font class="keyword"> const</font>
04511 <font class="keyword">    </font>{
04512         ATLASSERT(::IsWindow(m_hWnd));
04513         ATLASSERT(lpSizePadding != NULL);
04514         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, TB_GETPADDING, 0, 0L);
04515         lpSizePadding-&gt;cx = <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwRet);
04516         lpSizePadding-&gt;cy = <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwRet);
04517     }
<a name="l04518"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a60">04518</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a60">SetPadding</a>(<font class="keywordtype">int</font> cx, <font class="keywordtype">int</font> cy, LPSIZE lpSizePadding = NULL)
04519     {
04520         ATLASSERT(::IsWindow(m_hWnd));
04521         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, TB_SETPADDING, 0, MAKELPARAM(cx, cy));
04522         <font class="keywordflow">if</font>(lpSizePadding != NULL)
04523         {
04524             lpSizePadding-&gt;cx = <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwRet);
04525             lpSizePadding-&gt;cy = <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwRet);
04526         }
04527     }
<a name="l04528"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a61">04528</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a61">GetUnicodeFormat</a>()<font class="keyword"> const</font>
04529 <font class="keyword">    </font>{
04530         ATLASSERT(::IsWindow(m_hWnd));
04531         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_GETUNICODEFORMAT, 0, 0L);
04532     }
<a name="l04533"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a62">04533</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a62">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
04534     {
04535         ATLASSERT(::IsWindow(m_hWnd));
04536         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_SETUNICODEFORMAT, bUnicode, 0L);
04537     }
04538 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
04539 <font class="preprocessor"></font>
04540 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l04541"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a63">04541</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a63">GetString</a>(<font class="keywordtype">int</font> nString, LPTSTR lpstrString, <font class="keywordtype">int</font> cchMaxLen)<font class="keyword"> const</font>
04542 <font class="keyword">    </font>{
04543         ATLASSERT(::IsWindow(m_hWnd));
04544         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_GETSTRING, MAKEWPARAM(cchMaxLen, nString), (LPARAM)lpstrString);
04545     }
<a name="l04546"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a64">04546</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a64">GetStringBSTR</a>(<font class="keywordtype">int</font> nString, BSTR&amp; bstrString)<font class="keyword"> const</font>
04547 <font class="keyword">    </font>{
04548         USES_CONVERSION;
04549         ATLASSERT(::IsWindow(m_hWnd));
04550         ATLASSERT(bstrString == NULL);
04551         <font class="keywordtype">int</font> nLength = (int)(short)LOWORD(::SendMessage(m_hWnd, TB_GETSTRING, MAKEWPARAM(0, nString), NULL));
04552         <font class="keywordflow">if</font>(nLength != -1)
04553         {
04554             LPTSTR lpszString = (LPTSTR)_alloca((nLength + 1) * <font class="keyword">sizeof</font>(TCHAR));
04555             nLength = (int)::SendMessage(m_hWnd, TB_GETSTRING, MAKEWPARAM(nLength + 1, nString), (LPARAM)lpszString);
04556             <font class="keywordflow">if</font>(nLength != -1)
04557                 bstrString = ::SysAllocString(T2OLE(lpszString));
04558         }
04559         <font class="keywordflow">return</font> nLength;
04560     }
04561 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
04562 <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a63">GetString</a>(<font class="keywordtype">int</font> nString, CString&amp; str)<font class="keyword"> const</font>
04563 <font class="keyword">    </font>{
04564         ATLASSERT(::IsWindow(m_hWnd));
04565         <font class="keywordtype">int</font> nLength = (int)(short)LOWORD(::SendMessage(m_hWnd, TB_GETSTRING, MAKEWPARAM(0, nString), NULL));
04566         <font class="keywordflow">if</font>(nLength != -1)
04567         {
04568             LPTSTR lpstr = str.GetBufferSetLength(nLength + 1);
04569             <font class="keywordflow">if</font>(lpstr != NULL)
04570                 nLength = (int)::SendMessage(m_hWnd, TB_GETSTRING, MAKEWPARAM(nLength + 1, nString), (LPARAM)lpstr);
04571             <font class="keywordflow">else</font>
04572                 nLength = -1;
04573             str.ReleaseBuffer();
04574         }
04575         <font class="keywordflow">return</font> nLength;
04576     }
04577 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
04578 <font class="preprocessor"></font><font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
04579 <font class="preprocessor"></font>
04580 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l04581"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a65">04581</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a65">GetMetrics</a>(LPTBMETRICS lptbm)<font class="keyword"> const</font>
04582 <font class="keyword">    </font>{
04583         ATLASSERT(::IsWindow(m_hWnd));
04584         ::SendMessage(m_hWnd, TB_GETMETRICS, 0, (LPARAM)lptbm);
04585     }
<a name="l04586"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a66">04586</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a66">SetMetrics</a>(LPTBMETRICS lptbm)
04587     {
04588         ATLASSERT(::IsWindow(m_hWnd));
04589         ::SendMessage(m_hWnd, TB_SETMETRICS, 0, (LPARAM)lptbm);
04590     }
<a name="l04591"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a67">04591</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a67">SetWindowTheme</a>(LPCWSTR lpstrTheme)
04592     {
04593         ATLASSERT(::IsWindow(m_hWnd));
04594         ::SendMessage(m_hWnd, TB_SETWINDOWTHEME, 0, (LPARAM)lpstrTheme);
04595     }
04596 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
04597 <font class="preprocessor"></font>
04598 <font class="comment">// Operations</font>
<a name="l04599"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a68">04599</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a68">EnableButton</a>(<font class="keywordtype">int</font> nID, BOOL bEnable = TRUE)
04600     {
04601         ATLASSERT(::IsWindow(m_hWnd));
04602         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ENABLEBUTTON, nID, MAKELPARAM(bEnable, 0));
04603     }
<a name="l04604"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a69">04604</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a69">CheckButton</a>(<font class="keywordtype">int</font> nID, BOOL bCheck = TRUE)
04605     {
04606         ATLASSERT(::IsWindow(m_hWnd));
04607         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_CHECKBUTTON, nID, MAKELPARAM(bCheck, 0));
04608     }
<a name="l04609"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a70">04609</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a70">PressButton</a>(<font class="keywordtype">int</font> nID, BOOL bPress = TRUE)
04610     {
04611         ATLASSERT(::IsWindow(m_hWnd));
04612         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_PRESSBUTTON, nID, MAKELPARAM(bPress, 0));
04613     }
<a name="l04614"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a71">04614</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a71">HideButton</a>(<font class="keywordtype">int</font> nID, BOOL bHide = TRUE)
04615     {
04616         ATLASSERT(::IsWindow(m_hWnd));
04617         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_HIDEBUTTON, nID, MAKELPARAM(bHide, 0));
04618     }
<a name="l04619"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a72">04619</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a72">Indeterminate</a>(<font class="keywordtype">int</font> nID, BOOL bIndeterminate = TRUE)
04620     {
04621         ATLASSERT(::IsWindow(m_hWnd));
04622         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_INDETERMINATE, nID, MAKELPARAM(bIndeterminate, 0));
04623     }
<a name="l04624"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a73">04624</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a73">AddBitmap</a>(<font class="keywordtype">int</font> nNumButtons, UINT nBitmapID)
04625     {
04626         ATLASSERT(::IsWindow(m_hWnd));
04627         TBADDBITMAP tbab;
04628         tbab.hInst = _Module.GetResourceInstance();
04629         ATLASSERT(tbab.hInst != NULL);
04630         tbab.nID = nBitmapID;
04631         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_ADDBITMAP, (WPARAM)nNumButtons, (LPARAM)&amp;tbab);
04632     }
<a name="l04633"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a74">04633</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a73">AddBitmap</a>(<font class="keywordtype">int</font> nNumButtons, HBITMAP hBitmap)
04634     {
04635         ATLASSERT(::IsWindow(m_hWnd));
04636         TBADDBITMAP tbab;
04637         tbab.hInst = NULL;
04638         tbab.nID = (UINT_PTR)hBitmap;
04639         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_ADDBITMAP, (WPARAM)nNumButtons, (LPARAM)&amp;tbab);
04640     }
<a name="l04641"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a75">04641</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a75">AddButtons</a>(<font class="keywordtype">int</font> nNumButtons, LPTBBUTTON lpButtons)
04642     {
04643         ATLASSERT(::IsWindow(m_hWnd));
04644         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_ADDBUTTONS, nNumButtons, (LPARAM)lpButtons);
04645     }
<a name="l04646"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a76">04646</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a76">InsertButton</a>(<font class="keywordtype">int</font> nIndex, LPTBBUTTON lpButton)
04647     {
04648         ATLASSERT(::IsWindow(m_hWnd));
04649         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_INSERTBUTTON, nIndex, (LPARAM)lpButton);
04650     }
<a name="l04651"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a77">04651</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a77">DeleteButton</a>(<font class="keywordtype">int</font> nIndex)
04652     {
04653         ATLASSERT(::IsWindow(m_hWnd));
04654         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_DELETEBUTTON, nIndex, 0L);
04655     }
<a name="l04656"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a78">04656</a>     UINT <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a78">CommandToIndex</a>(UINT nID)<font class="keyword"> const</font>
04657 <font class="keyword">    </font>{
04658         ATLASSERT(::IsWindow(m_hWnd));
04659         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, TB_COMMANDTOINDEX, nID, 0L);
04660     }
<a name="l04661"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a79">04661</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a79">SaveState</a>(HKEY hKeyRoot, LPCTSTR lpszSubKey, LPCTSTR lpszValueName)
04662     {
04663         ATLASSERT(::IsWindow(m_hWnd));
04664         TBSAVEPARAMS tbs;
04665         tbs.hkr = hKeyRoot;
04666         tbs.pszSubKey = lpszSubKey;
04667         tbs.pszValueName = lpszValueName;
04668         ::SendMessage(m_hWnd, TB_SAVERESTORE, (WPARAM)TRUE, (LPARAM)&amp;tbs);
04669     }
<a name="l04670"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a80">04670</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a80">RestoreState</a>(HKEY hKeyRoot, LPCTSTR lpszSubKey, LPCTSTR lpszValueName)
04671     {
04672         ATLASSERT(::IsWindow(m_hWnd));
04673         TBSAVEPARAMS tbs;
04674         tbs.hkr = hKeyRoot;
04675         tbs.pszSubKey = lpszSubKey;
04676         tbs.pszValueName = lpszValueName;
04677         ::SendMessage(m_hWnd, TB_SAVERESTORE, (WPARAM)FALSE, (LPARAM)&amp;tbs);
04678     }
<a name="l04679"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a81">04679</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a81">Customize</a>()
04680     {
04681         ATLASSERT(::IsWindow(m_hWnd));
04682         ::SendMessage(m_hWnd, TB_CUSTOMIZE, 0, 0L);
04683     }
<a name="l04684"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a82">04684</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a82">AddString</a>(UINT nStringID)
04685     {
04686         ATLASSERT(::IsWindow(m_hWnd));
04687         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_ADDSTRING, (WPARAM)_Module.GetResourceInstance(), (LPARAM)nStringID);
04688     }
<a name="l04689"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a83">04689</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a83">AddStrings</a>(LPCTSTR lpszStrings)
04690     {
04691         ATLASSERT(::IsWindow(m_hWnd));
04692         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_ADDSTRING, 0, (LPARAM)lpszStrings);
04693     }
<a name="l04694"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a84">04694</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a84">AutoSize</a>()
04695     {
04696         ATLASSERT(::IsWindow(m_hWnd));
04697         ::SendMessage(m_hWnd, TB_AUTOSIZE, 0, 0L);
04698     }
04699 
<a name="l04700"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a85">04700</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a85">ChangeBitmap</a>(<font class="keywordtype">int</font> nID, <font class="keywordtype">int</font> nBitmap)
04701     {
04702         ATLASSERT(::IsWindow(m_hWnd));
04703         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_CHANGEBITMAP, nID, MAKELPARAM(nBitmap, 0));
04704     }
<a name="l04705"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a86">04705</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a86">LoadImages</a>(<font class="keywordtype">int</font> nBitmapID)
04706     {
04707         ATLASSERT(::IsWindow(m_hWnd));
04708         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_LOADIMAGES, nBitmapID, (LPARAM)_Module.GetResourceInstance());
04709     }
<a name="l04710"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a87">04710</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a87">LoadStdImages</a>(<font class="keywordtype">int</font> nBitmapID)
04711     {
04712         ATLASSERT(::IsWindow(m_hWnd));
04713         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_LOADIMAGES, nBitmapID, (LPARAM)HINST_COMMCTRL);
04714     }
<a name="l04715"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a88">04715</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a88">ReplaceBitmap</a>(LPTBREPLACEBITMAP ptbrb)
04716     {
04717         ATLASSERT(::IsWindow(m_hWnd));
04718         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_REPLACEBITMAP, 0, (LPARAM)ptbrb);
04719     }
04720 
04721 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l04722"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a89">04722</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a89">HitTest</a>(LPPOINT lpPoint)
04723     {
04724         ATLASSERT(::IsWindow(m_hWnd));
04725         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TB_HITTEST, 0, (LPARAM)lpPoint);
04726     }
<a name="l04727"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a90">04727</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a90">InsertMarkHitTest</a>(LPPOINT lpPoint, LPTBINSERTMARK lptbim)
04728     {
04729         ATLASSERT(::IsWindow(m_hWnd));
04730         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_INSERTMARKHITTEST, (WPARAM)lpPoint, (LPARAM)lptbim);
04731     }
<a name="l04732"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a91">04732</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a90">InsertMarkHitTest</a>(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, LPTBINSERTMARK lptbim)
04733     {
04734         ATLASSERT(::IsWindow(m_hWnd));
04735         POINT pt = { x, y };
04736         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_INSERTMARKHITTEST, (WPARAM)&amp;pt, (LPARAM)lptbim);
04737     }
<a name="l04738"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a92">04738</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a92">MapAccelerator</a>(TCHAR chAccel, <font class="keywordtype">int</font>&amp; nID)<font class="keyword"> const</font>
04739 <font class="keyword">    </font>{
04740         ATLASSERT(::IsWindow(m_hWnd));
04741         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_MAPACCELERATOR, (WPARAM)chAccel, (LPARAM)&amp;nID);
04742     }
<a name="l04743"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a93">04743</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a93">MarkButton</a>(<font class="keywordtype">int</font> nID, BOOL bHighlight = TRUE)
04744     {
04745         ATLASSERT(::IsWindow(m_hWnd));
04746         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_MARKBUTTON, nID, MAKELPARAM(bHighlight, 0));
04747     }
<a name="l04748"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a94">04748</a>     BOOL <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a94">MoveButton</a>(<font class="keywordtype">int</font> nOldPos, <font class="keywordtype">int</font> nNewPos)
04749     {
04750         ATLASSERT(::IsWindow(m_hWnd));
04751         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TB_MOVEBUTTON, nOldPos, nNewPos);
04752     }
<a name="l04753"></a><a class="code" href="classWTL_1_1CToolBarCtrlT.html#a95">04753</a>     HRESULT <a class="code" href="classWTL_1_1CToolBarCtrlT.html#a95">GetObject</a>(REFIID iid, LPVOID* ppvObject)
04754     {
04755         ATLASSERT(::IsWindow(m_hWnd));
04756         <font class="keywordflow">return</font> (HRESULT)::SendMessage(m_hWnd, TB_GETOBJECT, (WPARAM)&amp;iid, (LPARAM)ppvObject);
04757     }
04758 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
04759 <font class="preprocessor"></font>};
04760 
<a name="l04761"></a><a class="code" href="namespaceWTL.html#a13">04761</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CToolBarCtrlT.html">CToolBarCtrlT&lt;CWindow&gt;</a>      <a class="code" href="namespaceWTL.html#a13">CToolBarCtrl</a>;
04762 
04763 
04765 <font class="comment">// CStatusBarCtrl</font>
04766 
04767 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l04768"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html">04768</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CStatusBarCtrlT.html">CStatusBarCtrlT</a> : <font class="keyword">public</font> TBase
04769 {
04770 <font class="keyword">public</font>:
04771 <font class="comment">// Constructors</font>
<a name="l04772"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a0">04772</a>     <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a0">CStatusBarCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
04773 
<a name="l04774"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a1">04774</a>     <a class="code" href="classWTL_1_1CStatusBarCtrlT.html">CStatusBarCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a1">operator=</a>(HWND hWnd)
04775     {
04776         m_hWnd = hWnd;
04777         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
04778     }
04779 
<a name="l04780"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a2">04780</a>     HWND <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
04781             DWORD dwStyle = 0, DWORD dwExStyle = 0,
04782             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
04783     {
04784         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CStatusBarCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
04785     }
04786 
04787 <font class="comment">// Methods</font>
<a name="l04788"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#d0">04788</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#d0">GetWndClassName</a>()
04789     {
04790         <font class="keywordflow">return</font> STATUSCLASSNAME;
04791     }
04792 
<a name="l04793"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a3">04793</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a3">GetParts</a>(<font class="keywordtype">int</font> nParts, <font class="keywordtype">int</font>* pParts)<font class="keyword"> const</font>
04794 <font class="keyword">    </font>{
04795         ATLASSERT(::IsWindow(m_hWnd));
04796         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, SB_GETPARTS, nParts, (LPARAM)pParts);
04797     }
<a name="l04798"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a4">04798</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a4">SetParts</a>(<font class="keywordtype">int</font> nParts, <font class="keywordtype">int</font>* pWidths)
04799     {
04800         ATLASSERT(::IsWindow(m_hWnd));
04801         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_SETPARTS, nParts, (LPARAM)pWidths);
04802     }
<a name="l04803"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a5">04803</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a5">GetTextLength</a>(<font class="keywordtype">int</font> nPane, <font class="keywordtype">int</font>* pType = NULL)<font class="keyword"> const</font>
04804 <font class="keyword">    </font>{
04805         ATLASSERT(::IsWindow(m_hWnd));
04806         ATLASSERT(nPane &lt; 256);
04807         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, SB_GETTEXTLENGTH, (WPARAM)nPane, 0L);
04808         <font class="keywordflow">if</font> (pType != NULL)
04809             *pType = (int)(short)HIWORD(dwRet);
04810         <font class="keywordflow">return</font> (int)(short)LOWORD(dwRet);
04811     }
<a name="l04812"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a6">04812</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a6">GetText</a>(<font class="keywordtype">int</font> nPane, LPTSTR lpszText, <font class="keywordtype">int</font>* pType = NULL)<font class="keyword"> const</font>
04813 <font class="keyword">    </font>{
04814         ATLASSERT(::IsWindow(m_hWnd));
04815         ATLASSERT(nPane &lt; 256);
04816         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, SB_GETTEXT, (WPARAM)nPane, (LPARAM)lpszText);
04817         <font class="keywordflow">if</font>(pType != NULL)
04818             *pType = (int)(short)HIWORD(dwRet);
04819         <font class="keywordflow">return</font> (int)(short)LOWORD(dwRet);
04820     }
04821 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
<a name="l04822"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a7">04822</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a7">GetTextBSTR</a>(<font class="keywordtype">int</font> nPane, BSTR&amp; bstrText, <font class="keywordtype">int</font>* pType = NULL)<font class="keyword"> const</font>
04823 <font class="keyword">    </font>{
04824         USES_CONVERSION;
04825         ATLASSERT(::IsWindow(m_hWnd));
04826         ATLASSERT(nPane &lt; 256);
04827         ATLASSERT(bstrText == NULL);
04828         <font class="keywordtype">int</font> nLength = (int)(short)LOWORD(::SendMessage(m_hWnd, SB_GETTEXTLENGTH, (WPARAM)nPane, 0L));
04829         <font class="keywordflow">if</font>(nLength == 0)
04830             <font class="keywordflow">return</font> FALSE;
04831 
04832         LPTSTR lpszText = (LPTSTR)_alloca((nLength + 1) * <font class="keyword">sizeof</font>(TCHAR));
04833         <font class="keywordflow">if</font>(!<a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a6">GetText</a>(nPane, lpszText, pType))
04834             <font class="keywordflow">return</font> FALSE;
04835 
04836         bstrText = ::SysAllocString(T2OLE(lpszText));
04837         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
04838     }
04839 <font class="preprocessor">#endif </font>
04840 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
04841 <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a6">GetText</a>(<font class="keywordtype">int</font> nPane, CString&amp; strText, <font class="keywordtype">int</font>* pType = NULL)<font class="keyword"> const</font>
04842 <font class="keyword">    </font>{
04843         ATLASSERT(::IsWindow(m_hWnd));
04844         ATLASSERT(nPane &lt; 256);
04845         <font class="keywordtype">int</font> nLength = (int)(short)LOWORD(::SendMessage(m_hWnd, SB_GETTEXTLENGTH, (WPARAM)nPane, 0L));
04846         <font class="keywordflow">if</font>(nLength == 0)
04847             <font class="keywordflow">return</font> 0;
04848 
04849         LPTSTR lpstr = strText.GetBufferSetLength(nLength);
04850         <font class="keywordflow">if</font>(lpstr == NULL)
04851             <font class="keywordflow">return</font> 0;
04852         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a6">GetText</a>(nPane, lpstr, pType);
04853     }
04854 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l04855"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a8">04855</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a8">SetText</a>(<font class="keywordtype">int</font> nPane, LPCTSTR lpszText, <font class="keywordtype">int</font> nType = 0)
04856     {
04857         ATLASSERT(::IsWindow(m_hWnd));
04858         ATLASSERT(nPane &lt; 256);
04859         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_SETTEXT, (nPane | nType), (LPARAM)lpszText);
04860     }
<a name="l04861"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a9">04861</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a9">GetRect</a>(<font class="keywordtype">int</font> nPane, LPRECT lpRect)<font class="keyword"> const</font>
04862 <font class="keyword">    </font>{
04863         ATLASSERT(::IsWindow(m_hWnd));
04864         ATLASSERT(nPane &lt; 256);
04865         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_GETRECT, nPane, (LPARAM)lpRect);
04866     }
<a name="l04867"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a10">04867</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a10">GetBorders</a>(<font class="keywordtype">int</font>* pBorders)<font class="keyword"> const</font>
04868 <font class="keyword">    </font>{
04869         ATLASSERT(::IsWindow(m_hWnd));
04870         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_GETBORDERS, 0, (LPARAM)pBorders);
04871     }
<a name="l04872"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a11">04872</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a10">GetBorders</a>(<font class="keywordtype">int</font>&amp; nHorz, <font class="keywordtype">int</font>&amp; nVert, <font class="keywordtype">int</font>&amp; nSpacing)<font class="keyword"> const</font>
04873 <font class="keyword">    </font>{
04874         ATLASSERT(::IsWindow(m_hWnd));
04875         <font class="keywordtype">int</font> borders[3];
04876         BOOL bResult = (BOOL)::SendMessage(m_hWnd, SB_GETBORDERS, 0, (LPARAM)&amp;borders);
04877         <font class="keywordflow">if</font>(bResult)
04878         {
04879             nHorz = borders[0];
04880             nVert = borders[1];
04881             nSpacing = borders[2];
04882         }
04883         <font class="keywordflow">return</font> bResult;
04884     }
<a name="l04885"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a12">04885</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a12">SetMinHeight</a>(<font class="keywordtype">int</font> nMin)
04886     {
04887         ATLASSERT(::IsWindow(m_hWnd));
04888         ::SendMessage(m_hWnd, SB_SETMINHEIGHT, nMin, 0L);
04889     }
<a name="l04890"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a13">04890</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a13">SetSimple</a>(BOOL bSimple = TRUE)
04891     {
04892         ATLASSERT(::IsWindow(m_hWnd));
04893         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_SIMPLE, bSimple, 0L);
04894     }
<a name="l04895"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a14">04895</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a14">IsSimple</a>()<font class="keyword"> const</font>
04896 <font class="keyword">    </font>{
04897         ATLASSERT(::IsWindow(m_hWnd));
04898         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_ISSIMPLE, 0, 0L);
04899     }
04900 
04901 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l04902"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a15">04902</a> <font class="preprocessor"></font>    COLORREF <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a15">SetBkColor</a>(COLORREF clrBk)
04903     {
04904         ATLASSERT(::IsWindow(m_hWnd));
04905         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, SB_SETBKCOLOR, 0, (LPARAM)clrBk);
04906     }
<a name="l04907"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a16">04907</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a16">GetUnicodeFormat</a>()<font class="keyword"> const</font>
04908 <font class="keyword">    </font>{
04909         ATLASSERT(::IsWindow(m_hWnd));
04910         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_GETUNICODEFORMAT, 0, 0L);
04911     }
<a name="l04912"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a17">04912</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a17">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
04913     {
04914         ATLASSERT(::IsWindow(m_hWnd));
04915         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_SETUNICODEFORMAT, bUnicode, 0L);
04916     }
<a name="l04917"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a18">04917</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a18">GetTipText</a>(<font class="keywordtype">int</font> nPane, LPTSTR lpstrText, <font class="keywordtype">int</font> nSize)<font class="keyword"> const</font>
04918 <font class="keyword">    </font>{
04919         ATLASSERT(::IsWindow(m_hWnd));
04920         ATLASSERT(nPane &lt; 256);
04921         ::SendMessage(m_hWnd, SB_GETTIPTEXT, MAKEWPARAM(nPane, nSize), (LPARAM)lpstrText);
04922     }
<a name="l04923"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a19">04923</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a19">SetTipText</a>(<font class="keywordtype">int</font> nPane, LPCTSTR lpstrText)
04924     {
04925         ATLASSERT(::IsWindow(m_hWnd));
04926         ATLASSERT(nPane &lt; 256);
04927         ::SendMessage(m_hWnd, SB_SETTIPTEXT, nPane, (LPARAM)lpstrText);
04928     }
<a name="l04929"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a20">04929</a>     HICON <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a20">GetIcon</a>(<font class="keywordtype">int</font> nPane)<font class="keyword"> const</font>
04930 <font class="keyword">    </font>{
04931         ATLASSERT(::IsWindow(m_hWnd));
04932         ATLASSERT(nPane &lt; 256);
04933         <font class="keywordflow">return</font> (HICON)::SendMessage(m_hWnd, SB_GETICON, nPane, 0L);
04934     }
<a name="l04935"></a><a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a21">04935</a>     BOOL <a class="code" href="classWTL_1_1CStatusBarCtrlT.html#a21">SetIcon</a>(<font class="keywordtype">int</font> nPane, HICON hIcon)
04936     {
04937         ATLASSERT(::IsWindow(m_hWnd));
04938         ATLASSERT(nPane &lt; 256);
04939         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, SB_SETICON, nPane, (LPARAM)hIcon);
04940     }
04941 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
04942 <font class="preprocessor"></font>};
04943 
<a name="l04944"></a><a class="code" href="namespaceWTL.html#a14">04944</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CStatusBarCtrlT.html">CStatusBarCtrlT&lt;CWindow&gt;</a>        <a class="code" href="namespaceWTL.html#a14">CStatusBarCtrl</a>;
04945 
04946 
04948 <font class="comment">// CTabCtrl</font>
04949 
04950 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l04951"></a><a class="code" href="classWTL_1_1CTabCtrlT.html">04951</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CTabCtrlT.html">CTabCtrlT</a> : <font class="keyword">public</font> TBase
04952 {
04953 <font class="keyword">public</font>:
04954 <font class="comment">// Constructors</font>
<a name="l04955"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a0">04955</a>     <a class="code" href="classWTL_1_1CTabCtrlT.html#a0">CTabCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
04956 
<a name="l04957"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a1">04957</a>     <a class="code" href="classWTL_1_1CTabCtrlT.html">CTabCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CTabCtrlT.html#a1">operator=</a>(HWND hWnd)
04958     {
04959         m_hWnd = hWnd;
04960         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
04961     }
04962 
<a name="l04963"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a2">04963</a>     HWND <a class="code" href="classWTL_1_1CTabCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
04964             DWORD dwStyle = 0, DWORD dwExStyle = 0,
04965             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
04966     {
04967         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CTabCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
04968     }
04969 
04970 <font class="comment">// Attributes</font>
<a name="l04971"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#d0">04971</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CTabCtrlT.html#d0">GetWndClassName</a>()
04972     {
04973         <font class="keywordflow">return</font> WC_TABCONTROL;
04974     }
04975 
<a name="l04976"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a3">04976</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CTabCtrlT.html#a3">GetImageList</a>()<font class="keyword"> const</font>
04977 <font class="keyword">    </font>{
04978         ATLASSERT(::IsWindow(m_hWnd));
04979         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TCM_GETIMAGELIST, 0, 0L));
04980     }
<a name="l04981"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a4">04981</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CTabCtrlT.html#a4">SetImageList</a>(HIMAGELIST hImageList)
04982     {
04983         ATLASSERT(::IsWindow(m_hWnd));
04984         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, TCM_SETIMAGELIST, 0, (LPARAM)hImageList));
04985     }
<a name="l04986"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a5">04986</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a5">GetItemCount</a>()<font class="keyword"> const</font>
04987 <font class="keyword">    </font>{
04988         ATLASSERT(::IsWindow(m_hWnd));
04989         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_GETITEMCOUNT, 0, 0L);
04990     }
<a name="l04991"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a6">04991</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a6">GetItem</a>(<font class="keywordtype">int</font> nItem, LPTCITEM pTabCtrlItem)<font class="keyword"> const</font>
04992 <font class="keyword">    </font>{
04993         ATLASSERT(::IsWindow(m_hWnd));
04994         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_GETITEM, nItem, (LPARAM)pTabCtrlItem);
04995     }
<a name="l04996"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a7">04996</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a7">SetItem</a>(<font class="keywordtype">int</font> nItem, LPTCITEM pTabCtrlItem)
04997     {
04998         ATLASSERT(::IsWindow(m_hWnd));
04999         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_SETITEM, nItem, (LPARAM)pTabCtrlItem);
05000     }
<a name="l05001"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a8">05001</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a8">GetItemRect</a>(<font class="keywordtype">int</font> nItem, LPRECT lpRect)<font class="keyword"> const</font>
05002 <font class="keyword">    </font>{
05003         ATLASSERT(::IsWindow(m_hWnd));
05004         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_GETITEMRECT, nItem, (LPARAM)lpRect);
05005     }
<a name="l05006"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a9">05006</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a9">GetCurSel</a>()<font class="keyword"> const</font>
05007 <font class="keyword">    </font>{
05008         ATLASSERT(::IsWindow(m_hWnd));
05009         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_GETCURSEL, 0, 0L);
05010     }
<a name="l05011"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a10">05011</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a10">SetCurSel</a>(<font class="keywordtype">int</font> nItem)
05012     {
05013         ATLASSERT(::IsWindow(m_hWnd));
05014         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_SETCURSEL, nItem, 0L);
05015     }
<a name="l05016"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a11">05016</a>     SIZE <a class="code" href="classWTL_1_1CTabCtrlT.html#a11">SetItemSize</a>(SIZE size)
05017     {
05018         ATLASSERT(::IsWindow(m_hWnd));
05019         DWORD dwSize = (DWORD)::SendMessage(m_hWnd, TCM_SETITEMSIZE, 0, MAKELPARAM(size.cx, size.cy));
05020         SIZE sizeRet = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(dwSize), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(dwSize) };
05021         <font class="keywordflow">return</font> sizeRet;
05022     }
<a name="l05023"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a12">05023</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a12">SetPadding</a>(SIZE size)
05024     {
05025         ATLASSERT(::IsWindow(m_hWnd));
05026         ::SendMessage(m_hWnd, TCM_SETPADDING, 0, MAKELPARAM(size.cx, size.cy));
05027     }
<a name="l05028"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a13">05028</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a13">GetRowCount</a>()<font class="keyword"> const</font>
05029 <font class="keyword">    </font>{
05030         ATLASSERT(::IsWindow(m_hWnd));
05031         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_GETROWCOUNT, 0, 0L);
05032     }
<a name="l05033"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a14">05033</a>     CToolTipCtrl <a class="code" href="classWTL_1_1CTabCtrlT.html#a14">GetTooltips</a>()<font class="keyword"> const</font>
05034 <font class="keyword">    </font>{
05035         ATLASSERT(::IsWindow(m_hWnd));
05036         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, TCM_GETTOOLTIPS, 0, 0L));
05037     }
<a name="l05038"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a15">05038</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a15">SetTooltips</a>(HWND hWndToolTip)
05039     {
05040         ATLASSERT(::IsWindow(m_hWnd));
05041         ::SendMessage(m_hWnd, TCM_SETTOOLTIPS, (WPARAM)hWndToolTip, 0L);
05042     }
<a name="l05043"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a16">05043</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a16">GetCurFocus</a>()<font class="keyword"> const</font>
05044 <font class="keyword">    </font>{
05045         ATLASSERT(::IsWindow(m_hWnd));
05046         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_GETCURFOCUS, 0, 0L);
05047     }
05048 
<a name="l05049"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a17">05049</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a17">SetCurFocus</a>(<font class="keywordtype">int</font> nItem)
05050     {
05051         ATLASSERT(::IsWindow(m_hWnd));
05052         ::SendMessage(m_hWnd, TCM_SETCURFOCUS, nItem, 0L);
05053     }
<a name="l05054"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a18">05054</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a18">SetItemExtra</a>(<font class="keywordtype">int</font> cbExtra)
05055     {
05056         ATLASSERT(::IsWindow(m_hWnd));
05057         ATLASSERT(<a class="code" href="classWTL_1_1CTabCtrlT.html#a5">GetItemCount</a>() == 0); <font class="comment">// must be empty</font>
05058         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_SETITEMEXTRA, cbExtra, 0L);
05059     }
<a name="l05060"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a19">05060</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a19">SetMinTabWidth</a>(<font class="keywordtype">int</font> nWidth = -1)
05061     {
05062         ATLASSERT(::IsWindow(m_hWnd));
05063         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_SETMINTABWIDTH, 0, nWidth);
05064     }
05065 
05066 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l05067"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a20">05067</a> <font class="preprocessor"></font>    DWORD <a class="code" href="classWTL_1_1CTabCtrlT.html#a20">GetExtendedStyle</a>()<font class="keyword"> const</font>
05068 <font class="keyword">    </font>{
05069         ATLASSERT(::IsWindow(m_hWnd));
05070         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TCM_GETEXTENDEDSTYLE, 0, 0L);
05071     }
<a name="l05072"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a21">05072</a>     DWORD <a class="code" href="classWTL_1_1CTabCtrlT.html#a21">SetExtendedStyle</a>(DWORD dwExMask, DWORD dwExStyle)
05073     {
05074         ATLASSERT(::IsWindow(m_hWnd));
05075         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, TCM_SETEXTENDEDSTYLE, dwExMask, dwExStyle);
05076     }
<a name="l05077"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a22">05077</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a22">GetUnicodeFormat</a>()<font class="keyword"> const</font>
05078 <font class="keyword">    </font>{
05079         ATLASSERT(::IsWindow(m_hWnd));
05080         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_GETUNICODEFORMAT, 0, 0L);
05081     }
<a name="l05082"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a23">05082</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a23">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
05083     {
05084         ATLASSERT(::IsWindow(m_hWnd));
05085         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_SETUNICODEFORMAT, bUnicode, 0L);
05086     }
05087 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
05088 <font class="preprocessor"></font>
05089 <font class="comment">// Operations</font>
<a name="l05090"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a24">05090</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a24">InsertItem</a>(<font class="keywordtype">int</font> nItem, LPTCITEM pTabCtrlItem)
05091     {
05092         ATLASSERT(::IsWindow(m_hWnd));
05093         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_INSERTITEM, nItem, (LPARAM)pTabCtrlItem);
05094     }
<a name="l05095"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a25">05095</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a25">DeleteItem</a>(<font class="keywordtype">int</font> nItem)
05096     {
05097         ATLASSERT(::IsWindow(m_hWnd));
05098         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_DELETEITEM, nItem, 0L);
05099     }
<a name="l05100"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a26">05100</a>     BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a26">DeleteAllItems</a>()
05101     {
05102         ATLASSERT(::IsWindow(m_hWnd));
05103         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_DELETEALLITEMS, 0, 0L);
05104     }
<a name="l05105"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a27">05105</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a27">AdjustRect</a>(BOOL bLarger, LPRECT lpRect)
05106     {
05107         ATLASSERT(::IsWindow(m_hWnd));
05108         ::SendMessage(m_hWnd, TCM_ADJUSTRECT, bLarger, (LPARAM)lpRect);
05109     }
<a name="l05110"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a28">05110</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a28">RemoveImage</a>(<font class="keywordtype">int</font> nImage)
05111     {
05112         ATLASSERT(::IsWindow(m_hWnd));
05113         ::SendMessage(m_hWnd, TCM_REMOVEIMAGE, nImage, 0L);
05114     }
<a name="l05115"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a29">05115</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a29">HitTest</a>(TC_HITTESTINFO* pHitTestInfo)<font class="keyword"> const</font>
05116 <font class="keyword">    </font>{
05117         ATLASSERT(::IsWindow(m_hWnd));
05118         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TCM_HITTEST, 0, (LPARAM)pHitTestInfo);
05119     }
<a name="l05120"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a30">05120</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTabCtrlT.html#a30">DeselectAll</a>(BOOL bExcludeFocus = TRUE)
05121     {
05122         ATLASSERT(::IsWindow(m_hWnd));
05123         ::SendMessage(m_hWnd, TCM_DESELECTALL, bExcludeFocus, 0L);
05124     }
05125 
05126 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l05127"></a><a class="code" href="classWTL_1_1CTabCtrlT.html#a31">05127</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CTabCtrlT.html#a31">HighlightItem</a>(<font class="keywordtype">int</font> nIndex, BOOL bHighlight = TRUE)
05128     {
05129         ATLASSERT(::IsWindow(m_hWnd));
05130         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TCM_HIGHLIGHTITEM, nIndex, MAKELPARAM(bHighlight, 0));
05131     }
05132 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
05133 <font class="preprocessor"></font>};
05134 
<a name="l05135"></a><a class="code" href="namespaceWTL.html#a15">05135</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CTabCtrlT.html">CTabCtrlT&lt;CWindow&gt;</a>  <a class="code" href="namespaceWTL.html#a15">CTabCtrl</a>;
05136 
05137 
05139 <font class="comment">// CTrackBarCtrl</font>
05140 
05141 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l05142"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html">05142</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CTrackBarCtrlT.html">CTrackBarCtrlT</a> : <font class="keyword">public</font> TBase
05143 {
05144 <font class="keyword">public</font>:
05145 <font class="comment">// Constructors</font>
<a name="l05146"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a0">05146</a>     <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a0">CTrackBarCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
05147 
<a name="l05148"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a1">05148</a>     <a class="code" href="classWTL_1_1CTrackBarCtrlT.html">CTrackBarCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a1">operator=</a>(HWND hWnd)
05149     {
05150         m_hWnd = hWnd;
05151         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
05152     }
05153 
<a name="l05154"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a2">05154</a>     HWND <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
05155             DWORD dwStyle = 0, DWORD dwExStyle = 0,
05156             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
05157     {
05158         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CTrackBarCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
05159     }
05160 
05161 <font class="comment">// Attributes</font>
<a name="l05162"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#d0">05162</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#d0">GetWndClassName</a>()
05163     {
05164         <font class="keywordflow">return</font> TRACKBAR_CLASS;
05165     }
05166 
<a name="l05167"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a3">05167</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a3">GetLineSize</a>()<font class="keyword"> const</font>
05168 <font class="keyword">    </font>{
05169         ATLASSERT(::IsWindow(m_hWnd));
05170         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETLINESIZE, 0, 0L);
05171     }
<a name="l05172"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a4">05172</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a4">SetLineSize</a>(<font class="keywordtype">int</font> nSize)
05173     {
05174         ATLASSERT(::IsWindow(m_hWnd));
05175         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_SETLINESIZE, 0, nSize);
05176     }
<a name="l05177"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a5">05177</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a5">GetPageSize</a>()<font class="keyword"> const</font>
05178 <font class="keyword">    </font>{
05179         ATLASSERT(::IsWindow(m_hWnd));
05180         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETPAGESIZE, 0, 0L);
05181     }
<a name="l05182"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a6">05182</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a6">SetPageSize</a>(<font class="keywordtype">int</font> nSize)
05183     {
05184         ATLASSERT(::IsWindow(m_hWnd));
05185         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_SETPAGESIZE, 0, nSize);
05186     }
<a name="l05187"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a7">05187</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a7">GetRangeMin</a>()<font class="keyword"> const</font>
05188 <font class="keyword">    </font>{
05189         ATLASSERT(::IsWindow(m_hWnd));
05190         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETRANGEMIN, 0, 0L);
05191     }
<a name="l05192"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a8">05192</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a8">SetRangeMin</a>(<font class="keywordtype">int</font> nMin, BOOL bRedraw = FALSE)
05193     {
05194         ATLASSERT(::IsWindow(m_hWnd));
05195         ::SendMessage(m_hWnd, TBM_SETRANGEMIN, bRedraw, nMin);
05196     }
<a name="l05197"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a9">05197</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a9">GetRangeMax</a>()<font class="keyword"> const</font>
05198 <font class="keyword">    </font>{
05199         ATLASSERT(::IsWindow(m_hWnd));
05200         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETRANGEMAX, 0, 0L);
05201     }
<a name="l05202"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a10">05202</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a10">SetRangeMax</a>(<font class="keywordtype">int</font> nMax, BOOL bRedraw = FALSE)
05203     {
05204         ATLASSERT(::IsWindow(m_hWnd));
05205         ::SendMessage(m_hWnd, TBM_SETRANGEMAX, bRedraw, nMax);
05206     }
<a name="l05207"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a11">05207</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a11">GetRange</a>(<font class="keywordtype">int</font>&amp; nMin, <font class="keywordtype">int</font>&amp; nMax)<font class="keyword"> const</font>
05208 <font class="keyword">    </font>{
05209         nMin = <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a7">GetRangeMin</a>();
05210         nMax = <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a9">GetRangeMax</a>();
05211     }
<a name="l05212"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a12">05212</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a12">SetRange</a>(<font class="keywordtype">int</font> nMin, <font class="keywordtype">int</font> nMax, BOOL bRedraw = TRUE)
05213     {
05214         ATLASSERT(::IsWindow(m_hWnd));
05215         ::SendMessage(m_hWnd, TBM_SETRANGE, bRedraw, MAKELPARAM(nMin, nMax));
05216     }
<a name="l05217"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a13">05217</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a13">GetSelStart</a>()<font class="keyword"> const</font>
05218 <font class="keyword">    </font>{
05219         ATLASSERT(::IsWindow(m_hWnd));
05220         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETSELSTART, 0, 0L);
05221     }
<a name="l05222"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a14">05222</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a14">SetSelStart</a>(<font class="keywordtype">int</font> nMin)
05223     {
05224         ATLASSERT(::IsWindow(m_hWnd));
05225         ::SendMessage(m_hWnd, TBM_SETSELSTART, 0, (LPARAM)nMin);
05226     }
<a name="l05227"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a15">05227</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a15">GetSelEnd</a>()<font class="keyword"> const</font>
05228 <font class="keyword">    </font>{
05229         ATLASSERT(::IsWindow(m_hWnd));
05230         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETSELEND, 0, 0L);
05231     }
<a name="l05232"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a16">05232</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a16">SetSelEnd</a>(<font class="keywordtype">int</font> nMax)
05233     {
05234         ATLASSERT(::IsWindow(m_hWnd));
05235         ::SendMessage(m_hWnd, TBM_SETSELEND, 0, (LPARAM)nMax);
05236     }
<a name="l05237"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a17">05237</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a17">GetSelection</a>(<font class="keywordtype">int</font>&amp; nMin, <font class="keywordtype">int</font>&amp; nMax)<font class="keyword"> const</font>
05238 <font class="keyword">    </font>{
05239         nMin = <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a13">GetSelStart</a>();
05240         nMax = <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a15">GetSelEnd</a>();
05241     }
<a name="l05242"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a18">05242</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a18">SetSelection</a>(<font class="keywordtype">int</font> nMin, <font class="keywordtype">int</font> nMax)
05243     {
05244         <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a14">SetSelStart</a>(nMin);
05245         <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a16">SetSelEnd</a>(nMax);
05246     }
<a name="l05247"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a19">05247</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a19">GetChannelRect</a>(LPRECT lprc)<font class="keyword"> const</font>
05248 <font class="keyword">    </font>{
05249         ATLASSERT(::IsWindow(m_hWnd));
05250         ::SendMessage(m_hWnd, TBM_GETCHANNELRECT, 0, (LPARAM)lprc);
05251     }
<a name="l05252"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a20">05252</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a20">GetThumbRect</a>(LPRECT lprc)<font class="keyword"> const</font>
05253 <font class="keyword">    </font>{
05254         ATLASSERT(::IsWindow(m_hWnd));
05255         ::SendMessage(m_hWnd, TBM_GETTHUMBRECT, 0, (LPARAM)lprc);
05256     }
<a name="l05257"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a21">05257</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a21">GetPos</a>()<font class="keyword"> const</font>
05258 <font class="keyword">    </font>{
05259         ATLASSERT(::IsWindow(m_hWnd));
05260         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETPOS, 0, 0L);
05261     }
<a name="l05262"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a22">05262</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a22">SetPos</a>(<font class="keywordtype">int</font> nPos)
05263     {
05264         ATLASSERT(::IsWindow(m_hWnd));
05265         ::SendMessage(m_hWnd, TBM_SETPOS, TRUE, nPos);
05266     }
<a name="l05267"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a23">05267</a>     UINT <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a23">GetNumTics</a>()<font class="keyword"> const</font>
05268 <font class="keyword">    </font>{
05269         ATLASSERT(::IsWindow(m_hWnd));
05270         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, TBM_GETNUMTICS, 0, 0L);
05271     }
<a name="l05272"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a24">05272</a>     DWORD* <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a24">GetTicArray</a>()<font class="keyword"> const</font>
05273 <font class="keyword">    </font>{
05274         ATLASSERT(::IsWindow(m_hWnd));
05275         <font class="keywordflow">return</font> (DWORD*)::SendMessage(m_hWnd, TBM_GETPTICS, 0, 0L);
05276     }
<a name="l05277"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a25">05277</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a25">GetTic</a>(<font class="keywordtype">int</font> nTic)<font class="keyword"> const</font>
05278 <font class="keyword">    </font>{
05279         ATLASSERT(::IsWindow(m_hWnd));
05280         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETTIC, nTic, 0L);
05281     }
<a name="l05282"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a26">05282</a>     BOOL <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a26">SetTic</a>(<font class="keywordtype">int</font> nTic)
05283     {
05284         ATLASSERT(::IsWindow(m_hWnd));
05285         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TBM_SETTIC, 0, nTic);
05286     }
<a name="l05287"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a27">05287</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a27">GetTicPos</a>(<font class="keywordtype">int</font> nTic)<font class="keyword"> const</font>
05288 <font class="keyword">    </font>{
05289         ATLASSERT(::IsWindow(m_hWnd));
05290         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETTICPOS, nTic, 0L);
05291     }
<a name="l05292"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a28">05292</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a28">SetTicFreq</a>(<font class="keywordtype">int</font> nFreq)
05293     {
05294         ATLASSERT(::IsWindow(m_hWnd));
05295         ::SendMessage(m_hWnd, TBM_SETTICFREQ, nFreq, 0L);
05296     }
05297 
<a name="l05298"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a29">05298</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a29">GetThumbLength</a>()<font class="keyword"> const</font>
05299 <font class="keyword">    </font>{
05300         ATLASSERT(::IsWindow(m_hWnd));
05301         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_GETTHUMBLENGTH, 0, 0L);
05302     }
<a name="l05303"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a30">05303</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a30">SetThumbLength</a>(<font class="keywordtype">int</font> nLength)
05304     {
05305         ATLASSERT(::IsWindow(m_hWnd));
05306         ::SendMessage(m_hWnd, TBM_SETTHUMBLENGTH, nLength, 0L);
05307     }
<a name="l05308"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a31">05308</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a31">SetSel</a>(<font class="keywordtype">int</font> nStart, <font class="keywordtype">int</font> nEnd, BOOL bRedraw = TRUE)
05309     {
05310         ATLASSERT(::IsWindow(m_hWnd));
05311         ATLASSERT((GetStyle() &amp; TBS_ENABLESELRANGE) != 0);
05312         ::SendMessage(m_hWnd, TBM_SETSEL, bRedraw, MAKELPARAM(nStart, nEnd));
05313     }
<a name="l05314"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a32">05314</a>     <a class="code" href="classCWindow.html">CWindow</a> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a32">GetBuddy</a>(BOOL bLeft = TRUE)<font class="keyword"> const</font>
05315 <font class="keyword">    </font>{
05316         ATLASSERT(::IsWindow(m_hWnd));
05317         <font class="keywordflow">return</font> <a class="code" href="classCWindow.html">CWindow</a>((HWND)::SendMessage(m_hWnd, TBM_GETBUDDY, bLeft, 0L));
05318     }
<a name="l05319"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a33">05319</a>     <a class="code" href="classCWindow.html">CWindow</a> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a33">SetBuddy</a>(HWND hWndBuddy, BOOL bLeft = TRUE)
05320     {
05321         ATLASSERT(::IsWindow(m_hWnd));
05322         <font class="keywordflow">return</font> <a class="code" href="classCWindow.html">CWindow</a>((HWND)::SendMessage(m_hWnd, TBM_SETBUDDY, bLeft, (LPARAM)hWndBuddy));
05323     }
<a name="l05324"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a34">05324</a>     CToolTipCtrl <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a34">GetToolTips</a>()<font class="keyword"> const</font>
05325 <font class="keyword">    </font>{
05326         ATLASSERT(::IsWindow(m_hWnd));
05327         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, TBM_GETTOOLTIPS, 0, 0L));
05328     }
<a name="l05329"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a35">05329</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a35">SetToolTips</a>(HWND hWndTT)
05330     {
05331         ATLASSERT(::IsWindow(m_hWnd));
05332         ::SendMessage(m_hWnd, TBM_SETTOOLTIPS, (WPARAM)hWndTT, 0L);
05333     }
<a name="l05334"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a36">05334</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a36">SetTipSide</a>(<font class="keywordtype">int</font> nSide)
05335     {
05336         ATLASSERT(::IsWindow(m_hWnd));
05337         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, TBM_SETTIPSIDE, nSide, 0L);
05338     }
05339 
05340 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l05341"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a37">05341</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a37">GetUnicodeFormat</a>()<font class="keyword"> const</font>
05342 <font class="keyword">    </font>{
05343         ATLASSERT(::IsWindow(m_hWnd));
05344         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TBM_GETUNICODEFORMAT, 0, 0L);
05345     }
<a name="l05346"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a38">05346</a>     BOOL <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a38">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
05347     {
05348         ATLASSERT(::IsWindow(m_hWnd));
05349         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, TBM_SETUNICODEFORMAT, bUnicode, 0L);
05350     }
05351 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
05352 <font class="preprocessor"></font>
05353 <font class="comment">// Operations</font>
<a name="l05354"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a39">05354</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a39">ClearSel</a>(BOOL bRedraw = FALSE)
05355     {
05356         ATLASSERT(::IsWindow(m_hWnd));
05357         ::SendMessage(m_hWnd, TBM_CLEARSEL, bRedraw, 0L);
05358     }
<a name="l05359"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a40">05359</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a40">VerifyPos</a>()
05360     {
05361         ATLASSERT(::IsWindow(m_hWnd));
05362         ::SendMessage(m_hWnd, TBM_SETPOS, FALSE, 0L);
05363     }
<a name="l05364"></a><a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a41">05364</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html#a41">ClearTics</a>(BOOL bRedraw = FALSE)
05365     {
05366         ATLASSERT(::IsWindow(m_hWnd));
05367         ::SendMessage(m_hWnd, TBM_CLEARTICS, bRedraw, 0L);
05368     }
05369 };
05370 
<a name="l05371"></a><a class="code" href="namespaceWTL.html#a16">05371</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CTrackBarCtrlT.html">CTrackBarCtrlT&lt;CWindow&gt;</a>     <a class="code" href="namespaceWTL.html#a16">CTrackBarCtrl</a>;
05372 
05373 
05375 <font class="comment">// CUpDownCtrl</font>
05376 
05377 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l05378"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html">05378</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CUpDownCtrlT.html">CUpDownCtrlT</a> : <font class="keyword">public</font> TBase
05379 {
05380 <font class="keyword">public</font>:
05381 <font class="comment">// Constructors</font>
<a name="l05382"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a0">05382</a>     <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a0">CUpDownCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
05383 
<a name="l05384"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a1">05384</a>     <a class="code" href="classWTL_1_1CUpDownCtrlT.html">CUpDownCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a1">operator=</a>(HWND hWnd)
05385     {
05386         m_hWnd = hWnd;
05387         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
05388     }
05389 
<a name="l05390"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a2">05390</a>     HWND <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
05391             DWORD dwStyle = 0, DWORD dwExStyle = 0,
05392             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
05393     {
05394         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CUpDownCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
05395     }
05396 
05397 <font class="comment">// Attributes</font>
<a name="l05398"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#d0">05398</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CUpDownCtrlT.html#d0">GetWndClassName</a>()
05399     {
05400         <font class="keywordflow">return</font> UPDOWN_CLASS;
05401     }
05402 
<a name="l05403"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a3">05403</a>     UINT <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a3">GetAccel</a>(<font class="keywordtype">int</font> nAccel, UDACCEL* pAccel)<font class="keyword"> const</font>
05404 <font class="keyword">    </font>{
05405         ATLASSERT(::IsWindow(m_hWnd));
05406         <font class="keywordflow">return</font> (UINT)LOWORD(::SendMessage(m_hWnd, UDM_GETACCEL, nAccel, (LPARAM)pAccel));
05407     }
<a name="l05408"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a4">05408</a>     BOOL <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a4">SetAccel</a>(<font class="keywordtype">int</font> nAccel, UDACCEL* pAccel)
05409     {
05410         ATLASSERT(::IsWindow(m_hWnd));
05411         <font class="keywordflow">return</font> (BOOL)LOWORD(::SendMessage(m_hWnd, UDM_SETACCEL, nAccel, (LPARAM)pAccel));
05412     }
<a name="l05413"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a5">05413</a>     UINT <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a5">GetBase</a>()<font class="keyword"> const</font>
05414 <font class="keyword">    </font>{
05415         ATLASSERT(::IsWindow(m_hWnd));
05416         <font class="keywordflow">return</font> (UINT)LOWORD(::SendMessage(m_hWnd, UDM_GETBASE, 0, 0L));
05417     }
<a name="l05418"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a6">05418</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a6">SetBase</a>(<font class="keywordtype">int</font> nBase)
05419     {
05420         ATLASSERT(::IsWindow(m_hWnd));
05421         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, UDM_SETBASE, nBase, 0L);
05422     }
<a name="l05423"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a7">05423</a>     <a class="code" href="classCWindow.html">CWindow</a> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a7">GetBuddy</a>()<font class="keyword"> const</font>
05424 <font class="keyword">    </font>{
05425         ATLASSERT(::IsWindow(m_hWnd));
05426         <font class="keywordflow">return</font> <a class="code" href="classCWindow.html">CWindow</a>((HWND)::SendMessage(m_hWnd, UDM_GETBUDDY, 0, 0L));
05427     }
<a name="l05428"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a8">05428</a>     <a class="code" href="classCWindow.html">CWindow</a> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a8">SetBuddy</a>(HWND hWndBuddy)
05429     {
05430         ATLASSERT(::IsWindow(m_hWnd));
05431         <font class="keywordflow">return</font> <a class="code" href="classCWindow.html">CWindow</a>((HWND)::SendMessage(m_hWnd, UDM_SETBUDDY, (WPARAM)hWndBuddy, 0L));
05432     }
<a name="l05433"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a9">05433</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a9">GetPos</a>()<font class="keyword"> const</font>
05434 <font class="keyword">    </font>{
05435         ATLASSERT(::IsWindow(m_hWnd));
05436         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, UDM_GETPOS, 0, 0L);
05437     }
<a name="l05438"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a10">05438</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a10">SetPos</a>(<font class="keywordtype">int</font> nPos)
05439     {
05440         ATLASSERT(::IsWindow(m_hWnd));
05441         <font class="keywordflow">return</font> (int)(short)LOWORD(::SendMessage(m_hWnd, UDM_SETPOS, 0, MAKELPARAM(nPos, 0)));
05442     }
<a name="l05443"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a11">05443</a>     DWORD <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a11">GetRange</a>()<font class="keyword"> const</font>
05444 <font class="keyword">    </font>{
05445         ATLASSERT(::IsWindow(m_hWnd));
05446         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, UDM_GETRANGE, 0, 0L);
05447     }
<a name="l05448"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a12">05448</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a11">GetRange</a>(<font class="keywordtype">int</font>&amp; nLower, <font class="keywordtype">int</font>&amp; nUpper)<font class="keyword"> const</font>
05449 <font class="keyword">    </font>{
05450         ATLASSERT(::IsWindow(m_hWnd));
05451         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, UDM_GETRANGE, 0, 0L);
05452         nLower = (int)(short)HIWORD(dwRet);
05453         nUpper = (int)(short)LOWORD(dwRet);
05454     }
<a name="l05455"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a13">05455</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a13">SetRange</a>(<font class="keywordtype">int</font> nLower, <font class="keywordtype">int</font> nUpper)
05456     {
05457         ATLASSERT(::IsWindow(m_hWnd));
05458         ::SendMessage(m_hWnd, UDM_SETRANGE, 0, MAKELPARAM(nUpper, nLower));
05459     }
05460 
05461 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l05462"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a14">05462</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a14">SetRange32</a>(<font class="keywordtype">int</font> nLower, <font class="keywordtype">int</font> nUpper)
05463     {
05464         ATLASSERT(::IsWindow(m_hWnd));
05465         ::SendMessage(m_hWnd, UDM_SETRANGE32, nLower, nUpper);
05466     }
<a name="l05467"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a15">05467</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a15">GetRange32</a>(<font class="keywordtype">int</font>&amp; nLower, <font class="keywordtype">int</font>&amp; nUpper)<font class="keyword"> const</font>
05468 <font class="keyword">    </font>{
05469         ATLASSERT(::IsWindow(m_hWnd));
05470         ::SendMessage(m_hWnd, UDM_GETRANGE32, (WPARAM)&amp;nLower, (LPARAM)&amp;nUpper);
05471     }
<a name="l05472"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a16">05472</a>     BOOL <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a16">GetUnicodeFormat</a>()<font class="keyword"> const</font>
05473 <font class="keyword">    </font>{
05474         ATLASSERT(::IsWindow(m_hWnd));
05475         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, UDM_GETUNICODEFORMAT, 0, 0L);
05476     }
<a name="l05477"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a17">05477</a>     BOOL <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a17">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
05478     {
05479         ATLASSERT(::IsWindow(m_hWnd));
05480         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, UDM_SETUNICODEFORMAT, bUnicode, 0L);
05481     }
05482 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
05483 <font class="preprocessor"></font>
05484 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l05485"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a18">05485</a> <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a18">GetPos32</a>(LPBOOL lpbError <font class="comment">/*= NULL*/</font>)<font class="keyword"> const</font>
05486 <font class="keyword">    </font>{
05487         ATLASSERT(::IsWindow(m_hWnd));
05488         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, UDM_GETPOS32, 0, (LPARAM)lpbError);
05489     }
<a name="l05490"></a><a class="code" href="classWTL_1_1CUpDownCtrlT.html#a19">05490</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html#a19">SetPos32</a>(<font class="keywordtype">int</font> nPos)
05491     {
05492         ATLASSERT(::IsWindow(m_hWnd));
05493         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, UDM_SETPOS32, 0, (LPARAM)nPos);
05494     }
05495 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
05496 <font class="preprocessor"></font>};
05497 
<a name="l05498"></a><a class="code" href="namespaceWTL.html#a17">05498</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CUpDownCtrlT.html">CUpDownCtrlT&lt;CWindow&gt;</a>       <a class="code" href="namespaceWTL.html#a17">CUpDownCtrl</a>;
05499 
05500 
05502 <font class="comment">// CProgressBarCtrl</font>
05503 
05504 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l05505"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html">05505</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CProgressBarCtrlT.html">CProgressBarCtrlT</a> : <font class="keyword">public</font> TBase
05506 {
05507 <font class="keyword">public</font>:
05508 <font class="comment">// Constructors</font>
<a name="l05509"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a0">05509</a>     <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a0">CProgressBarCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
05510 
<a name="l05511"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a1">05511</a>     <a class="code" href="classWTL_1_1CProgressBarCtrlT.html">CProgressBarCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a1">operator=</a>(HWND hWnd)
05512     {
05513         m_hWnd = hWnd;
05514         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
05515     }
05516 
<a name="l05517"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a2">05517</a>     HWND <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
05518             DWORD dwStyle = 0, DWORD dwExStyle = 0,
05519             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
05520     {
05521         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CProgressBarCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
05522     }
05523 
05524 <font class="comment">// Attributes</font>
<a name="l05525"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#d0">05525</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#d0">GetWndClassName</a>()
05526     {
05527         <font class="keywordflow">return</font> PROGRESS_CLASS;
05528     }
05529 
<a name="l05530"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a3">05530</a>     DWORD <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a3">SetRange</a>(<font class="keywordtype">int</font> nLower, <font class="keywordtype">int</font> nUpper)
05531     {
05532         ATLASSERT(::IsWindow(m_hWnd));
05533         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, PBM_SETRANGE, 0, MAKELPARAM(nLower, nUpper));
05534     }
<a name="l05535"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a4">05535</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a4">SetPos</a>(<font class="keywordtype">int</font> nPos)
05536     {
05537         ATLASSERT(::IsWindow(m_hWnd));
05538         <font class="keywordflow">return</font> (int)(short)LOWORD(::SendMessage(m_hWnd, PBM_SETPOS, nPos, 0L));
05539     }
<a name="l05540"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a5">05540</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a5">OffsetPos</a>(<font class="keywordtype">int</font> nPos)
05541     {
05542         ATLASSERT(::IsWindow(m_hWnd));
05543         <font class="keywordflow">return</font> (int)(short)LOWORD(::SendMessage(m_hWnd, PBM_DELTAPOS, nPos, 0L));
05544     }
<a name="l05545"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a6">05545</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a6">SetStep</a>(<font class="keywordtype">int</font> nStep)
05546     {
05547         ATLASSERT(::IsWindow(m_hWnd));
05548         <font class="keywordflow">return</font> (int)(short)LOWORD(::SendMessage(m_hWnd, PBM_SETSTEP, nStep, 0L));
05549     }
<a name="l05550"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a7">05550</a>     UINT <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a7">GetPos</a>()<font class="keyword"> const</font>
05551 <font class="keyword">    </font>{
05552         ATLASSERT(::IsWindow(m_hWnd));
05553         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, PBM_GETPOS, 0, 0L);
05554     }
<a name="l05555"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a8">05555</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a8">GetRange</a>(PPBRANGE pPBRange)<font class="keyword"> const</font>
05556 <font class="keyword">    </font>{
05557         ATLASSERT(::IsWindow(m_hWnd));
05558         ATLASSERT(pPBRange != NULL);
05559         ::SendMessage(m_hWnd, PBM_GETRANGE, TRUE, (LPARAM)pPBRange);
05560     }
<a name="l05561"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a9">05561</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a9">GetRangeLimit</a>(BOOL bLimit)<font class="keyword"> const</font>
05562 <font class="keyword">    </font>{
05563         ATLASSERT(::IsWindow(m_hWnd));
05564         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PBM_GETRANGE, bLimit, (LPARAM)NULL);
05565     }
<a name="l05566"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a10">05566</a>     DWORD <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a10">SetRange32</a>(<font class="keywordtype">int</font> nMin, <font class="keywordtype">int</font> nMax)
05567     {
05568         ATLASSERT(::IsWindow(m_hWnd));
05569         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, PBM_SETRANGE32, nMin, nMax);
05570     }
05571 
05572 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l05573"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a11">05573</a> <font class="preprocessor"></font>    COLORREF <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a11">SetBarColor</a>(COLORREF clr)
05574     {
05575         ATLASSERT(::IsWindow(m_hWnd));
05576         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, PBM_SETBARCOLOR, 0, (LPARAM)clr);
05577     }
<a name="l05578"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a12">05578</a>     COLORREF <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a12">SetBkColor</a>(COLORREF clr)
05579     {
05580         ATLASSERT(::IsWindow(m_hWnd));
05581         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, PBM_SETBKCOLOR, 0, (LPARAM)clr);
05582     }
05583 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
05584 <font class="preprocessor"></font>
05585 <font class="comment">// Operations</font>
<a name="l05586"></a><a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a13">05586</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html#a13">StepIt</a>()
05587     {
05588         ATLASSERT(::IsWindow(m_hWnd));
05589         <font class="keywordflow">return</font> (int)(short)LOWORD(::SendMessage(m_hWnd, PBM_STEPIT, 0, 0L));
05590     }
05591 };
05592 
<a name="l05593"></a><a class="code" href="namespaceWTL.html#a18">05593</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CProgressBarCtrlT.html">CProgressBarCtrlT&lt;CWindow&gt;</a>  <a class="code" href="namespaceWTL.html#a18">CProgressBarCtrl</a>;
05594 
05595 
05597 <font class="comment">// CHotKeyCtrl</font>
05598 
05599 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l05600"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html">05600</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CHotKeyCtrlT.html">CHotKeyCtrlT</a> : <font class="keyword">public</font> TBase
05601 {
05602 <font class="keyword">public</font>:
05603 <font class="comment">// Constructors</font>
<a name="l05604"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a0">05604</a>     <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a0">CHotKeyCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
05605 
<a name="l05606"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a1">05606</a>     <a class="code" href="classWTL_1_1CHotKeyCtrlT.html">CHotKeyCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a1">operator=</a>(HWND hWnd)
05607     {
05608         m_hWnd = hWnd;
05609         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
05610     }
05611 
<a name="l05612"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a2">05612</a>     HWND <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
05613             DWORD dwStyle = 0, DWORD dwExStyle = 0,
05614             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
05615     {
05616         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CHotKeyCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
05617     }
05618 
05619 <font class="comment">// Attributes</font>
<a name="l05620"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#d0">05620</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#d0">GetWndClassName</a>()
05621     {
05622         <font class="keywordflow">return</font> HOTKEY_CLASS;
05623     }
05624 
<a name="l05625"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a3">05625</a>     DWORD <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a3">GetHotKey</a>()<font class="keyword"> const</font>
05626 <font class="keyword">    </font>{
05627         ATLASSERT(::IsWindow(m_hWnd));
05628         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, HKM_GETHOTKEY, 0, 0L);
05629     }
<a name="l05630"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a4">05630</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a3">GetHotKey</a>(WORD &amp;wVirtualKeyCode, WORD &amp;wModifiers)<font class="keyword"> const</font>
05631 <font class="keyword">    </font>{
05632         ATLASSERT(::IsWindow(m_hWnd));
05633         DWORD dw = (DWORD)::SendMessage(m_hWnd, HKM_GETHOTKEY, 0, 0L);
05634         wVirtualKeyCode = LOBYTE(LOWORD(dw));
05635         wModifiers = HIBYTE(LOWORD(dw));
05636     }
<a name="l05637"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a5">05637</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a5">SetHotKey</a>(WORD wVirtualKeyCode, WORD wModifiers)
05638     {
05639         ATLASSERT(::IsWindow(m_hWnd));
05640         ::SendMessage(m_hWnd, HKM_SETHOTKEY, MAKEWORD(wVirtualKeyCode, wModifiers), 0L);
05641     }
05642 
<a name="l05643"></a><a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a6">05643</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CHotKeyCtrlT.html#a6">SetRules</a>(WORD wInvalidComb, WORD wModifiers)
05644     {
05645         ATLASSERT(::IsWindow(m_hWnd));
05646         ::SendMessage(m_hWnd, HKM_SETRULES, wInvalidComb, MAKELPARAM(wModifiers, 0));
05647     }
05648 };
05649 
<a name="l05650"></a><a class="code" href="namespaceWTL.html#a19">05650</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CHotKeyCtrlT.html">CHotKeyCtrlT&lt;CWindow&gt;</a>       <a class="code" href="namespaceWTL.html#a19">CHotKeyCtrl</a>;
05651 
05652 
05654 <font class="comment">// CAnimateCtrl</font>
05655 
05656 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l05657"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html">05657</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CAnimateCtrlT.html">CAnimateCtrlT</a> : <font class="keyword">public</font> TBase
05658 {
05659 <font class="keyword">public</font>:
05660 <font class="comment">// Constructors</font>
<a name="l05661"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a0">05661</a>     <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a0">CAnimateCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
05662 
<a name="l05663"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a1">05663</a>     <a class="code" href="classWTL_1_1CAnimateCtrlT.html">CAnimateCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a1">operator=</a>(HWND hWnd)
05664     {
05665         m_hWnd = hWnd;
05666         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
05667     }
05668 
<a name="l05669"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a2">05669</a>     HWND <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
05670             DWORD dwStyle = 0, DWORD dwExStyle = 0,
05671             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
05672     {
05673         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CAnimateCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
05674     }
05675 
05676 <font class="comment">// Attributes</font>
<a name="l05677"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#d0">05677</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CAnimateCtrlT.html#d0">GetWndClassName</a>()
05678     {
05679         <font class="keywordflow">return</font> ANIMATE_CLASS;
05680     }
05681 
05682 <font class="comment">// Operations</font>
<a name="l05683"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a3">05683</a>     BOOL <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a3">Open</a>(<a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> FileName)
05684     {
05685         ATLASSERT(::IsWindow(m_hWnd));
05686         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, ACM_OPEN, 0, (LPARAM)FileName.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>);
05687     }
<a name="l05688"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a4">05688</a>     BOOL <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a4">Play</a>(UINT nFrom, UINT nTo, UINT nRep)
05689     {
05690         ATLASSERT(::IsWindow(m_hWnd));
05691         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, ACM_PLAY, nRep, MAKELPARAM(nFrom, nTo));
05692     }
<a name="l05693"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a5">05693</a>     BOOL <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a5">Stop</a>()
05694     {
05695         ATLASSERT(::IsWindow(m_hWnd));
05696         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, ACM_STOP, 0, 0L);
05697     }
<a name="l05698"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a6">05698</a>     BOOL <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a6">Close</a>()
05699     {
05700         ATLASSERT(::IsWindow(m_hWnd));
05701         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, ACM_OPEN, 0, 0L);
05702     }
<a name="l05703"></a><a class="code" href="classWTL_1_1CAnimateCtrlT.html#a7">05703</a>     BOOL <a class="code" href="classWTL_1_1CAnimateCtrlT.html#a7">Seek</a>(UINT nTo)
05704     {
05705         ATLASSERT(::IsWindow(m_hWnd));
05706         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, ACM_PLAY, 0, MAKELPARAM(nTo, nTo));
05707     }
05708 };
05709 
<a name="l05710"></a><a class="code" href="namespaceWTL.html#a20">05710</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CAnimateCtrlT.html">CAnimateCtrlT&lt;CWindow&gt;</a>      <a class="code" href="namespaceWTL.html#a20">CAnimateCtrl</a>;
05711 
05712 
05714 <font class="comment">// CRichEditCtrl</font>
05715 
05716 <font class="preprocessor">#ifdef _UNICODE</font>
05717 <font class="preprocessor"></font><font class="preprocessor">#if (_RICHEDIT_VER == 0x0100)</font>
05718 <font class="preprocessor"></font><font class="preprocessor">#undef RICHEDIT_CLASS</font>
05719 <font class="preprocessor"></font><font class="preprocessor">#define RICHEDIT_CLASS  L"RICHEDIT"</font>
05720 <font class="preprocessor"></font><font class="preprocessor">#endif //(_RICHEDIT_VER == 0x0100)</font>
05721 <font class="preprocessor"></font><font class="preprocessor">#endif //_UNICODE</font>
05722 <font class="preprocessor"></font>
05723 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l05724"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html">05724</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CRichEditCtrlT.html">CRichEditCtrlT</a> : <font class="keyword">public</font> TBase
05725 {
05726 <font class="keyword">public</font>:
05727 <font class="comment">// Constructors</font>
<a name="l05728"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a0">05728</a>     <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a0">CRichEditCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
05729 
<a name="l05730"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a1">05730</a>     <a class="code" href="classWTL_1_1CRichEditCtrlT.html">CRichEditCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a1">operator=</a>(HWND hWnd)
05731     {
05732         m_hWnd = hWnd;
05733         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
05734     }
05735 
<a name="l05736"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a2">05736</a>     HWND <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
05737             DWORD dwStyle = 0, DWORD dwExStyle = 0,
05738             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
05739     {
05740         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CRichEditCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
05741     }
05742 
05743 <font class="comment">// Attributes</font>
<a name="l05744"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#d0">05744</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CRichEditCtrlT.html#d0">GetWndClassName</a>()
05745     {
05746         <font class="keywordflow">return</font> RICHEDIT_CLASS;
05747     }
05748 
<a name="l05749"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#d1">05749</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CRichEditCtrlT.html#d1">GetLibraryName</a>()
05750     {
05751 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200)</font>
05752 <font class="preprocessor"></font>        <font class="keywordflow">return</font> _T(<font class="stringliteral">"RICHED20.DLL"</font>);
05753 <font class="preprocessor">#else</font>
05754 <font class="preprocessor"></font>        <font class="keywordflow">return</font> _T(<font class="stringliteral">"RICHED32.DLL"</font>);
05755 <font class="preprocessor">#endif</font>
05756 <font class="preprocessor"></font>    }
05757 
<a name="l05758"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a3">05758</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a3">GetLineCount</a>()<font class="keyword"> const</font>
05759 <font class="keyword">    </font>{
05760         ATLASSERT(::IsWindow(m_hWnd));
05761         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETLINECOUNT, 0, 0L);
05762     }
<a name="l05763"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a4">05763</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a4">GetModify</a>()<font class="keyword"> const</font>
05764 <font class="keyword">    </font>{
05765         ATLASSERT(::IsWindow(m_hWnd));
05766         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_GETMODIFY, 0, 0L);
05767     }
<a name="l05768"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a5">05768</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a5">SetModify</a>(BOOL bModified = TRUE)
05769     {
05770         ATLASSERT(::IsWindow(m_hWnd));
05771         ::SendMessage(m_hWnd, EM_SETMODIFY, bModified, 0L);
05772     }
<a name="l05773"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a6">05773</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a6">GetRect</a>(LPRECT lpRect)<font class="keyword"> const</font>
05774 <font class="keyword">    </font>{
05775         ATLASSERT(::IsWindow(m_hWnd));
05776         ::SendMessage(m_hWnd, EM_GETRECT, 0, (LPARAM)lpRect);
05777     }
<a name="l05778"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a7">05778</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a7">GetOptions</a>()<font class="keyword"> const</font>
05779 <font class="keyword">    </font>{
05780         ATLASSERT(::IsWindow(m_hWnd));
05781         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETOPTIONS, 0, 0L);
05782     }
<a name="l05783"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a8">05783</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a8">SetOptions</a>(WORD wOperation, DWORD dwOptions)
05784     {
05785         ATLASSERT(::IsWindow(m_hWnd));
05786         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_SETOPTIONS, wOperation, dwOptions);
05787     }
05788 
05789     <font class="comment">// NOTE: first word in lpszBuffer must contain the size of the buffer!</font>
<a name="l05790"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a9">05790</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a9">GetLine</a>(<font class="keywordtype">int</font> nIndex, LPTSTR lpszBuffer)<font class="keyword"> const</font>
05791 <font class="keyword">    </font>{
05792         ATLASSERT(::IsWindow(m_hWnd));
05793         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETLINE, nIndex, (LPARAM)lpszBuffer);
05794     }
<a name="l05795"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a10">05795</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a9">GetLine</a>(<font class="keywordtype">int</font> nIndex, LPTSTR lpszBuffer, <font class="keywordtype">int</font> nMaxLength)<font class="keyword"> const</font>
05796 <font class="keyword">    </font>{
05797         ATLASSERT(::IsWindow(m_hWnd));
05798         *(LPINT)lpszBuffer = nMaxLength;
05799         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETLINE, nIndex, (LPARAM)lpszBuffer);
05800     }
05801 
<a name="l05802"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a11">05802</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a11">CanUndo</a>()<font class="keyword"> const</font>
05803 <font class="keyword">    </font>{
05804         ATLASSERT(::IsWindow(m_hWnd));
05805         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_CANUNDO, 0, 0L);
05806     }
<a name="l05807"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a12">05807</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a12">CanPaste</a>(UINT nFormat = 0)<font class="keyword"> const</font>
05808 <font class="keyword">    </font>{
05809         ATLASSERT(::IsWindow(m_hWnd));
05810         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_CANPASTE, nFormat, 0L);
05811     }
<a name="l05812"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a13">05812</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a13">GetSel</a>(LONG&amp; nStartChar, LONG&amp; nEndChar)<font class="keyword"> const</font>
05813 <font class="keyword">    </font>{
05814         ATLASSERT(::IsWindow(m_hWnd));
05815         CHARRANGE cr;
05816         ::SendMessage(m_hWnd, EM_EXGETSEL, 0, (LPARAM)&amp;cr);
05817         nStartChar = cr.cpMin;
05818         nEndChar = cr.cpMax;
05819     }
<a name="l05820"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a14">05820</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a13">GetSel</a>(CHARRANGE &amp;cr)<font class="keyword"> const</font>
05821 <font class="keyword">    </font>{
05822         ATLASSERT(::IsWindow(m_hWnd));
05823         ::SendMessage(m_hWnd, EM_EXGETSEL, 0, (LPARAM)&amp;cr);
05824     }
<a name="l05825"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a15">05825</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a15">SetSel</a>(LONG nStartChar, LONG nEndChar)
05826     {
05827         ATLASSERT(::IsWindow(m_hWnd));
05828         CHARRANGE cr = { nStartChar, nEndChar };
05829         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_EXSETSEL, 0, (LPARAM)&amp;cr);
05830     }
<a name="l05831"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a16">05831</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a15">SetSel</a>(CHARRANGE &amp;cr)
05832     {
05833         ATLASSERT(::IsWindow(m_hWnd));
05834         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_EXSETSEL, 0, (LPARAM)&amp;cr);
05835     }
<a name="l05836"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a17">05836</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a17">SetSelAll</a>()
05837     {
05838         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a15">SetSel</a>(0, -1);
05839     }
<a name="l05840"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a18">05840</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a18">SetSelNone</a>()
05841     {
05842         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a15">SetSel</a>(-1, 0);
05843     }
<a name="l05844"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a19">05844</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a19">GetDefaultCharFormat</a>(CHARFORMAT&amp; cf)<font class="keyword"> const</font>
05845 <font class="keyword">    </font>{
05846         ATLASSERT(::IsWindow(m_hWnd));
05847         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT);
05848         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETCHARFORMAT, 0, (LPARAM)&amp;cf);
05849     }
<a name="l05850"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a20">05850</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a20">GetSelectionCharFormat</a>(CHARFORMAT&amp; cf)<font class="keyword"> const</font>
05851 <font class="keyword">    </font>{
05852         ATLASSERT(::IsWindow(m_hWnd));
05853         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT);
05854         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETCHARFORMAT, 1, (LPARAM)&amp;cf);
05855     }
<a name="l05856"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a21">05856</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a21">GetEventMask</a>()<font class="keyword"> const</font>
05857 <font class="keyword">    </font>{
05858         ATLASSERT(::IsWindow(m_hWnd));
05859         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETEVENTMASK, 0, 0L);
05860     }
<a name="l05861"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a22">05861</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a22">GetLimitText</a>()<font class="keyword"> const</font>
05862 <font class="keyword">    </font>{
05863         ATLASSERT(::IsWindow(m_hWnd));
05864         <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_GETLIMITTEXT, 0, 0L);
05865     }
<a name="l05866"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a23">05866</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a23">GetParaFormat</a>(PARAFORMAT&amp; pf)<font class="keyword"> const</font>
05867 <font class="keyword">    </font>{
05868         ATLASSERT(::IsWindow(m_hWnd));
05869         pf.cbSize = <font class="keyword">sizeof</font>(PARAFORMAT);
05870         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETPARAFORMAT, 0, (LPARAM)&amp;pf);
05871     }
05872     <font class="comment">// richedit EM_GETSELTEXT is ANSI</font>
<a name="l05873"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a24">05873</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a24">GetSelText</a>(LPSTR lpBuf)<font class="keyword"> const</font>
05874 <font class="keyword">    </font>{
05875         ATLASSERT(::IsWindow(m_hWnd));
05876         <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_GETSELTEXT, 0, (LPARAM)lpBuf);
05877     }
05878 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
<a name="l05879"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a25">05879</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a25">GetSelTextBSTR</a>(BSTR&amp; bstrText)<font class="keyword"> const</font>
05880 <font class="keyword">    </font>{
05881         USES_CONVERSION;
05882         ATLASSERT(::IsWindow(m_hWnd));
05883         ATLASSERT(bstrText == NULL);
05884 
05885         CHARRANGE cr;
05886         cr.cpMin = cr.cpMax = 0;
05887         ::SendMessage(m_hWnd, EM_EXGETSEL, 0, (LPARAM)&amp;cr);
05888         LPSTR lpstrText = (<font class="keywordtype">char</font>*)_alloca((cr.cpMax - cr.cpMin + 1) * 2);
05889         lpstrText[0] = 0;
05890         <font class="keywordflow">if</font>(::SendMessage(m_hWnd, EM_GETSELTEXT, 0, (LPARAM)lpstrText) == 0)
05891             <font class="keywordflow">return</font> FALSE;
05892 
05893         bstrText = ::SysAllocString(A2W(lpstrText));
05894         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
05895     }
05896 <font class="preprocessor">#endif </font>
05897 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
05898 <font class="preprocessor"></font>    LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a24">GetSelText</a>(CString&amp; strText)<font class="keyword"> const</font>
05899 <font class="keyword">    </font>{
05900         ATLASSERT(::IsWindow(m_hWnd));
05901 
05902         CHARRANGE cr;
05903         cr.cpMin = cr.cpMax = 0;
05904         ::SendMessage(m_hWnd, EM_EXGETSEL, 0, (LPARAM)&amp;cr);
05905         LPSTR lpstrText = (<font class="keywordtype">char</font>*)_alloca((cr.cpMax - cr.cpMin + 1) * 2);
05906         lpstrText[0] = 0;
05907         LONG lLen = (LONG)::SendMessage(m_hWnd, EM_GETSELTEXT, 0, (LPARAM)lpstrText);
05908         <font class="keywordflow">if</font>(lLen == 0)
05909             <font class="keywordflow">return</font> 0;
05910 
05911         USES_CONVERSION;
05912         strText = A2T(lpstrText);
05913         <font class="keywordflow">return</font> lLen;
05914     }
05915 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l05916"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a26">05916</a> <font class="preprocessor"></font>    WORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a26">GetSelectionType</a>()<font class="keyword"> const</font>
05917 <font class="keyword">    </font>{
05918         ATLASSERT(::IsWindow(m_hWnd));
05919         <font class="keywordflow">return</font> (WORD)::SendMessage(m_hWnd, EM_SELECTIONTYPE, 0, 0L);
05920     }
<a name="l05921"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a27">05921</a>     COLORREF <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a28">SetBackgroundColor</a>(COLORREF cr)
05922     {
05923         ATLASSERT(::IsWindow(m_hWnd));
05924         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, EM_SETBKGNDCOLOR, 0, cr);
05925     }
<a name="l05926"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a28">05926</a>     COLORREF <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a28">SetBackgroundColor</a>()   <font class="comment">// sets to system background</font>
05927     {
05928         ATLASSERT(::IsWindow(m_hWnd));
05929         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, EM_SETBKGNDCOLOR, 1, 0);
05930     }
<a name="l05931"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a29">05931</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a29">SetCharFormat</a>(CHARFORMAT&amp; cf, WORD wFlags)
05932     {
05933         ATLASSERT(::IsWindow(m_hWnd));
05934         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT);
05935         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, (WPARAM)wFlags, (LPARAM)&amp;cf);
05936     }
<a name="l05937"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a30">05937</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a30">SetDefaultCharFormat</a>(CHARFORMAT&amp; cf)
05938     {
05939         ATLASSERT(::IsWindow(m_hWnd));
05940         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT);
05941         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, 0, (LPARAM)&amp;cf);
05942     }
<a name="l05943"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a31">05943</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a31">SetSelectionCharFormat</a>(CHARFORMAT&amp; cf)
05944     {
05945         ATLASSERT(::IsWindow(m_hWnd));
05946         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT);
05947         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, SCF_SELECTION, (LPARAM)&amp;cf);
05948     }
<a name="l05949"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a32">05949</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a32">SetWordCharFormat</a>(CHARFORMAT&amp; cf)
05950     {
05951         ATLASSERT(::IsWindow(m_hWnd));
05952         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT);
05953         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, SCF_SELECTION | SCF_WORD, (LPARAM)&amp;cf);
05954     }
<a name="l05955"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a33">05955</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a33">SetEventMask</a>(DWORD dwEventMask)
05956     {
05957         ATLASSERT(::IsWindow(m_hWnd));
05958         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_SETEVENTMASK, 0, dwEventMask);
05959     }
<a name="l05960"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a34">05960</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a34">SetParaFormat</a>(PARAFORMAT&amp; pf)
05961     {
05962         ATLASSERT(::IsWindow(m_hWnd));
05963         pf.cbSize = <font class="keyword">sizeof</font>(PARAFORMAT);
05964         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETPARAFORMAT, 0, (LPARAM)&amp;pf);
05965     }
<a name="l05966"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a35">05966</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a35">SetTargetDevice</a>(HDC hDC, <font class="keywordtype">int</font> cxLineWidth)
05967     {
05968         ATLASSERT(::IsWindow(m_hWnd));
05969         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETTARGETDEVICE, (WPARAM)hDC, cxLineWidth);
05970     }
<a name="l05971"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a36">05971</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a36">GetTextLength</a>()<font class="keyword"> const</font>
05972 <font class="keyword">    </font>{
05973         ATLASSERT(::IsWindow(m_hWnd));
05974         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, WM_GETTEXTLENGTH, 0, 0L);
05975     }
<a name="l05976"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a37">05976</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a37">SetReadOnly</a>(BOOL bReadOnly = TRUE)
05977     {
05978         ATLASSERT(::IsWindow(m_hWnd));
05979         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETREADONLY, bReadOnly, 0L);
05980     }
<a name="l05981"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a38">05981</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a38">GetFirstVisibleLine</a>()<font class="keyword"> const</font>
05982 <font class="keyword">    </font>{
05983         ATLASSERT(::IsWindow(m_hWnd));
05984         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETFIRSTVISIBLELINE, 0, 0L);
05985     }
05986 
<a name="l05987"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a39">05987</a>     EDITWORDBREAKPROCEX <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a39">GetWordBreakProcEx</a>()<font class="keyword"> const</font>
05988 <font class="keyword">    </font>{
05989         ATLASSERT(::IsWindow(m_hWnd));
05990         <font class="keywordflow">return</font> (EDITWORDBREAKPROCEX)::SendMessage(m_hWnd, EM_GETWORDBREAKPROCEX, 0, 0L);
05991     }
<a name="l05992"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a40">05992</a>     EDITWORDBREAKPROCEX <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a40">SetWordBreakProcEx</a>(EDITWORDBREAKPROCEX pfnEditWordBreakProcEx)
05993     {
05994         ATLASSERT(::IsWindow(m_hWnd));
05995         <font class="keywordflow">return</font> (EDITWORDBREAKPROCEX)::SendMessage(m_hWnd, EM_SETWORDBREAKPROCEX, 0, (LPARAM)pfnEditWordBreakProcEx);
05996     }
05997 
<a name="l05998"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a41">05998</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a41">GetTextRange</a>(TEXTRANGE* pTextRange)<font class="keyword"> const</font>
05999 <font class="keyword">    </font>{
06000         ATLASSERT(::IsWindow(m_hWnd));
06001         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTRANGE, 0, (LPARAM)pTextRange);
06002     }
06003 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200)</font>
06004 <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a41">GetTextRange</a>(LONG nStartChar, LONG nEndChar, LPTSTR lpstrText)<font class="keyword"> const</font>
06005 <font class="keyword">    </font>{
06006         ATLASSERT(::IsWindow(m_hWnd));
06007         TEXTRANGE tr;
06008         tr.chrg.cpMin = nStartChar;
06009         tr.chrg.cpMax = nEndChar;
06010         tr.lpstrText = lpstrText;
06011         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTRANGE, 0, (LPARAM)&amp;tr);
06012     }
06013 <font class="preprocessor">#else </font>
<a name="l06014"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a42">06014</a> <font class="preprocessor">    int GetTextRange(LONG nStartChar, LONG nEndChar, LPSTR lpstrText) const</font>
06015 <font class="preprocessor"></font>    {
06016         ATLASSERT(::IsWindow(m_hWnd));
06017         TEXTRANGE tr;
06018         tr.chrg.cpMin = nStartChar;
06019         tr.chrg.cpMax = nEndChar;
06020         tr.lpstrText = lpstrText;
06021         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTRANGE, 0, (LPARAM)&amp;tr);
06022     }
06023 <font class="preprocessor">#endif </font>
06024 <font class="preprocessor"></font>
06025 <font class="preprocessor"></font><font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200)</font>
06026 <font class="preprocessor"></font>    DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a19">GetDefaultCharFormat</a>(CHARFORMAT2&amp; cf)<font class="keyword"> const</font>
06027 <font class="keyword">    </font>{
06028         ATLASSERT(::IsWindow(m_hWnd));
06029         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT2);
06030         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETCHARFORMAT, 0, (LPARAM)&amp;cf);
06031     }
06032     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a29">SetCharFormat</a>(CHARFORMAT2&amp; cf, WORD wFlags)
06033     {
06034         ATLASSERT(::IsWindow(m_hWnd));
06035         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT2);
06036         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, (WPARAM)wFlags, (LPARAM)&amp;cf);
06037     }
06038     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a30">SetDefaultCharFormat</a>(CHARFORMAT2&amp; cf)
06039     {
06040         ATLASSERT(::IsWindow(m_hWnd));
06041         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT2);
06042         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, 0, (LPARAM)&amp;cf);
06043     }
06044     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a20">GetSelectionCharFormat</a>(CHARFORMAT2&amp; cf)<font class="keyword"> const</font>
06045 <font class="keyword">    </font>{
06046         ATLASSERT(::IsWindow(m_hWnd));
06047         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT2);
06048         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETCHARFORMAT, 1, (LPARAM)&amp;cf);
06049     }
06050     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a31">SetSelectionCharFormat</a>(CHARFORMAT2&amp; cf)
06051     {
06052         ATLASSERT(::IsWindow(m_hWnd));
06053         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT2);
06054         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, SCF_SELECTION, (LPARAM)&amp;cf);
06055     }
06056     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a32">SetWordCharFormat</a>(CHARFORMAT2&amp; cf)
06057     {
06058         ATLASSERT(::IsWindow(m_hWnd));
06059         cf.cbSize = <font class="keyword">sizeof</font>(CHARFORMAT2);
06060         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETCHARFORMAT, SCF_SELECTION | SCF_WORD, (LPARAM)&amp;cf);
06061     }
06062 
06063     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a23">GetParaFormat</a>(PARAFORMAT2&amp; pf)<font class="keyword"> const</font>
06064 <font class="keyword">    </font>{
06065         ATLASSERT(::IsWindow(m_hWnd));
06066         pf.cbSize = <font class="keyword">sizeof</font>(PARAFORMAT2);
06067         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_GETPARAFORMAT, 0, (LPARAM)&amp;pf);
06068     }
06069     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a34">SetParaFormat</a>(PARAFORMAT2&amp; pf)
06070     {
06071         ATLASSERT(::IsWindow(m_hWnd));
06072         pf.cbSize = <font class="keyword">sizeof</font>(PARAFORMAT2);
06073         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETPARAFORMAT, 0, (LPARAM)&amp;pf);
06074     }
06075     TEXTMODE GetTextMode()<font class="keyword"> const</font>
06076 <font class="keyword">    </font>{
06077         ATLASSERT(::IsWindow(m_hWnd));
06078         <font class="keywordflow">return</font> (TEXTMODE)::SendMessage(m_hWnd, EM_GETTEXTMODE, 0, 0L);
06079     }
06080     BOOL SetTextMode(TEXTMODE enumTextMode)
06081     {
06082         ATLASSERT(::IsWindow(m_hWnd));
06083         <font class="keywordflow">return</font> !(BOOL)::SendMessage(m_hWnd, EM_SETTEXTMODE, enumTextMode, 0L);
06084     }
06085     UNDONAMEID GetUndoName()<font class="keyword"> const</font>
06086 <font class="keyword">    </font>{
06087         ATLASSERT(::IsWindow(m_hWnd));
06088         <font class="keywordflow">return</font> (UNDONAMEID)::SendMessage(m_hWnd, EM_GETUNDONAME, 0, 0L);
06089     }
06090     UNDONAMEID GetRedoName()<font class="keyword"> const</font>
06091 <font class="keyword">    </font>{
06092         ATLASSERT(::IsWindow(m_hWnd));
06093         <font class="keywordflow">return</font> (UNDONAMEID)::SendMessage(m_hWnd, EM_GETREDONAME, 0, 0L);
06094     }
06095     BOOL CanRedo()<font class="keyword"> const</font>
06096 <font class="keyword">    </font>{
06097         ATLASSERT(::IsWindow(m_hWnd));
06098         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_CANREDO, 0, 0L);
06099     }
06100     BOOL GetAutoURLDetect()<font class="keyword"> const</font>
06101 <font class="keyword">    </font>{
06102         ATLASSERT(::IsWindow(m_hWnd));
06103         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_GETAUTOURLDETECT, 0, 0L);
06104     }
06105     BOOL SetAutoURLDetect(BOOL bAutoDetect = TRUE)
06106     {
06107         ATLASSERT(::IsWindow(m_hWnd));
06108         <font class="keywordflow">return</font> !(BOOL)::SendMessage(m_hWnd, EM_AUTOURLDETECT, bAutoDetect, 0L);
06109     }
06110     <font class="comment">// this method is deprecated, please use SetAutoURLDetect</font>
06111     BOOL EnableAutoURLDetect(BOOL bEnable = TRUE) { <font class="keywordflow">return</font> SetAutoURLDetect(bEnable); }
06112     UINT SetUndoLimit(UINT uUndoLimit)
06113     {
06114         ATLASSERT(::IsWindow(m_hWnd));
06115         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, EM_SETUNDOLIMIT, uUndoLimit, 0L);
06116     }
06117     <font class="keywordtype">void</font> SetPalette(HPALETTE hPalette)
06118     {
06119         ATLASSERT(::IsWindow(m_hWnd));
06120         ::SendMessage(m_hWnd, EM_SETPALETTE, (WPARAM)hPalette, 0L);
06121     }
06122     <font class="keywordtype">int</font> GetTextEx(GETTEXTEX* pGetTextEx, LPTSTR lpstrText)<font class="keyword"> const</font>
06123 <font class="keyword">    </font>{
06124         ATLASSERT(::IsWindow(m_hWnd));
06125         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTEX, (WPARAM)pGetTextEx, (LPARAM)lpstrText);
06126     }
06127     <font class="keywordtype">int</font> GetTextEx(LPTSTR lpstrText, <font class="keywordtype">int</font> nTextLen, DWORD dwFlags = GT_DEFAULT, UINT uCodePage = CP_ACP, LPCSTR lpDefaultChar = NULL, LPBOOL lpUsedDefChar = NULL)<font class="keyword"> const</font>
06128 <font class="keyword">    </font>{
06129         ATLASSERT(::IsWindow(m_hWnd));
06130         GETTEXTEX gte;
06131         gte.cb = nTextLen * <font class="keyword">sizeof</font>(TCHAR);
06132         gte.codepage = uCodePage;
06133         gte.flags = dwFlags;
06134         gte.lpDefaultChar = lpDefaultChar;
06135         gte.lpUsedDefChar = lpUsedDefChar;
06136         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTEX, (WPARAM)&amp;gte, (LPARAM)lpstrText);
06137     }
06138     <font class="keywordtype">int</font> GetTextLengthEx(GETTEXTLENGTHEX* pGetTextLengthEx)<font class="keyword"> const</font>
06139 <font class="keyword">    </font>{
06140         ATLASSERT(::IsWindow(m_hWnd));
06141         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTLENGTHEX, (WPARAM)pGetTextLengthEx, 0L);
06142     }
06143     <font class="keywordtype">int</font> GetTextLengthEx(DWORD dwFlags = GTL_DEFAULT, UINT uCodePage = CP_ACP)<font class="keyword"> const</font>
06144 <font class="keyword">    </font>{
06145         ATLASSERT(::IsWindow(m_hWnd));
06146         GETTEXTLENGTHEX gtle;
06147         gtle.codepage = uCodePage;
06148         gtle.flags = dwFlags;
06149         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETTEXTLENGTHEX, (WPARAM)&amp;gtle, 0L);
06150     }
06151 <font class="preprocessor">#endif //(_RICHEDIT_VER &gt;= 0x0200)</font>
06152 <font class="preprocessor"></font>
06153 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0300)</font>
06154 <font class="preprocessor"></font>    <font class="keywordtype">int</font> SetTextEx(SETTEXTEX* pSetTextEx, LPCTSTR lpstrText)
06155     {
06156         ATLASSERT(::IsWindow(m_hWnd));
06157         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_SETTEXTEX, (WPARAM)pSetTextEx, (LPARAM)lpstrText);
06158     }
06159     <font class="keywordtype">int</font> SetTextEx(LPCTSTR lpstrText, DWORD dwFlags = ST_DEFAULT, UINT uCodePage = CP_ACP)
06160     {
06161         ATLASSERT(::IsWindow(m_hWnd));
06162         SETTEXTEX ste;
06163         ste.flags = dwFlags;
06164         ste.codepage = uCodePage;
06165         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_SETTEXTEX, (WPARAM)&amp;ste, (LPARAM)lpstrText);
06166     }
06167     <font class="keywordtype">int</font> GetEditStyle()<font class="keyword"> const</font>
06168 <font class="keyword">    </font>{
06169         ATLASSERT(::IsWindow(m_hWnd));
06170         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_GETEDITSTYLE, 0, 0L);
06171     }
06172 
06173     <font class="keywordtype">int</font> SetEditStyle(<font class="keywordtype">int</font> nStyle, <font class="keywordtype">int</font> nMask = -1)
06174     {
06175         ATLASSERT(::IsWindow(m_hWnd));
06176         <font class="keywordflow">if</font>(nMask == -1)
06177             nMask = nStyle; <font class="comment">// set everything specified</font>
06178         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_SETEDITSTYLE, nStyle, nMask);
06179     }
06180     BOOL SetFontSize(<font class="keywordtype">int</font> nFontSizeDelta)
06181     {
06182         ATLASSERT(::IsWindow(m_hWnd));
06183         ATLASSERT(nFontSizeDelta &gt;= -1637 &amp;&amp; nFontSizeDelta &lt;= 1638);
06184         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETFONTSIZE, nFontSizeDelta, 0L);
06185     }
06186     <font class="keywordtype">void</font> GetScrollPos(LPPOINT lpPoint)<font class="keyword"> const</font>
06187 <font class="keyword">    </font>{
06188         ATLASSERT(::IsWindow(m_hWnd));
06189         ATLASSERT(lpPoint != NULL);
06190         ::SendMessage(m_hWnd, EM_GETSCROLLPOS, 0, (LPARAM)lpPoint);
06191     }
06192     <font class="keywordtype">void</font> SetScrollPos(LPPOINT lpPoint)
06193     {
06194         ATLASSERT(::IsWindow(m_hWnd));
06195         ATLASSERT(lpPoint != NULL);
06196         ::SendMessage(m_hWnd, EM_SETSCROLLPOS, 0, (LPARAM)lpPoint);
06197     }
06198     BOOL GetZoom(<font class="keywordtype">int</font>&amp; nNum, <font class="keywordtype">int</font>&amp; nDen)<font class="keyword"> const</font>
06199 <font class="keyword">    </font>{
06200         ATLASSERT(::IsWindow(m_hWnd));
06201         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_GETZOOM, (WPARAM)&amp;nNum, (LPARAM)&amp;nDen);
06202     }
06203     BOOL SetZoom(<font class="keywordtype">int</font> nNum, <font class="keywordtype">int</font> nDen)
06204     {
06205         ATLASSERT(::IsWindow(m_hWnd));
06206         ATLASSERT(nNum &gt;= 0 &amp;&amp; nNum &lt;= 64);
06207         ATLASSERT(nDen &gt;= 0 &amp;&amp; nDen &lt;= 64);
06208         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETZOOM, nNum, nDen);
06209     }
06210     BOOL SetZoomOff()
06211     {
06212         ATLASSERT(::IsWindow(m_hWnd));
06213         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETZOOM, 0, 0L);
06214     }
06215 <font class="preprocessor">#endif //(_RICHEDIT_VER &gt;= 0x0300)</font>
06216 <font class="preprocessor"></font>
06217 <font class="comment">// Operations</font>
<a name="l06218"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a43">06218</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a43">LimitText</a>(LONG nChars = 0)
06219     {
06220         ATLASSERT(::IsWindow(m_hWnd));
06221         ::SendMessage(m_hWnd, EM_EXLIMITTEXT, 0, nChars);
06222     }
<a name="l06223"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a44">06223</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a44">LineFromChar</a>(LONG nIndex)<font class="keyword"> const</font>
06224 <font class="keyword">    </font>{
06225         ATLASSERT(::IsWindow(m_hWnd));
06226         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_EXLINEFROMCHAR, 0, nIndex);
06227     }
<a name="l06228"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a45">06228</a>     POINT <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a45">PosFromChar</a>(LONG nChar)<font class="keyword"> const</font>
06229 <font class="keyword">    </font>{
06230         ATLASSERT(::IsWindow(m_hWnd));
06231         POINT point;
06232         ::SendMessage(m_hWnd, EM_POSFROMCHAR, (WPARAM)&amp;point, nChar);
06233         <font class="keywordflow">return</font> point;
06234     }
<a name="l06235"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a46">06235</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a46">CharFromPos</a>(POINT pt)<font class="keyword"> const</font>
06236 <font class="keyword">    </font>{
06237         ATLASSERT(::IsWindow(m_hWnd));
06238         POINTL ptl = { pt.x, pt.y };
06239         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_CHARFROMPOS, 0, (LPARAM)&amp;ptl);
06240     }
<a name="l06241"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a47">06241</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a47">EmptyUndoBuffer</a>()
06242     {
06243         ATLASSERT(::IsWindow(m_hWnd));
06244         ::SendMessage(m_hWnd, EM_EMPTYUNDOBUFFER, 0, 0L);
06245     }
<a name="l06246"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a48">06246</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a48">LineIndex</a>(<font class="keywordtype">int</font> nLine = -1)<font class="keyword"> const</font>
06247 <font class="keyword">    </font>{
06248         ATLASSERT(::IsWindow(m_hWnd));
06249         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_LINEINDEX, nLine, 0L);
06250     }
<a name="l06251"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a49">06251</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a49">LineLength</a>(<font class="keywordtype">int</font> nLine = -1)<font class="keyword"> const</font>
06252 <font class="keyword">    </font>{
06253         ATLASSERT(::IsWindow(m_hWnd));
06254         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, EM_LINELENGTH, nLine, 0L);
06255     }
<a name="l06256"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a50">06256</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a50">LineScroll</a>(<font class="keywordtype">int</font> nLines, <font class="keywordtype">int</font> nChars = 0)
06257     {
06258         ATLASSERT(::IsWindow(m_hWnd));
06259         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_LINESCROLL, nChars, nLines);
06260     }
<a name="l06261"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a51">06261</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a51">ReplaceSel</a>(LPCTSTR lpszNewText, BOOL bCanUndo = FALSE)
06262     {
06263         ATLASSERT(::IsWindow(m_hWnd));
06264         ::SendMessage(m_hWnd, EM_REPLACESEL, (WPARAM) bCanUndo, (LPARAM)lpszNewText);
06265     }
<a name="l06266"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a52">06266</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a52">SetRect</a>(LPCRECT lpRect)
06267     {
06268         ATLASSERT(::IsWindow(m_hWnd));
06269         ::SendMessage(m_hWnd, EM_SETRECT, 0, (LPARAM)lpRect);
06270     }
06271 
<a name="l06272"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a53">06272</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a53">DisplayBand</a>(LPRECT pDisplayRect)
06273     {
06274         ATLASSERT(::IsWindow(m_hWnd));
06275         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_DISPLAYBAND, 0, (LPARAM)pDisplayRect);
06276     }
<a name="l06277"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a54">06277</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a54">FindText</a>(DWORD dwFlags, FINDTEXT&amp; ft)<font class="keyword"> const</font>
06278 <font class="keyword">    </font>{
06279         ATLASSERT(::IsWindow(m_hWnd));
06280 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200) &amp;&amp; defined(_UNICODE)</font>
06281 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_FINDTEXTW, dwFlags, (LPARAM)&amp;ft);
06282 <font class="preprocessor">#else</font>
06283 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_FINDTEXT, dwFlags, (LPARAM)&amp;ft);
06284 <font class="preprocessor">#endif</font>
06285 <font class="preprocessor"></font>    }
<a name="l06286"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a55">06286</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a54">FindText</a>(DWORD dwFlags, FINDTEXTEX&amp; ft)<font class="keyword"> const</font>
06287 <font class="keyword">    </font>{
06288         ATLASSERT(::IsWindow(m_hWnd));
06289 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200) &amp;&amp; defined(_UNICODE)</font>
06290 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_FINDTEXTEXW, dwFlags, (LPARAM)&amp;ft);
06291 <font class="preprocessor">#else</font>
06292 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_FINDTEXTEX, dwFlags, (LPARAM)&amp;ft);
06293 <font class="preprocessor">#endif</font>
06294 <font class="preprocessor"></font>    }
<a name="l06295"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a56">06295</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a56">FormatRange</a>(FORMATRANGE&amp; fr, BOOL bDisplay = TRUE)
06296     {
06297         ATLASSERT(::IsWindow(m_hWnd));
06298         <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_FORMATRANGE, bDisplay, (LPARAM)&amp;fr);
06299     }
<a name="l06300"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a57">06300</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a56">FormatRange</a>(FORMATRANGE* pFormatRange, BOOL bDisplay = TRUE)
06301     {
06302         ATLASSERT(::IsWindow(m_hWnd));
06303         <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_FORMATRANGE, bDisplay, (LPARAM)pFormatRange);
06304     }
<a name="l06305"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a58">06305</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a58">HideSelection</a>(BOOL bHide = TRUE, BOOL bChangeStyle = FALSE)
06306     {
06307         ATLASSERT(::IsWindow(m_hWnd));
06308         ::SendMessage(m_hWnd, EM_HIDESELECTION, bHide, bChangeStyle);
06309     }
<a name="l06310"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a59">06310</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a59">PasteSpecial</a>(UINT uClipFormat, DWORD dwAspect = 0, HMETAFILE hMF = 0)
06311     {
06312         ATLASSERT(::IsWindow(m_hWnd));
06313         REPASTESPECIAL reps = { dwAspect, (DWORD_PTR)hMF };
06314         ::SendMessage(m_hWnd, EM_PASTESPECIAL, uClipFormat, (LPARAM)&amp;reps);
06315     }
<a name="l06316"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a60">06316</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a60">RequestResize</a>()
06317     {
06318         ATLASSERT(::IsWindow(m_hWnd));
06319         ::SendMessage(m_hWnd, EM_REQUESTRESIZE, 0, 0L);
06320     }
<a name="l06321"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a61">06321</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a61">StreamIn</a>(UINT uFormat, EDITSTREAM&amp; es)
06322     {
06323         ATLASSERT(::IsWindow(m_hWnd));
06324         <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_STREAMIN, uFormat, (LPARAM)&amp;es);
06325     }
<a name="l06326"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a62">06326</a>     LONG <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a62">StreamOut</a>(UINT uFormat, EDITSTREAM&amp; es)
06327     {
06328         ATLASSERT(::IsWindow(m_hWnd));
06329         <font class="keywordflow">return</font> (LONG)::SendMessage(m_hWnd, EM_STREAMOUT, uFormat, (LPARAM)&amp;es);
06330     }
06331 
<a name="l06332"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a63">06332</a>     DWORD <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a63">FindWordBreak</a>(<font class="keywordtype">int</font> nCode, LONG nStartChar)
06333     {
06334         ATLASSERT(::IsWindow(m_hWnd));
06335         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, EM_FINDWORDBREAK, nCode, nStartChar);
06336     }
06337 
06338     <font class="comment">// Additional operations</font>
<a name="l06339"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a64">06339</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a64">ScrollCaret</a>()
06340     {
06341         ATLASSERT(::IsWindow(m_hWnd));
06342         ::SendMessage(m_hWnd, EM_SCROLLCARET, 0, 0L);
06343     }
<a name="l06344"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a65">06344</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a65">InsertText</a>(<font class="keywordtype">long</font> nInsertAfterChar, LPCTSTR lpstrText, BOOL bCanUndo = FALSE)
06345     {
06346         <font class="keywordtype">int</font> nRet = <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a15">SetSel</a>(nInsertAfterChar, nInsertAfterChar);
06347         <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a51">ReplaceSel</a>(lpstrText, bCanUndo);
06348         <font class="keywordflow">return</font> nRet;
06349     }
<a name="l06350"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a66">06350</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a66">AppendText</a>(LPCTSTR lpstrText, BOOL bCanUndo = FALSE)
06351     {
06352         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a65">InsertText</a>(GetWindowTextLength(), lpstrText, bCanUndo);
06353     }
06354 
06355     <font class="comment">// Clipboard operations</font>
<a name="l06356"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a67">06356</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a67">Undo</a>()
06357     {
06358         ATLASSERT(::IsWindow(m_hWnd));
06359         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_UNDO, 0, 0L);
06360     }
<a name="l06361"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a68">06361</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a68">Clear</a>()
06362     {
06363         ATLASSERT(::IsWindow(m_hWnd));
06364         ::SendMessage(m_hWnd, WM_CLEAR, 0, 0L);
06365     }
<a name="l06366"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a69">06366</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a69">Copy</a>()
06367     {
06368         ATLASSERT(::IsWindow(m_hWnd));
06369         ::SendMessage(m_hWnd, WM_COPY, 0, 0L);
06370     }
<a name="l06371"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a70">06371</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a70">Cut</a>()
06372     {
06373         ATLASSERT(::IsWindow(m_hWnd));
06374         ::SendMessage(m_hWnd, WM_CUT, 0, 0L);
06375     }
<a name="l06376"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a71">06376</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a71">Paste</a>()
06377     {
06378         ATLASSERT(::IsWindow(m_hWnd));
06379         ::SendMessage(m_hWnd, WM_PASTE, 0, 0L);
06380     }
06381 
06382     <font class="comment">// OLE support</font>
<a name="l06383"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a72">06383</a>     IRichEditOle* <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a72">GetOleInterface</a>()<font class="keyword"> const</font>
06384 <font class="keyword">    </font>{
06385         ATLASSERT(::IsWindow(m_hWnd));
06386         IRichEditOle *pRichEditOle = NULL;
06387         ::SendMessage(m_hWnd, EM_GETOLEINTERFACE, 0, (LPARAM)&amp;pRichEditOle);
06388         <font class="keywordflow">return</font> pRichEditOle;
06389     }
<a name="l06390"></a><a class="code" href="classWTL_1_1CRichEditCtrlT.html#a73">06390</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCtrlT.html#a73">SetOleCallback</a>(IRichEditOleCallback* pCallback)
06391     {
06392         ATLASSERT(::IsWindow(m_hWnd));
06393         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_SETOLECALLBACK, 0, (LPARAM)pCallback);
06394     }
06395 
06396 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200)</font>
06397 <font class="preprocessor"></font>    BOOL Redo()
06398     {
06399         ATLASSERT(::IsWindow(m_hWnd));
06400         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, EM_REDO, 0, 0L);
06401     }
06402     <font class="keywordtype">void</font> StopGroupTyping()
06403     {
06404         ATLASSERT(::IsWindow(m_hWnd));
06405         ::SendMessage(m_hWnd, EM_STOPGROUPTYPING, 0, 0L);
06406     }
06407     <font class="keywordtype">void</font> ShowScrollBar(<font class="keywordtype">int</font> nBarType, BOOL bVisible = TRUE)
06408     {
06409         ATLASSERT(::IsWindow(m_hWnd));
06410         ::SendMessage(m_hWnd, EM_SHOWSCROLLBAR, nBarType, bVisible);
06411     }
06412 <font class="preprocessor">#endif //(_RICHEDIT_VER &gt;= 0x0200)</font>
06413 <font class="preprocessor"></font>};
06414 
<a name="l06415"></a><a class="code" href="namespaceWTL.html#a21">06415</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CRichEditCtrlT.html">CRichEditCtrlT&lt;CWindow&gt;</a>     <a class="code" href="namespaceWTL.html#a21">CRichEditCtrl</a>;
06416 
06417 
06419 <font class="comment">// CRichEditCommands - message handlers for standard EDIT commands</font>
06420 
06421 <font class="comment">// Chain to CRichEditCommands message map. Your class must also derive from CRichEditCtrl.</font>
06422 <font class="comment">// Example:</font>
06423 <font class="comment">// class CMyRichEdit : public CWindowImpl&lt;CMyRichEdit, CRichEditCtrl&gt;,</font>
06424 <font class="comment">//                     public CRichEditCommands&lt;CMyRichEdit&gt;</font>
06425 <font class="comment">// {</font>
06426 <font class="comment">// public:</font>
06427 <font class="comment">//      BEGIN_MSG_MAP(CMyRichEdit)</font>
06428 <font class="comment">//              // your handlers...</font>
06429 <font class="comment">//              CHAIN_MSG_MAP_ALT(CRichEditCommands&lt;CMyRichEdit&gt;, 1)</font>
06430 <font class="comment">//      END_MSG_MAP()</font>
06431 <font class="comment">//      // other stuff...</font>
06432 <font class="comment">// };</font>
06433 
06434 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l06435"></a><a class="code" href="classWTL_1_1CRichEditCommands.html">06435</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CRichEditCommands.html">CRichEditCommands</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands</a>&lt; T &gt;
06436 {
06437 <font class="keyword">public</font>:
06438     BEGIN_MSG_MAP(<a class="code" href="classWTL_1_1CRichEditCommands.html">CRichEditCommands&lt; T &gt;</a>)
06439     ALT_MSG_MAP(1)
06440         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a47">ID_EDIT_CLEAR</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a0">OnEditClear</a>)
06441         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a48">ID_EDIT_CLEAR_ALL</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a1">OnEditClearAll</a>)
06442         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a49">ID_EDIT_COPY</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a2">OnEditCopy</a>)
06443         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a50">ID_EDIT_CUT</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a3">OnEditCut</a>)
06444         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a52">ID_EDIT_PASTE</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a4">OnEditPaste</a>)
06445         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a57">ID_EDIT_SELECT_ALL</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a5">OnEditSelectAll</a>)
06446         COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a58">ID_EDIT_UNDO</a>, <a class="code" href="classWTL_1_1CEditCommands.html">CEditCommands&lt; T &gt;</a>::<a class="code" href="classWTL_1_1CEditCommands.html#a6">OnEditUndo</a>)
06447 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200)</font>
06448 <font class="preprocessor"></font>        COMMAND_ID_HANDLER(<a class="code" href="atlres_8h.html#a59">ID_EDIT_REDO</a>, OnEditRedo)
06449 <font class="preprocessor">#endif //(_RICHEDIT_VER &gt;= 0x0200)</font>
06450 <font class="preprocessor"></font>    END_MSG_MAP()
06451 
06452 <font class="preprocessor">#if (_RICHEDIT_VER &gt;= 0x0200)</font>
06453 <font class="preprocessor"></font>    LRESULT OnEditRedo(WORD <font class="comment">/*wNotifyCode*/</font>, WORD <font class="comment">/*wID*/</font>, HWND <font class="comment">/*hWndCtl*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
06454     {
06455         T* pT = static_cast&lt;T*&gt;(this);
06456         pT-&gt;Redo();
06457         <font class="keywordflow">return</font> 0;
06458     }
06459 <font class="preprocessor">#endif //(_RICHEDIT_VER &gt;= 0x0200)</font>
06460 <font class="preprocessor"></font>
06461 <font class="comment">// State (update UI) helpers</font>
<a name="l06462"></a><a class="code" href="classWTL_1_1CRichEditCommands.html#a0">06462</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCommands.html#a0">CanCut</a>()<font class="keyword"> const</font>
06463 <font class="keyword">    </font>{ <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CRichEditCommands.html#a3">HasSelection</a>(); }
<a name="l06464"></a><a class="code" href="classWTL_1_1CRichEditCommands.html#a1">06464</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCommands.html#a1">CanCopy</a>()<font class="keyword"> const</font>
06465 <font class="keyword">    </font>{ <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CRichEditCommands.html#a3">HasSelection</a>(); }
<a name="l06466"></a><a class="code" href="classWTL_1_1CRichEditCommands.html#a2">06466</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCommands.html#a2">CanClear</a>()<font class="keyword"> const</font>
06467 <font class="keyword">    </font>{ <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CRichEditCommands.html#a3">HasSelection</a>(); }
06468 
06469 <font class="comment">// Implementation</font>
<a name="l06470"></a><a class="code" href="classWTL_1_1CRichEditCommands.html#a3">06470</a>     BOOL <a class="code" href="classWTL_1_1CRichEditCommands.html#a3">HasSelection</a>()<font class="keyword"> const</font>
06471 <font class="keyword">    </font>{
06472         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
06473         <font class="keywordflow">return</font> (pT-&gt;GetSelectionType() != SEL_EMPTY);
06474     }
06475 };
06476 
06477 
06479 <font class="comment">// CDragListBox</font>
06480 
06481 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l06482"></a><a class="code" href="classWTL_1_1CDragListBoxT.html">06482</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CDragListBoxT.html">CDragListBoxT</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CListBoxT.html">CListBoxT</a>&lt; TBase &gt;
06483 {
06484 <font class="keyword">public</font>:
06485 <font class="comment">// Constructors</font>
<a name="l06486"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#a0">06486</a>     <a class="code" href="classWTL_1_1CDragListBoxT.html#a0">CDragListBoxT</a>(HWND hWnd = NULL) : <a class="code" href="classWTL_1_1CListBoxT.html">CListBoxT</a>&lt; TBase &gt;(hWnd) { }
06487 
<a name="l06488"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#a1">06488</a>     <a class="code" href="classWTL_1_1CDragListBoxT.html">CDragListBoxT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CDragListBoxT.html#a1">operator=</a>(HWND hWnd)
06489     {
06490         m_hWnd = hWnd;
06491         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
06492     }
06493 
<a name="l06494"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#a2">06494</a>     HWND <a class="code" href="classWTL_1_1CDragListBoxT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
06495             DWORD dwStyle = 0, DWORD dwExStyle = 0,
06496             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
06497     {
06498         HWND hWnd = CWindow::Create(<a class="code" href="classWTL_1_1CListBoxT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
06499         <font class="keywordflow">if</font>(hWnd != NULL)
06500             <a class="code" href="classWTL_1_1CDragListBoxT.html#a3">MakeDragList</a>();
06501         <font class="keywordflow">return</font> hWnd;
06502     }
06503 
06504 <font class="comment">// Operations</font>
<a name="l06505"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#a3">06505</a>     BOOL <a class="code" href="classWTL_1_1CDragListBoxT.html#a3">MakeDragList</a>()
06506     {
06507         ATLASSERT(::IsWindow(m_hWnd));
06508         ATLASSERT((GetStyle() &amp; (LBS_MULTIPLESEL | LBS_EXTENDEDSEL)) == 0);
06509         return ::MakeDragList(m_hWnd);
06510     }
06511 
<a name="l06512"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#a4">06512</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CDragListBoxT.html#a4">LBItemFromPt</a>(POINT pt, BOOL bAutoScroll = TRUE)
06513     {
06514         ATLASSERT(::IsWindow(m_hWnd));
06515         return ::LBItemFromPt(m_hWnd, pt, bAutoScroll);
06516     }
06517 
<a name="l06518"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#a5">06518</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CDragListBoxT.html#a5">DrawInsert</a>(<font class="keywordtype">int</font> nItem)
06519     {
06520         ATLASSERT(::IsWindow(m_hWnd));
06521         ::DrawInsert(GetParent(), m_hWnd, nItem);
06522     }
06523 
<a name="l06524"></a><a class="code" href="classWTL_1_1CDragListBoxT.html#d0">06524</a>     <font class="keyword">static</font> UINT <a class="code" href="classWTL_1_1CDragListBoxT.html#d0">GetDragListMessage</a>()
06525     {
06526         <font class="keyword">static</font> UINT uDragListMessage = 0;
06527         <font class="keywordflow">if</font>(uDragListMessage == 0)
06528         {
06529             ::EnterCriticalSection(&amp;_Module.m_csStaticDataInit);
06530             <font class="keywordflow">if</font>(uDragListMessage == 0)
06531                 uDragListMessage = ::RegisterWindowMessage(DRAGLISTMSGSTRING);
06532             ::LeaveCriticalSection(&amp;_Module.m_csStaticDataInit);
06533         }
06534         ATLASSERT(uDragListMessage != 0);
06535         <font class="keywordflow">return</font> uDragListMessage;
06536     }
06537 };
06538 
<a name="l06539"></a><a class="code" href="namespaceWTL.html#a22">06539</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CDragListBoxT.html">CDragListBoxT&lt;CWindow&gt;</a>  <a class="code" href="namespaceWTL.html#a22">CDragListBox</a>;
06540 
06541 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l06542"></a><a class="code" href="classWTL_1_1CDragListNotifyImpl.html">06542</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CDragListNotifyImpl.html">CDragListNotifyImpl</a>
06543 {
06544 <font class="keyword">public</font>:
06545     BEGIN_MSG_MAP(<a class="code" href="classWTL_1_1CDragListNotifyImpl.html">CDragListNotifyImpl&lt; T &gt;</a>)
06546         MESSAGE_HANDLER(CDragListBox::GetDragListMessage(), <a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a0">OnDragListNotify</a>)
06547     END_MSG_MAP()
06548 
<a name="l06549"></a><a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a0">06549</a>     LRESULT <a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a0">OnDragListNotify</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)
06550     {
06551         uMsg;   <font class="comment">// avoid level 4 warning</font>
06552         ATLASSERT(uMsg == CDragListBox::GetDragListMessage());
06553         T* pT = static_cast&lt;T*&gt;(this);
06554         LPDRAGLISTINFO lpDragListInfo = (LPDRAGLISTINFO)lParam;
06555         LRESULT lRet = 0;
06556         <font class="keywordflow">switch</font>(lpDragListInfo-&gt;uNotification)
06557         {
06558         <font class="keywordflow">case</font> DL_BEGINDRAG:
06559             lRet = (LPARAM)pT-&gt;OnBeginDrag((<font class="keywordtype">int</font>)wParam, lpDragListInfo-&gt;hWnd, lpDragListInfo-&gt;ptCursor);
06560             <font class="keywordflow">break</font>;
06561         <font class="keywordflow">case</font> DL_CANCELDRAG:
06562             pT-&gt;OnCancelDrag((<font class="keywordtype">int</font>)wParam, lpDragListInfo-&gt;hWnd, lpDragListInfo-&gt;ptCursor);
06563             <font class="keywordflow">break</font>;
06564         <font class="keywordflow">case</font> DL_DRAGGING:
06565             lRet = (LPARAM)pT-&gt;OnDragging((<font class="keywordtype">int</font>)wParam, lpDragListInfo-&gt;hWnd, lpDragListInfo-&gt;ptCursor);
06566             <font class="keywordflow">break</font>;
06567         <font class="keywordflow">case</font> DL_DROPPED:
06568             pT-&gt;OnDropped((<font class="keywordtype">int</font>)wParam, lpDragListInfo-&gt;hWnd, lpDragListInfo-&gt;ptCursor);
06569             <font class="keywordflow">break</font>;
06570         <font class="keywordflow">default</font>:
06571             ATLTRACE2(<a class="code" href="namespaceWTL.html#a111a1">atlTraceUI</a>, 0, _T(<font class="stringliteral">"Unknown DragListBox notification\n"</font>));
06572             bHandled = FALSE;   <font class="comment">// don't handle it</font>
06573             <font class="keywordflow">break</font>;
06574         }
06575         <font class="keywordflow">return</font> lRet;
06576     }
06577 
06578 <font class="comment">// Overrideables</font>
<a name="l06579"></a><a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a1">06579</a>     BOOL <a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a1">OnBeginDrag</a>(<font class="keywordtype">int</font> <font class="comment">/*nCtlID*/</font>, HWND <font class="comment">/*hWndDragList*/</font>, POINT <font class="comment">/*ptCursor*/</font>)
06580     {
06581         <font class="keywordflow">return</font> TRUE;    <font class="comment">// allow dragging</font>
06582     }
<a name="l06583"></a><a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a2">06583</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a2">OnCancelDrag</a>(<font class="keywordtype">int</font> <font class="comment">/*nCtlID*/</font>, HWND <font class="comment">/*hWndDragList*/</font>, POINT <font class="comment">/*ptCursor*/</font>)
06584     {
06585         <font class="comment">// nothing to do</font>
06586     }
<a name="l06587"></a><a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a3">06587</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a3">OnDragging</a>(<font class="keywordtype">int</font> <font class="comment">/*nCtlID*/</font>, HWND <font class="comment">/*hWndDragList*/</font>, POINT <font class="comment">/*ptCursor*/</font>)
06588     {
06589         <font class="keywordflow">return</font> 0;   <font class="comment">// don't change cursor</font>
06590     }
<a name="l06591"></a><a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a4">06591</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CDragListNotifyImpl.html#a4">OnDropped</a>(<font class="keywordtype">int</font> <font class="comment">/*nCtlID*/</font>, HWND <font class="comment">/*hWndDragList*/</font>, POINT <font class="comment">/*ptCursor*/</font>)
06592     {
06593         <font class="comment">// nothing to do</font>
06594     }
06595 };
06596 
06597 
06599 <font class="comment">// CReBarCtrl</font>
06600 
06601 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l06602"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html">06602</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CReBarCtrlT.html">CReBarCtrlT</a> : <font class="keyword">public</font> TBase
06603 {
06604 <font class="keyword">public</font>:
06605 <font class="comment">// Constructors</font>
<a name="l06606"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a0">06606</a>     <a class="code" href="classWTL_1_1CReBarCtrlT.html#a0">CReBarCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
06607 
<a name="l06608"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a1">06608</a>     <a class="code" href="classWTL_1_1CReBarCtrlT.html">CReBarCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CReBarCtrlT.html#a1">operator=</a>(HWND hWnd)
06609     {
06610         m_hWnd = hWnd;
06611         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
06612     }
06613 
<a name="l06614"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a2">06614</a>     HWND <a class="code" href="classWTL_1_1CReBarCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
06615             DWORD dwStyle = 0, DWORD dwExStyle = 0,
06616             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
06617     {
06618         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CReBarCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
06619     }
06620 
06621 <font class="comment">// Attributes</font>
<a name="l06622"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#d0">06622</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CReBarCtrlT.html#d0">GetWndClassName</a>()
06623     {
06624         <font class="keywordflow">return</font> REBARCLASSNAME;
06625     }
06626 
<a name="l06627"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a3">06627</a>     UINT <a class="code" href="classWTL_1_1CReBarCtrlT.html#a3">GetBandCount</a>()<font class="keyword"> const</font>
06628 <font class="keyword">    </font>{
06629         ATLASSERT(::IsWindow(m_hWnd));
06630         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, RB_GETBANDCOUNT, 0, 0L);
06631     }
<a name="l06632"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a4">06632</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a4">GetBandInfo</a>(<font class="keywordtype">int</font> nBand, LPREBARBANDINFO lprbbi)<font class="keyword"> const</font>
06633 <font class="keyword">    </font>{
06634         ATLASSERT(::IsWindow(m_hWnd));
06635         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_GETBANDINFO, nBand, (LPARAM)lprbbi);
06636     }
<a name="l06637"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a5">06637</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a5">SetBandInfo</a>(<font class="keywordtype">int</font> nBand, LPREBARBANDINFO lprbbi)
06638     {
06639         ATLASSERT(::IsWindow(m_hWnd));
06640         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_SETBANDINFO, nBand, (LPARAM)lprbbi);
06641     }
<a name="l06642"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a6">06642</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a6">GetBarInfo</a>(LPREBARINFO lprbi)<font class="keyword"> const</font>
06643 <font class="keyword">    </font>{
06644         ATLASSERT(::IsWindow(m_hWnd));
06645         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_GETBARINFO, 0, (LPARAM)lprbi);
06646     }
<a name="l06647"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a7">06647</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a7">SetBarInfo</a>(LPREBARINFO lprbi)
06648     {
06649         ATLASSERT(::IsWindow(m_hWnd));
06650         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_SETBARINFO, 0, (LPARAM)lprbi);
06651     }
<a name="l06652"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a8">06652</a>     UINT <a class="code" href="classWTL_1_1CReBarCtrlT.html#a8">GetRowCount</a>()<font class="keyword"> const</font>
06653 <font class="keyword">    </font>{
06654         ATLASSERT(::IsWindow(m_hWnd));
06655         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, RB_GETROWCOUNT, 0, 0L);
06656     }
<a name="l06657"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a9">06657</a>     UINT <a class="code" href="classWTL_1_1CReBarCtrlT.html#a9">GetRowHeight</a>(<font class="keywordtype">int</font> nBand)<font class="keyword"> const</font>
06658 <font class="keyword">    </font>{
06659         ATLASSERT(::IsWindow(m_hWnd));
06660         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, RB_GETROWHEIGHT, nBand, 0L);
06661     }
06662 
06663 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l06664"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a10">06664</a> <font class="preprocessor"></font>    COLORREF <a class="code" href="classWTL_1_1CReBarCtrlT.html#a10">GetTextColor</a>()<font class="keyword"> const</font>
06665 <font class="keyword">    </font>{
06666         ATLASSERT(::IsWindow(m_hWnd));
06667         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, RB_GETTEXTCOLOR, 0, 0L);
06668     }
<a name="l06669"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a11">06669</a>     COLORREF <a class="code" href="classWTL_1_1CReBarCtrlT.html#a11">SetTextColor</a>(COLORREF clr)
06670     {
06671         ATLASSERT(::IsWindow(m_hWnd));
06672         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, RB_SETTEXTCOLOR, 0, (LPARAM)clr);
06673     }
<a name="l06674"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a12">06674</a>     COLORREF <a class="code" href="classWTL_1_1CReBarCtrlT.html#a12">GetBkColor</a>()<font class="keyword"> const</font>
06675 <font class="keyword">    </font>{
06676         ATLASSERT(::IsWindow(m_hWnd));
06677         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, RB_GETBKCOLOR, 0, 0L);
06678     }
<a name="l06679"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a13">06679</a>     COLORREF <a class="code" href="classWTL_1_1CReBarCtrlT.html#a13">SetBkColor</a>(COLORREF clr)
06680     {
06681         ATLASSERT(::IsWindow(m_hWnd));
06682         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, RB_SETBKCOLOR, 0, (LPARAM)clr);
06683     }
<a name="l06684"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a14">06684</a>     UINT <a class="code" href="classWTL_1_1CReBarCtrlT.html#a14">GetBarHeight</a>()<font class="keyword"> const</font>
06685 <font class="keyword">    </font>{
06686         ATLASSERT(::IsWindow(m_hWnd));
06687         <font class="keywordflow">return</font> (UINT)::SendMessage(m_hWnd, RB_GETBARHEIGHT, 0, 0L);
06688     }
<a name="l06689"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a15">06689</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a15">GetRect</a>(<font class="keywordtype">int</font> nBand, LPRECT lpRect)<font class="keyword"> const</font>
06690 <font class="keyword">    </font>{
06691         ATLASSERT(::IsWindow(m_hWnd));
06692         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_GETRECT, nBand, (LPARAM)lpRect);
06693     }
<a name="l06694"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a16">06694</a>     CToolTipCtrl <a class="code" href="classWTL_1_1CReBarCtrlT.html#a16">GetToolTips</a>()<font class="keyword"> const</font>
06695 <font class="keyword">    </font>{
06696         ATLASSERT(::IsWindow(m_hWnd));
06697         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a>((HWND)::SendMessage(m_hWnd, RB_GETTOOLTIPS, 0, 0L));
06698     }
<a name="l06699"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a17">06699</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a17">SetToolTips</a>(HWND hwndToolTip)
06700     {
06701         ATLASSERT(::IsWindow(m_hWnd));
06702         ::SendMessage(m_hWnd, RB_SETTOOLTIPS, (WPARAM)hwndToolTip, 0L);
06703     }
<a name="l06704"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a18">06704</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a18">GetBandBorders</a>(<font class="keywordtype">int</font> nBand, LPRECT lpRect)<font class="keyword"> const</font>
06705 <font class="keyword">    </font>{
06706         ATLASSERT(::IsWindow(m_hWnd));
06707         ATLASSERT(lpRect != NULL);
06708         ::SendMessage(m_hWnd, RB_GETBANDBORDERS, nBand, (LPARAM)lpRect);
06709     }
<a name="l06710"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a19">06710</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a19">GetColorScheme</a>(LPCOLORSCHEME lpColorScheme)<font class="keyword"> const</font>
06711 <font class="keyword">    </font>{
06712         ATLASSERT(::IsWindow(m_hWnd));
06713         ATLASSERT(lpColorScheme != NULL);
06714         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_GETCOLORSCHEME, 0, (LPARAM)lpColorScheme);
06715     }
<a name="l06716"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a20">06716</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a20">SetColorScheme</a>(LPCOLORSCHEME lpColorScheme)
06717     {
06718         ATLASSERT(::IsWindow(m_hWnd));
06719         ATLASSERT(lpColorScheme != NULL);
06720         ::SendMessage(m_hWnd, RB_SETCOLORSCHEME, 0, (LPARAM)lpColorScheme);
06721     }
<a name="l06722"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a21">06722</a>     HPALETTE <a class="code" href="classWTL_1_1CReBarCtrlT.html#a21">GetPalette</a>()<font class="keyword"> const</font>
06723 <font class="keyword">    </font>{
06724         ATLASSERT(::IsWindow(m_hWnd));
06725         <font class="keywordflow">return</font> (HPALETTE)::SendMessage(m_hWnd, RB_GETPALETTE, 0, 0L);
06726     }
<a name="l06727"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a22">06727</a>     HPALETTE <a class="code" href="classWTL_1_1CReBarCtrlT.html#a22">SetPalette</a>(HPALETTE hPalette)
06728     {
06729         ATLASSERT(::IsWindow(m_hWnd));
06730         <font class="keywordflow">return</font> (HPALETTE)::SendMessage(m_hWnd, RB_SETPALETTE, 0, (LPARAM)hPalette);
06731     }
<a name="l06732"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a23">06732</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a23">GetUnicodeFormat</a>()<font class="keyword"> const</font>
06733 <font class="keyword">    </font>{
06734         ATLASSERT(::IsWindow(m_hWnd));
06735         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_GETUNICODEFORMAT, 0, 0L);
06736     }
<a name="l06737"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a24">06737</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a24">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
06738     {
06739         ATLASSERT(::IsWindow(m_hWnd));
06740         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_SETUNICODEFORMAT, bUnicode, 0L);
06741     }
06742 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
06743 <font class="preprocessor"></font>
06744 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
06745 <font class="preprocessor"></font>    <font class="comment">// requires uxtheme.h to be included to use MARGINS struct</font>
06746 <font class="preprocessor">#ifndef _UXTHEME_H_</font>
<a name="l06747"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#s0">06747</a> <font class="preprocessor"></font>    <font class="keyword">typedef</font> <font class="keyword">struct </font>_MARGINS*    <a class="code" href="classWTL_1_1CReBarCtrlT.html#s0">PMARGINS</a>;
06748 <font class="preprocessor">#endif </font>
<a name="l06749"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a25">06749</a> <font class="preprocessor">    void GetBandMargins(PMARGINS pMargins) const</font>
06750 <font class="preprocessor"></font>    {
06751         ATLASSERT(::IsWindow(m_hWnd));
06752         ::SendMessage(m_hWnd, RB_GETBANDMARGINS, 0, (LPARAM)pMargins);
06753     }
<a name="l06754"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a26">06754</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a26">SetWindowTheme</a>(LPCWSTR lpstrTheme)
06755     {
06756         ATLASSERT(::IsWindow(m_hWnd));
06757         ::SendMessage(m_hWnd, RB_SETWINDOWTHEME, 0, (LPARAM)lpstrTheme);
06758     }
06759 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
06760 <font class="preprocessor"></font>
06761 <font class="comment">// Operations</font>
<a name="l06762"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a27">06762</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a27">InsertBand</a>(<font class="keywordtype">int</font> nBand, LPREBARBANDINFO lprbbi)
06763     {
06764         ATLASSERT(::IsWindow(m_hWnd));
06765         lprbbi-&gt;cbSize = <font class="keyword">sizeof</font>(REBARBANDINFO);
06766         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_INSERTBAND, nBand, (LPARAM)lprbbi);
06767     }
<a name="l06768"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a28">06768</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a28">DeleteBand</a>(<font class="keywordtype">int</font> nBand)
06769     {
06770         ATLASSERT(::IsWindow(m_hWnd));
06771         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_DELETEBAND, nBand, 0L);
06772     }
<a name="l06773"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a29">06773</a>     <a class="code" href="classCWindow.html">CWindow</a> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a29">SetNotifyWnd</a>(HWND hWnd)
06774     {
06775         ATLASSERT(::IsWindow(m_hWnd));
06776         <font class="keywordflow">return</font> <a class="code" href="classCWindow.html">CWindow</a>((HWND)::SendMessage(m_hWnd, RB_SETPARENT, (WPARAM)hWnd, 0L));
06777     }
06778 
06779 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l06780"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a30">06780</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a30">BeginDrag</a>(<font class="keywordtype">int</font> nBand, DWORD dwPos)
06781     {
06782         ATLASSERT(::IsWindow(m_hWnd));
06783         ::SendMessage(m_hWnd, RB_BEGINDRAG, nBand, dwPos);
06784     }
<a name="l06785"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a31">06785</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a30">BeginDrag</a>(<font class="keywordtype">int</font> nBand, <font class="keywordtype">int</font> xPos, <font class="keywordtype">int</font> yPos)
06786     {
06787         ATLASSERT(::IsWindow(m_hWnd));
06788         ::SendMessage(m_hWnd, RB_BEGINDRAG, nBand, MAKELPARAM(xPos, yPos));
06789     }
<a name="l06790"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a32">06790</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a32">EndDrag</a>()
06791     {
06792         ATLASSERT(::IsWindow(m_hWnd));
06793         ::SendMessage(m_hWnd, RB_ENDDRAG, 0, 0L);
06794     }
<a name="l06795"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a33">06795</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a33">DragMove</a>(DWORD dwPos)
06796     {
06797         ATLASSERT(::IsWindow(m_hWnd));
06798         ::SendMessage(m_hWnd, RB_DRAGMOVE, 0, dwPos);
06799     }
<a name="l06800"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a34">06800</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a33">DragMove</a>(<font class="keywordtype">int</font> xPos, <font class="keywordtype">int</font> yPos)
06801     {
06802         ATLASSERT(::IsWindow(m_hWnd));
06803         ::SendMessage(m_hWnd, RB_DRAGMOVE, 0, MAKELPARAM(xPos, yPos));
06804     }
<a name="l06805"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a35">06805</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a35">GetDropTarget</a>(IDropTarget** ppDropTarget)<font class="keyword"> const</font>
06806 <font class="keyword">    </font>{
06807         ATLASSERT(::IsWindow(m_hWnd));
06808         ::SendMessage(m_hWnd, RB_GETDROPTARGET, 0, (LPARAM)ppDropTarget);
06809     }
<a name="l06810"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a36">06810</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a36">MaximizeBand</a>(<font class="keywordtype">int</font> nBand)
06811     {
06812         ATLASSERT(::IsWindow(m_hWnd));
06813         ::SendMessage(m_hWnd, RB_MAXIMIZEBAND, nBand, 0L);
06814     }
<a name="l06815"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a37">06815</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a37">MinimizeBand</a>(<font class="keywordtype">int</font> nBand)
06816     {
06817         ATLASSERT(::IsWindow(m_hWnd));
06818         ::SendMessage(m_hWnd, RB_MINIMIZEBAND, nBand, 0L);
06819     }
<a name="l06820"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a38">06820</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a38">SizeToRect</a>(LPRECT lpRect)
06821     {
06822         ATLASSERT(::IsWindow(m_hWnd));
06823         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_SIZETORECT, 0, (LPARAM)lpRect);
06824     }
<a name="l06825"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a39">06825</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a39">IdToIndex</a>(UINT uBandID)<font class="keyword"> const</font>
06826 <font class="keyword">    </font>{
06827         ATLASSERT(::IsWindow(m_hWnd));
06828         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, RB_IDTOINDEX, uBandID, 0L);
06829     }
<a name="l06830"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a40">06830</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a40">HitTest</a>(LPRBHITTESTINFO lprbht)<font class="keyword"> const</font>
06831 <font class="keyword">    </font>{
06832         ATLASSERT(::IsWindow(m_hWnd));
06833         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, RB_HITTEST, 0, (LPARAM)lprbht);
06834     }
<a name="l06835"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a41">06835</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a41">ShowBand</a>(<font class="keywordtype">int</font> nBand, BOOL bShow)
06836     {
06837         ATLASSERT(::IsWindow(m_hWnd));
06838         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_SHOWBAND, nBand, bShow);
06839     }
<a name="l06840"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a42">06840</a>     BOOL <a class="code" href="classWTL_1_1CReBarCtrlT.html#a42">MoveBand</a>(<font class="keywordtype">int</font> nBand, <font class="keywordtype">int</font> nNewPos)
06841     {
06842         ATLASSERT(::IsWindow(m_hWnd));
06843         ATLASSERT(nNewPos &gt;= 0 &amp;&amp; nNewPos &lt;= ((<font class="keywordtype">int</font>)<a class="code" href="classWTL_1_1CReBarCtrlT.html#a3">GetBandCount</a>() - 1));
06844         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, RB_MOVEBAND, nBand, nNewPos);
06845     }
06846 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
06847 <font class="preprocessor"></font>
06848 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</font>
<a name="l06849"></a><a class="code" href="classWTL_1_1CReBarCtrlT.html#a43">06849</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html#a43">PushChevron</a>(<font class="keywordtype">int</font> nBand, LPARAM lAppValue)
06850     {
06851         ATLASSERT(::IsWindow(m_hWnd));
06852         ::SendMessage(m_hWnd, RB_PUSHCHEVRON, nBand, lAppValue);
06853     }
06854 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0500)</font>
06855 <font class="preprocessor"></font>};
06856 
<a name="l06857"></a><a class="code" href="namespaceWTL.html#a23">06857</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CReBarCtrlT.html">CReBarCtrlT&lt;CWindow&gt;</a>        <a class="code" href="namespaceWTL.html#a23">CReBarCtrl</a>;
06858 
06859 
06861 <font class="comment">// CComboBoxEx</font>
06862 
06863 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l06864"></a><a class="code" href="classWTL_1_1CComboBoxExT.html">06864</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CComboBoxExT.html">CComboBoxExT</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CComboBoxT.html">CComboBoxT</a>&lt; TBase &gt;
06865 {
06866 <font class="keyword">public</font>:
06867 <font class="comment">// Constructors</font>
<a name="l06868"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a0">06868</a>     <a class="code" href="classWTL_1_1CComboBoxExT.html#a0">CComboBoxExT</a>(HWND hWnd = NULL) : <a class="code" href="classWTL_1_1CComboBoxT.html">CComboBoxT</a>&lt; TBase &gt;(hWnd) { }
06869 
<a name="l06870"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a1">06870</a>     <a class="code" href="classWTL_1_1CComboBoxExT.html">CComboBoxExT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CComboBoxExT.html#a1">operator=</a>(HWND hWnd)
06871     {
06872         m_hWnd = hWnd;
06873         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
06874     }
06875 
<a name="l06876"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a2">06876</a>     HWND <a class="code" href="classWTL_1_1CComboBoxExT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
06877             DWORD dwStyle = 0, DWORD dwExStyle = 0,
06878             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
06879     {
06880         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CComboBoxExT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
06881     }
06882 
06883 <font class="comment">// Attributes</font>
<a name="l06884"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#d0">06884</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CComboBoxExT.html#d0">GetWndClassName</a>()
06885     {
06886         <font class="keywordflow">return</font> WC_COMBOBOXEX;
06887     }
06888 
<a name="l06889"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a3">06889</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CComboBoxExT.html#a3">GetImageList</a>()<font class="keyword"> const</font>
06890 <font class="keyword">    </font>{
06891         ATLASSERT(::IsWindow(m_hWnd));
06892         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, CBEM_GETIMAGELIST, 0, 0L));
06893     }
<a name="l06894"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a4">06894</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> <a class="code" href="classWTL_1_1CComboBoxExT.html#a4">SetImageList</a>(HIMAGELIST hImageList)
06895     {
06896         ATLASSERT(::IsWindow(m_hWnd));
06897         <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CImageList.html">CImageList</a>((HIMAGELIST)::SendMessage(m_hWnd, CBEM_SETIMAGELIST, 0, (LPARAM)hImageList));
06898     }
06899 
06900 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l06901"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a5">06901</a> <font class="preprocessor"></font>    DWORD <a class="code" href="classWTL_1_1CComboBoxExT.html#a5">GetExtendedStyle</a>()<font class="keyword"> const</font>
06902 <font class="keyword">    </font>{
06903         ATLASSERT(::IsWindow(m_hWnd));
06904         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, CBEM_GETEXTENDEDSTYLE, 0, 0L);
06905     }
<a name="l06906"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a6">06906</a>     DWORD <a class="code" href="classWTL_1_1CComboBoxExT.html#a6">SetExtendedStyle</a>(DWORD dwExMask, DWORD dwExStyle)
06907     {
06908         ATLASSERT(::IsWindow(m_hWnd));
06909         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, CBEM_SETEXTENDEDSTYLE, dwExMask, dwExStyle);
06910     }
<a name="l06911"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a7">06911</a>     BOOL <a class="code" href="classWTL_1_1CComboBoxExT.html#a7">GetUnicodeFormat</a>()<font class="keyword"> const</font>
06912 <font class="keyword">    </font>{
06913         ATLASSERT(::IsWindow(m_hWnd));
06914         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CBEM_GETUNICODEFORMAT, 0, 0L);
06915     }
<a name="l06916"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a8">06916</a>     BOOL <a class="code" href="classWTL_1_1CComboBoxExT.html#a8">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
06917     {
06918         ATLASSERT(::IsWindow(m_hWnd));
06919         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CBEM_SETUNICODEFORMAT, bUnicode, 0L);
06920     }
06921 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
06922 <font class="preprocessor"></font>
06923 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
<a name="l06924"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a9">06924</a> <font class="preprocessor"></font>    <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CComboBoxExT.html#a9">SetWindowTheme</a>(LPCWSTR lpstrTheme)
06925     {
06926         ATLASSERT(::IsWindow(m_hWnd));
06927         ::SendMessage(m_hWnd, CBEM_SETWINDOWTHEME, 0, (LPARAM)lpstrTheme);
06928     }
06929 <font class="preprocessor">#endif //(_WIN32_WINNT &gt;= 0x0501)</font>
06930 <font class="preprocessor"></font>
06931 <font class="comment">// Operations</font>
<a name="l06932"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a10">06932</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CComboBoxExT.html#a10">InsertItem</a>(<font class="keyword">const</font> COMBOBOXEXITEM FAR* lpcCBItem)
06933     {
06934         ATLASSERT(::IsWindow(m_hWnd));
06935         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CBEM_INSERTITEM, 0, (LPARAM)lpcCBItem);
06936     }
<a name="l06937"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a11">06937</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CComboBoxExT.html#a11">DeleteItem</a>(<font class="keywordtype">int</font> nIndex)
06938     {
06939         ATLASSERT(::IsWindow(m_hWnd));
06940         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, CBEM_DELETEITEM, nIndex, 0L);
06941     }
<a name="l06942"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a12">06942</a>     BOOL <a class="code" href="classWTL_1_1CComboBoxExT.html#a12">GetItem</a>(PCOMBOBOXEXITEM pCBItem)<font class="keyword"> const</font>
06943 <font class="keyword">    </font>{
06944         ATLASSERT(::IsWindow(m_hWnd));
06945         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CBEM_GETITEM, 0, (LPARAM)pCBItem);
06946     }
<a name="l06947"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a13">06947</a>     BOOL <a class="code" href="classWTL_1_1CComboBoxExT.html#a13">SetItem</a>(<font class="keyword">const</font> COMBOBOXEXITEM FAR* lpcCBItem)
06948     {
06949         ATLASSERT(::IsWindow(m_hWnd));
06950         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CBEM_SETITEM, 0, (LPARAM)lpcCBItem);
06951     }
<a name="l06952"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a14">06952</a>     CComboBox <a class="code" href="classWTL_1_1CComboBoxExT.html#a14">GetComboCtrl</a>()<font class="keyword"> const</font>
06953 <font class="keyword">    </font>{
06954         ATLASSERT(::IsWindow(m_hWnd));
06955         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a5">CComboBox</a>((HWND)::SendMessage(m_hWnd, CBEM_GETCOMBOCONTROL, 0, 0L));
06956     }
<a name="l06957"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a15">06957</a>     CEdit <a class="code" href="classWTL_1_1CComboBoxExT.html#a15">GetEditCtrl</a>()<font class="keyword"> const</font>
06958 <font class="keyword">    </font>{
06959         ATLASSERT(::IsWindow(m_hWnd));
06960         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a6">CEdit</a>((HWND)::SendMessage(m_hWnd, CBEM_GETEDITCONTROL, 0, 0L));
06961     }
<a name="l06962"></a><a class="code" href="classWTL_1_1CComboBoxExT.html#a16">06962</a>     BOOL <a class="code" href="classWTL_1_1CComboBoxExT.html#a16">HasEditChanged</a>()<font class="keyword"> const</font>
06963 <font class="keyword">    </font>{
06964         ATLASSERT(::IsWindow(m_hWnd));
06965         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, CBEM_HASEDITCHANGED, 0, 0L);
06966     }
06967 };
06968 
<a name="l06969"></a><a class="code" href="namespaceWTL.html#a24">06969</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CComboBoxExT.html">CComboBoxExT&lt;CWindow&gt;</a>       <a class="code" href="namespaceWTL.html#a24">CComboBoxEx</a>;
06970 
06971 
06973 <font class="comment">// CMonthCalendarCtrl</font>
06974 
06975 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l06976"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html">06976</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html">CMonthCalendarCtrlT</a> : <font class="keyword">public</font> TBase
06977 {
06978 <font class="keyword">public</font>:
06979 <font class="comment">// Constructors</font>
<a name="l06980"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a0">06980</a>     <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a0">CMonthCalendarCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
06981 
<a name="l06982"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a1">06982</a>     <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html">CMonthCalendarCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a1">operator=</a>(HWND hWnd)
06983     {
06984         m_hWnd = hWnd;
06985         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
06986     }
06987 
<a name="l06988"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a2">06988</a>     HWND <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
06989             DWORD dwStyle = 0, DWORD dwExStyle = 0,
06990             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
06991     {
06992         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
06993     }
06994 
06995 <font class="comment">// Attributes</font>
<a name="l06996"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#d0">06996</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#d0">GetWndClassName</a>()
06997     {
06998         <font class="keywordflow">return</font> MONTHCAL_CLASS;
06999     }
07000 
<a name="l07001"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a3">07001</a>     COLORREF <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a3">GetColor</a>(<font class="keywordtype">int</font> nColorType)<font class="keyword"> const</font>
07002 <font class="keyword">    </font>{
07003         ATLASSERT(::IsWindow(m_hWnd));
07004         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, MCM_GETCOLOR, nColorType, 0L);
07005     }
<a name="l07006"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a4">07006</a>     COLORREF <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a4">SetColor</a>(<font class="keywordtype">int</font> nColorType, COLORREF clr)
07007     {
07008         ATLASSERT(::IsWindow(m_hWnd));
07009         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, MCM_SETCOLOR, nColorType, clr);
07010     }
<a name="l07011"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a5">07011</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a5">GetCurSel</a>(LPSYSTEMTIME lpSysTime)<font class="keyword"> const</font>
07012 <font class="keyword">    </font>{
07013         ATLASSERT(::IsWindow(m_hWnd));
07014         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_GETCURSEL, 0, (LPARAM)lpSysTime);
07015     }
<a name="l07016"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a6">07016</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a6">SetCurSel</a>(LPSYSTEMTIME lpSysTime)
07017     {
07018         ATLASSERT(::IsWindow(m_hWnd));
07019         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_SETCURSEL, 0, (LPARAM)lpSysTime);
07020     }
<a name="l07021"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a7">07021</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a7">GetFirstDayOfWeek</a>(BOOL* pbLocaleVal = NULL)<font class="keyword"> const</font>
07022 <font class="keyword">    </font>{
07023         ATLASSERT(::IsWindow(m_hWnd));
07024         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, MCM_GETFIRSTDAYOFWEEK, 0, 0L);
07025         <font class="keywordflow">if</font>(pbLocaleVal != NULL)
07026             *pbLocaleVal = (BOOL)HIWORD(dwRet);
07027         <font class="keywordflow">return</font> (int)(short)LOWORD(dwRet);
07028     }
<a name="l07029"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a8">07029</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a8">SetFirstDayOfWeek</a>(<font class="keywordtype">int</font> nDay, BOOL* pbLocaleVal = NULL)
07030     {
07031         ATLASSERT(::IsWindow(m_hWnd));
07032         DWORD dwRet = (DWORD)::SendMessage(m_hWnd, MCM_SETFIRSTDAYOFWEEK, 0, nDay);
07033         <font class="keywordflow">if</font>(pbLocaleVal != NULL)
07034             *pbLocaleVal = (BOOL)HIWORD(dwRet);
07035         <font class="keywordflow">return</font> (int)(short)LOWORD(dwRet);
07036     }
<a name="l07037"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a9">07037</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a9">GetMaxSelCount</a>()<font class="keyword"> const</font>
07038 <font class="keyword">    </font>{
07039         ATLASSERT(::IsWindow(m_hWnd));
07040         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, MCM_GETMAXSELCOUNT, 0, 0L);
07041     }
<a name="l07042"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a10">07042</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a10">SetMaxSelCount</a>(<font class="keywordtype">int</font> nMax)
07043     {
07044         ATLASSERT(::IsWindow(m_hWnd));
07045         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_SETMAXSELCOUNT, nMax, 0L);
07046     }
<a name="l07047"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a11">07047</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a11">GetMonthDelta</a>()<font class="keyword"> const</font>
07048 <font class="keyword">    </font>{
07049         ATLASSERT(::IsWindow(m_hWnd));
07050         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, MCM_GETMONTHDELTA, 0, 0L);
07051     }
<a name="l07052"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a12">07052</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a12">SetMonthDelta</a>(<font class="keywordtype">int</font> nDelta)
07053     {
07054         ATLASSERT(::IsWindow(m_hWnd));
07055         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, MCM_SETMONTHDELTA, nDelta, 0L);
07056     }
<a name="l07057"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a13">07057</a>     DWORD <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a13">GetRange</a>(LPSYSTEMTIME lprgSysTimeArray)<font class="keyword"> const</font>
07058 <font class="keyword">    </font>{
07059         ATLASSERT(::IsWindow(m_hWnd));
07060         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, MCM_GETRANGE, 0, (LPARAM)lprgSysTimeArray);
07061     }
<a name="l07062"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a14">07062</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a14">SetRange</a>(DWORD dwFlags, LPSYSTEMTIME lprgSysTimeArray)
07063     {
07064         ATLASSERT(::IsWindow(m_hWnd));
07065         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_SETRANGE, dwFlags, (LPARAM)lprgSysTimeArray);
07066     }
<a name="l07067"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a15">07067</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a15">GetSelRange</a>(LPSYSTEMTIME lprgSysTimeArray)<font class="keyword"> const</font>
07068 <font class="keyword">    </font>{
07069         ATLASSERT(::IsWindow(m_hWnd));
07070         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_GETSELRANGE, 0, (LPARAM)lprgSysTimeArray);
07071     }
<a name="l07072"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a16">07072</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a16">SetSelRange</a>(LPSYSTEMTIME lprgSysTimeArray)
07073     {
07074         ATLASSERT(::IsWindow(m_hWnd));
07075         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_SETSELRANGE, 0, (LPARAM)lprgSysTimeArray);
07076     }
<a name="l07077"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a17">07077</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a17">GetToday</a>(LPSYSTEMTIME lpSysTime)<font class="keyword"> const</font>
07078 <font class="keyword">    </font>{
07079         ATLASSERT(::IsWindow(m_hWnd));
07080         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_GETTODAY, 0, (LPARAM)lpSysTime);
07081     }
<a name="l07082"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a18">07082</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a18">SetToday</a>(LPSYSTEMTIME lpSysTime)
07083     {
07084         ATLASSERT(::IsWindow(m_hWnd));
07085         ::SendMessage(m_hWnd, MCM_SETTODAY, 0, (LPARAM)lpSysTime);
07086     }
<a name="l07087"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a19">07087</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a19">GetMinReqRect</a>(LPRECT lpRectInfo)<font class="keyword"> const</font>
07088 <font class="keyword">    </font>{
07089         ATLASSERT(::IsWindow(m_hWnd));
07090         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_GETMINREQRECT, 0, (LPARAM)lpRectInfo);
07091     }
<a name="l07092"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a20">07092</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a20">GetMonthRange</a>()<font class="keyword"> const</font>
07093 <font class="keyword">    </font>{
07094         ATLASSERT(::IsWindow(m_hWnd));
07095         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, MCM_GETMAXTODAYWIDTH, 0, 0L);
07096     }
07097 
07098 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l07099"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a21">07099</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a21">GetUnicodeFormat</a>()<font class="keyword"> const</font>
07100 <font class="keyword">    </font>{
07101         ATLASSERT(::IsWindow(m_hWnd));
07102         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_GETUNICODEFORMAT, 0, 0L);
07103     }
<a name="l07104"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a22">07104</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a22">SetUnicodeFormat</a>(BOOL bUnicode = TRUE)
07105     {
07106         ATLASSERT(::IsWindow(m_hWnd));
07107         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_SETUNICODEFORMAT, bUnicode, 0L);
07108     }
07109 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07110 <font class="preprocessor"></font>
07111 <font class="comment">// Operations</font>
<a name="l07112"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a23">07112</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a20">GetMonthRange</a>(DWORD dwFlags, LPSYSTEMTIME lprgSysTimeArray)<font class="keyword"> const</font>
07113 <font class="keyword">    </font>{
07114         ATLASSERT(::IsWindow(m_hWnd));
07115         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, MCM_GETMONTHRANGE, dwFlags, (LPARAM)lprgSysTimeArray);
07116     }
<a name="l07117"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a24">07117</a>     BOOL <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a24">SetDayState</a>(<font class="keywordtype">int</font> nMonths, LPMONTHDAYSTATE lpDayStateArray)
07118     {
07119         ATLASSERT(::IsWindow(m_hWnd));
07120         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, MCM_SETDAYSTATE, nMonths, (LPARAM)lpDayStateArray);
07121     }
<a name="l07122"></a><a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a25">07122</a>     DWORD <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html#a25">HitTest</a>(PMCHITTESTINFO pMCHitTest)<font class="keyword"> const</font>
07123 <font class="keyword">    </font>{
07124         ATLASSERT(::IsWindow(m_hWnd));
07125         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, MCM_HITTEST, 0, (LPARAM)pMCHitTest);
07126     }
07127 };
07128 
<a name="l07129"></a><a class="code" href="namespaceWTL.html#a25">07129</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CMonthCalendarCtrlT.html">CMonthCalendarCtrlT&lt;CWindow&gt;</a>        <a class="code" href="namespaceWTL.html#a25">CMonthCalendarCtrl</a>;
07130 
07131 
07133 <font class="comment">// CDateTimePickerCtrl</font>
07134 
07135 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l07136"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html">07136</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html">CDateTimePickerCtrlT</a> : <font class="keyword">public</font> TBase
07137 {
07138 <font class="keyword">public</font>:
07139 <font class="comment">// Constructors</font>
<a name="l07140"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a0">07140</a>     <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a0">CDateTimePickerCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
07141 
<a name="l07142"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a1">07142</a>     <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html">CDateTimePickerCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a1">operator=</a>(HWND hWnd)
07143     {
07144         m_hWnd = hWnd;
07145         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
07146     }
07147 
<a name="l07148"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a2">07148</a>     HWND <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
07149             DWORD dwStyle = 0, DWORD dwExStyle = 0,
07150             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
07151     {
07152         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
07153     }
07154 
07155 <font class="comment">// Operations</font>
<a name="l07156"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#d0">07156</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#d0">GetWndClassName</a>()
07157     {
07158         <font class="keywordflow">return</font> DATETIMEPICK_CLASS;
07159     }
07160 
<a name="l07161"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a3">07161</a>     BOOL <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a3">SetFormat</a>(LPTSTR lpszFormat)
07162     {
07163         ATLASSERT(::IsWindow(m_hWnd));
07164         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, DTM_SETFORMAT, 0, (LPARAM)lpszFormat);
07165     }
<a name="l07166"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a4">07166</a>     COLORREF <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a4">GetMonthCalColor</a>(<font class="keywordtype">int</font> nColorType)<font class="keyword"> const</font>
07167 <font class="keyword">    </font>{
07168         ATLASSERT(::IsWindow(m_hWnd));
07169         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, DTM_GETMCCOLOR, nColorType, 0L);
07170     }
<a name="l07171"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a5">07171</a>     COLORREF <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a5">SetMonthCalColor</a>(<font class="keywordtype">int</font> nColorType, COLORREF clr)
07172     {
07173         ATLASSERT(::IsWindow(m_hWnd));
07174         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, DTM_SETMCCOLOR, nColorType, clr);
07175     }
<a name="l07176"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a6">07176</a>     DWORD <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a6">GetRange</a>(LPSYSTEMTIME lpSysTimeArray)<font class="keyword"> const</font>
07177 <font class="keyword">    </font>{
07178         ATLASSERT(::IsWindow(m_hWnd));
07179         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, DTM_GETRANGE, 0, (LPARAM)lpSysTimeArray);
07180     }
<a name="l07181"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a7">07181</a>     BOOL <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a7">SetRange</a>(DWORD dwFlags, LPSYSTEMTIME lpSysTimeArray)
07182     {
07183         ATLASSERT(::IsWindow(m_hWnd));
07184         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, DTM_SETRANGE, dwFlags, (LPARAM)lpSysTimeArray);
07185     }
<a name="l07186"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a8">07186</a>     DWORD <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a8">GetSystemTime</a>(LPSYSTEMTIME lpSysTime)<font class="keyword"> const</font>
07187 <font class="keyword">    </font>{
07188         ATLASSERT(::IsWindow(m_hWnd));
07189         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, DTM_GETSYSTEMTIME, 0, (LPARAM)lpSysTime);
07190     }
<a name="l07191"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a9">07191</a>     BOOL <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a9">SetSystemTime</a>(DWORD dwFlags, LPSYSTEMTIME lpSysTime)
07192     {
07193         ATLASSERT(::IsWindow(m_hWnd));
07194         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, DTM_SETSYSTEMTIME, dwFlags, (LPARAM)lpSysTime);
07195     }
<a name="l07196"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a10">07196</a>     CMonthCalendarCtrl <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a10">GetMonthCal</a>()<font class="keyword"> const</font>
07197 <font class="keyword">    </font>{
07198         ATLASSERT(::IsWindow(m_hWnd));
07199         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a25">CMonthCalendarCtrl</a>((HWND)::SendMessage(m_hWnd, DTM_GETMONTHCAL, 0, 0L));
07200     }
07201 
07202 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l07203"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a11">07203</a> <font class="preprocessor"></font>    <a class="code" href="namespaceWTL.html#a39">CFontHandle</a> <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a11">GetMonthCalFont</a>()<font class="keyword"> const</font>
07204 <font class="keyword">    </font>{
07205         ATLASSERT(::IsWindow(m_hWnd));
07206         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a39">CFontHandle</a>((HFONT)::SendMessage(m_hWnd, DTM_GETMCFONT, 0, 0L));
07207     }
<a name="l07208"></a><a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a12">07208</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html#a12">SetMonthCalFont</a>(HFONT hFont, BOOL bRedraw = TRUE)
07209     {
07210         ATLASSERT(::IsWindow(m_hWnd));
07211         ::SendMessage(m_hWnd, DTM_SETMCFONT, (WPARAM)hFont, MAKELPARAM(bRedraw, 0));
07212     }
07213 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07214 <font class="preprocessor"></font>};
07215 
<a name="l07216"></a><a class="code" href="namespaceWTL.html#a26">07216</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CDateTimePickerCtrlT.html">CDateTimePickerCtrlT&lt;CWindow&gt;</a>       <a class="code" href="namespaceWTL.html#a26">CDateTimePickerCtrl</a>;
07217 
07218 
07220 <font class="comment">// CFlatScrollBarImpl - support for flat scroll bars</font>
07221 
07222 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
07223 <font class="preprocessor"></font>
07224 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l07225"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html">07225</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html">CFlatScrollBarImpl</a>
07226 {
07227 <font class="keyword">public</font>:
07228 <font class="comment">// Initialization</font>
<a name="l07229"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a0">07229</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a0">FlatSB_Initialize</a>()
07230     {
07231         T* pT = static_cast&lt;T*&gt;(this);
07232         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07233         return ::InitializeFlatSB(pT-&gt;m_hWnd);
07234     }
<a name="l07235"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a1">07235</a>     HRESULT <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a1">FlatSB_Uninitialize</a>()
07236     {
07237         T* pT = static_cast&lt;T*&gt;(this);
07238         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07239         return ::UninitializeFlatSB(pT-&gt;m_hWnd);
07240     }
07241 
07242 <font class="comment">// Flat scroll bar properties</font>
<a name="l07243"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a2">07243</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a2">FlatSB_GetScrollProp</a>(UINT uIndex, LPINT lpnValue)<font class="keyword"> const</font>
07244 <font class="keyword">    </font>{
07245         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
07246         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07247         return ::FlatSB_GetScrollProp(pT-&gt;m_hWnd, uIndex, lpnValue);
07248     }
<a name="l07249"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a3">07249</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a3">FlatSB_SetScrollProp</a>(UINT uIndex, <font class="keywordtype">int</font> nValue, BOOL bRedraw = TRUE)
07250     {
07251         T* pT = static_cast&lt;T*&gt;(this);
07252         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07253         return ::FlatSB_SetScrollProp(pT-&gt;m_hWnd, uIndex, nValue, bRedraw);
07254     }
07255 
07256 <font class="comment">// Attributes</font>
<a name="l07257"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a4">07257</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a4">FlatSB_GetScrollPos</a>(<font class="keywordtype">int</font> nBar)<font class="keyword"> const</font>
07258 <font class="keyword">    </font>{
07259         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
07260         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07261         return ::FlatSB_GetScrollPos(pT-&gt;m_hWnd, nBar);
07262     }
07263 
<a name="l07264"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a5">07264</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a5">FlatSB_SetScrollPos</a>(<font class="keywordtype">int</font> nBar, <font class="keywordtype">int</font> nPos, BOOL bRedraw = TRUE)
07265     {
07266         T* pT = static_cast&lt;T*&gt;(this);
07267         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07268         return ::FlatSB_SetScrollPos(pT-&gt;m_hWnd, nBar, nPos, bRedraw);
07269     }
07270 
<a name="l07271"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a6">07271</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a6">FlatSB_GetScrollRange</a>(<font class="keywordtype">int</font> nBar, LPINT lpMinPos, LPINT lpMaxPos)<font class="keyword"> const</font>
07272 <font class="keyword">    </font>{
07273         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
07274         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07275         return ::FlatSB_GetScrollRange(pT-&gt;m_hWnd, nBar, lpMinPos, lpMaxPos);
07276     }
07277 
<a name="l07278"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a7">07278</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a7">FlatSB_SetScrollRange</a>(<font class="keywordtype">int</font> nBar, <font class="keywordtype">int</font> nMinPos, <font class="keywordtype">int</font> nMaxPos, BOOL bRedraw = TRUE)
07279     {
07280         T* pT = static_cast&lt;T*&gt;(this);
07281         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07282         return ::FlatSB_SetScrollRange(pT-&gt;m_hWnd, nBar, nMinPos, nMaxPos, bRedraw);
07283     }
07284 
<a name="l07285"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a8">07285</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a8">FlatSB_GetScrollInfo</a>(<font class="keywordtype">int</font> nBar, LPSCROLLINFO lpScrollInfo)<font class="keyword"> const</font>
07286 <font class="keyword">    </font>{
07287         <font class="keyword">const</font> T* pT = static_cast&lt;const T*&gt;(this);
07288         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07289         return ::FlatSB_GetScrollInfo(pT-&gt;m_hWnd, nBar, lpScrollInfo);
07290     }
07291 
<a name="l07292"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a9">07292</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a9">FlatSB_SetScrollInfo</a>(<font class="keywordtype">int</font> nBar, LPSCROLLINFO lpScrollInfo, BOOL bRedraw = TRUE)
07293     {
07294         T* pT = static_cast&lt;T*&gt;(this);
07295         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07296         return ::FlatSB_SetScrollInfo(pT-&gt;m_hWnd, nBar, lpScrollInfo, bRedraw);
07297     }
07298 
07299 <font class="comment">// Operations</font>
<a name="l07300"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a10">07300</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a10">FlatSB_ShowScrollBar</a>(UINT nBar, BOOL bShow = TRUE)
07301     {
07302         T* pT = static_cast&lt;T*&gt;(this);
07303         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07304         return ::FlatSB_ShowScrollBar(pT-&gt;m_hWnd, nBar, bShow);
07305     }
07306 
<a name="l07307"></a><a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a11">07307</a>     BOOL <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html#a11">FlatSB_EnableScrollBar</a>(UINT uSBFlags, UINT uArrowFlags = ESB_ENABLE_BOTH)
07308     {
07309         T* pT = static_cast&lt;T*&gt;(this);
07310         ATLASSERT(::IsWindow(pT-&gt;m_hWnd));
07311         return ::FlatSB_EnableScrollBar(pT-&gt;m_hWnd, uSBFlags, uArrowFlags);
07312     }
07313 };
07314 
07315 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l07316"></a><a class="code" href="classWTL_1_1CFlatScrollBarT.html">07316</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CFlatScrollBarT.html">CFlatScrollBarT</a> : <font class="keyword">public</font> TBase, <font class="keyword">public</font> <a class="code" href="classWTL_1_1CFlatScrollBarImpl.html">CFlatScrollBarImpl</a>&lt;CFlatScrollBarT&lt; TBase &gt; &gt;
07317 {
07318 <font class="keyword">public</font>:
<a name="l07319"></a><a class="code" href="classWTL_1_1CFlatScrollBarT.html#a0">07319</a>     <a class="code" href="classWTL_1_1CFlatScrollBarT.html#a0">CFlatScrollBarT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
07320 
<a name="l07321"></a><a class="code" href="classWTL_1_1CFlatScrollBarT.html#a1">07321</a>     <a class="code" href="classWTL_1_1CFlatScrollBarT.html">CFlatScrollBarT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CFlatScrollBarT.html#a1">operator=</a>(HWND hWnd)
07322     {
07323         m_hWnd = hWnd;
07324         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
07325     }
07326 };
07327 
<a name="l07328"></a><a class="code" href="namespaceWTL.html#a27">07328</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CFlatScrollBarT.html">CFlatScrollBarT&lt;CWindow&gt;</a>        <a class="code" href="namespaceWTL.html#a27">CFlatScrollBar</a>;
07329 
07330 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07331 <font class="preprocessor"></font>
07332 
07334 <font class="comment">// CIPAddressCtrl</font>
07335 
07336 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
07337 <font class="preprocessor"></font>
07338 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l07339"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html">07339</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CIPAddressCtrlT.html">CIPAddressCtrlT</a> : <font class="keyword">public</font> TBase
07340 {
07341 <font class="keyword">public</font>:
07342 <font class="comment">// Constructors</font>
<a name="l07343"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a0">07343</a>     <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a0">CIPAddressCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
07344 
<a name="l07345"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a1">07345</a>     <a class="code" href="classWTL_1_1CIPAddressCtrlT.html">CIPAddressCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a1">operator=</a>(HWND hWnd)
07346     {
07347         m_hWnd = hWnd;
07348         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
07349     }
07350 
<a name="l07351"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a2">07351</a>     HWND <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
07352             DWORD dwStyle = 0, DWORD dwExStyle = 0,
07353             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
07354     {
07355         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CIPAddressCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
07356     }
07357 
07358 <font class="comment">// Atteributes</font>
<a name="l07359"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#d0">07359</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#d0">GetWndClassName</a>()
07360     {
07361         <font class="keywordflow">return</font> WC_IPADDRESS;
07362     }
07363 
<a name="l07364"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a3">07364</a>     BOOL <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a3">IsBlank</a>()<font class="keyword"> const</font>
07365 <font class="keyword">    </font>{
07366         ATLASSERT(::IsWindow(m_hWnd));
07367         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, IPM_ISBLANK, 0, 0L);
07368     }
<a name="l07369"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a4">07369</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a4">GetAddress</a>(LPDWORD lpdwAddress)<font class="keyword"> const</font>
07370 <font class="keyword">    </font>{
07371         ATLASSERT(::IsWindow(m_hWnd));
07372         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, IPM_GETADDRESS, 0, (LPARAM)lpdwAddress);
07373     }
<a name="l07374"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a5">07374</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a5">SetAddress</a>(DWORD dwAddress)
07375     {
07376         ATLASSERT(::IsWindow(m_hWnd));
07377         ::SendMessage(m_hWnd, IPM_SETADDRESS, 0, dwAddress);
07378     }
<a name="l07379"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a6">07379</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a6">ClearAddress</a>()
07380     {
07381         ATLASSERT(::IsWindow(m_hWnd));
07382         ::SendMessage(m_hWnd, IPM_CLEARADDRESS, 0, 0L);
07383     }
<a name="l07384"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a7">07384</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a7">SetRange</a>(<font class="keywordtype">int</font> nField, WORD wRange)
07385     {
07386         ATLASSERT(::IsWindow(m_hWnd));
07387         ::SendMessage(m_hWnd, IPM_SETRANGE, nField, wRange);
07388     }
<a name="l07389"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a8">07389</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a7">SetRange</a>(<font class="keywordtype">int</font> nField, BYTE nMin, BYTE nMax)
07390     {
07391         ATLASSERT(::IsWindow(m_hWnd));
07392         ::SendMessage(m_hWnd, IPM_SETRANGE, nField, MAKEIPRANGE(nMin, nMax));
07393     }
<a name="l07394"></a><a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a9">07394</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html#a9">SetFocus</a>(<font class="keywordtype">int</font> nField)
07395     {
07396         ATLASSERT(::IsWindow(m_hWnd));
07397         ::SendMessage(m_hWnd, IPM_SETFOCUS, nField, 0L);
07398     }
07399 };
07400 
<a name="l07401"></a><a class="code" href="namespaceWTL.html#a28">07401</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CIPAddressCtrlT.html">CIPAddressCtrlT&lt;CWindow&gt;</a>        <a class="code" href="namespaceWTL.html#a28">CIPAddressCtrl</a>;
07402 
07403 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07404 <font class="preprocessor"></font>
07405 
07407 <font class="comment">// CPagerCtrl</font>
07408 
07409 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
07410 <font class="preprocessor"></font>
07411 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l07412"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html">07412</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CPagerCtrlT.html">CPagerCtrlT</a> : <font class="keyword">public</font> TBase
07413 {
07414 <font class="keyword">public</font>:
07415 <font class="comment">// Constructors</font>
<a name="l07416"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a0">07416</a>     <a class="code" href="classWTL_1_1CPagerCtrlT.html#a0">CPagerCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
07417 
<a name="l07418"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a1">07418</a>     <a class="code" href="classWTL_1_1CPagerCtrlT.html">CPagerCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CPagerCtrlT.html#a1">operator=</a>(HWND hWnd)
07419     {
07420         m_hWnd = hWnd;
07421         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
07422     }
07423 
<a name="l07424"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a2">07424</a>     HWND <a class="code" href="classWTL_1_1CPagerCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
07425             DWORD dwStyle = 0, DWORD dwExStyle = 0,
07426             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
07427     {
07428         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CPagerCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
07429     }
07430 
07431 <font class="comment">// Attributes</font>
<a name="l07432"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#d0">07432</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CPagerCtrlT.html#d0">GetWndClassName</a>()
07433     {
07434         <font class="keywordflow">return</font> WC_PAGESCROLLER;
07435     }
07436 
<a name="l07437"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a3">07437</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a3">GetButtonSize</a>()<font class="keyword"> const</font>
07438 <font class="keyword">    </font>{
07439         ATLASSERT(::IsWindow(m_hWnd));
07440         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PGM_GETBUTTONSIZE, 0, 0L);
07441     }
<a name="l07442"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a4">07442</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a4">SetButtonSize</a>(<font class="keywordtype">int</font> nButtonSize)
07443     {
07444         ATLASSERT(::IsWindow(m_hWnd));
07445         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PGM_SETBUTTONSIZE, 0, nButtonSize);
07446     }
<a name="l07447"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a5">07447</a>     DWORD <a class="code" href="classWTL_1_1CPagerCtrlT.html#a5">GetButtonState</a>(<font class="keywordtype">int</font> nButton)<font class="keyword"> const</font>
07448 <font class="keyword">    </font>{
07449         ATLASSERT(::IsWindow(m_hWnd));
07450         ATLASSERT(nButton == PGB_TOPORLEFT || nButton == PGB_BOTTOMORRIGHT);
07451         <font class="keywordflow">return</font> (DWORD)::SendMessage(m_hWnd, PGM_GETBUTTONSTATE, 0, nButton);
07452     }
<a name="l07453"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a6">07453</a>     COLORREF <a class="code" href="classWTL_1_1CPagerCtrlT.html#a6">GetBkColor</a>()<font class="keyword"> const</font>
07454 <font class="keyword">    </font>{
07455         ATLASSERT(::IsWindow(m_hWnd));
07456         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, PGM_GETBKCOLOR, 0, 0L);
07457     }
<a name="l07458"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a7">07458</a>     COLORREF <a class="code" href="classWTL_1_1CPagerCtrlT.html#a7">SetBkColor</a>(COLORREF clrBk)
07459     {
07460         ATLASSERT(::IsWindow(m_hWnd));
07461         <font class="keywordflow">return</font> (COLORREF)::SendMessage(m_hWnd, PGM_SETBKCOLOR, 0, (LPARAM)clrBk);
07462     }
<a name="l07463"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a8">07463</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a8">GetBorder</a>()<font class="keyword"> const</font>
07464 <font class="keyword">    </font>{
07465         ATLASSERT(::IsWindow(m_hWnd));
07466         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PGM_GETBORDER, 0, 0L);
07467     }
<a name="l07468"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a9">07468</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a9">SetBorder</a>(<font class="keywordtype">int</font> nBorderSize)
07469     {
07470         ATLASSERT(::IsWindow(m_hWnd));
07471         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PGM_SETBORDER, 0, nBorderSize);
07472     }
<a name="l07473"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a10">07473</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a10">GetPos</a>()<font class="keyword"> const</font>
07474 <font class="keyword">    </font>{
07475         ATLASSERT(::IsWindow(m_hWnd));
07476         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PGM_GETPOS, 0, 0L);
07477     }
<a name="l07478"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a11">07478</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a11">SetPos</a>(<font class="keywordtype">int</font> nPos)
07479     {
07480         ATLASSERT(::IsWindow(m_hWnd));
07481         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, PGM_SETPOS, 0, nPos);
07482     }
07483 
07484 <font class="comment">// Operations</font>
<a name="l07485"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a12">07485</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a12">SetChild</a>(HWND hWndChild)
07486     {
07487         ATLASSERT(::IsWindow(m_hWnd));
07488         ::SendMessage(m_hWnd, PGM_SETCHILD, 0, (LPARAM)hWndChild);
07489     }
<a name="l07490"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a13">07490</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a13">ForwardMouse</a>(BOOL bForward = TRUE)
07491     {
07492         ATLASSERT(::IsWindow(m_hWnd));
07493         ::SendMessage(m_hWnd, PGM_FORWARDMOUSE, bForward, 0L);
07494     }
<a name="l07495"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a14">07495</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a14">RecalcSize</a>()
07496     {
07497         ATLASSERT(::IsWindow(m_hWnd));
07498         ::SendMessage(m_hWnd, PGM_RECALCSIZE, 0, 0L);
07499     }
<a name="l07500"></a><a class="code" href="classWTL_1_1CPagerCtrlT.html#a15">07500</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html#a15">GetDropTarget</a>(IDropTarget** ppDropTarget)
07501     {
07502         ATLASSERT(::IsWindow(m_hWnd));
07503         ATLASSERT(ppDropTarget != NULL);
07504         ::SendMessage(m_hWnd, PGM_GETDROPTARGET, 0, (LPARAM)ppDropTarget);
07505     }
07506 };
07507 
<a name="l07508"></a><a class="code" href="namespaceWTL.html#a29">07508</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CPagerCtrlT.html">CPagerCtrlT&lt;CWindow&gt;</a>        <a class="code" href="namespaceWTL.html#a29">CPagerCtrl</a>;
07509 
07510 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07511 <font class="preprocessor"></font>
07512 
07514 <font class="comment">// CLinkCtrl - Windows SYSLINK control</font>
07515 
07516 <font class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501)</font>
07517 <font class="preprocessor"></font>
07518 <font class="keyword">template</font> &lt;<font class="keyword">class</font> TBase&gt;
<a name="l07519"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html">07519</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CLinkCtrlT.html">CLinkCtrlT</a> : <font class="keyword">public</font> TBase
07520 {
07521 <font class="keyword">public</font>:
07522 <font class="comment">// Constructors</font>
<a name="l07523"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a0">07523</a>     <a class="code" href="classWTL_1_1CLinkCtrlT.html#a0">CLinkCtrlT</a>(HWND hWnd = NULL) : TBase(hWnd) { }
07524 
<a name="l07525"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a1">07525</a>     <a class="code" href="classWTL_1_1CLinkCtrlT.html">CLinkCtrlT&lt; TBase &gt;</a>&amp; <a class="code" href="classWTL_1_1CLinkCtrlT.html#a1">operator=</a>(HWND hWnd)
07526     {
07527         m_hWnd = hWnd;
07528         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
07529     }
07530 
<a name="l07531"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a2">07531</a>     HWND <a class="code" href="classWTL_1_1CLinkCtrlT.html#a2">Create</a>(HWND hWndParent, <a class="code" href="classWTL_1_1__U__RECT.html">_U_RECT</a> rect = NULL, LPCTSTR szWindowName = NULL,
07532             DWORD dwStyle = 0, DWORD dwExStyle = 0,
07533             <a class="code" href="classWTL_1_1__U__MENUorID.html">_U_MENUorID</a> MenuOrID = 0U, LPVOID lpCreateParam = NULL)
07534     {
07535         <font class="keywordflow">return</font> CWindow::Create(<a class="code" href="classWTL_1_1CLinkCtrlT.html#d0">GetWndClassName</a>(), hWndParent, rect.m_lpRect, szWindowName, dwStyle, dwExStyle, MenuOrID.m_hMenu, lpCreateParam);
07536     }
07537 
07538 <font class="comment">// Attributes</font>
<a name="l07539"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#d0">07539</a>     <font class="keyword">static</font> LPCTSTR <a class="code" href="classWTL_1_1CLinkCtrlT.html#d0">GetWndClassName</a>()
07540     {
07541 <font class="preprocessor">#ifdef _UNICODE</font>
07542 <font class="preprocessor"></font>        <font class="keywordflow">return</font> WC_LINK;
07543 <font class="preprocessor">#else </font>
07544 <font class="preprocessor">        return "SysLink";</font>
07545 <font class="preprocessor"></font><font class="preprocessor">#endif </font>
07546 <font class="preprocessor">    }</font>
07547 <font class="preprocessor"></font>
<a name="l07548"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a3">07548</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CLinkCtrlT.html#a3">GetIdealHeight</a>()<font class="keyword"> const</font>
07549 <font class="keyword">    </font>{
07550         ATLASSERT(::IsWindow(m_hWnd));
07551         <font class="keywordflow">return</font> (int)::SendMessage(m_hWnd, LM_GETIDEALHEIGHT, 0, 0L);
07552     }
07553 
<a name="l07554"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a4">07554</a>     BOOL <a class="code" href="classWTL_1_1CLinkCtrlT.html#a4">GetItem</a>(PLITEM pLItem)<font class="keyword"> const</font>
07555 <font class="keyword">    </font>{
07556         ATLASSERT(::IsWindow(m_hWnd));
07557         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LM_GETITEM, 0, (LPARAM)pLItem);
07558     }
07559 
<a name="l07560"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a5">07560</a>     BOOL <a class="code" href="classWTL_1_1CLinkCtrlT.html#a5">SetItem</a>(PLITEM pLItem)
07561     {
07562         ATLASSERT(::IsWindow(m_hWnd));
07563         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LM_SETITEM, 0, (LPARAM)pLItem);
07564     }
07565 
07566 <font class="comment">// Operations</font>
<a name="l07567"></a><a class="code" href="classWTL_1_1CLinkCtrlT.html#a6">07567</a>     BOOL <a class="code" href="classWTL_1_1CLinkCtrlT.html#a6">HitTest</a>(PLHITTESTINFO pLHitTestInfo)<font class="keyword"> const</font>
07568 <font class="keyword">    </font>{
07569         ATLASSERT(::IsWindow(m_hWnd));
07570         <font class="keywordflow">return</font> (BOOL)::SendMessage(m_hWnd, LM_HITTEST, 0, (LPARAM)pLHitTestInfo);
07571     }
07572 };
07573 
<a name="l07574"></a><a class="code" href="namespaceWTL.html#a30">07574</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CLinkCtrlT.html">CLinkCtrlT&lt;CWindow&gt;</a> <a class="code" href="namespaceWTL.html#a30">CLinkCtrl</a>;
07575 
07576 <font class="preprocessor">#endif // (_WIN32_WINNT &gt;= 0x0501)</font>
07577 <font class="preprocessor"></font>
07578 
07580 <font class="comment">// CCustomDraw - MI class for custom-draw support</font>
07581 
07582 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
<a name="l07583"></a><a class="code" href="classWTL_1_1CCustomDraw.html">07583</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CCustomDraw.html">CCustomDraw</a>
07584 {
07585 <font class="keyword">public</font>:
07586 <font class="preprocessor">#if (_ATL_VER &lt; 0x0700)</font>
<a name="l07587"></a><a class="code" href="classWTL_1_1CCustomDraw.html#m0">07587</a> <font class="preprocessor"></font>    BOOL m_bHandledCD;
07588 
<a name="l07589"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a0">07589</a>     BOOL IsMsgHandled()<font class="keyword"> const</font>
07590 <font class="keyword">    </font>{
07591         <font class="keywordflow">return</font> m_bHandledCD;
07592     }
<a name="l07593"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a1">07593</a>     <font class="keywordtype">void</font> SetMsgHandled(BOOL bHandled)
07594     {
07595         m_bHandledCD = bHandled;
07596     }
07597 <font class="preprocessor">#endif </font>
07598 <font class="preprocessor"></font>
07599 <font class="preprocessor"></font><font class="comment">// Message map and handlers</font>
07600     BEGIN_MSG_MAP(CCustomDraw&lt; T &gt;)
07601         NOTIFY_CODE_HANDLER(NM_CUSTOMDRAW, OnCustomDraw)
07602     ALT_MSG_MAP(1)
07603         <a class="code" href="atlapp_8h.html#a38">REFLECTED_NOTIFY_CODE_HANDLER</a>(NM_CUSTOMDRAW, OnCustomDraw)
07604     END_MSG_MAP()
07605 
07606 <font class="comment">// message handler</font>
<a name="l07607"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a2">07607</a>     LRESULT OnCustomDraw(<font class="keywordtype">int</font> idCtrl, LPNMHDR pnmh, BOOL&amp; bHandled)
07608     {
07609         T* pT = static_cast&lt;T*&gt;(this);
07610         pT-&gt;SetMsgHandled(TRUE);
07611         LPNMCUSTOMDRAW lpNMCustomDraw = (LPNMCUSTOMDRAW)pnmh;
07612         DWORD dwRet = 0;
07613         <font class="keywordflow">switch</font>(lpNMCustomDraw-&gt;dwDrawStage)
07614         {
07615         <font class="keywordflow">case</font> CDDS_PREPAINT:
07616             dwRet = pT-&gt;OnPrePaint(idCtrl, lpNMCustomDraw);
07617             <font class="keywordflow">break</font>;
07618         <font class="keywordflow">case</font> CDDS_POSTPAINT:
07619             dwRet = pT-&gt;OnPostPaint(idCtrl, lpNMCustomDraw);
07620             <font class="keywordflow">break</font>;
07621         <font class="keywordflow">case</font> CDDS_PREERASE:
07622             dwRet = pT-&gt;OnPreErase(idCtrl, lpNMCustomDraw);
07623             <font class="keywordflow">break</font>;
07624         <font class="keywordflow">case</font> CDDS_POSTERASE:
07625             dwRet = pT-&gt;OnPostErase(idCtrl, lpNMCustomDraw);
07626             <font class="keywordflow">break</font>;
07627         <font class="keywordflow">case</font> CDDS_ITEMPREPAINT:
07628             dwRet = pT-&gt;OnItemPrePaint(idCtrl, lpNMCustomDraw);
07629             <font class="keywordflow">break</font>;
07630         <font class="keywordflow">case</font> CDDS_ITEMPOSTPAINT:
07631             dwRet = pT-&gt;OnItemPostPaint(idCtrl, lpNMCustomDraw);
07632             <font class="keywordflow">break</font>;
07633         <font class="keywordflow">case</font> CDDS_ITEMPREERASE:
07634             dwRet = pT-&gt;OnItemPreErase(idCtrl, lpNMCustomDraw);
07635             <font class="keywordflow">break</font>;
07636         <font class="keywordflow">case</font> CDDS_ITEMPOSTERASE:
07637             dwRet = pT-&gt;OnItemPostErase(idCtrl, lpNMCustomDraw);
07638             <font class="keywordflow">break</font>;
07639 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
07640 <font class="preprocessor"></font>        <font class="keywordflow">case</font> (CDDS_ITEMPREPAINT | CDDS_SUBITEM):
07641             dwRet = pT-&gt;OnSubItemPrePaint(idCtrl, lpNMCustomDraw);
07642             <font class="keywordflow">break</font>;
07643 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07644 <font class="preprocessor"></font>        <font class="keywordflow">default</font>:
07645             pT-&gt;SetMsgHandled(FALSE);
07646             <font class="keywordflow">break</font>;
07647         }
07648         bHandled = pT-&gt;IsMsgHandled();
07649         <font class="keywordflow">return</font> dwRet;
07650     }
07651 
07652 <font class="comment">// Overrideables</font>
<a name="l07653"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a3">07653</a>     DWORD OnPrePaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07654     {
07655         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07656     }
<a name="l07657"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a4">07657</a>     DWORD OnPostPaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07658     {
07659         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07660     }
<a name="l07661"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a5">07661</a>     DWORD OnPreErase(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07662     {
07663         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07664     }
<a name="l07665"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a6">07665</a>     DWORD OnPostErase(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07666     {
07667         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07668     }
<a name="l07669"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a7">07669</a>     DWORD OnItemPrePaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07670     {
07671         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07672     }
<a name="l07673"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a8">07673</a>     DWORD OnItemPostPaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07674     {
07675         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07676     }
<a name="l07677"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a9">07677</a>     DWORD OnItemPreErase(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07678     {
07679         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07680     }
<a name="l07681"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a10">07681</a>     DWORD OnItemPostErase(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07682     {
07683         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07684     }
07685 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l07686"></a><a class="code" href="classWTL_1_1CCustomDraw.html#a11">07686</a> <font class="preprocessor"></font>    DWORD OnSubItemPrePaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
07687     {
07688         <font class="keywordflow">return</font> CDRF_DODEFAULT;
07689     }
07690 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
07691 <font class="preprocessor"></font>};
07692 
07693 }; <font class="comment">//namespace WTL</font>
07694 
07695 <font class="preprocessor">#endif // __ATLCTRLS_H__</font>
</pre></div><hr><address align="right"><small>Generated on Thu Apr 11 21:09:29 2002 for wtl-doc by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
