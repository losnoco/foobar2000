<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>atluser.h Source File</title>
<link href="mystyles.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>atluser.h</h1><a href="atluser_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// Windows Template Library - WTL version 7.0</font>
00002 <font class="comment">// Copyright (C) 1997-2002 Microsoft Corporation</font>
00003 <font class="comment">// All rights reserved.</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// This file is a part of the Windows Template Library.</font>
00006 <font class="comment">// The code and information is provided "as-is" without</font>
00007 <font class="comment">// warranty of any kind, either expressed or implied.</font>
00008 
00009 <font class="preprocessor">#ifndef __ATLUSER_H__</font>
00010 <font class="preprocessor"></font><font class="preprocessor">#define __ATLUSER_H__</font>
00011 <font class="preprocessor"></font>
00012 <font class="preprocessor">#pragma once</font>
00013 <font class="preprocessor"></font>
00014 <font class="preprocessor">#ifndef __cplusplus</font>
00015 <font class="preprocessor"></font><font class="preprocessor">    #error ATL requires C++ compilation (use a .cpp suffix)</font>
00016 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00017 <font class="preprocessor"></font>
00018 <font class="preprocessor">#ifndef __ATLBASE_H__</font>
00019 <font class="preprocessor"></font><font class="preprocessor">    #error atluser.h requires atlbase.h to be included first</font>
00020 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00021 <font class="preprocessor"></font>
00022 
00024 <font class="comment">// Classes in this file</font>
00025 <font class="comment">//</font>
00026 <font class="comment">// CMenuItemInfo</font>
00027 <font class="comment">// CMenuT&lt;t_bManaged&gt;</font>
00028 
00029 
00030 <font class="keyword">namespace </font>WTL
00031 {
00032 
00034 <font class="comment">// AtlMessageBox - accepts both memory and resource based strings</font>
00035 
<a name="l00036"></a><a class="code" href="namespaceWTL.html#a110">00036</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="namespaceWTL.html#a110">AtlMessageBox</a>(HWND hWndOwner, <a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> message, <a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> title = (LPCTSTR)NULL, UINT uType = MB_OK | MB_ICONINFORMATION)
00037 {
00038     ATLASSERT(hWndOwner == NULL || ::IsWindow(hWndOwner));
00039 
00040     LPTSTR lpstrMessage = NULL;
00041     <font class="keywordflow">if</font>(<a class="code" href="atlapp_8h.html#a26">IS_INTRESOURCE</a>(message.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>))
00042     {
00043         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nLen = 256; ; nLen *= 2)
00044         {
00045             ATLTRY(lpstrMessage = <font class="keyword">new</font> TCHAR[nLen]);
00046             <font class="keywordflow">if</font>(lpstrMessage == NULL)
00047             {
00048                 ATLASSERT(FALSE);
00049                 <font class="keywordflow">return</font> 0;
00050             }
00051             <font class="keywordtype">int</font> nRes = ::LoadString(_pModule-&gt;GetResourceInstance(), LOWORD(message.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>), lpstrMessage, nLen);
00052             <font class="keywordflow">if</font>(nRes &lt; nLen - 1)
00053                 <font class="keywordflow">break</font>;
00054             <font class="keyword">delete</font> [] lpstrMessage;
00055             lpstrMessage = NULL;
00056         }
00057 
00058         message.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a> = lpstrMessage;
00059     }
00060 
00061     LPTSTR lpstrTitle = NULL;
00062     <font class="keywordflow">if</font>(<a class="code" href="atlapp_8h.html#a26">IS_INTRESOURCE</a>(title.m_lpstr) &amp;&amp; LOWORD(title.m_lpstr) != 0)
00063     {
00064         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> nLen = 256; ; nLen *= 2)
00065         {
00066             ATLTRY(lpstrTitle = <font class="keyword">new</font> TCHAR[nLen]);
00067             <font class="keywordflow">if</font>(lpstrTitle == NULL)
00068             {
00069                 ATLASSERT(FALSE);
00070                 <font class="keywordflow">return</font> 0;
00071             }
00072             <font class="keywordtype">int</font> nRes = ::LoadString(_pModule-&gt;GetResourceInstance(), LOWORD(title.m_lpstr), lpstrTitle, nLen);
00073             <font class="keywordflow">if</font>(nRes &lt; nLen - 1)
00074                 <font class="keywordflow">break</font>;
00075             <font class="keyword">delete</font> [] lpstrTitle;
00076             lpstrTitle = NULL;
00077         }
00078 
00079         title.m_lpstr = lpstrTitle;
00080     }
00081 
00082     <font class="keywordtype">int</font> nRet = ::MessageBox(hWndOwner, message.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>, title.m_lpstr, uType);
00083 
00084     <font class="keyword">delete</font> [] lpstrMessage;
00085     <font class="keyword">delete</font> [] lpstrTitle;
00086 
00087     <font class="keywordflow">return</font> nRet;
00088 }
00089 
00090 
00092 <font class="comment">// CMenu</font>
00093 
<a name="l00094"></a><a class="code" href="classWTL_1_1CMenuItemInfo.html">00094</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CMenuItemInfo.html">CMenuItemInfo</a> : <font class="keyword">public</font> MENUITEMINFO
00095 {
00096 <font class="keyword">public</font>:
<a name="l00097"></a><a class="code" href="classWTL_1_1CMenuItemInfo.html#a0">00097</a>     <a class="code" href="classWTL_1_1CMenuItemInfo.html#a0">CMenuItemInfo</a>()
00098     {
00099         memset(<font class="keyword">this</font>, 0, <font class="keyword">sizeof</font>(MENUITEMINFO));
00100         cbSize = <font class="keyword">sizeof</font>(MENUITEMINFO);
00101     }
00102 };
00103 
00104 
00105 <font class="comment">// forward declarations</font>
00106 <font class="keyword">template</font> &lt;<font class="keywordtype">bool</font> t_bManaged&gt; <font class="keyword">class </font>CMenuT;
<a name="l00107"></a><a class="code" href="namespaceWTL.html#a57">00107</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CMenuT.html">CMenuT&lt;false&gt;</a>       <a class="code" href="namespaceWTL.html#a57">CMenuHandle</a>;
<a name="l00108"></a><a class="code" href="namespaceWTL.html#a58">00108</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CMenuT.html">CMenuT&lt;true&gt;</a>        <a class="code" href="namespaceWTL.html#a58">CMenu</a>;
00109 
00110 
00111 <font class="keyword">template</font> &lt;<font class="keywordtype">bool</font> t_bManaged&gt;
<a name="l00112"></a><a class="code" href="classWTL_1_1CMenuT.html">00112</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CMenuT.html">CMenuT</a>
00113 {
00114 <font class="keyword">public</font>:
00115 <font class="comment">// Data members</font>
00116     HMENU <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>;
00117 
00118 <font class="comment">// Constructor/destructor/operators</font>
<a name="l00119"></a><a class="code" href="classWTL_1_1CMenuT.html#a0">00119</a>     <a class="code" href="classWTL_1_1CMenuT.html#a0">CMenuT</a>(HMENU hMenu = NULL) : <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>(hMenu)
00120     { }
00121 
<a name="l00122"></a><a class="code" href="classWTL_1_1CMenuT.html#a1">00122</a>     <a class="code" href="classWTL_1_1CMenuT.html#a1">~CMenuT</a>()
00123     {
00124         <font class="keywordflow">if</font>(t_bManaged &amp;&amp; <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> != NULL)
00125             <a class="code" href="classWTL_1_1CMenuT.html#a11">DestroyMenu</a>();
00126     }
00127 
<a name="l00128"></a><a class="code" href="classWTL_1_1CMenuT.html#a2">00128</a>     <a class="code" href="classWTL_1_1CMenuT.html">CMenuT&lt;t_bManaged&gt;</a>&amp; <a class="code" href="classWTL_1_1CMenuT.html#a2">operator=</a>(HMENU hMenu)
00129     {
00130         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = hMenu;
00131         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00132     }
00133 
<a name="l00134"></a><a class="code" href="classWTL_1_1CMenuT.html#a3">00134</a>     <font class="keywordtype">void</font> <a class="code" href="classWTL_1_1CMenuT.html#a3">Attach</a>(HMENU hMenuNew)
00135     {
00136         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(hMenuNew));
00137         <font class="keywordflow">if</font>(t_bManaged &amp;&amp; <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> != NULL)
00138             ::DestroyMenu(m_hMenu);
00139         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = hMenuNew;
00140     }
00141 
<a name="l00142"></a><a class="code" href="classWTL_1_1CMenuT.html#a4">00142</a>     HMENU <a class="code" href="classWTL_1_1CMenuT.html#a4">Detach</a>()
00143     {
00144         HMENU hMenu = <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>;
00145         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = NULL;
00146         <font class="keywordflow">return</font> hMenu;
00147     }
00148 
<a name="l00149"></a><a class="code" href="classWTL_1_1CMenuT.html#a5">00149</a>     <a class="code" href="classWTL_1_1CMenuT.html#a5">operator HMENU</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>; }
00150 
<a name="l00151"></a><a class="code" href="classWTL_1_1CMenuT.html#a6">00151</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>()<font class="keyword"> const</font>
00152 <font class="keyword">    </font>{
00153         return ::IsMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>);
00154     }
00155 
00156 <font class="comment">// Create and load methods</font>
<a name="l00157"></a><a class="code" href="classWTL_1_1CMenuT.html#a7">00157</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a7">CreateMenu</a>()
00158     {
00159         ATLASSERT(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> == NULL);
00160         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = ::CreateMenu();
00161         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> != NULL) ? TRUE : FALSE;
00162     }
<a name="l00163"></a><a class="code" href="classWTL_1_1CMenuT.html#a8">00163</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a8">CreatePopupMenu</a>()
00164     {
00165         ATLASSERT(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> == NULL);
00166         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = ::CreatePopupMenu();
00167         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> != NULL) ? TRUE : FALSE;
00168     }
<a name="l00169"></a><a class="code" href="classWTL_1_1CMenuT.html#a9">00169</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a9">LoadMenu</a>(<a class="code" href="classWTL_1_1__U__STRINGorID.html">_U_STRINGorID</a> menu)
00170     {
00171         ATLASSERT(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> == NULL);
00172         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = ::LoadMenu(_Module.GetResourceInstance(), menu.<a class="code" href="classWTL_1_1__U__STRINGorID.html#m0">m_lpstr</a>);
00173         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> != NULL) ? TRUE : FALSE;
00174     }
<a name="l00175"></a><a class="code" href="classWTL_1_1CMenuT.html#a10">00175</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a10">LoadMenuIndirect</a>(<font class="keyword">const</font> <font class="keywordtype">void</font>* lpMenuTemplate)
00176     {
00177         ATLASSERT(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> == NULL);
00178         <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = ::LoadMenuIndirect(lpMenuTemplate);
00179         <font class="keywordflow">return</font> (<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> != NULL) ? TRUE : FALSE;
00180     }
<a name="l00181"></a><a class="code" href="classWTL_1_1CMenuT.html#a11">00181</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a11">DestroyMenu</a>()
00182     {
00183         <font class="keywordflow">if</font> (<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> == NULL)
00184             <font class="keywordflow">return</font> FALSE;
00185         BOOL bRet = ::DestroyMenu(m_hMenu);
00186         <font class="keywordflow">if</font>(bRet)
00187             <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a> = NULL;
00188         <font class="keywordflow">return</font> bRet;
00189     }
00190 
00191 <font class="comment">// Menu Operations</font>
<a name="l00192"></a><a class="code" href="classWTL_1_1CMenuT.html#a12">00192</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a12">DeleteMenu</a>(UINT nPosition, UINT nFlags)
00193     {
00194         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00195         return ::DeleteMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags);
00196     }
<a name="l00197"></a><a class="code" href="classWTL_1_1CMenuT.html#a13">00197</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a13">TrackPopupMenu</a>(UINT nFlags, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, HWND hWnd, LPCRECT lpRect = NULL)
00198     {
00199         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00200         return ::TrackPopupMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nFlags, x, y, 0, hWnd, lpRect);
00201     }
<a name="l00202"></a><a class="code" href="classWTL_1_1CMenuT.html#a14">00202</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a14">TrackPopupMenuEx</a>(UINT uFlags, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, HWND hWnd, LPTPMPARAMS lptpm = NULL)
00203     {
00204         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00205         return ::TrackPopupMenuEx(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uFlags, x, y, hWnd, lptpm);
00206     }
00207 
00208 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
<a name="l00209"></a><a class="code" href="classWTL_1_1CMenuT.html#a15">00209</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CMenuT.html#a15">GetMenuInfo</a>(LPMENUINFO lpMenuInfo)<font class="keyword"> const</font>
00210 <font class="keyword">    </font>{
00211         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00212         return ::GetMenuInfo(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, lpMenuInfo);
00213     }
<a name="l00214"></a><a class="code" href="classWTL_1_1CMenuT.html#a16">00214</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a16">SetMenuInfo</a>(LPCMENUINFO lpMenuInfo)
00215     {
00216         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00217         return ::SetMenuInfo(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, lpMenuInfo);
00218     }
00219 <font class="preprocessor">#endif //(WINVER &gt;= 0x0500)</font>
00220 <font class="preprocessor"></font>
00221 <font class="comment">// Menu Item Operations</font>
<a name="l00222"></a><a class="code" href="classWTL_1_1CMenuT.html#a17">00222</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a17">AppendMenu</a>(UINT nFlags, UINT_PTR nIDNewItem = 0, LPCTSTR lpszNewItem = NULL)
00223     {
00224         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00225         return ::AppendMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nFlags, nIDNewItem, lpszNewItem);
00226     }
<a name="l00227"></a><a class="code" href="classWTL_1_1CMenuT.html#a18">00227</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a17">AppendMenu</a>(UINT nFlags, UINT_PTR nIDNewItem, HBITMAP hBmp)
00228     {
00229         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00230         return ::AppendMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nFlags | MF_BITMAP, nIDNewItem, (LPCTSTR)hBmp);
00231     }
<a name="l00232"></a><a class="code" href="classWTL_1_1CMenuT.html#a19">00232</a>     UINT <a class="code" href="classWTL_1_1CMenuT.html#a19">CheckMenuItem</a>(UINT nIDCheckItem, UINT nCheck)
00233     {
00234         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00235         <font class="keywordflow">return</font> (UINT)::CheckMenuItem(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nIDCheckItem, nCheck);
00236     }
<a name="l00237"></a><a class="code" href="classWTL_1_1CMenuT.html#a20">00237</a>     UINT <a class="code" href="classWTL_1_1CMenuT.html#a20">EnableMenuItem</a>(UINT nIDEnableItem, UINT nEnable)
00238     {
00239         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00240         return ::EnableMenuItem(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nIDEnableItem, nEnable);
00241     }
<a name="l00242"></a><a class="code" href="classWTL_1_1CMenuT.html#a21">00242</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a21">HiliteMenuItem</a>(HWND hWnd, UINT uIDHiliteItem, UINT uHilite)
00243     {
00244         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00245         return ::HiliteMenuItem(hWnd, <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uIDHiliteItem, uHilite);
00246     }
<a name="l00247"></a><a class="code" href="classWTL_1_1CMenuT.html#a22">00247</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMenuT.html#a22">GetMenuItemCount</a>()<font class="keyword"> const</font>
00248 <font class="keyword">    </font>{
00249         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00250         return ::GetMenuItemCount(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>);
00251     }
<a name="l00252"></a><a class="code" href="classWTL_1_1CMenuT.html#a23">00252</a>     UINT <a class="code" href="classWTL_1_1CMenuT.html#a23">GetMenuItemID</a>(<font class="keywordtype">int</font> nPos)<font class="keyword"> const</font>
00253 <font class="keyword">    </font>{
00254         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00255         return ::GetMenuItemID(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPos);
00256     }
<a name="l00257"></a><a class="code" href="classWTL_1_1CMenuT.html#a24">00257</a>     UINT <a class="code" href="classWTL_1_1CMenuT.html#a24">GetMenuState</a>(UINT nID, UINT nFlags)<font class="keyword"> const</font>
00258 <font class="keyword">    </font>{
00259         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00260         return ::GetMenuState(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nID, nFlags);
00261     }
<a name="l00262"></a><a class="code" href="classWTL_1_1CMenuT.html#a25">00262</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMenuT.html#a25">GetMenuString</a>(UINT nIDItem, LPTSTR lpString, <font class="keywordtype">int</font> nMaxCount, UINT nFlags)<font class="keyword"> const</font>
00263 <font class="keyword">    </font>{
00264         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00265         return ::GetMenuString(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nIDItem, lpString, nMaxCount, nFlags);
00266     }
<a name="l00267"></a><a class="code" href="classWTL_1_1CMenuT.html#a26">00267</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMenuT.html#a26">GetMenuStringLen</a>(UINT nIDItem, UINT nFlags)<font class="keyword"> const</font>
00268 <font class="keyword">    </font>{
00269         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00270         return ::GetMenuString(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nIDItem, NULL, 0, nFlags);
00271     }
00272 <font class="preprocessor">#ifndef _ATL_NO_COM</font>
<a name="l00273"></a><a class="code" href="classWTL_1_1CMenuT.html#a27">00273</a> <font class="preprocessor"></font>    BOOL <a class="code" href="classWTL_1_1CMenuT.html#a25">GetMenuString</a>(UINT nIDItem, BSTR&amp; bstrText, UINT nFlags)<font class="keyword"> const</font>
00274 <font class="keyword">    </font>{
00275         USES_CONVERSION;
00276         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00277         ATLASSERT(bstrText == NULL);
00278 
00279         <font class="keywordtype">int</font> nLen = <a class="code" href="classWTL_1_1CMenuT.html#a26">GetMenuStringLen</a>(nIDItem, nFlags);
00280         <font class="keywordflow">if</font>(nLen == 0)
00281         {
00282             bstrText = ::SysAllocString(OLESTR(<font class="stringliteral">""</font>));
00283             <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
00284         }
00285 
00286         nLen++;     <font class="comment">// increment to include terminating NULL char</font>
00287         LPTSTR lpszText = (LPTSTR)_alloca((nLen) * <font class="keyword">sizeof</font>(TCHAR));
00288 
00289         <font class="keywordflow">if</font>(!<a class="code" href="classWTL_1_1CMenuT.html#a25">GetMenuString</a>(nIDItem, lpszText, nLen, nFlags))
00290             <font class="keywordflow">return</font> FALSE;
00291 
00292         bstrText = ::SysAllocString(T2OLE(lpszText));
00293         <font class="keywordflow">return</font> (bstrText != NULL) ? TRUE : FALSE;
00294     }
00295 <font class="preprocessor">#endif </font>
00296 <font class="preprocessor">#if defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
00297 <font class="preprocessor"></font>    <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMenuT.html#a25">GetMenuString</a>(UINT nIDItem, CString&amp; strText, UINT nFlags)<font class="keyword"> const</font>
00298 <font class="keyword">    </font>{
00299         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00300 
00301         <font class="keywordtype">int</font> nLen = <a class="code" href="classWTL_1_1CMenuT.html#a26">GetMenuStringLen</a>(nIDItem, nFlags);
00302         <font class="keywordflow">if</font>(nLen == 0)
00303             <font class="keywordflow">return</font> 0;
00304 
00305         nLen++;     <font class="comment">// increment to include terminating NULL char</font>
00306         LPTSTR lpstr = strText.GetBufferSetLength(nLen);
00307         <font class="keywordflow">if</font>(lpstr == NULL)
00308             <font class="keywordflow">return</font> 0;
00309         <font class="keywordtype">int</font> nRet = <a class="code" href="classWTL_1_1CMenuT.html#a25">GetMenuString</a>(nIDItem, lpstr, nLen, nFlags);
00310         strText.ReleaseBuffer();
00311         <font class="keywordflow">return</font> nRet;
00312     }
00313 <font class="preprocessor">#endif //defined(_WTL_USE_CSTRING) || defined(__ATLSTR_H__)</font>
<a name="l00314"></a><a class="code" href="classWTL_1_1CMenuT.html#a28">00314</a> <font class="preprocessor"></font>    <a class="code" href="namespaceWTL.html#a57">CMenuHandle</a> <a class="code" href="classWTL_1_1CMenuT.html#a28">GetSubMenu</a>(<font class="keywordtype">int</font> nPos)<font class="keyword"> const</font>
00315 <font class="keyword">    </font>{
00316         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00317         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a57">CMenuHandle</a>(::<a class="code" href="classWTL_1_1CMenuT.html#a28">GetSubMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPos));
00318     }
<a name="l00319"></a><a class="code" href="classWTL_1_1CMenuT.html#a29">00319</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a29">InsertMenu</a>(UINT nPosition, UINT nFlags, UINT_PTR nIDNewItem = 0, LPCTSTR lpszNewItem = NULL)
00320     {
00321         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00322         return ::InsertMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags, nIDNewItem, lpszNewItem);
00323     }
<a name="l00324"></a><a class="code" href="classWTL_1_1CMenuT.html#a30">00324</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a29">InsertMenu</a>(UINT nPosition, UINT nFlags, UINT_PTR nIDNewItem, HBITMAP hBmp)
00325     {
00326         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00327         return ::InsertMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags | MF_BITMAP, nIDNewItem, (LPCTSTR)hBmp);
00328     }
<a name="l00329"></a><a class="code" href="classWTL_1_1CMenuT.html#a31">00329</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a31">ModifyMenu</a>(UINT nPosition, UINT nFlags, UINT_PTR nIDNewItem = 0, LPCTSTR lpszNewItem = NULL)
00330     {
00331         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00332         return ::ModifyMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags, nIDNewItem, lpszNewItem);
00333     }
<a name="l00334"></a><a class="code" href="classWTL_1_1CMenuT.html#a32">00334</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a31">ModifyMenu</a>(UINT nPosition, UINT nFlags, UINT_PTR nIDNewItem, HBITMAP hBmp)
00335     {
00336         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00337         return ::ModifyMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags | MF_BITMAP, nIDNewItem, (LPCTSTR)hBmp);
00338     }
<a name="l00339"></a><a class="code" href="classWTL_1_1CMenuT.html#a33">00339</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a33">RemoveMenu</a>(UINT nPosition, UINT nFlags)
00340     {
00341         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00342         return ::RemoveMenu(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags);
00343     }
<a name="l00344"></a><a class="code" href="classWTL_1_1CMenuT.html#a34">00344</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a34">SetMenuItemBitmaps</a>(UINT nPosition, UINT nFlags, HBITMAP hBmpUnchecked, HBITMAP hBmpChecked)
00345     {
00346         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00347         return ::SetMenuItemBitmaps(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nPosition, nFlags, hBmpUnchecked, hBmpChecked);
00348     }
<a name="l00349"></a><a class="code" href="classWTL_1_1CMenuT.html#a35">00349</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a35">CheckMenuRadioItem</a>(UINT nIDFirst, UINT nIDLast, UINT nIDItem, UINT nFlags)
00350     {
00351         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00352         return ::CheckMenuRadioItem(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, nIDFirst, nIDLast, nIDItem, nFlags);
00353     }
00354 
<a name="l00355"></a><a class="code" href="classWTL_1_1CMenuT.html#a36">00355</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a36">GetMenuItemInfo</a>(UINT uItem, BOOL bByPosition, LPMENUITEMINFO lpmii)<font class="keyword"> const</font>
00356 <font class="keyword">    </font>{
00357         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00358         <font class="keywordflow">return</font> (BOOL)::GetMenuItemInfo(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uItem, bByPosition, lpmii);
00359     }
<a name="l00360"></a><a class="code" href="classWTL_1_1CMenuT.html#a37">00360</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a37">SetMenuItemInfo</a>(UINT uItem, BOOL bByPosition, LPMENUITEMINFO lpmii)
00361     {
00362         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00363         <font class="keywordflow">return</font> (BOOL)::SetMenuItemInfo(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uItem, bByPosition, lpmii);
00364     }
<a name="l00365"></a><a class="code" href="classWTL_1_1CMenuT.html#a38">00365</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a38">InsertMenuItem</a>(UINT uItem, BOOL bByPosition, LPMENUITEMINFO lpmii)
00366     {
00367         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00368         <font class="keywordflow">return</font> (BOOL)::InsertMenuItem(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uItem, bByPosition, lpmii);
00369     }
00370 
<a name="l00371"></a><a class="code" href="classWTL_1_1CMenuT.html#a39">00371</a>     UINT <a class="code" href="classWTL_1_1CMenuT.html#a39">GetMenuDefaultItem</a>(BOOL bByPosition = FALSE, UINT uFlags = 0U)<font class="keyword"> const</font>
00372 <font class="keyword">    </font>{
00373         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00374         return ::GetMenuDefaultItem(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, (UINT)bByPosition, uFlags);
00375     }
<a name="l00376"></a><a class="code" href="classWTL_1_1CMenuT.html#a40">00376</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a40">SetMenuDefaultItem</a>(UINT uItem = (UINT)-1,  BOOL bByPosition = FALSE)
00377     {
00378         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00379         return ::SetMenuDefaultItem(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uItem, (UINT)bByPosition);
00380     }
<a name="l00381"></a><a class="code" href="classWTL_1_1CMenuT.html#a41">00381</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a41">GetMenuItemRect</a>(HWND hWnd, UINT uItem, LPRECT lprcItem)<font class="keyword"> const</font>
00382 <font class="keyword">    </font>{
00383         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00384         return ::GetMenuItemRect(hWnd, <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, uItem, lprcItem);
00385     }
<a name="l00386"></a><a class="code" href="classWTL_1_1CMenuT.html#a42">00386</a>     <font class="keywordtype">int</font> <a class="code" href="classWTL_1_1CMenuT.html#a42">MenuItemFromPoint</a>(HWND hWnd, POINT point)<font class="keyword"> const</font>
00387 <font class="keyword">    </font>{
00388         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00389         return ::MenuItemFromPoint(hWnd, <a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, point);
00390     }
00391 
00392 <font class="comment">// Context Help Functions</font>
<a name="l00393"></a><a class="code" href="classWTL_1_1CMenuT.html#a43">00393</a>     BOOL <a class="code" href="classWTL_1_1CMenuT.html#a43">SetMenuContextHelpId</a>(DWORD dwContextHelpId)
00394     {
00395         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00396         return ::SetMenuContextHelpId(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>, dwContextHelpId);
00397     }
<a name="l00398"></a><a class="code" href="classWTL_1_1CMenuT.html#a44">00398</a>     DWORD <a class="code" href="classWTL_1_1CMenuT.html#a44">GetMenuContextHelpId</a>()<font class="keyword"> const</font>
00399 <font class="keyword">    </font>{
00400         ATLASSERT(::<a class="code" href="classWTL_1_1CMenuT.html#a6">IsMenu</a>(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>));
00401         return ::GetMenuContextHelpId(<a class="code" href="classWTL_1_1CMenuT.html#m0">m_hMenu</a>);
00402     }
00403 };
00404 
00405 }; <font class="comment">//namespace WTL</font>
00406 
00407 <font class="preprocessor">#endif // __ATLUSER_H__</font>
</pre></div><hr><address align="right"><small>Generated on Thu Apr 11 21:09:32 2002 for wtl-doc by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
