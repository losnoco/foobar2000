<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>atlctrlx.h Source File</title>
<link href="mystyles.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>atlctrlx.h</h1><a href="atlctrlx_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// Windows Template Library - WTL version 7.0</font>
00002 <font class="comment">// Copyright (C) 1997-2002 Microsoft Corporation</font>
00003 <font class="comment">// All rights reserved.</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// This file is a part of the Windows Template Library.</font>
00006 <font class="comment">// The code and information is provided "as-is" without</font>
00007 <font class="comment">// warranty of any kind, either expressed or implied.</font>
00008 
00009 <font class="preprocessor">#ifndef __ATLCTRLX_H__</font>
00010 <font class="preprocessor"></font><font class="preprocessor">#define __ATLCTRLX_H__</font>
00011 <font class="preprocessor"></font>
00012 <font class="preprocessor">#pragma once</font>
00013 <font class="preprocessor"></font>
00014 <font class="preprocessor">#ifndef __cplusplus</font>
00015 <font class="preprocessor"></font><font class="preprocessor">    #error ATL requires C++ compilation (use a .cpp suffix)</font>
00016 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00017 <font class="preprocessor"></font>
00018 <font class="preprocessor">#ifndef __ATLAPP_H__</font>
00019 <font class="preprocessor"></font><font class="preprocessor">    #error atlctrlx.h requires atlapp.h to be included first</font>
00020 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00021 <font class="preprocessor"></font>
00022 <font class="preprocessor">#ifndef __ATLCTRLS_H__</font>
00023 <font class="preprocessor"></font><font class="preprocessor">    #error atlctrlx.h requires atlctrls.h to be included first</font>
00024 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00025 <font class="preprocessor"></font>
00026 
00028 <font class="comment">// Classes in this file</font>
00029 <font class="comment">//</font>
00030 <font class="comment">// CBitmapButtonImpl&lt;T, TBase, TWinTraits&gt;</font>
00031 <font class="comment">// CBitmapButton</font>
00032 <font class="comment">// CCheckListViewCtrlImpl&lt;T, TBase, TWinTraits&gt;</font>
00033 <font class="comment">// CCheckListViewCtrl</font>
00034 <font class="comment">// CHyperLinkImpl&lt;T, TBase, TWinTraits&gt;</font>
00035 <font class="comment">// CHyperLink</font>
00036 <font class="comment">// CWaitCursor</font>
00037 <font class="comment">// CMultiPaneStatusBarCtrlImpl&lt;T, TBase&gt;</font>
00038 <font class="comment">// CMultiPaneStatusBarCtrl</font>
00039 <font class="comment">// CPaneContainerImpl&lt;T, TBase, TWinTraits&gt;</font>
00040 <font class="comment">// CPaneContainer</font>
00041 
00042 
00043 <font class="keyword">namespace </font>WTL
00044 {
00045 
00047 <font class="comment">// CBitmapButton - bitmap button implementation</font>
00048 
00049 <font class="comment">// bitmap button extended styles</font>
<a name="l00050"></a><a class="code" href="atlctrlx_8h.html#a0">00050</a> <font class="preprocessor">#define BMPBTN_HOVER        0x00000001</font>
<a name="l00051"></a><a class="code" href="atlctrlx_8h.html#a1">00051</a> <font class="preprocessor"></font><font class="preprocessor">#define BMPBTN_AUTO3D_SINGLE    0x00000002</font>
<a name="l00052"></a><a class="code" href="atlctrlx_8h.html#a2">00052</a> <font class="preprocessor"></font><font class="preprocessor">#define BMPBTN_AUTO3D_DOUBLE    0x00000004</font>
<a name="l00053"></a><a class="code" href="atlctrlx_8h.html#a3">00053</a> <font class="preprocessor"></font><font class="preprocessor">#define BMPBTN_AUTOSIZE     0x00000008</font>
<a name="l00054"></a><a class="code" href="atlctrlx_8h.html#a4">00054</a> <font class="preprocessor"></font><font class="preprocessor">#define BMPBTN_SHAREIMAGELISTS  0x00000010</font>
<a name="l00055"></a><a class="code" href="atlctrlx_8h.html#a5">00055</a> <font class="preprocessor"></font><font class="preprocessor">#define BMPBTN_AUTOFIRE     0x00000020</font>
00056 <font class="preprocessor"></font>
00057 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CButton, <font class="keyword">class</font> TWinTraits = CControlWinTraits&gt;
<a name="l00058"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html">00058</a> <font class="keyword">class </font>ATL_NO_VTABLE <a class="code" href="classWTL_1_1CBitmapButtonImpl.html">CBitmapButtonImpl</a> : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt; T, TBase, TWinTraits&gt;
00059 {
00060 <font class="keyword">public</font>:
<a name="l00061"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a0">00061</a>     DECLARE_WND_SUPERCLASS(NULL, TBase::GetWndClassName())
00062 
00063     <font class="keyword">enum</font>
00064     {
00065         _nImageNormal = 0,
00066         _nImagePushed,
00067         _nImageFocusOrHover,
00068         _nImageDisabled,
00069 
00070         _nImageCount = 4,
00071     };
00072 
00073     <font class="keyword">enum</font>
00074     {
00075         ID_TIMER_FIRST = 1000,
00076         ID_TIMER_REPEAT = 1001
00077     };
00078 
00079     <font class="comment">// Bitmap button specific extended styles</font>
<a name="l00080"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m0">00080</a>     DWORD m_dwExtendedStyle;
00081 
<a name="l00082"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m1">00082</a>     <a class="code" href="classWTL_1_1CImageList.html">CImageList</a> m_ImageList;
<a name="l00083"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m2">00083</a>     <font class="keywordtype">int</font> m_nImage[_nImageCount];
00084 
<a name="l00085"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m3">00085</a>     <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a> m_tip;
<a name="l00086"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m4">00086</a>     LPTSTR m_lpstrToolTipText;
00087 
00088     <font class="comment">// Internal states</font>
<a name="l00089"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m5">00089</a>     <font class="keywordtype">unsigned</font> m_fMouseOver:1;
<a name="l00090"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m6">00090</a>     <font class="keywordtype">unsigned</font> m_fFocus:1;
<a name="l00091"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#m7">00091</a>     <font class="keywordtype">unsigned</font> m_fPressed:1;
00092 
00093 
00094 <font class="comment">// Constructor/Destructor</font>
<a name="l00095"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a1">00095</a>     <a class="code" href="classWTL_1_1CBitmapButtonImpl.html">CBitmapButtonImpl</a>(DWORD dwExtendedStyle = <a class="code" href="atlctrlx_8h.html#a3">BMPBTN_AUTOSIZE</a>, HIMAGELIST hImageList = NULL) : 
00096             m_ImageList(hImageList), m_dwExtendedStyle(dwExtendedStyle), m_lpstrToolTipText(NULL),
00097             m_fMouseOver(0), m_fFocus(0), m_fPressed(0)
00098     {
00099         m_nImage[_nImageNormal] = -1;
00100         m_nImage[_nImagePushed] = -1;
00101         m_nImage[_nImageFocusOrHover] = -1;
00102         m_nImage[_nImageDisabled] = -1;
00103     }
00104 
<a name="l00105"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a2">00105</a>     ~<a class="code" href="classWTL_1_1CBitmapButtonImpl.html">CBitmapButtonImpl</a>()
00106     {
00107         <font class="keywordflow">if</font>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a4">BMPBTN_SHAREIMAGELISTS</a>) == 0)
00108             m_ImageList.<a class="code" href="classWTL_1_1CImageList.html#a22">Destroy</a>();
00109         <font class="keyword">delete</font> [] m_lpstrToolTipText;
00110     }
00111 
00112     <font class="comment">// overridden to provide proper initialization</font>
<a name="l00113"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a3">00113</a>     BOOL SubclassWindow(HWND hWnd)
00114     {
00115         BOOL bRet = <a class="code" href="classCWindowImpl.html">CWindowImpl&lt; T, TBase, TWinTraits&gt;::SubclassWindow</a>(hWnd);
00116         <font class="keywordflow">if</font>(bRet)
00117             Init();
00118         <font class="keywordflow">return</font> bRet;
00119     }
00120 
00121 <font class="comment">// Attributes</font>
<a name="l00122"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a4">00122</a>     DWORD GetBitmapButtonExtendedStyle()<font class="keyword"> const</font>
00123 <font class="keyword">    </font>{
00124         <font class="keywordflow">return</font> m_dwExtendedStyle;
00125     }
<a name="l00126"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a5">00126</a>     DWORD SetBitmapButtonExtendedStyle(DWORD dwExtendedStyle, DWORD dwMask = 0)
00127     {
00128         DWORD dwPrevStyle = m_dwExtendedStyle;
00129         <font class="keywordflow">if</font>(dwMask == 0)
00130             m_dwExtendedStyle = dwExtendedStyle;
00131         <font class="keywordflow">else</font>
00132             m_dwExtendedStyle = (m_dwExtendedStyle &amp; ~dwMask) | (dwExtendedStyle &amp; dwMask);
00133         <font class="keywordflow">return</font> dwPrevStyle;
00134     }
<a name="l00135"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a6">00135</a>     HIMAGELIST GetImageList()<font class="keyword"> const</font>
00136 <font class="keyword">    </font>{
00137         <font class="keywordflow">return</font> m_ImageList;
00138     }
<a name="l00139"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a7">00139</a>     HIMAGELIST SetImageList(HIMAGELIST hImageList)
00140     {
00141         HIMAGELIST hImageListPrev = m_ImageList;
00142         m_ImageList = hImageList;
00143         <font class="keywordflow">if</font>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a3">BMPBTN_AUTOSIZE</a>) != 0 &amp;&amp; ::IsWindow(m_hWnd))
00144             SizeToImage();
00145         <font class="keywordflow">return</font> hImageListPrev;
00146     }
<a name="l00147"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a8">00147</a>     <font class="keywordtype">int</font> GetToolTipTextLength()<font class="keyword"> const</font>
00148 <font class="keyword">    </font>{
00149         <font class="keywordflow">return</font> (m_lpstrToolTipText == NULL) ? -1 : lstrlen(m_lpstrToolTipText);
00150     }
<a name="l00151"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a9">00151</a>     <font class="keywordtype">bool</font> GetToolTipText(LPTSTR lpstrText, <font class="keywordtype">int</font> nLength)<font class="keyword"> const</font>
00152 <font class="keyword">    </font>{
00153         ATLASSERT(lpstrText != NULL);
00154         <font class="keywordflow">if</font>(m_lpstrToolTipText == NULL)
00155             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00156         <font class="keywordflow">return</font> (lstrcpyn(lpstrText, m_lpstrToolTipText, min(nLength, lstrlen(m_lpstrToolTipText) + 1)) != NULL);
00157     }
<a name="l00158"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a10">00158</a>     <font class="keywordtype">bool</font> SetToolTipText(LPCTSTR lpstrText)
00159     {
00160         <font class="keywordflow">if</font>(m_lpstrToolTipText != NULL)
00161         {
00162             <font class="keyword">delete</font> [] m_lpstrToolTipText;
00163             m_lpstrToolTipText = NULL;
00164         }
00165         <font class="keywordflow">if</font>(lpstrText == NULL)
00166         {
00167             <font class="keywordflow">if</font>(m_tip.IsWindow())
00168                 m_tip.Activate(FALSE);
00169             <font class="keywordflow">return</font> <font class="keyword">true</font>;
00170         }
00171         ATLTRY(m_lpstrToolTipText = <font class="keyword">new</font> TCHAR[lstrlen(lpstrText) + 1]);
00172         <font class="keywordflow">if</font>(m_lpstrToolTipText == NULL)
00173             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00174         <font class="keywordtype">bool</font> bRet = (lstrcpy(m_lpstrToolTipText, lpstrText) != NULL);
00175         <font class="keywordflow">if</font>(bRet &amp;&amp; m_tip.IsWindow())
00176         {
00177             m_tip.Activate(TRUE);
00178             m_tip.AddTool(m_hWnd, m_lpstrToolTipText);
00179         }
00180         <font class="keywordflow">return</font> bRet;
00181     }
00182 
00183 <font class="comment">// Operations</font>
<a name="l00184"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a11">00184</a>     <font class="keywordtype">void</font> SetImages(<font class="keywordtype">int</font> nNormal, <font class="keywordtype">int</font> nPushed = -1, <font class="keywordtype">int</font> nFocusOrHover = -1, <font class="keywordtype">int</font> nDisabled = -1)
00185     {
00186         <font class="keywordflow">if</font>(nNormal != -1)
00187             m_nImage[_nImageNormal] = nNormal;
00188         <font class="keywordflow">if</font>(nPushed != -1)
00189             m_nImage[_nImagePushed] = nPushed;
00190         <font class="keywordflow">if</font>(nFocusOrHover != -1)
00191             m_nImage[_nImageFocusOrHover] = nFocusOrHover;
00192         <font class="keywordflow">if</font>(nDisabled != -1)
00193             m_nImage[_nImageDisabled] = nDisabled;
00194     }
<a name="l00195"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a12">00195</a>     BOOL SizeToImage()
00196     {
00197         ATLASSERT(::IsWindow(m_hWnd) &amp;&amp; m_ImageList.<a class="code" href="classWTL_1_1CImageList.html#m0">m_hImageList</a> != NULL);
00198         <font class="keywordtype">int</font> cx = 0;
00199         <font class="keywordtype">int</font> cy = 0;
00200         <font class="keywordflow">if</font>(!m_ImageList.<a class="code" href="classWTL_1_1CImageList.html#a11">GetIconSize</a>(cx, cy))
00201             <font class="keywordflow">return</font> FALSE;
00202         <font class="keywordflow">return</font> ResizeClient(cx, cy);
00203     }
00204 
00205 <font class="comment">// Overrideables</font>
<a name="l00206"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a13">00206</a>     <font class="keywordtype">void</font> DoPaint(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc)
00207     {
00208         ATLASSERT(m_ImageList.<a class="code" href="classWTL_1_1CImageList.html#m0">m_hImageList</a> != NULL);    <font class="comment">// image list must be set</font>
00209         ATLASSERT(m_nImage[0] != -1);           <font class="comment">// main bitmap must be set</font>
00210 
00211         <font class="comment">// set bitmap according to the current button state</font>
00212         <font class="keywordtype">int</font> nImage = -1;
00213         <font class="keywordtype">bool</font> bHover = IsHoverMode();
00214         <font class="keywordflow">if</font>(m_fPressed == 1)
00215             nImage = m_nImage[_nImagePushed];
00216         <font class="keywordflow">else</font> <font class="keywordflow">if</font>((!bHover &amp;&amp; m_fFocus == 1) || (bHover &amp;&amp; m_fMouseOver == 1))
00217             nImage = m_nImage[_nImageFocusOrHover];
00218         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(!IsWindowEnabled())
00219             nImage = m_nImage[_nImageDisabled];
00220         <font class="keywordflow">if</font>(nImage == -1)    <font class="comment">// not there, use default one</font>
00221             nImage = m_nImage[_nImageNormal];
00222 
00223         <font class="comment">// draw the button image</font>
00224         <font class="keywordtype">int</font> xyPos = 0;
00225         <font class="keywordflow">if</font>((m_fPressed == 1) &amp;&amp; ((m_dwExtendedStyle &amp; (<a class="code" href="atlctrlx_8h.html#a1">BMPBTN_AUTO3D_SINGLE</a> | <a class="code" href="atlctrlx_8h.html#a2">BMPBTN_AUTO3D_DOUBLE</a>)) != 0) &amp;&amp; (m_nImage[_nImagePushed] == -1))
00226             xyPos = 1;
00227         m_ImageList.<a class="code" href="classWTL_1_1CImageList.html#a31">Draw</a>(dc, nImage, xyPos, xyPos, ILD_NORMAL);
00228 
00229         <font class="comment">// draw 3D border if required</font>
00230         <font class="keywordflow">if</font>((m_dwExtendedStyle &amp; (<a class="code" href="atlctrlx_8h.html#a1">BMPBTN_AUTO3D_SINGLE</a> | <a class="code" href="atlctrlx_8h.html#a2">BMPBTN_AUTO3D_DOUBLE</a>)) != 0)
00231         {
00232             RECT rect;
00233             GetClientRect(&amp;rect);
00234 
00235             <font class="keywordflow">if</font>(m_fPressed == 1)
00236                 dc.DrawEdge(&amp;rect, ((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a1">BMPBTN_AUTO3D_SINGLE</a>) != 0) ? BDR_SUNKENOUTER : EDGE_SUNKEN, BF_RECT);
00237             <font class="keywordflow">else</font> <font class="keywordflow">if</font>(!bHover || m_fMouseOver == 1)
00238                 dc.DrawEdge(&amp;rect, ((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a1">BMPBTN_AUTO3D_SINGLE</a>) != 0) ? BDR_RAISEDINNER : EDGE_RAISED, BF_RECT);
00239 
00240             <font class="keywordflow">if</font>(!bHover &amp;&amp; m_fFocus == 1)
00241             {
00242                 ::InflateRect(&amp;rect, -2 * ::GetSystemMetrics(SM_CXEDGE), -2 * ::GetSystemMetrics(SM_CYEDGE));
00243                 dc.DrawFocusRect(&amp;rect);
00244             }
00245         }
00246     }
00247 
00248 <font class="comment">// Message map and handlers</font>
<a name="l00249"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#s0">00249</a>     <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CBitmapButtonImpl.html">CBitmapButtonImpl&lt; T, TBase, TWinTraits &gt;</a>   thisClass;
00250     BEGIN_MSG_MAP(thisClass)
00251         MESSAGE_HANDLER(WM_CREATE, OnCreate)
00252         MESSAGE_RANGE_HANDLER(WM_MOUSEFIRST, WM_MOUSELAST, OnMouseMessage)
00253         MESSAGE_HANDLER(WM_ERASEBKGND, OnEraseBackground)
00254         MESSAGE_HANDLER(WM_PAINT, OnPaint)
00255         MESSAGE_HANDLER(WM_PRINTCLIENT, OnPaint)
00256         MESSAGE_HANDLER(WM_SETFOCUS, OnFocus)
00257         MESSAGE_HANDLER(WM_KILLFOCUS, OnFocus)
00258         MESSAGE_HANDLER(WM_LBUTTONDOWN, OnLButtonDown)
00259         MESSAGE_HANDLER(WM_LBUTTONDBLCLK, OnLButtonDblClk)
00260         MESSAGE_HANDLER(WM_LBUTTONUP, OnLButtonUp)
00261         MESSAGE_HANDLER(WM_CAPTURECHANGED, OnCaptureChanged)
00262         MESSAGE_HANDLER(WM_ENABLE, OnEnable)
00263         MESSAGE_HANDLER(WM_MOUSEMOVE, OnMouseMove)
00264         MESSAGE_HANDLER(WM_MOUSELEAVE, OnMouseLeave)
00265         MESSAGE_HANDLER(WM_KEYDOWN, OnKeyDown)
00266         MESSAGE_HANDLER(WM_KEYUP, OnKeyUp)
00267         MESSAGE_HANDLER(WM_TIMER, OnTimer)
00268     END_MSG_MAP()
00269 
<a name="l00270"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a14">00270</a>     LRESULT OnCreate(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00271     {
00272         Init();
00273         bHandled = FALSE;
00274         <font class="keywordflow">return</font> 1;
00275     }
00276 
<a name="l00277"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a15">00277</a>     LRESULT OnMouseMessage(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)
00278     {
00279         MSG msg = { m_hWnd, uMsg, wParam, lParam };
00280         <font class="keywordflow">if</font>(m_tip.IsWindow())
00281             m_tip.RelayEvent(&amp;msg);
00282         bHandled = FALSE;
00283         <font class="keywordflow">return</font> 1;
00284     }
00285 
<a name="l00286"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a16">00286</a>     LRESULT OnEraseBackground(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00287     {
00288         <font class="keywordflow">return</font> 1;   <font class="comment">// no background needed</font>
00289     }
00290 
<a name="l00291"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a17">00291</a>     LRESULT OnPaint(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00292     {
00293         T* pT = static_cast&lt;T*&gt;(this);
00294         <font class="keywordflow">if</font>(wParam != NULL)
00295         {
00296             pT-&gt;DoPaint((HDC)wParam);
00297         }
00298         <font class="keywordflow">else</font>
00299         {
00300             <a class="code" href="classWTL_1_1CPaintDC.html">CPaintDC</a> dc(m_hWnd);
00301             pT-&gt;DoPaint(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
00302         }
00303         <font class="keywordflow">return</font> 0;
00304     }
00305 
<a name="l00306"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a18">00306</a>     LRESULT OnFocus(UINT uMsg, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00307     {
00308         m_fFocus = (uMsg == WM_SETFOCUS) ? 1 : 0;
00309         Invalidate();
00310         UpdateWindow();
00311         bHandled = FALSE;
00312         <font class="keywordflow">return</font> 1;
00313     }
00314 
<a name="l00315"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a19">00315</a>     LRESULT OnLButtonDown(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00316     {
00317         LRESULT lRet = 0;
00318         <font class="keywordflow">if</font>(IsHoverMode())
00319             SetCapture();
00320         <font class="keywordflow">else</font>
00321             lRet = DefWindowProc(uMsg, wParam, lParam);
00322         <font class="keywordflow">if</font>(::GetCapture() == m_hWnd)
00323         {
00324             m_fPressed = 1;
00325             Invalidate();
00326             UpdateWindow();
00327         }
00328         <font class="keywordflow">if</font>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a5">BMPBTN_AUTOFIRE</a>) != 0)
00329         {
00330             <font class="keywordtype">int</font> nElapse = 250;
00331             <font class="keywordtype">int</font> nDelay = 0;
00332             <font class="keywordflow">if</font>(::SystemParametersInfo(SPI_GETKEYBOARDDELAY, 0, &amp;nDelay, 0))
00333                 nElapse += nDelay * 250;    <font class="comment">// all milli-seconds</font>
00334             SetTimer(ID_TIMER_FIRST, nElapse);
00335         }
00336         <font class="keywordflow">return</font> lRet;
00337     }
00338 
<a name="l00339"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a20">00339</a>     LRESULT OnLButtonDblClk(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00340     {
00341         LRESULT lRet = 0;
00342         <font class="keywordflow">if</font>(!IsHoverMode())
00343             lRet = DefWindowProc(uMsg, wParam, lParam);
00344         <font class="keywordflow">if</font>(::GetCapture() != m_hWnd)
00345             SetCapture();
00346         <font class="keywordflow">if</font>(m_fPressed == 0)
00347         {
00348             m_fPressed = 1;
00349             Invalidate();
00350             UpdateWindow();
00351         }
00352         <font class="keywordflow">return</font> lRet;
00353     }
00354 
<a name="l00355"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a21">00355</a>     LRESULT OnLButtonUp(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00356     {
00357         LRESULT lRet = 0;
00358         <font class="keywordtype">bool</font> bHover = IsHoverMode();
00359         <font class="keywordflow">if</font>(!bHover)
00360             lRet = DefWindowProc(uMsg, wParam, lParam);
00361         <font class="keywordflow">if</font>(::GetCapture() == m_hWnd)
00362         {
00363             <font class="keywordflow">if</font>(bHover &amp;&amp; m_fPressed == 1)
00364                 ::SendMessage(GetParent(), WM_COMMAND, MAKEWPARAM(GetDlgCtrlID(), BN_CLICKED), (LPARAM)m_hWnd);
00365             ::ReleaseCapture();
00366         }
00367         <font class="keywordflow">return</font> lRet;
00368     }
00369 
<a name="l00370"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a22">00370</a>     LRESULT OnCaptureChanged(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00371     {
00372         <font class="keywordflow">if</font>(m_fPressed == 1)
00373         {
00374             m_fPressed = 0;
00375             Invalidate();
00376             UpdateWindow();
00377         }
00378         bHandled = FALSE;
00379         <font class="keywordflow">return</font> 1;
00380     }
00381 
<a name="l00382"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a23">00382</a>     LRESULT OnEnable(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00383     {
00384         Invalidate();
00385         UpdateWindow();
00386         bHandled = FALSE;
00387         <font class="keywordflow">return</font> 1;
00388     }
00389 
<a name="l00390"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a24">00390</a>     LRESULT OnMouseMove(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; bHandled)
00391     {
00392         <font class="keywordflow">if</font>(::GetCapture() == m_hWnd)
00393         {
00394             POINT ptCursor = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam) };
00395             ClientToScreen(&amp;ptCursor);
00396             RECT rect;
00397             GetWindowRect(&amp;rect);
00398             <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> uPressed = ::PtInRect(&amp;rect, ptCursor) ? 1 : 0;
00399             <font class="keywordflow">if</font>(m_fPressed != uPressed)
00400             {
00401                 m_fPressed = uPressed;
00402                 Invalidate();
00403                 UpdateWindow();
00404             }
00405         }
00406         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(IsHoverMode() &amp;&amp; m_fMouseOver == 0)
00407         {
00408             m_fMouseOver = 1;
00409             Invalidate();
00410             UpdateWindow();
00411             StartTrackMouseLeave();
00412         }
00413         bHandled = FALSE;
00414         <font class="keywordflow">return</font> 1;
00415     }
00416 
<a name="l00417"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a25">00417</a>     LRESULT OnMouseLeave(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00418     {
00419         <font class="keywordflow">if</font>(m_fMouseOver == 1)
00420         {
00421             m_fMouseOver = 0;
00422             Invalidate();
00423             UpdateWindow();
00424         }
00425         <font class="keywordflow">return</font> 0;
00426     }
00427 
<a name="l00428"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a26">00428</a>     LRESULT OnKeyDown(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00429     {
00430         <font class="keywordflow">if</font>(wParam == VK_SPACE &amp;&amp; IsHoverMode())
00431             <font class="keywordflow">return</font> 0;   <font class="comment">// ignore if in hover mode</font>
00432         <font class="keywordflow">if</font>(wParam == VK_SPACE &amp;&amp; m_fPressed == 0)
00433         {
00434             m_fPressed = 1;
00435             Invalidate();
00436             UpdateWindow();
00437         }
00438         bHandled = FALSE;
00439         <font class="keywordflow">return</font> 1;
00440     }
00441 
<a name="l00442"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a27">00442</a>     LRESULT OnKeyUp(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00443     {
00444         <font class="keywordflow">if</font>(wParam == VK_SPACE &amp;&amp; IsHoverMode())
00445             <font class="keywordflow">return</font> 0;   <font class="comment">// ignore if in hover mode</font>
00446         <font class="keywordflow">if</font>(wParam == VK_SPACE &amp;&amp; m_fPressed == 1)
00447         {
00448             m_fPressed = 0;
00449             Invalidate();
00450             UpdateWindow();
00451         }
00452         bHandled = FALSE;
00453         <font class="keywordflow">return</font> 1;
00454     }
00455 
<a name="l00456"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a28">00456</a>     LRESULT OnTimer(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00457     {
00458         ATLASSERT((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a5">BMPBTN_AUTOFIRE</a>) != 0);
00459         <font class="keywordflow">switch</font>(wParam)  <font class="comment">// timer ID</font>
00460         {
00461         <font class="keywordflow">case</font> ID_TIMER_FIRST:
00462             KillTimer(ID_TIMER_FIRST);
00463             <font class="keywordflow">if</font>(m_fPressed == 1)
00464             {
00465                 ::SendMessage(GetParent(), WM_COMMAND, MAKEWPARAM(GetDlgCtrlID(), BN_CLICKED), (LPARAM)m_hWnd);
00466                 <font class="keywordtype">int</font> nElapse = 250;
00467                 <font class="keywordtype">int</font> nRepeat = 40;
00468                 <font class="keywordflow">if</font>(::SystemParametersInfo(SPI_GETKEYBOARDSPEED, 0, &amp;nRepeat, 0))
00469                     nElapse = 10000 / (10 * nRepeat + 25);  <font class="comment">// milli-seconds, approximated</font>
00470                 SetTimer(ID_TIMER_REPEAT, nElapse);
00471             }
00472             <font class="keywordflow">break</font>;
00473         <font class="keywordflow">case</font> ID_TIMER_REPEAT:
00474             <font class="keywordflow">if</font>(m_fPressed == 1)
00475                 ::SendMessage(GetParent(), WM_COMMAND, MAKEWPARAM(GetDlgCtrlID(), BN_CLICKED), (LPARAM)m_hWnd);
00476             <font class="keywordflow">else</font> <font class="keywordflow">if</font>(::GetCapture() != m_hWnd)
00477                 KillTimer(ID_TIMER_REPEAT);
00478             <font class="keywordflow">break</font>;
00479         <font class="keywordflow">default</font>:    <font class="comment">// not our timer</font>
00480             <font class="keywordflow">break</font>;
00481         }
00482         <font class="keywordflow">return</font> 0;
00483     }
00484 
00485 <font class="comment">// Implementation</font>
<a name="l00486"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a29">00486</a>     <font class="keywordtype">void</font> Init()
00487     {
00488         <font class="comment">// We need this style to prevent Windows from painting the button</font>
00489         ModifyStyle(0, BS_OWNERDRAW);
00490 
00491         <font class="comment">// create a tool tip</font>
00492         m_tip.Create(m_hWnd);
00493         ATLASSERT(m_tip.IsWindow());
00494         <font class="keywordflow">if</font>(m_tip.IsWindow() &amp;&amp; m_lpstrToolTipText != NULL)
00495         {
00496             m_tip.Activate(TRUE);
00497             m_tip.AddTool(m_hWnd, m_lpstrToolTipText);
00498         }
00499 
00500         <font class="keywordflow">if</font>(m_ImageList.<a class="code" href="classWTL_1_1CImageList.html#m0">m_hImageList</a> != NULL &amp;&amp; (m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a3">BMPBTN_AUTOSIZE</a>) != 0)
00501             SizeToImage();
00502     }
00503 
<a name="l00504"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a30">00504</a>     BOOL StartTrackMouseLeave()
00505     {
00506         TRACKMOUSEEVENT tme;
00507         tme.cbSize = <font class="keyword">sizeof</font>(tme);
00508         tme.dwFlags = TME_LEAVE;
00509         tme.hwndTrack = m_hWnd;
00510         <font class="keywordflow">return</font> _TrackMouseEvent(&amp;tme);
00511     }
00512 
<a name="l00513"></a><a class="code" href="classWTL_1_1CBitmapButtonImpl.html#a31">00513</a>     <font class="keywordtype">bool</font> IsHoverMode()<font class="keyword"> const</font>
00514 <font class="keyword">    </font>{
00515         <font class="keywordflow">return</font> ((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a0">BMPBTN_HOVER</a>) != 0);
00516     }
00517 };
00518 
00519 
<a name="l00520"></a><a class="code" href="classWTL_1_1CBitmapButton.html">00520</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CBitmapButton.html">CBitmapButton</a> : <font class="keyword">public</font> <a class="code" href="classWTL_1_1CBitmapButtonImpl.html">CBitmapButtonImpl</a>&lt;CBitmapButton&gt;
00521 {
00522 <font class="keyword">public</font>:
00523     <a class="code" href="classWTL_1_1CBitmapButton.html#a0">DECLARE_WND_SUPERCLASS</a>(_T(<font class="stringliteral">"WTL_BitmapButton"</font>), GetWndClassName())
00524 
00525     <a class="code" href="classWTL_1_1CBitmapButton.html">CBitmapButton</a>(DWORD dwExtendedStyle = <a class="code" href="atlctrlx_8h.html#a3">BMPBTN_AUTOSIZE</a>, HIMAGELIST hImageList = NULL) : 
00526         <a class="code" href="classWTL_1_1CBitmapButtonImpl.html">CBitmapButtonImpl&lt;CBitmapButton&gt;</a>(dwExtendedStyle, hImageList)
00527     { }
00528 };
00529 
00530 
00532 <font class="comment">// CCheckListCtrlView - list view control with check boxes</font>
00533 
00534 <font class="keyword">template</font> &lt;DWORD t_dwStyle, DWORD t_dwExStyle, DWORD t_dwExListViewStyle&gt;
<a name="l00535"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html">00535</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html">CCheckListViewCtrlImplTraits</a>
00536 {
00537 <font class="keyword">public</font>:
<a name="l00538"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html#d0">00538</a>     <font class="keyword">static</font> DWORD <a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html#d0">GetWndStyle</a>(DWORD dwStyle)
00539     {
00540         <font class="keywordflow">return</font> (dwStyle == 0) ? t_dwStyle : dwStyle;
00541     }
<a name="l00542"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html#d1">00542</a>     <font class="keyword">static</font> DWORD <a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html#d1">GetWndExStyle</a>(DWORD dwExStyle)
00543     {
00544         <font class="keywordflow">return</font> (dwExStyle == 0) ? t_dwExStyle : dwExStyle;
00545     }
<a name="l00546"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html#d2">00546</a>     <font class="keyword">static</font> DWORD <a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html#d2">GetExtendedLVStyle</a>()
00547     {
00548         <font class="keywordflow">return</font> t_dwExListViewStyle;
00549     }
00550 };
00551 
<a name="l00552"></a><a class="code" href="namespaceWTL.html#a33">00552</a> <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CCheckListViewCtrlImplTraits.html">CCheckListViewCtrlImplTraits&lt;WS_CHILD | WS_VISIBLE | LVS_REPORT | LVS_SHOWSELALWAYS, WS_EX_CLIENTEDGE, LVS_EX_CHECKBOXES | LVS_EX_FULLROWSELECT&gt;</a>    <a class="code" href="namespaceWTL.html#a33">CCheckListViewCtrlTraits</a>;
00553 
00554 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CListViewCtrl, <font class="keyword">class</font> TWinTraits = CCheckListViewCtrlTraits&gt;
<a name="l00555"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html">00555</a> <font class="keyword">class </font>ATL_NO_VTABLE CCheckListViewCtrlImpl : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt;T, TBase, TWinTraits&gt;
00556 {
00557 <font class="keyword">public</font>:
<a name="l00558"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a0">00558</a>     DECLARE_WND_SUPERCLASS(NULL, TBase::GetWndClassName())
00559 
00560 <font class="comment">// Attributes</font>
00561     <font class="keyword">static</font> DWORD GetExtendedLVStyle()
00562     {
00563         <font class="keywordflow">return</font> TWinTraits::GetExtendedLVStyle();
00564     }
00565 
00566 <font class="comment">// Operations</font>
<a name="l00567"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a1">00567</a>     BOOL SubclassWindow(HWND hWnd)
00568     {
00569         BOOL bRet = <a class="code" href="classCWindowImplBaseT.html">CWindowImplBaseT&lt; TBase, TWinTraits&gt;::SubclassWindow</a>(hWnd);
00570         <font class="keywordflow">if</font>(bRet)
00571         {
00572             T* pT = static_cast&lt;T*&gt;(this);
00573             pT;
00574             ATLASSERT((pT-&gt;GetExtendedLVStyle() &amp; LVS_EX_CHECKBOXES) != 0);
00575             SetExtendedListViewStyle(pT-&gt;GetExtendedLVStyle());
00576         }
00577         <font class="keywordflow">return</font> bRet;
00578     }
00579 
<a name="l00580"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a2">00580</a>     <font class="keywordtype">void</font> CheckSelectedItems(<font class="keywordtype">int</font> nCurrItem)
00581     {
00582         <font class="comment">// first check if this item is selected</font>
00583         LVITEM lvi;
00584         lvi.iItem = nCurrItem;
00585         lvi.iSubItem = 0;
00586         lvi.mask = LVIF_STATE;
00587         lvi.stateMask = LVIS_SELECTED;
00588         GetItem(&amp;lvi);
00589         <font class="comment">// if item is not selected, don't do anything</font>
00590         <font class="keywordflow">if</font>(!(lvi.state &amp; LVIS_SELECTED))
00591             <font class="keywordflow">return</font>;
00592         <font class="comment">// new check state will be reverse of the current state,</font>
00593         BOOL bCheck = !GetCheckState(nCurrItem);
00594         <font class="keywordtype">int</font> nItem = -1;
00595         <font class="keywordtype">int</font> nOldItem = -1;
00596         <font class="keywordflow">while</font>((nItem = GetNextItem(nOldItem, LVNI_SELECTED)) != -1)
00597         {
00598             <font class="keywordflow">if</font>(nItem != nCurrItem)
00599                 SetCheckState(nItem, bCheck);
00600             nOldItem = nItem;
00601         }
00602     }
00603 
00604 <font class="comment">// Implementation</font>
<a name="l00605"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#s0">00605</a>     <font class="keyword">typedef</font> <a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html">CCheckListViewCtrlImpl&lt; T, TBase, TWinTraits &gt;</a>  thisClass;
00606     BEGIN_MSG_MAP(thisClass)
00607         MESSAGE_HANDLER(WM_CREATE, OnCreate)
00608         MESSAGE_HANDLER(WM_LBUTTONDOWN, OnLButtonDown)
00609         MESSAGE_HANDLER(WM_LBUTTONDBLCLK, OnLButtonDown)
00610         MESSAGE_HANDLER(WM_KEYDOWN, OnKeyDown)
00611     END_MSG_MAP()
00612 
<a name="l00613"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a3">00613</a>     LRESULT OnCreate(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00614     {
00615         <font class="comment">// first let list view control initialize everything</font>
00616         LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);
00617         T* pT = static_cast&lt;T*&gt;(this);
00618         pT;
00619         ATLASSERT((pT-&gt;GetExtendedLVStyle() &amp; LVS_EX_CHECKBOXES) != 0);
00620         SetExtendedListViewStyle(pT-&gt;GetExtendedLVStyle());
00621         <font class="keywordflow">return</font> lRet;
00622     }
00623 
<a name="l00624"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a4">00624</a>     LRESULT OnLButtonDown(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; bHandled)
00625     {
00626         POINT ptMsg = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam) };
00627         LVHITTESTINFO lvh;
00628         lvh.pt = ptMsg;
00629         <font class="keywordflow">if</font>(HitTest(&amp;lvh) != -1 &amp;&amp; lvh.flags == LVHT_ONITEMSTATEICON &amp;&amp; ::GetKeyState(VK_CONTROL) &gt;= 0)
00630             CheckSelectedItems(lvh.iItem);
00631         bHandled = FALSE;
00632         <font class="keywordflow">return</font> 1;
00633     }
00634 
<a name="l00635"></a><a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a5">00635</a>     LRESULT OnKeyDown(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00636     {
00637         <font class="keywordflow">if</font>(wParam == VK_SPACE)
00638         {
00639             <font class="keywordtype">int</font> nCurrItem = GetNextItem(-1, LVNI_FOCUSED);
00640             <font class="keywordflow">if</font>(nCurrItem != -1  &amp;&amp; ::GetKeyState(VK_CONTROL) &gt;= 0)
00641                 CheckSelectedItems(nCurrItem);
00642         }
00643         bHandled = FALSE;
00644         <font class="keywordflow">return</font> 1;
00645     }
00646 };
00647 
<a name="l00648"></a><a class="code" href="classWTL_1_1CCheckListViewCtrl.html">00648</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CCheckListViewCtrl.html">CCheckListViewCtrl</a> : <font class="keyword">public</font> CCheckListViewCtrlImpl&lt;CCheckListViewCtrl&gt;
00649 {
00650 <font class="keyword">public</font>:
00651     <a class="code" href="classWTL_1_1CCheckListViewCtrlImpl.html#a0">DECLARE_WND_SUPERCLASS</a>(_T(<font class="stringliteral">"WTL_CheckListView"</font>), GetWndClassName())
00652 };
00653 
00654 
00656 <font class="comment">// CHyperLink - hyper link control implementation</font>
00657 
00658 <font class="preprocessor">#if (WINVER &lt; 0x0500)</font>
00659 <font class="preprocessor"></font><a class="code" href="namespaceWTL.html#a64">__declspec</a>(selectany) <font class="keyword">struct</font>
00660 <font class="keyword"></font>{
00661     <font class="keyword">enum</font> { cxWidth = 32, cyHeight = 32 };
00662     <font class="keywordtype">int</font> xHotSpot;
00663     <font class="keywordtype">int</font> yHotSpot;
00664     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> arrANDPlane[cxWidth * cyHeight / 8];
00665     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> arrXORPlane[cxWidth * cyHeight / 8];
00666 } _AtlHyperLink_CursorData = 
00667 {
00668     5, 0, 
00669     {
00670         0xF9, 0xFF, 0xFF, 0xFF, 0xF0, 0xFF, 0xFF, 0xFF, 0xF0, 0xFF, 0xFF, 0xFF, 0xF0, 0xFF, 0xFF, 0xFF, 
00671         0xF0, 0xFF, 0xFF, 0xFF, 0xF0, 0x3F, 0xFF, 0xFF, 0xF0, 0x07, 0xFF, 0xFF, 0xF0, 0x01, 0xFF, 0xFF, 
00672         0xF0, 0x00, 0xFF, 0xFF, 0x10, 0x00, 0x7F, 0xFF, 0x00, 0x00, 0x7F, 0xFF, 0x00, 0x00, 0x7F, 0xFF, 
00673         0x80, 0x00, 0x7F, 0xFF, 0xC0, 0x00, 0x7F, 0xFF, 0xC0, 0x00, 0x7F, 0xFF, 0xE0, 0x00, 0x7F, 0xFF, 
00674         0xE0, 0x00, 0xFF, 0xFF, 0xF0, 0x00, 0xFF, 0xFF, 0xF0, 0x00, 0xFF, 0xFF, 0xF8, 0x01, 0xFF, 0xFF, 
00675         0xF8, 0x01, 0xFF, 0xFF, 0xF8, 0x01, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
00676         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
00677         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF
00678     },
00679     {
00680         0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 
00681         0x06, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x06, 0xC0, 0x00, 0x00, 0x06, 0xD8, 0x00, 0x00, 
00682         0x06, 0xDA, 0x00, 0x00, 0x06, 0xDB, 0x00, 0x00, 0x67, 0xFB, 0x00, 0x00, 0x77, 0xFF, 0x00, 0x00, 
00683         0x37, 0xFF, 0x00, 0x00, 0x17, 0xFF, 0x00, 0x00, 0x1F, 0xFF, 0x00, 0x00, 0x0F, 0xFF, 0x00, 0x00, 
00684         0x0F, 0xFE, 0x00, 0x00, 0x07, 0xFE, 0x00, 0x00, 0x07, 0xFE, 0x00, 0x00, 0x03, 0xFC, 0x00, 0x00, 
00685         0x03, 0xFC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00686         0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00687         0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
00688     }
00689 };
00690 <font class="preprocessor">#endif //(WINVER &lt; 0x0500)</font>
00691 <font class="preprocessor"></font>
00692 
00693 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CWindow, <font class="keyword">class</font> TWinTraits = CControlWinTraits&gt;
<a name="l00694"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html">00694</a> <font class="keyword">class </font>ATL_NO_VTABLE CHyperLinkImpl : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt; T, TBase, TWinTraits &gt;
00695 {
00696 <font class="keyword">public</font>:
<a name="l00697"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m0">00697</a>     LPTSTR m_lpstrLabel;
<a name="l00698"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m1">00698</a>     LPTSTR m_lpstrHyperLink;
<a name="l00699"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m2">00699</a>     HCURSOR m_hCursor;
<a name="l00700"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m3">00700</a>     HFONT m_hFont;
<a name="l00701"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m4">00701</a>     RECT m_rcLink;
<a name="l00702"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m5">00702</a>     <font class="keywordtype">bool</font> m_bPaintLabel;
<a name="l00703"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m6">00703</a>     <a class="code" href="namespaceWTL.html#a8">CToolTipCtrl</a> m_tip;
00704 
<a name="l00705"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m7">00705</a>     <font class="keywordtype">bool</font> m_bVisited;
<a name="l00706"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m8">00706</a>     COLORREF m_clrLink;
<a name="l00707"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#m9">00707</a>     COLORREF m_clrVisited;
00708 
00709 
00710 <font class="comment">// Constructor/Destructor</font>
<a name="l00711"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a0">00711</a>     CHyperLinkImpl() : m_lpstrLabel(NULL), m_lpstrHyperLink(NULL),
00712             m_hCursor(NULL), m_hFont(NULL), m_bPaintLabel(true), m_bVisited(false),
00713             m_clrLink(RGB(0, 0, 255)), m_clrVisited(RGB(128, 0, 128))
00714     {
00715         ::SetRectEmpty(&amp;m_rcLink);
00716     }
00717 
<a name="l00718"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a1">00718</a>     ~CHyperLinkImpl()
00719     {
00720         free(m_lpstrLabel);
00721         free(m_lpstrHyperLink);
00722         <font class="keywordflow">if</font>(m_hFont != NULL)
00723             ::DeleteObject(m_hFont);
00724 <font class="preprocessor">#if (WINVER &lt; 0x0500)</font>
00725 <font class="preprocessor"></font>        <font class="comment">// It was created, not loaded, so we have to destroy it</font>
00726         <font class="keywordflow">if</font>(m_hCursor != NULL)
00727             ::DestroyCursor(m_hCursor);
00728 <font class="preprocessor">#endif //(WINVER &lt; 0x0500)</font>
00729 <font class="preprocessor"></font>    }
00730 
00731 <font class="comment">// Attributes</font>
<a name="l00732"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a2">00732</a>     <font class="keywordtype">bool</font> GetLabel(LPTSTR lpstrBuffer, <font class="keywordtype">int</font> nLength)<font class="keyword"> const</font>
00733 <font class="keyword">    </font>{
00734         <font class="keywordflow">if</font>(m_lpstrLabel == NULL)
00735             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00736         ATLASSERT(lpstrBuffer != NULL);
00737         <font class="keywordflow">if</font>(nLength &gt; lstrlen(m_lpstrLabel) + 1)
00738         {
00739             lstrcpy(lpstrBuffer, m_lpstrLabel);
00740             <font class="keywordflow">return</font> <font class="keyword">true</font>;
00741         }
00742         <font class="keywordflow">return</font> <font class="keyword">false</font>;
00743     }
00744 
<a name="l00745"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a3">00745</a>     <font class="keywordtype">bool</font> SetLabel(LPCTSTR lpstrLabel)
00746     {
00747         free(m_lpstrLabel);
00748         m_lpstrLabel = NULL;
00749         ATLTRY(m_lpstrLabel = (LPTSTR)malloc((lstrlen(lpstrLabel) + 1) * <font class="keyword">sizeof</font>(TCHAR)));
00750         <font class="keywordflow">if</font>(m_lpstrLabel == NULL)
00751             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00752         lstrcpy(m_lpstrLabel, lpstrLabel);
00753         T* pT = static_cast&lt;T*&gt;(this);
00754         pT-&gt;CalcLabelRect();
00755         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00756     }
00757 
<a name="l00758"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a4">00758</a>     <font class="keywordtype">bool</font> GetHyperLink(LPTSTR lpstrBuffer, <font class="keywordtype">int</font> nLength)<font class="keyword"> const</font>
00759 <font class="keyword">    </font>{
00760         <font class="keywordflow">if</font>(m_lpstrHyperLink == NULL)
00761             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00762         ATLASSERT(lpstrBuffer != NULL);
00763         <font class="keywordflow">if</font>(nLength &gt; lstrlen(m_lpstrHyperLink) + 1)
00764         {
00765             lstrcpy(lpstrBuffer, m_lpstrHyperLink);
00766             <font class="keywordflow">return</font> <font class="keyword">true</font>;
00767         }
00768         <font class="keywordflow">return</font> <font class="keyword">false</font>;
00769     }
00770 
<a name="l00771"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a5">00771</a>     <font class="keywordtype">bool</font> SetHyperLink(LPCTSTR lpstrLink)
00772     {
00773         free(m_lpstrHyperLink);
00774         m_lpstrHyperLink = NULL;
00775         ATLTRY(m_lpstrHyperLink = (LPTSTR)malloc((lstrlen(lpstrLink) + 1) * <font class="keyword">sizeof</font>(TCHAR)));
00776         <font class="keywordflow">if</font>(m_lpstrHyperLink == NULL)
00777             <font class="keywordflow">return</font> <font class="keyword">false</font>;
00778         lstrcpy(m_lpstrHyperLink, lpstrLink);
00779         <font class="keywordflow">if</font>(m_lpstrLabel == NULL)
00780         {
00781             T* pT = static_cast&lt;T*&gt;(this);
00782             pT-&gt;CalcLabelRect();
00783         }
00784         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00785     }
00786 
00787 <font class="comment">// Operations</font>
<a name="l00788"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a6">00788</a>     BOOL SubclassWindow(HWND hWnd)
00789     {
00790         ATLASSERT(m_hWnd == NULL);
00791         ATLASSERT(::IsWindow(hWnd));
00792         BOOL bRet = <a class="code" href="classCWindowImpl.html">CWindowImpl&lt; T, TBase, TWinTraits &gt;::SubclassWindow</a>(hWnd);
00793         <font class="keywordflow">if</font>(bRet)
00794             Init();
00795         <font class="keywordflow">return</font> bRet;
00796     }
00797 
<a name="l00798"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a7">00798</a>     <font class="keywordtype">bool</font> Navigate()
00799     {
00800         ATLASSERT(::IsWindow(m_hWnd));
00801         ATLASSERT(m_lpstrHyperLink != NULL);
00802         <a class="code" href="atlapp_8h.html#a43">DWORD_PTR</a> dwRet = (DWORD_PTR)::ShellExecute(0, _T(<font class="stringliteral">"open"</font>), m_lpstrHyperLink, 0, 0, SW_SHOWNORMAL);
00803         ATLASSERT(dwRet &gt; 32);
00804         <font class="keywordflow">if</font>(dwRet &gt; 32)
00805         {
00806             m_bVisited = <font class="keyword">true</font>;
00807             Invalidate();
00808         }
00809         <font class="keywordflow">return</font> (dwRet &gt; 32);
00810     }
00811 
00812 <font class="comment">// Message map and handlers</font>
00813     BEGIN_MSG_MAP(CHyperLinkImpl)
00814         MESSAGE_HANDLER(WM_CREATE, OnCreate)
00815         MESSAGE_RANGE_HANDLER(WM_MOUSEFIRST, WM_MOUSELAST, OnMouseMessage)
00816         MESSAGE_HANDLER(WM_ERASEBKGND, OnEraseBackground)
00817         MESSAGE_HANDLER(WM_PAINT, OnPaint)
00818         MESSAGE_HANDLER(WM_PRINTCLIENT, OnPaint)
00819         MESSAGE_HANDLER(WM_SETFOCUS, OnFocus)
00820         MESSAGE_HANDLER(WM_KILLFOCUS, OnFocus)
00821         MESSAGE_HANDLER(WM_MOUSEMOVE, OnMouseMove)
00822         MESSAGE_HANDLER(WM_LBUTTONDOWN, OnLButtonDown)
00823         MESSAGE_HANDLER(WM_LBUTTONUP, OnLButtonUp)
00824         MESSAGE_HANDLER(WM_CHAR, OnChar)
00825         MESSAGE_HANDLER(WM_GETDLGCODE, OnGetDlgCode)
00826         MESSAGE_HANDLER(WM_SETCURSOR, OnSetCursor)
00827     END_MSG_MAP()
00828 
<a name="l00829"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a8">00829</a>     LRESULT OnCreate(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00830     {
00831         Init();
00832         <font class="keywordflow">return</font> 0;
00833     }
00834 
<a name="l00835"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a9">00835</a>     LRESULT OnEraseBackground(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00836     {
00837         <font class="keywordflow">if</font>(m_bPaintLabel)
00838         {
00839             HBRUSH hBrush = (HBRUSH)::SendMessage(GetParent(), WM_CTLCOLORSTATIC, wParam, (LPARAM)m_hWnd);
00840             <font class="keywordflow">if</font>(hBrush != NULL)
00841             {
00842                 <a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc = (HDC)wParam;
00843                 RECT rect;
00844                 GetClientRect(&amp;rect);
00845                 dc.FillRect(&amp;rect, hBrush);
00846             }
00847         }
00848         <font class="keywordflow">else</font>
00849         {
00850             bHandled = FALSE;
00851         }
00852         <font class="keywordflow">return</font> 1;
00853     }
00854 
<a name="l00855"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a10">00855</a>     LRESULT OnPaint(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00856     {
00857         <font class="keywordflow">if</font>(!m_bPaintLabel)
00858         {
00859             bHandled = FALSE;
00860             <font class="keywordflow">return</font> 1;
00861         }
00862 
00863         T* pT = static_cast&lt;T*&gt;(this);
00864         <font class="keywordflow">if</font>(wParam != NULL)
00865         {
00866             pT-&gt;DoPaint((HDC)wParam);
00867         }
00868         <font class="keywordflow">else</font>
00869         {
00870             <a class="code" href="classWTL_1_1CPaintDC.html">CPaintDC</a> dc(m_hWnd);
00871             pT-&gt;DoPaint(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
00872         }
00873 
00874         <font class="keywordflow">return</font> 0;
00875     }
00876 
<a name="l00877"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a11">00877</a>     LRESULT OnFocus(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00878     {
00879         <font class="keywordflow">if</font>(m_bPaintLabel)
00880             Invalidate();
00881         <font class="keywordflow">else</font>
00882             bHandled = FALSE;
00883         <font class="keywordflow">return</font> 0;
00884     }
00885 
<a name="l00886"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a12">00886</a>     LRESULT OnMouseMove(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; bHandled)
00887     {
00888         POINT pt = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam) };
00889         <font class="keywordflow">if</font>(m_lpstrHyperLink != NULL &amp;&amp; ::PtInRect(&amp;m_rcLink, pt))
00890             ::SetCursor(m_hCursor);
00891         <font class="keywordflow">else</font>
00892             bHandled = FALSE;
00893         <font class="keywordflow">return</font> 0;
00894     }
00895 
<a name="l00896"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a13">00896</a>     LRESULT OnLButtonDown(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00897     {
00898         POINT pt = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam) };
00899         <font class="keywordflow">if</font>(::PtInRect(&amp;m_rcLink, pt))
00900         {
00901             SetFocus();
00902             SetCapture();
00903         }
00904         <font class="keywordflow">return</font> 0;
00905     }
00906 
<a name="l00907"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a14">00907</a>     LRESULT OnLButtonUp(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00908     {
00909         <font class="keywordflow">if</font>(GetCapture() == m_hWnd)
00910         {
00911             ReleaseCapture();
00912             POINT pt = { <a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam) };
00913             <font class="keywordflow">if</font>(::PtInRect(&amp;m_rcLink, pt))
00914             {
00915                 T* pT = static_cast&lt;T*&gt;(this);
00916                 pT-&gt;Navigate();
00917             }
00918         }
00919         <font class="keywordflow">return</font> 0;
00920     }
00921 
<a name="l00922"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a15">00922</a>     LRESULT OnSetCursor(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; bHandled)
00923     {
00924         POINT pt;
00925         GetCursorPos(&amp;pt);
00926         ScreenToClient(&amp;pt);
00927         <font class="keywordflow">if</font>(m_lpstrHyperLink != NULL &amp;&amp; ::PtInRect(&amp;m_rcLink, pt))
00928         {
00929             <font class="keywordflow">return</font> TRUE;
00930         }
00931         bHandled = FALSE;
00932         <font class="keywordflow">return</font> FALSE;
00933     }
00934 
<a name="l00935"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a16">00935</a>     LRESULT OnChar(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00936     {
00937         <font class="keywordflow">if</font>(wParam == VK_RETURN || wParam == VK_SPACE)
00938         {
00939             T* pT = static_cast&lt;T*&gt;(this);
00940             pT-&gt;Navigate();
00941         }
00942         <font class="keywordflow">return</font> 0;
00943     }
00944 
<a name="l00945"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a17">00945</a>     LRESULT OnGetDlgCode(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
00946     {
00947         <font class="keywordflow">return</font> DLGC_WANTCHARS;
00948     }
00949 
<a name="l00950"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a18">00950</a>     LRESULT OnMouseMessage(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)
00951     {
00952         MSG msg = { m_hWnd, uMsg, wParam, lParam };
00953         <font class="keywordflow">if</font>(m_tip.IsWindow())
00954             m_tip.RelayEvent(&amp;msg);
00955         bHandled = FALSE;
00956         <font class="keywordflow">return</font> 1;
00957     }
00958 
00959 <font class="comment">// Implementation</font>
<a name="l00960"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a19">00960</a>     <font class="keywordtype">void</font> Init()
00961     {
00962         ATLASSERT(::IsWindow(m_hWnd));
00963 
00964         <font class="comment">// Check if we should paint a label</font>
00965         TCHAR lpszBuffer[8];
00966         <font class="keywordflow">if</font>(::GetClassName(m_hWnd, lpszBuffer, 8))
00967         {
00968             <font class="keywordflow">if</font>(lstrcmpi(lpszBuffer, _T(<font class="stringliteral">"static"</font>)) == 0)
00969             {
00970                 ModifyStyle(0, SS_NOTIFY);  <font class="comment">// we need this</font>
00971                 DWORD dwStyle = GetStyle() &amp; 0x000000FF;
00972                 <font class="keywordflow">if</font>(dwStyle == SS_ICON || dwStyle == SS_BLACKRECT || dwStyle == SS_GRAYRECT || 
00973                         dwStyle == SS_WHITERECT || dwStyle == SS_BLACKFRAME || dwStyle == SS_GRAYFRAME || 
00974                         dwStyle == SS_WHITEFRAME || dwStyle == SS_OWNERDRAW || 
00975                         dwStyle == SS_BITMAP || dwStyle == SS_ENHMETAFILE)
00976                     m_bPaintLabel = <font class="keyword">false</font>;
00977             }
00978         }
00979 
00980         <font class="comment">// create or load a cursor</font>
00981 <font class="preprocessor">#if (WINVER &gt;= 0x0500)</font>
00982 <font class="preprocessor"></font>        m_hCursor = ::LoadCursor(NULL, IDC_HAND);
00983 <font class="preprocessor">#else</font>
00984 <font class="preprocessor"></font>        m_hCursor = ::CreateCursor(_Module.GetModuleInstance(), _AtlHyperLink_CursorData.xHotSpot, _AtlHyperLink_CursorData.yHotSpot, _AtlHyperLink_CursorData.cxWidth, _AtlHyperLink_CursorData.cyHeight, _AtlHyperLink_CursorData.arrANDPlane, _AtlHyperLink_CursorData.arrXORPlane);
00985 <font class="preprocessor">#endif </font>
00986 <font class="preprocessor">        ATLASSERT(m_hCursor != NULL);</font>
00987 <font class="preprocessor"></font>
00988         <font class="comment">// set font</font>
00989         <font class="keywordflow">if</font>(m_bPaintLabel)
00990         {
00991             <a class="code" href="classCWindow.html">CWindow</a> wnd = GetParent();
00992             <a class="code" href="namespaceWTL.html#a39">CFontHandle</a> font = wnd.GetFont();
00993             <font class="keywordflow">if</font>(font.m_hFont != NULL)
00994             {
00995                 LOGFONT lf;
00996                 font.GetLogFont(&amp;lf);
00997                 lf.lfUnderline = TRUE;
00998                 m_hFont = ::CreateFontIndirect(&amp;lf);
00999             }
01000         }
01001 
01002         <font class="comment">// set label (defaults to window text)</font>
01003         <font class="keywordflow">if</font>(m_lpstrLabel == NULL)
01004         {
01005             <font class="keywordtype">int</font> nLen = GetWindowTextLength();
01006             <font class="keywordflow">if</font>(nLen &gt; 0)
01007             {
01008                 LPTSTR lpszText = (LPTSTR)_alloca((nLen+1)*<font class="keyword">sizeof</font>(TCHAR));
01009                 <font class="keywordflow">if</font>(GetWindowText(lpszText, nLen+1))
01010                     SetLabel(lpszText);
01011             }
01012         }
01013 
01014         <font class="comment">// set hyperlink (defaults to label)</font>
01015         <font class="keywordflow">if</font>(m_lpstrHyperLink == NULL &amp;&amp; m_lpstrLabel != NULL)
01016             SetHyperLink(m_lpstrLabel);
01017 
01018         T* pT = static_cast&lt;T*&gt;(this);
01019         pT-&gt;CalcLabelRect();
01020 
01021         <font class="comment">// create a tool tip</font>
01022         m_tip.Create(m_hWnd);
01023         ATLASSERT(m_tip.IsWindow());
01024         m_tip.Activate(TRUE);
01025         m_tip.AddTool(m_hWnd, m_lpstrHyperLink);
01026 
01027         <font class="comment">// set link colors</font>
01028         <font class="keywordflow">if</font>(m_bPaintLabel)
01029         {
01030             CRegKey rk;
01031             LONG lRet = rk.Open(HKEY_CURRENT_USER, _T(<font class="stringliteral">"Software\\Microsoft\\Internet Explorer\\Settings"</font>));
01032             <font class="keywordflow">if</font>(lRet == 0)
01033             {
01034                 TCHAR szBuff[12];
01035 <font class="preprocessor">#if (_ATL_VER &gt;= 0x0700)</font>
01036 <font class="preprocessor"></font>                ULONG ulCount = 12 * <font class="keyword">sizeof</font>(TCHAR);
01037                 lRet = rk.QueryStringValue(_T(<font class="stringliteral">"Anchor Color"</font>), szBuff, &amp;ulCount);
01038 <font class="preprocessor">#else</font>
01039 <font class="preprocessor"></font>                DWORD dwCount = 12 * <font class="keyword">sizeof</font>(TCHAR);
01040                 lRet = rk.QueryValue(szBuff, _T(<font class="stringliteral">"Anchor Color"</font>), &amp;dwCount);
01041 <font class="preprocessor">#endif</font>
01042 <font class="preprocessor"></font>                <font class="keywordflow">if</font>(lRet == 0)
01043                 {
01044                     COLORREF clr = _ParseColorString(szBuff);
01045                     ATLASSERT(clr != CLR_INVALID);
01046                     <font class="keywordflow">if</font>(clr != CLR_INVALID)
01047                         m_clrLink = clr;
01048                 }
01049 
01050 <font class="preprocessor">#if (_ATL_VER &gt;= 0x0700)</font>
01051 <font class="preprocessor"></font>                ulCount = 12 * <font class="keyword">sizeof</font>(TCHAR);
01052                 lRet = rk.QueryStringValue(_T(<font class="stringliteral">"Anchor Color Visited"</font>), szBuff, &amp;ulCount);
01053 <font class="preprocessor">#else</font>
01054 <font class="preprocessor"></font>                dwCount = 12 * <font class="keyword">sizeof</font>(TCHAR);
01055                 lRet = rk.QueryValue(szBuff, _T(<font class="stringliteral">"Anchor Color Visited"</font>), &amp;dwCount);
01056 <font class="preprocessor">#endif</font>
01057 <font class="preprocessor"></font>                <font class="keywordflow">if</font>(lRet == 0)
01058                 {
01059                     COLORREF clr = _ParseColorString(szBuff);
01060                     ATLASSERT(clr != CLR_INVALID);
01061                     <font class="keywordflow">if</font>(clr != CLR_INVALID)
01062                         m_clrVisited = clr;
01063                 }
01064             }
01065         }
01066     }
01067 
<a name="l01068"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#d0">01068</a>     <font class="keyword">static</font> COLORREF _ParseColorString(LPTSTR lpstr)
01069     {
01070         <font class="keywordtype">int</font> c[3] = { -1, -1, -1 };
01071         LPTSTR p;
01072         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; 2; i++)
01073         {
01074             <font class="keywordflow">for</font>(p = lpstr; *p != _T(<font class="charliteral">'\0'</font>); p = ::CharNext(p))
01075             {
01076                 <font class="keywordflow">if</font>(*p == _T(<font class="charliteral">','</font>))
01077                 {
01078                     *p = _T(<font class="charliteral">'\0'</font>);
01079                     c[i] = _ttoi(lpstr);
01080                     lpstr = &amp;p[1];
01081                     <font class="keywordflow">break</font>;
01082                 }
01083             }
01084             <font class="keywordflow">if</font>(c[i] == -1)
01085                 <font class="keywordflow">return</font> CLR_INVALID;
01086         }
01087         <font class="keywordflow">if</font>(*lpstr == _T(<font class="charliteral">'\0'</font>))
01088             <font class="keywordflow">return</font> CLR_INVALID;
01089         c[2] = _ttoi(lpstr);
01090 
01091         <font class="keywordflow">return</font> RGB(c[0], c[1], c[2]);
01092     }
01093 
<a name="l01094"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a20">01094</a>     <font class="keywordtype">bool</font> CalcLabelRect()
01095     {
01096         <font class="keywordflow">if</font>(!::IsWindow(m_hWnd))
01097             <font class="keywordflow">return</font> <font class="keyword">false</font>;
01098         <font class="keywordflow">if</font>(m_lpstrLabel == NULL &amp;&amp; m_lpstrHyperLink == NULL)
01099             <font class="keywordflow">return</font> <font class="keyword">false</font>;
01100 
01101         <a class="code" href="classWTL_1_1CClientDC.html">CClientDC</a> dc(m_hWnd);
01102         RECT rect;
01103         GetClientRect(&amp;rect);
01104         m_rcLink = rect;
01105         <font class="keywordflow">if</font>(m_bPaintLabel)
01106         {
01107             HFONT hOldFont = NULL;
01108             <font class="keywordflow">if</font>(m_hFont != NULL)
01109                 hOldFont = dc.<a class="code" href="classWTL_1_1CDCT.html#a28">SelectFont</a>(m_hFont);
01110             LPTSTR lpstrText = (m_lpstrLabel != NULL) ? m_lpstrLabel : m_lpstrHyperLink;
01111             DWORD dwStyle = GetStyle();
01112             <font class="keywordtype">int</font> nDrawStyle = DT_LEFT;
01113             <font class="keywordflow">if</font> (dwStyle &amp; SS_CENTER)
01114                 nDrawStyle = DT_CENTER;
01115             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (dwStyle &amp; SS_RIGHT)
01116                 nDrawStyle = DT_RIGHT;
01117             dc.<a class="code" href="classWTL_1_1CDCT.html#a161">DrawText</a>(lpstrText, -1, &amp;m_rcLink, nDrawStyle | DT_WORDBREAK | DT_CALCRECT);
01118             <font class="keywordflow">if</font>(m_hFont != NULL)
01119                 dc.<a class="code" href="classWTL_1_1CDCT.html#a28">SelectFont</a>(hOldFont);
01120             <font class="keywordflow">if</font> (dwStyle &amp; SS_CENTER)
01121             {
01122                 <font class="keywordtype">int</font> dx = (rect.right - m_rcLink.right) / 2;
01123                 ::OffsetRect(&amp;m_rcLink, dx, 0);
01124             }
01125             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (dwStyle &amp; SS_RIGHT)
01126             {
01127                 <font class="keywordtype">int</font> dx = rect.right - m_rcLink.right;
01128                 ::OffsetRect(&amp;m_rcLink, dx, 0);
01129             }
01130         }
01131 
01132         <font class="keywordflow">return</font> <font class="keyword">true</font>;
01133     }
01134 
<a name="l01135"></a><a class="code" href="classWTL_1_1CHyperLinkImpl.html#a21">01135</a>     <font class="keywordtype">void</font> DoPaint(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc)
01136     {
01137         dc.SetBkMode(TRANSPARENT);
01138         dc.SetTextColor(m_bVisited ? m_clrVisited : m_clrLink);
01139         <font class="keywordflow">if</font>(m_hFont != NULL)
01140             dc.SelectFont(m_hFont);
01141         LPTSTR lpstrText = (m_lpstrLabel != NULL) ? m_lpstrLabel : m_lpstrHyperLink;
01142         DWORD dwStyle = GetStyle();
01143         <font class="keywordtype">int</font> nDrawStyle = DT_LEFT;
01144         <font class="keywordflow">if</font> (dwStyle &amp; SS_CENTER)
01145             nDrawStyle = DT_CENTER;
01146         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (dwStyle &amp; SS_RIGHT)
01147             nDrawStyle = DT_RIGHT;
01148         dc.DrawText(lpstrText, -1, &amp;m_rcLink, nDrawStyle | DT_WORDBREAK);
01149         <font class="keywordflow">if</font>(GetFocus() == m_hWnd)
01150             dc.DrawFocusRect(&amp;m_rcLink);
01151     }
01152 };
01153 
01154 
<a name="l01155"></a><a class="code" href="classWTL_1_1CHyperLink.html">01155</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CHyperLink.html">CHyperLink</a> : <font class="keyword">public</font> CHyperLinkImpl&lt;CHyperLink&gt;
01156 {
01157 <font class="keyword">public</font>:
01158     DECLARE_WND_CLASS(_T(<font class="stringliteral">"WTL_HyperLink"</font>))
01159 };
01160 
01161 
01163 <font class="comment">// CWaitCursor - displays a wait cursor</font>
01164 
<a name="l01165"></a><a class="code" href="classWTL_1_1CWaitCursor.html">01165</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CWaitCursor.html">CWaitCursor</a>
01166 {
01167 <font class="keyword">public</font>:
01168 <font class="comment">// Data</font>
01169     HCURSOR <a class="code" href="classWTL_1_1CWaitCursor.html#m0">m_hWaitCursor</a>;
01170     HCURSOR <a class="code" href="classWTL_1_1CWaitCursor.html#m1">m_hOldCursor</a>;
01171     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CWaitCursor.html#m2">m_bInUse</a>;
01172 
01173 <font class="comment">// Constructor/destructor</font>
<a name="l01174"></a><a class="code" href="classWTL_1_1CWaitCursor.html#a0">01174</a>     <a class="code" href="classWTL_1_1CWaitCursor.html#a0">CWaitCursor</a>(<font class="keywordtype">bool</font> bSet = <font class="keyword">true</font>, LPCTSTR lpstrCursor = IDC_WAIT, <font class="keywordtype">bool</font> bSys = <font class="keyword">true</font>) : <a class="code" href="classWTL_1_1CWaitCursor.html#m1">m_hOldCursor</a>(NULL), <a class="code" href="classWTL_1_1CWaitCursor.html#m2">m_bInUse</a>(false)
01175     {
01176         HINSTANCE hInstance = bSys ? NULL : _Module.GetResourceInstance();
01177         <a class="code" href="classWTL_1_1CWaitCursor.html#m0">m_hWaitCursor</a> = ::LoadCursor(hInstance, lpstrCursor);
01178         ATLASSERT(<a class="code" href="classWTL_1_1CWaitCursor.html#m0">m_hWaitCursor</a> != NULL);
01179 
01180         <font class="keywordflow">if</font>(bSet)
01181             <a class="code" href="classWTL_1_1CWaitCursor.html#a2">Set</a>();
01182     }
01183 
<a name="l01184"></a><a class="code" href="classWTL_1_1CWaitCursor.html#a1">01184</a>     <a class="code" href="classWTL_1_1CWaitCursor.html#a1">~CWaitCursor</a>()
01185     {
01186         <a class="code" href="classWTL_1_1CWaitCursor.html#a3">Restore</a>();
01187     }
01188 
01189 <font class="comment">// Methods</font>
<a name="l01190"></a><a class="code" href="classWTL_1_1CWaitCursor.html#a2">01190</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CWaitCursor.html#a2">Set</a>()
01191     {
01192         <font class="keywordflow">if</font>(m_bInUse)
01193             <font class="keywordflow">return</font> <font class="keyword">false</font>;
01194         <a class="code" href="classWTL_1_1CWaitCursor.html#m1">m_hOldCursor</a> = ::SetCursor(m_hWaitCursor);
01195         <a class="code" href="classWTL_1_1CWaitCursor.html#m2">m_bInUse</a> = <font class="keyword">true</font>;
01196         <font class="keywordflow">return</font> <font class="keyword">true</font>;
01197     }
01198 
<a name="l01199"></a><a class="code" href="classWTL_1_1CWaitCursor.html#a3">01199</a>     <font class="keywordtype">bool</font> <a class="code" href="classWTL_1_1CWaitCursor.html#a3">Restore</a>()
01200     {
01201         <font class="keywordflow">if</font>(!<a class="code" href="classWTL_1_1CWaitCursor.html#m2">m_bInUse</a>)
01202             <font class="keywordflow">return</font> <font class="keyword">false</font>;
01203         ::SetCursor(m_hOldCursor);
01204         <a class="code" href="classWTL_1_1CWaitCursor.html#m2">m_bInUse</a> = <font class="keyword">false</font>;
01205         <font class="keywordflow">return</font> <font class="keyword">true</font>;
01206     }
01207 };
01208 
01209 
01211 <font class="comment">// CMultiPaneStatusBarCtrl - Status Bar with multiple panes</font>
01212 
01213 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CStatusBarCtrl&gt;
<a name="l01214"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html">01214</a> <font class="keyword">class </font>ATL_NO_VTABLE CMultiPaneStatusBarCtrlImpl : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt; T, TBase &gt;
01215 {
01216 <font class="keyword">public</font>:
<a name="l01217"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a0">01217</a>     DECLARE_WND_SUPERCLASS(NULL, TBase::GetWndClassName())
01218 
01219 <font class="comment">// Data</font>
01220     <font class="keyword">enum</font> { m_cxPaneMargin = 3 };
01221 
<a name="l01222"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#m0">01222</a>     <font class="keywordtype">int</font> m_nPanes;
<a name="l01223"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#m1">01223</a>     <font class="keywordtype">int</font>* m_pPane;
01224 
01225 <font class="comment">// Constructor/destructor</font>
<a name="l01226"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a1">01226</a>     CMultiPaneStatusBarCtrlImpl() : m_nPanes(0), m_pPane(NULL)
01227     { }
01228 
<a name="l01229"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a2">01229</a>     ~CMultiPaneStatusBarCtrlImpl()
01230     {
01231         <font class="keyword">delete</font> [] m_pPane;
01232     }
01233 
01234 <font class="comment">// Methods</font>
<a name="l01235"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a3">01235</a>     HWND Create(HWND hWndParent, LPCTSTR lpstrText, DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN | WS_CLIPSIBLINGS | SBARS_SIZEGRIP, UINT nID = <a class="code" href="atlres_8h.html#a5">ATL_IDW_STATUS_BAR</a>)
01236     {
01237         <font class="keywordflow">return</font> <a class="code" href="classCWindowImpl.html">CWindowImpl&lt; T, TBase &gt;::Create</a>(hWndParent, rcDefault, lpstrText, dwStyle, 0, nID);
01238     }
01239 
<a name="l01240"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a4">01240</a>     HWND Create(HWND hWndParent, UINT nTextID = <a class="code" href="atlres_8h.html#a104">ATL_IDS_IDLEMESSAGE</a>, DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN | WS_CLIPSIBLINGS | SBARS_SIZEGRIP, UINT nID = <a class="code" href="atlres_8h.html#a5">ATL_IDW_STATUS_BAR</a>)
01241     {
01242         TCHAR szText[128];  <font class="comment">// max text lentgth is 127 for status bars</font>
01243         szText[0] = 0;
01244         ::LoadString(_Module.GetResourceInstance(), nTextID, szText, 127);
01245         <font class="keywordflow">return</font> Create(hWndParent, szText, dwStyle, nID);
01246     }
01247 
<a name="l01248"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a5">01248</a>     BOOL SetPanes(<font class="keywordtype">int</font>* pPanes, <font class="keywordtype">int</font> nPanes, <font class="keywordtype">bool</font> bSetText = <font class="keyword">true</font>)
01249     {
01250         ATLASSERT(::IsWindow(m_hWnd));
01251         ATLASSERT(nPanes &gt; 0);
01252 
01253         m_nPanes = nPanes;
01254         <font class="keyword">delete</font> [] m_pPane;
01255         m_pPane = NULL;
01256 
01257         ATLTRY(m_pPane = <font class="keyword">new</font> <font class="keywordtype">int</font>[nPanes]);
01258         ATLASSERT(m_pPane != NULL);
01259         <font class="keywordflow">if</font>(m_pPane == NULL)
01260             <font class="keywordflow">return</font> FALSE;
01261         memcpy(m_pPane, pPanes, nPanes * <font class="keyword">sizeof</font>(<font class="keywordtype">int</font>));
01262 
01263         <font class="keywordtype">int</font>* pPanesPos = NULL;
01264         ATLTRY(pPanesPos = (<font class="keywordtype">int</font>*)_alloca(nPanes * <font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)));
01265         ATLASSERT(pPanesPos != NULL);
01266 
01267         <font class="comment">// get status bar DC and set font</font>
01268         <a class="code" href="classWTL_1_1CClientDC.html">CClientDC</a> dc(m_hWnd);
01269         HFONT hOldFont = dc.<a class="code" href="classWTL_1_1CDCT.html#a28">SelectFont</a>(GetFont());
01270 
01271         <font class="comment">// get status bar borders</font>
01272         <font class="keywordtype">int</font> arrBorders[3];
01273         GetBorders(arrBorders);
01274 
01275         TCHAR szBuff[256];
01276         SIZE size;
01277         <font class="keywordtype">int</font> cxLeft = arrBorders[0];
01278 
01279         <font class="comment">// calculate right edge of each part</font>
01280         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; nPanes; i++)
01281         {
01282             <font class="keywordflow">if</font>(pPanes[i] == <a class="code" href="atlres_8h.html#a3">ID_DEFAULT_PANE</a>)
01283             {
01284                 <font class="comment">// will be resized later</font>
01285                 pPanesPos[i] = 100 + cxLeft + arrBorders[2];
01286             }
01287             <font class="keywordflow">else</font>
01288             {
01289                 ::LoadString(_Module.GetResourceInstance(), pPanes[i], szBuff, <font class="keyword">sizeof</font>(szBuff) / <font class="keyword">sizeof</font>(TCHAR));
01290                 dc.<a class="code" href="classWTL_1_1CDCT.html#a164">GetTextExtent</a>(szBuff, lstrlen(szBuff), &amp;size);
01291                 T* pT = static_cast&lt;T*&gt;(this);
01292                 pT;
01293                 pPanesPos[i] = cxLeft + size.cx + arrBorders[2] + 2 * pT-&gt;m_cxPaneMargin;
01294             }
01295             cxLeft = pPanesPos[i];
01296         }
01297 
01298         BOOL bRet = SetParts(nPanes, pPanesPos);
01299 
01300         <font class="keywordflow">if</font>(bRet &amp;&amp; bSetText)
01301         {
01302             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; nPanes; i++)
01303             {
01304                 <font class="keywordflow">if</font>(pPanes[i] != <a class="code" href="atlres_8h.html#a3">ID_DEFAULT_PANE</a>)
01305                 {
01306                     ::LoadString(_Module.GetResourceInstance(), pPanes[i], szBuff, <font class="keyword">sizeof</font>(szBuff) / <font class="keyword">sizeof</font>(TCHAR));
01307                     SetPaneText(m_pPane[i], szBuff);
01308                 }
01309             }
01310         }
01311 
01312         dc.<a class="code" href="classWTL_1_1CDCT.html#a28">SelectFont</a>(hOldFont);
01313         <font class="keywordflow">return</font> bRet;
01314     }
01315 
<a name="l01316"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a6">01316</a>     <font class="keywordtype">bool</font> GetPaneTextLength(<font class="keywordtype">int</font> nPaneID, <font class="keywordtype">int</font>* pcchLength = NULL, <font class="keywordtype">int</font>* pnType = NULL)<font class="keyword"> const</font>
01317 <font class="keyword">    </font>{
01318         ATLASSERT(::IsWindow(m_hWnd));
01319         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01320         <font class="keywordflow">if</font>(nIndex == -1)
01321             <font class="keywordflow">return</font> <font class="keyword">false</font>;
01322 
01323         <font class="keywordtype">int</font> nLength = GetTextLength(nIndex, pnType);
01324         <font class="keywordflow">if</font>(pcchLength != NULL)
01325             *pcchLength = nLength;
01326 
01327         <font class="keywordflow">return</font> <font class="keyword">true</font>;
01328     }
01329 
<a name="l01330"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a7">01330</a>     BOOL GetPaneText(<font class="keywordtype">int</font> nPaneID, LPTSTR lpstrText, <font class="keywordtype">int</font>* pcchLength = NULL, <font class="keywordtype">int</font>* pnType = NULL)<font class="keyword"> const</font>
01331 <font class="keyword">    </font>{
01332         ATLASSERT(::IsWindow(m_hWnd));
01333         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01334         <font class="keywordflow">if</font>(nIndex == -1)
01335             <font class="keywordflow">return</font> FALSE;
01336 
01337         <font class="keywordtype">int</font> nLength = GetText(nIndex, lpstrText, pnType);
01338         <font class="keywordflow">if</font>(pcchLength != NULL)
01339             *pcchLength = nLength;
01340 
01341         <font class="keywordflow">return</font> TRUE;
01342     }
01343 
<a name="l01344"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a8">01344</a>     BOOL SetPaneText(<font class="keywordtype">int</font> nPaneID, LPCTSTR lpstrText, <font class="keywordtype">int</font> nType = 0)
01345     {
01346         ATLASSERT(::IsWindow(m_hWnd));
01347         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01348         <font class="keywordflow">if</font>(nIndex == -1)
01349             <font class="keywordflow">return</font> FALSE;
01350 
01351         <font class="keywordflow">return</font> SetText(nIndex, lpstrText, nType);
01352     }
01353 
<a name="l01354"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a9">01354</a>     BOOL GetPaneRect(<font class="keywordtype">int</font> nPaneID, LPRECT lpRect)<font class="keyword"> const</font>
01355 <font class="keyword">    </font>{
01356         ATLASSERT(::IsWindow(m_hWnd));
01357         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01358         <font class="keywordflow">if</font>(nIndex == -1)
01359             <font class="keywordflow">return</font> FALSE;
01360 
01361         <font class="keywordflow">return</font> GetRect(nIndex, lpRect);
01362     }
01363 
<a name="l01364"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a10">01364</a>     BOOL SetPaneWidth(<font class="keywordtype">int</font> nPaneID, <font class="keywordtype">int</font> cxWidth)
01365     {
01366         ATLASSERT(::IsWindow(m_hWnd));
01367         ATLASSERT(nPaneID != <a class="code" href="atlres_8h.html#a3">ID_DEFAULT_PANE</a>);  <font class="comment">// Can't resize this one</font>
01368         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01369         <font class="keywordflow">if</font>(nIndex == -1)
01370             <font class="keywordflow">return</font> FALSE;
01371 
01372         <font class="comment">// get pane positions</font>
01373         <font class="keywordtype">int</font>* pPanesPos = NULL;
01374         ATLTRY(pPanesPos = (<font class="keywordtype">int</font>*)_alloca(m_nPanes * <font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)));
01375         GetParts(m_nPanes, pPanesPos);
01376         <font class="comment">// calculate offset</font>
01377         <font class="keywordtype">int</font> cxPaneWidth = pPanesPos[nIndex] - ((nIndex == 0) ? 0 : pPanesPos[nIndex - 1]);
01378         <font class="keywordtype">int</font> cxOff = cxWidth - cxPaneWidth;
01379         <font class="comment">// find variable width pane</font>
01380         <font class="keywordtype">int</font> nDef = m_nPanes;
01381         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; m_nPanes; i++)
01382         {
01383             <font class="keywordflow">if</font>(m_pPane[i] == <a class="code" href="atlres_8h.html#a3">ID_DEFAULT_PANE</a>)
01384             {
01385                 nDef = i;
01386                 <font class="keywordflow">break</font>;
01387             }
01388         }
01389         <font class="comment">// resize</font>
01390         <font class="keywordflow">if</font>(nIndex &lt; nDef)   <font class="comment">// before default pane</font>
01391         {
01392             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = nIndex; i &lt; nDef; i++)
01393                 pPanesPos[i] += cxOff;
01394                 
01395         }
01396         <font class="keywordflow">else</font>            <font class="comment">// after default one</font>
01397         {
01398             <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = nDef; i &lt; nIndex; i++)
01399                 pPanesPos[i] -= cxOff;
01400         }
01401         <font class="comment">// set pane postions</font>
01402         <font class="keywordflow">return</font> SetParts(m_nPanes, pPanesPos);
01403     }
01404 
01405 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
<a name="l01406"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a11">01406</a> <font class="preprocessor"></font>    BOOL GetPaneTipText(<font class="keywordtype">int</font> nPaneID, LPTSTR lpstrText, <font class="keywordtype">int</font> nSize)<font class="keyword"> const</font>
01407 <font class="keyword">    </font>{
01408         ATLASSERT(::IsWindow(m_hWnd));
01409         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01410         <font class="keywordflow">if</font>(nIndex == -1)
01411             <font class="keywordflow">return</font> FALSE;
01412 
01413         GetTipText(nIndex, lpstrText, nSize);
01414         <font class="keywordflow">return</font> TRUE;
01415     }
01416 
<a name="l01417"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a12">01417</a>     BOOL SetPaneTipText(<font class="keywordtype">int</font> nPaneID, LPCTSTR lpstrText)
01418     {
01419         ATLASSERT(::IsWindow(m_hWnd));
01420         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01421         <font class="keywordflow">if</font>(nIndex == -1)
01422             <font class="keywordflow">return</font> FALSE;
01423 
01424         SetTipText(nIndex, lpstrText);
01425         <font class="keywordflow">return</font> TRUE;
01426     }
01427 
<a name="l01428"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a13">01428</a>     BOOL GetPaneIcon(<font class="keywordtype">int</font> nPaneID, HICON&amp; hIcon)<font class="keyword"> const</font>
01429 <font class="keyword">    </font>{
01430         ATLASSERT(::IsWindow(m_hWnd));
01431         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01432         <font class="keywordflow">if</font>(nIndex == -1)
01433             <font class="keywordflow">return</font> FALSE;
01434 
01435         hIcon = GetIcon(nIndex);
01436         <font class="keywordflow">return</font> TRUE;
01437     }
01438 
<a name="l01439"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a14">01439</a>     BOOL SetPaneIcon(<font class="keywordtype">int</font> nPaneID, HICON hIcon)
01440     {
01441         ATLASSERT(::IsWindow(m_hWnd));
01442         <font class="keywordtype">int</font> nIndex  = GetPaneIndexFromID(nPaneID);
01443         <font class="keywordflow">if</font>(nIndex == -1)
01444             <font class="keywordflow">return</font> FALSE;
01445 
01446         <font class="keywordflow">return</font> SetIcon(nIndex, hIcon);
01447     }
01448 <font class="preprocessor">#endif //(_WIN32_IE &gt;= 0x0400)</font>
01449 <font class="preprocessor"></font>
01450 <font class="comment">// Message map and handlers</font>
01451     BEGIN_MSG_MAP(CMultiPaneStatusBarCtrlImpl&lt; T &gt;)
01452         MESSAGE_HANDLER(WM_SIZE, OnSize)
01453     END_MSG_MAP()
01454 
<a name="l01455"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a15">01455</a>     LRESULT OnSize(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01456     {
01457         LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);
01458         <font class="keywordflow">if</font>(wParam != SIZE_MINIMIZED &amp;&amp; m_nPanes &gt; 0)
01459         {
01460             T* pT = static_cast&lt;T*&gt;(this);
01461             pT-&gt;UpdatePanesLayout();
01462         }
01463         <font class="keywordflow">return</font> lRet;
01464     }
01465 
01466 <font class="comment">// Implementation</font>
<a name="l01467"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a16">01467</a>     BOOL UpdatePanesLayout()
01468     {
01469         <font class="comment">// get pane positions</font>
01470         <font class="keywordtype">int</font>* pPanesPos = NULL;
01471         ATLTRY(pPanesPos = (<font class="keywordtype">int</font>*)_alloca(m_nPanes * <font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)));
01472         ATLASSERT(pPanesPos != NULL);
01473         <font class="keywordflow">if</font>(pPanesPos == NULL)
01474             <font class="keywordflow">return</font> FALSE;
01475         <font class="keywordtype">int</font> nRet = GetParts(m_nPanes, pPanesPos);
01476         ATLASSERT(nRet == m_nPanes);
01477         <font class="keywordflow">if</font>(nRet != m_nPanes)
01478             <font class="keywordflow">return</font> FALSE;
01479         <font class="comment">// calculate offset</font>
01480         RECT rcClient;
01481         GetClientRect(&amp;rcClient);
01482         <font class="keywordtype">int</font> cxOff = rcClient.right - (pPanesPos[m_nPanes - 1] + ::GetSystemMetrics(SM_CXVSCROLL) + ::GetSystemMetrics(SM_CXEDGE));
01483         <font class="comment">// find variable width pane</font>
01484         <font class="keywordtype">int</font> i;
01485         <font class="keywordflow">for</font>(i = 0; i &lt; m_nPanes; i++)
01486         {
01487             <font class="keywordflow">if</font>(m_pPane[i] == <a class="code" href="atlres_8h.html#a3">ID_DEFAULT_PANE</a>)
01488                 <font class="keywordflow">break</font>;
01489         }
01490         <font class="comment">// resize all panes from the variable one to the right</font>
01491         <font class="keywordflow">if</font>((i &lt; m_nPanes) &amp;&amp; (pPanesPos[i] + cxOff) &gt; ((i == 0) ? 0 : pPanesPos[i - 1]))
01492         {
01493             <font class="keywordflow">for</font>(; i &lt; m_nPanes; i++)
01494                 pPanesPos[i] += cxOff;
01495         }
01496         <font class="comment">// set pane postions</font>
01497         <font class="keywordflow">return</font> SetParts(m_nPanes, pPanesPos);
01498     }
01499 
<a name="l01500"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a17">01500</a>     <font class="keywordtype">int</font> GetPaneIndexFromID(<font class="keywordtype">int</font> nPaneID)<font class="keyword"> const</font>
01501 <font class="keyword">    </font>{
01502         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; m_nPanes; i++)
01503         {
01504             <font class="keywordflow">if</font>(m_pPane[i] == nPaneID)
01505                 <font class="keywordflow">return</font> i;
01506         }
01507 
01508         <font class="keywordflow">return</font> -1;  <font class="comment">// not found</font>
01509     }
01510 };
01511 
<a name="l01512"></a><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrl.html">01512</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrl.html">CMultiPaneStatusBarCtrl</a> : <font class="keyword">public</font> CMultiPaneStatusBarCtrlImpl&lt;CMultiPaneStatusBarCtrl&gt;
01513 {
01514 <font class="keyword">public</font>:
01515     <a class="code" href="classWTL_1_1CMultiPaneStatusBarCtrlImpl.html#a0">DECLARE_WND_SUPERCLASS</a>(_T(<font class="stringliteral">"WTL_MultiPaneStatusBar"</font>), GetWndClassName())
01516 };
01517 
01518 
01520 <font class="comment">// CPaneContainer - provides header with title and close button for panes</font>
01521 
01522 <font class="comment">// pane container extended styles</font>
<a name="l01523"></a><a class="code" href="atlctrlx_8h.html#a6">01523</a> <font class="preprocessor">#define PANECNT_NOCLOSEBUTTON   0x00000001</font>
<a name="l01524"></a><a class="code" href="atlctrlx_8h.html#a7">01524</a> <font class="preprocessor"></font><font class="preprocessor">#define PANECNT_VERTICAL    0x00000002</font>
01525 <font class="preprocessor"></font>
01526 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keyword">class</font> TBase = CWindow, <font class="keyword">class</font> TWinTraits = CControlWinTraits&gt;
<a name="l01527"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html">01527</a> <font class="keyword">class </font>ATL_NO_VTABLE CPaneContainerImpl : <font class="keyword">public</font> <a class="code" href="classCWindowImpl.html">CWindowImpl</a>&lt; T, TBase, TWinTraits &gt;, <font class="keyword">public</font> <a class="code" href="classWTL_1_1CCustomDraw.html">CCustomDraw</a>&lt; T &gt;
01528 {
01529 <font class="keyword">public</font>:
01530     DECLARE_WND_CLASS_EX(NULL, 0, -1)
01531 
01532 <font class="comment">// Constants</font>
01533     <font class="keyword">enum</font>
01534     {
01535         m_cxyBorder = 2,
01536         m_cxyTextOffset = 4,
01537         m_cxyBtnOffset = 1,
01538 
01539         m_cchTitle = 80,
01540 
01541         m_cxImageTB = 13,
01542         m_cyImageTB = 11,
01543         m_cxyBtnAddTB = 7,
01544 
01545         m_cxToolBar = m_cxImageTB + m_cxyBtnAddTB + m_cxyBorder + m_cxyBtnOffset,
01546 
01547         m_xBtnImageLeft = 6,
01548         m_yBtnImageTop = 5,
01549         m_xBtnImageRight = 12,
01550         m_yBtnImageBottom = 11,
01551 
01552         m_nCloseBtnID = <a class="code" href="atlres_8h.html#a79">ID_PANE_CLOSE</a>
01553     };
01554 
01555 <font class="comment">// Data members</font>
<a name="l01556"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#m0">01556</a>     <a class="code" href="namespaceWTL.html#a13">CToolBarCtrl</a> m_tb;
<a name="l01557"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#m1">01557</a>     <a class="code" href="classCWindow.html">CWindow</a> m_wndClient;
<a name="l01558"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#m2">01558</a>     <font class="keywordtype">int</font> m_cxyHeader;
<a name="l01559"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#m3">01559</a>     TCHAR m_szTitle[m_cchTitle];
<a name="l01560"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#m4">01560</a>     DWORD m_dwExtendedStyle;    <font class="comment">// Pane container specific extended styles</font>
01561 
01562 
01563 <font class="comment">// Constructor</font>
<a name="l01564"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a0">01564</a>     CPaneContainerImpl() : m_cxyHeader(0), m_dwExtendedStyle(0)
01565     {
01566         m_szTitle[0] = 0;
01567     }
01568 
01569 <font class="comment">// Attributes</font>
<a name="l01570"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a1">01570</a>     DWORD GetPaneContainerExtendedStyle()<font class="keyword"> const</font>
01571 <font class="keyword">    </font>{
01572         <font class="keywordflow">return</font> m_dwExtendedStyle;
01573     }
01574 
<a name="l01575"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a2">01575</a>     DWORD SetPaneContainerExtendedStyle(DWORD dwExtendedStyle, DWORD dwMask = 0)
01576     {
01577         DWORD dwPrevStyle = m_dwExtendedStyle;
01578         <font class="keywordflow">if</font>(dwMask == 0)
01579             m_dwExtendedStyle = dwExtendedStyle;
01580         <font class="keywordflow">else</font>
01581             m_dwExtendedStyle = (m_dwExtendedStyle &amp; ~dwMask) | (dwExtendedStyle &amp; dwMask);
01582         <font class="keywordflow">if</font>(m_hWnd != NULL)
01583         {
01584             T* pT = static_cast&lt;T*&gt;(this);
01585             <font class="keywordtype">bool</font> bUpdate = <font class="keyword">false</font>;
01586 
01587             <font class="keywordflow">if</font>(((dwPrevStyle &amp; <a class="code" href="atlctrlx_8h.html#a6">PANECNT_NOCLOSEBUTTON</a>) != 0) &amp;&amp; ((dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a6">PANECNT_NOCLOSEBUTTON</a>) == 0))    <font class="comment">// add close button</font>
01588             {
01589                 pT-&gt;CreateCloseButton();
01590                 bUpdate = <font class="keyword">true</font>;
01591             }
01592             <font class="keywordflow">else</font> <font class="keywordflow">if</font>(((dwPrevStyle &amp; <a class="code" href="atlctrlx_8h.html#a6">PANECNT_NOCLOSEBUTTON</a>) == 0) &amp;&amp; ((dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a6">PANECNT_NOCLOSEBUTTON</a>) != 0))   <font class="comment">// remove close button</font>
01593             {
01594                 pT-&gt;DestroyCloseButton();
01595                 bUpdate = <font class="keyword">true</font>;
01596             }
01597 
01598             <font class="keywordflow">if</font>((dwPrevStyle &amp; <a class="code" href="atlctrlx_8h.html#a7">PANECNT_VERTICAL</a>) != (dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a7">PANECNT_VERTICAL</a>))    <font class="comment">// change orientation</font>
01599             {
01600                 CalcSize();
01601                 bUpdate = <font class="keyword">true</font>;
01602             }
01603 
01604             <font class="keywordflow">if</font>(bUpdate)
01605                 pT-&gt;UpdateLayout();
01606         }
01607         <font class="keywordflow">return</font> dwPrevStyle;
01608     }
01609 
<a name="l01610"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a3">01610</a>     HWND GetClient()<font class="keyword"> const</font>
01611 <font class="keyword">    </font>{
01612         <font class="keywordflow">return</font> m_wndClient;
01613     }
01614 
<a name="l01615"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a4">01615</a>     HWND SetClient(HWND hWndClient)
01616     {
01617         HWND hWndOldClient = m_wndClient;
01618         m_wndClient = hWndClient;
01619         <font class="keywordflow">if</font>(m_hWnd != NULL)
01620         {
01621             T* pT = static_cast&lt;T*&gt;(this);
01622             pT-&gt;UpdateLayout();
01623         }
01624         <font class="keywordflow">return</font> hWndOldClient;
01625     }
01626 
<a name="l01627"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a5">01627</a>     BOOL GetTitle(LPTSTR lpstrTitle, <font class="keywordtype">int</font> cchLength)<font class="keyword"> const</font>
01628 <font class="keyword">    </font>{
01629         ATLASSERT(lpstrTitle != NULL);
01630         <font class="keywordflow">return</font> (lstrcpyn(lpstrTitle, m_szTitle, cchLength) != NULL);
01631     }
01632 
<a name="l01633"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a6">01633</a>     BOOL SetTitle(LPCTSTR lpstrTitle)
01634     {
01635         ATLASSERT(lpstrTitle != NULL);
01636         BOOL bRet = (lstrcpyn(m_szTitle, lpstrTitle, m_cchTitle) != NULL);
01637         <font class="keywordflow">if</font>(bRet &amp;&amp; m_hWnd != NULL)
01638         {
01639             T* pT = static_cast&lt;T*&gt;(this);
01640             pT-&gt;UpdateLayout();
01641         }
01642         <font class="keywordflow">return</font> bRet;
01643     }
01644 
<a name="l01645"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a7">01645</a>     <font class="keywordtype">int</font> GetTitleLength()<font class="keyword"> const</font>
01646 <font class="keyword">    </font>{
01647         <font class="keywordflow">return</font> lstrlen(m_szTitle);
01648     }
01649 
01650 <font class="comment">// Methods</font>
<a name="l01651"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a8">01651</a>     HWND Create(HWND hWndParent, LPCTSTR lpstrTitle = NULL, DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN,
01652             DWORD dwExStyle = 0, UINT nID = 0, LPVOID lpCreateParam = NULL)
01653     {
01654         <font class="keywordflow">if</font>(lpstrTitle != NULL)
01655             lstrcpyn(m_szTitle, lpstrTitle, m_cchTitle);
01656         <font class="keywordflow">return</font> <a class="code" href="classCWindowImpl.html">CWindowImpl&lt; T, TBase, TWinTraits &gt;::Create</a>(hWndParent, rcDefault, NULL, dwStyle, dwExStyle, nID, lpCreateParam);
01657     }
01658 
<a name="l01659"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a9">01659</a>     HWND Create(HWND hWndParent, UINT uTitleID, DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN,
01660             DWORD dwExStyle = 0, UINT nID = 0, LPVOID lpCreateParam = NULL)
01661     {
01662         <font class="keywordflow">if</font>(uTitleID != 0U)
01663             ::LoadString(_Module.GetResourceInstance(), uTitleID, m_szTitle, m_cchTitle);
01664         <font class="keywordflow">return</font> <a class="code" href="classCWindowImpl.html">CWindowImpl&lt; T, TBase, TWinTraits &gt;::Create</a>(hWndParent, rcDefault, NULL, dwStyle, dwExStyle, nID, lpCreateParam);
01665     }
01666 
<a name="l01667"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a10">01667</a>     BOOL EnableCloseButton(BOOL bEnable)
01668     {
01669         ATLASSERT(::IsWindow(m_hWnd));
01670         T* pT = static_cast&lt;T*&gt;(this);
01671         pT; <font class="comment">// avoid level 4 warning</font>
01672         <font class="keywordflow">return</font> (m_tb.m_hWnd != NULL) ? m_tb.EnableButton(pT-&gt;m_nCloseBtnID, bEnable) : FALSE;
01673     }
01674 
<a name="l01675"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a11">01675</a>     <font class="keywordtype">void</font> UpdateLayout()
01676     {
01677         RECT rcClient;
01678         GetClientRect(&amp;rcClient);
01679         T* pT = static_cast&lt;T*&gt;(this);
01680         pT-&gt;UpdateLayout(rcClient.right, rcClient.bottom);
01681     }
01682 
01683 <font class="comment">// Message map and handlers</font>
01684     BEGIN_MSG_MAP(CPaneContainerImpl)
01685         MESSAGE_HANDLER(WM_CREATE, OnCreate)
01686         MESSAGE_HANDLER(WM_SIZE, OnSize)
01687         MESSAGE_HANDLER(WM_SETFOCUS, OnSetFocus)
01688         MESSAGE_HANDLER(WM_ERASEBKGND, OnEraseBackground)
01689         MESSAGE_HANDLER(WM_PAINT, OnPaint)
01690         MESSAGE_HANDLER(WM_NOTIFY, OnNotify)
01691         MESSAGE_HANDLER(WM_COMMAND, OnCommand)
01692         <a class="code" href="atlapp_8h.html#a30">FORWARD_NOTIFICATIONS</a>()
01693     END_MSG_MAP()
01694 
<a name="l01695"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a12">01695</a>     LRESULT OnCreate(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01696     {
01697         T* pT = static_cast&lt;T*&gt;(this);
01698         pT-&gt;CalcSize();
01699 
01700         <font class="keywordflow">if</font>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a6">PANECNT_NOCLOSEBUTTON</a>) == 0)
01701             pT-&gt;CreateCloseButton();
01702 
01703         <font class="keywordflow">return</font> 0;
01704     }
01705 
<a name="l01706"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a13">01706</a>     LRESULT OnSize(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01707     {
01708         T* pT = static_cast&lt;T*&gt;(this);
01709         pT-&gt;UpdateLayout(<a class="code" href="atlapp_8h.html#a28">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a29">GET_Y_LPARAM</a>(lParam));
01710         <font class="keywordflow">return</font> 0;
01711     }
01712 
<a name="l01713"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a14">01713</a>     LRESULT OnSetFocus(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01714     {
01715         <font class="keywordflow">if</font>(m_wndClient.m_hWnd != NULL)
01716             m_wndClient.SetFocus();
01717         <font class="keywordflow">return</font> 0;
01718     }
01719 
<a name="l01720"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a15">01720</a>     LRESULT OnEraseBackground(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01721     {
01722         <font class="keywordflow">return</font> 1;   <font class="comment">// no background needed</font>
01723     }
01724 
<a name="l01725"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a16">01725</a>     LRESULT OnPaint(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM <font class="comment">/*lParam*/</font>, BOOL&amp; <font class="comment">/*bHandled*/</font>)
01726     {
01727         <a class="code" href="classWTL_1_1CPaintDC.html">CPaintDC</a> dc(m_hWnd);
01728 
01729         T* pT = static_cast&lt;T*&gt;(this);
01730         pT-&gt;DrawPaneTitle(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
01731 
01732         <font class="keywordflow">if</font>(m_wndClient.m_hWnd == NULL)  <font class="comment">// no client window</font>
01733             pT-&gt;DrawPane(dc.<a class="code" href="classWTL_1_1CDCT.html#m0">m_hDC</a>);
01734 
01735         <font class="keywordflow">return</font> 0;
01736     }
01737 
<a name="l01738"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a17">01738</a>     LRESULT OnNotify(UINT <font class="comment">/*uMsg*/</font>, WPARAM <font class="comment">/*wParam*/</font>, LPARAM lParam, BOOL&amp; bHandled)
01739     {
01740         <font class="keywordflow">if</font>(m_tb.m_hWnd == NULL)
01741         {
01742             bHandled = FALSE;
01743             <font class="keywordflow">return</font> 1;
01744         }
01745 
01746         T* pT = static_cast&lt;T*&gt;(this);
01747         LPNMHDR lpnmh = (LPNMHDR)lParam;
01748         LRESULT lRet = 0;
01749 
01750         <font class="comment">// pass toolbar custom draw notifications to the base class</font>
01751         <font class="keywordflow">if</font>(lpnmh-&gt;code == NM_CUSTOMDRAW &amp;&amp; lpnmh-&gt;hwndFrom == m_tb.m_hWnd)
01752             lRet = <a class="code" href="classWTL_1_1CCustomDraw.html">CCustomDraw&lt; T &gt;::OnCustomDraw</a>(0, lpnmh, bHandled);
01753         <font class="comment">// tooltip notifications come with the tooltip window handle and button ID,</font>
01754         <font class="comment">// pass them to the parent if we don't handle them</font>
01755         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(lpnmh-&gt;code == TTN_GETDISPINFO &amp;&amp; lpnmh-&gt;idFrom == pT-&gt;m_nCloseBtnID)
01756             bHandled = pT-&gt;GetToolTipText(lpnmh);
01757         <font class="comment">// only let notifications not from the toolbar go to the parent</font>
01758         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(lpnmh-&gt;hwndFrom != m_tb.m_hWnd &amp;&amp; lpnmh-&gt;idFrom != pT-&gt;m_nCloseBtnID)
01759             bHandled = FALSE;
01760 
01761         <font class="keywordflow">return</font> lRet;
01762     }
01763 
<a name="l01764"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a18">01764</a>     LRESULT OnCommand(UINT <font class="comment">/*uMsg*/</font>, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)
01765     {
01766         <font class="comment">// if command comes from the close button, substitute HWND of the pane container instead</font>
01767         <font class="keywordflow">if</font>(m_tb.m_hWnd != NULL &amp;&amp; (HWND)lParam == m_tb.m_hWnd)
01768             return ::SendMessage(GetParent(), WM_COMMAND, wParam, (LPARAM)m_hWnd);
01769 
01770         bHandled = FALSE;
01771         <font class="keywordflow">return</font> 1;
01772     }
01773 
01774 <font class="comment">// Custom draw overrides</font>
<a name="l01775"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a19">01775</a>     DWORD OnPrePaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW <font class="comment">/*lpNMCustomDraw*/</font>)
01776     {
01777         <font class="keywordflow">return</font> CDRF_NOTIFYITEMDRAW; <font class="comment">// we need per-item notifications</font>
01778     }
01779 
<a name="l01780"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a20">01780</a>     DWORD OnItemPrePaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW lpNMCustomDraw)
01781     {
01782         <a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc = lpNMCustomDraw-&gt;hdc;
01783 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
01784 <font class="preprocessor"></font>        RECT&amp; rc = lpNMCustomDraw-&gt;rc;
01785 <font class="preprocessor">#else </font>
01786 <font class="preprocessor">        RECT rc;</font>
01787 <font class="preprocessor"></font>        m_tb.GetItemRect(0, &amp;rc);
01788 <font class="preprocessor">#endif </font>
01789 <font class="preprocessor"></font>
01790 <font class="preprocessor"></font>        dc.FillRect(&amp;rc, COLOR_3DFACE);
01791 
01792         <font class="keywordflow">return</font> CDRF_NOTIFYPOSTPAINT;
01793     }
01794 
<a name="l01795"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a21">01795</a>     DWORD OnItemPostPaint(<font class="keywordtype">int</font> <font class="comment">/*idCtrl*/</font>, LPNMCUSTOMDRAW lpNMCustomDraw)
01796     {
01797         <a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc = lpNMCustomDraw-&gt;hdc;
01798 <font class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</font>
01799 <font class="preprocessor"></font>        RECT&amp; rc = lpNMCustomDraw-&gt;rc;
01800 <font class="preprocessor">#else </font>
01801 <font class="preprocessor">        RECT rc;</font>
01802 <font class="preprocessor"></font>        m_tb.GetItemRect(0, &amp;rc);
01803 <font class="preprocessor">#endif </font>
01804 <font class="preprocessor"></font>
01805 <font class="preprocessor"></font>        RECT rcImage = { m_xBtnImageLeft, m_yBtnImageTop, m_xBtnImageRight + 1, m_yBtnImageBottom + 1 };
01806         ::OffsetRect(&amp;rcImage, rc.left, rc.top);
01807         T* pT = static_cast&lt;T*&gt;(this);
01808 
01809         <font class="keywordflow">if</font>((lpNMCustomDraw-&gt;uItemState &amp; CDIS_DISABLED) != 0)
01810         {
01811             RECT rcShadow = rcImage;
01812             ::OffsetRect(&amp;rcShadow, 1, 1);
01813             <a class="code" href="namespaceWTL.html#a36">CPen</a> pen1;
01814             pen1.CreatePen(PS_SOLID, 0, ::GetSysColor(COLOR_3DHILIGHT));
01815             pT-&gt;DrawButtonImage(dc, rcShadow, pen1);
01816             <a class="code" href="namespaceWTL.html#a36">CPen</a> pen2;
01817             pen2.CreatePen(PS_SOLID, 0, ::GetSysColor(COLOR_3DSHADOW));
01818             pT-&gt;DrawButtonImage(dc, rcImage, pen2);
01819         }
01820         <font class="keywordflow">else</font>
01821         {
01822             <font class="keywordflow">if</font>((lpNMCustomDraw-&gt;uItemState &amp; CDIS_SELECTED) != 0)
01823                 ::OffsetRect(&amp;rcImage, 1, 1);
01824             <a class="code" href="namespaceWTL.html#a36">CPen</a> pen;
01825             pen.CreatePen(PS_SOLID, 0, ::GetSysColor(COLOR_BTNTEXT));
01826             pT-&gt;DrawButtonImage(dc, rcImage, pen);
01827         }
01828 
01829         <font class="keywordflow">return</font> CDRF_DODEFAULT;  <font class="comment">// continue with the default item painting</font>
01830     }
01831 
01832 <font class="comment">// Implementation - overrideable methods</font>
<a name="l01833"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a22">01833</a>     <font class="keywordtype">void</font> UpdateLayout(<font class="keywordtype">int</font> cxWidth, <font class="keywordtype">int</font> cyHeight)
01834     {
01835         ATLASSERT(::IsWindow(m_hWnd));
01836         RECT rect;
01837 
01838         <font class="keywordflow">if</font>(IsVertical())
01839         {
01840             ::SetRect(&amp;rect, 0, 0, m_cxyHeader, cyHeight);
01841             <font class="keywordflow">if</font>(m_tb.m_hWnd != NULL)
01842                 m_tb.SetWindowPos(NULL, m_cxyBorder, m_cxyBorder + m_cxyBtnOffset, 0, 0, SWP_NOZORDER | SWP_NOSIZE | SWP_NOACTIVATE);
01843 
01844             <font class="keywordflow">if</font>(m_wndClient.m_hWnd != NULL)
01845                 m_wndClient.SetWindowPos(NULL, m_cxyHeader, 0, cxWidth - m_cxyHeader, cyHeight, SWP_NOZORDER);
01846             <font class="keywordflow">else</font>
01847                 rect.right = cxWidth;
01848         }
01849         <font class="keywordflow">else</font>
01850         {
01851             ::SetRect(&amp;rect, 0, 0, cxWidth, m_cxyHeader);
01852             <font class="keywordflow">if</font>(m_tb.m_hWnd != NULL)
01853                 m_tb.SetWindowPos(NULL, rect.right - m_cxToolBar, m_cxyBorder + m_cxyBtnOffset, 0, 0, SWP_NOZORDER | SWP_NOSIZE | SWP_NOACTIVATE);
01854 
01855             <font class="keywordflow">if</font>(m_wndClient.m_hWnd != NULL)
01856                 m_wndClient.SetWindowPos(NULL, 0, m_cxyHeader, cxWidth, cyHeight - m_cxyHeader, SWP_NOZORDER);
01857             <font class="keywordflow">else</font>
01858                 rect.bottom = cyHeight;
01859         }
01860 
01861         InvalidateRect(&amp;rect);
01862     }
01863 
<a name="l01864"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a23">01864</a>     <font class="keywordtype">void</font> CreateCloseButton()
01865     {
01866         ATLASSERT(m_tb.m_hWnd == NULL);
01867         <font class="comment">// create toolbar for the "x" button</font>
01868         m_tb.Create(m_hWnd, rcDefault, NULL, WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN | WS_CLIPSIBLINGS | CCS_NODIVIDER | CCS_NORESIZE | CCS_NOPARENTALIGN | CCS_NOMOVEY | TBSTYLE_TOOLTIPS | TBSTYLE_FLAT, 0);
01869         ATLASSERT(m_tb.IsWindow());
01870 
01871         <font class="keywordflow">if</font>(m_tb.m_hWnd != NULL)
01872         {
01873             T* pT = static_cast&lt;T*&gt;(this);
01874             pT; <font class="comment">// avoid level 4 warning</font>
01875 
01876             m_tb.SetButtonStructSize();
01877 
01878             TBBUTTON tbbtn;
01879             memset(&amp;tbbtn, 0, <font class="keyword">sizeof</font>(tbbtn));
01880             tbbtn.idCommand = pT-&gt;m_nCloseBtnID;
01881             tbbtn.fsState = TBSTATE_ENABLED;
01882             tbbtn.fsStyle = TBSTYLE_BUTTON;
01883             m_tb.AddButtons(1, &amp;tbbtn);
01884 
01885             m_tb.SetBitmapSize(m_cxImageTB, m_cyImageTB);
01886             m_tb.SetButtonSize(m_cxImageTB + m_cxyBtnAddTB, m_cyImageTB + m_cxyBtnAddTB);
01887 
01888             <font class="keywordflow">if</font>(IsVertical())
01889                 m_tb.SetWindowPos(NULL, m_cxyBorder + m_cxyBtnOffset, m_cxyBorder + m_cxyBtnOffset, m_cxImageTB + m_cxyBtnAddTB, m_cyImageTB + m_cxyBtnAddTB, SWP_NOZORDER | SWP_NOACTIVATE);
01890             <font class="keywordflow">else</font>
01891                 m_tb.SetWindowPos(NULL, 0, 0, m_cxImageTB + m_cxyBtnAddTB, m_cyImageTB + m_cxyBtnAddTB, SWP_NOZORDER | SWP_NOMOVE | SWP_NOACTIVATE);
01892         }
01893     }
01894 
<a name="l01895"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a24">01895</a>     <font class="keywordtype">void</font> DestroyCloseButton()
01896     {
01897         <font class="keywordflow">if</font>(m_tb.m_hWnd != NULL)
01898             m_tb.DestroyWindow();
01899     }
01900 
<a name="l01901"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a25">01901</a>     <font class="keywordtype">void</font> CalcSize()
01902     {
01903         T* pT = static_cast&lt;T*&gt;(this);
01904         <a class="code" href="namespaceWTL.html#a39">CFontHandle</a> font = pT-&gt;GetTitleFont();
01905         LOGFONT lf;
01906         font.GetLogFont(lf);
01907         <font class="keywordflow">if</font>(IsVertical())
01908         {
01909             m_cxyHeader = m_cxImageTB + m_cxyBtnAddTB + m_cxyBorder;
01910         }
01911         <font class="keywordflow">else</font>
01912         {
01913             <font class="keywordtype">int</font> cyFont = abs(lf.lfHeight) + m_cxyBorder + 2 * m_cxyTextOffset;
01914             <font class="keywordtype">int</font> cyBtn = m_cyImageTB + m_cxyBtnAddTB + m_cxyBorder + 2 * m_cxyBtnOffset;
01915             m_cxyHeader = max(cyFont, cyBtn);
01916         }
01917     }
01918 
<a name="l01919"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a26">01919</a>     HFONT GetTitleFont()<font class="keyword"> const</font>
01920 <font class="keyword">    </font>{
01921         <font class="keywordflow">return</font> <a class="code" href="namespaceWTL.html#a60">AtlGetDefaultGuiFont</a>();
01922     }
01923 
<a name="l01924"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a27">01924</a>     BOOL GetToolTipText(LPNMHDR <font class="comment">/*lpnmh*/</font>)
01925     {
01926         <font class="keywordflow">return</font> FALSE;
01927     }
01928 
<a name="l01929"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a28">01929</a>     <font class="keywordtype">void</font> DrawPaneTitle(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc)
01930     {
01931         RECT rect;
01932         GetClientRect(&amp;rect);
01933 
01934         <font class="keywordflow">if</font>(IsVertical())
01935         {
01936             rect.right = rect.left + m_cxyHeader;
01937             dc.DrawEdge(&amp;rect, EDGE_ETCHED, BF_LEFT | BF_TOP | BF_BOTTOM | BF_ADJUST);
01938             dc.FillRect(&amp;rect, COLOR_3DFACE);
01939         }
01940         <font class="keywordflow">else</font>
01941         {
01942             rect.bottom = rect.top + m_cxyHeader;
01943             dc.DrawEdge(&amp;rect, EDGE_ETCHED, BF_LEFT | BF_TOP | BF_RIGHT | BF_ADJUST);
01944             dc.FillRect(&amp;rect, COLOR_3DFACE);
01945             <font class="comment">// draw title only for horizontal pane container</font>
01946             dc.SetTextColor(::GetSysColor(COLOR_WINDOWTEXT));
01947             dc.SetBkMode(TRANSPARENT);
01948             T* pT = static_cast&lt;T*&gt;(this);
01949             HFONT hFontOld = dc.SelectFont(pT-&gt;GetTitleFont());
01950             rect.left += m_cxyTextOffset;
01951             rect.right -= m_cxyTextOffset;
01952             <font class="keywordflow">if</font>(m_tb.m_hWnd != NULL)
01953                 rect.right -= m_cxToolBar;;
01954             dc.DrawText(m_szTitle, -1, &amp;rect, DT_LEFT | DT_SINGLELINE | DT_VCENTER | DT_END_ELLIPSIS);
01955             dc.SelectFont(hFontOld);
01956         }
01957     }
01958 
01959     <font class="comment">// called only if pane is empty</font>
<a name="l01960"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a29">01960</a>     <font class="keywordtype">void</font> DrawPane(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc)
01961     {
01962         RECT rect;
01963         GetClientRect(&amp;rect);
01964         <font class="keywordflow">if</font>(IsVertical())
01965             rect.left += m_cxyHeader;
01966         <font class="keywordflow">else</font>
01967             rect.top += m_cxyHeader;
01968         <font class="keywordflow">if</font>((GetExStyle() &amp; WS_EX_CLIENTEDGE) == 0)
01969             dc.DrawEdge(&amp;rect, EDGE_SUNKEN, BF_RECT | BF_ADJUST);
01970         dc.FillRect(&amp;rect, COLOR_APPWORKSPACE);
01971     }
01972 
01973     <font class="comment">// drawing helper - draws "x" button image</font>
<a name="l01974"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a30">01974</a>     <font class="keywordtype">void</font> DrawButtonImage(<a class="code" href="namespaceWTL.html#a47">CDCHandle</a> dc, RECT&amp; rcImage, HPEN hPen)
01975     {
01976         HPEN hPenOld = dc.SelectPen(hPen);
01977 
01978         dc.MoveTo(rcImage.left, rcImage.top);
01979         dc.LineTo(rcImage.right, rcImage.bottom);
01980         dc.MoveTo(rcImage.left + 1, rcImage.top);
01981         dc.LineTo(rcImage.right + 1, rcImage.bottom);
01982 
01983         dc.MoveTo(rcImage.left, rcImage.bottom - 1);
01984         dc.LineTo(rcImage.right, rcImage.top - 1);
01985         dc.MoveTo(rcImage.left + 1, rcImage.bottom - 1);
01986         dc.LineTo(rcImage.right + 1, rcImage.top - 1);
01987 
01988         dc.SelectPen(hPenOld);
01989     }
01990 
<a name="l01991"></a><a class="code" href="classWTL_1_1CPaneContainerImpl.html#a31">01991</a>     <font class="keywordtype">bool</font> IsVertical()<font class="keyword"> const</font>
01992 <font class="keyword">    </font>{
01993         <font class="keywordflow">return</font> ((m_dwExtendedStyle &amp; <a class="code" href="atlctrlx_8h.html#a7">PANECNT_VERTICAL</a>) != 0);
01994     }
01995 };
01996 
<a name="l01997"></a><a class="code" href="classWTL_1_1CPaneContainer.html">01997</a> <font class="keyword">class </font><a class="code" href="classWTL_1_1CPaneContainer.html">CPaneContainer</a> : <font class="keyword">public</font> CPaneContainerImpl&lt;CPaneContainer&gt;
01998 {
01999 <font class="keyword">public</font>:
02000     DECLARE_WND_CLASS_EX(_T(<font class="stringliteral">"WTL_PaneContainer"</font>), 0, -1)
02001 };
02002 
02003 }; <font class="comment">//namespace WTL</font>
02004 
02005 <font class="preprocessor">#endif // __ATLCTRLX_H__</font>
</pre></div><hr><address align="right"><small>Generated on Thu Apr 11 21:09:30 2002 for wtl-doc by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
